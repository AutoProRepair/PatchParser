<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|31501d5eefb54b11e3fd238c97f777510e70b8b0|lout"> 
  <link rel="shortcut icon" href="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"sd.customer.profile.multi.languages\":true,\"sd.customer.portal.transitions\":true,\"sd.customer.portal.transitions.config\":true,\"sd.custom.email.stripping.rules\":false,\"sd.sla.lucene.issue.id.callback.performance\":true,\"sd.new.settings.sidebar.location\":true,\"sd.workload.report.paginator\":true,\"sd.experimental.portal.search.algorithm.default.1\":false,\"sd.customer.portal.help.center.agent.announcement\":true,\"sd.sla.improved.rendering\":false,\"sd.experimental.portal.search.algorithm.default.2\":false,\"sd.customer.feedback.validate.reporter.on.token\":true,\"sd.custom.email.notifications.utf8.csat.star\":true,\"sd.who.create.customers.by.email.setting\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.renderer.consider.variable.format\":true,\"sd.stats.event.tracking\":true,\"sd.password.helper.dialog\":true,\"sd.canned.responses\":false,\"sd.portal.help.center.customer.signup.secondary.email\":true,\"sd.custom.email.notifications.manage.language\":true,\"sd.use.search.by.permissions\":true,\"sd.slavalue.record.updated.date\":false,\"sd.report.custom.date.range\":false,\"sd.kb.article.helpfulness.report\":false,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"sd.custom.email.notifications.styling\":true,\"sd.workinghours.new.page.bulldog.1\":false,\"sd.customer.portal.two.step.login\":false,\"sd.automation.psmq.async.executor\":true,\"sd.customer.org.list.page.lazy.search\":true,\"sd.approval.requested.when.handler\":true,\"sd.request.type.field.rest.api.filtering.bugfix\":true,\"sd.automation.then.action.auto.answer.approval\":true,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"sla.will.only.be.paused.if.they.are.already.started\":true,\"sd.kb.comment.share.stats.collection\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"sd.customer.orgs.group.participants\":true,\"sd.portal.help.center.customer.signup\":true,\"sd.sla.agent.jql.security.restricted\":true,\"sd.test.feature.flag.x\":true,\"sd.test.feature.flag.y\":false,\"sd.cluster.safe.mail.channel.shutdown\":true,\"sd.email.channel.folders\":false,\"sd.email.analytics.open\":false,\"sd.kb.project.creation.create.link.space\":true,\"sd.workinghours.new.page\":false,\"sd.confluence.anonymous.permission.fix\":true,\"com.atlassian.jira.issuetable.draggable\":true,\"sd.customer.portal.project.agent.announcement\":true,\"sd.automation.audit.log\":true,\"jira.jql.suggestrecentfields\":false,\"sd.canned.responses.check.index.startup\":false,\"sd.new.project.templates\":true,\"sd.custom.email.notifications.custom.rules.simple.ui\":false,\"sd.custom.email.notifications.cut.over\":true,\"sd.dismiss.all.misconfiguration.warnings.setting\":true,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"sd.sla.configurations.export\":true,\"sd.canned.responses.variable.substitution\":true,\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"sd.customer.portal.prioties.per.project.fix\":true,\"jira.instrumentation.laas\":false,\"sd.kb.self.service.report\":false,\"sla.improved.request.handling\":true,\"sd.no.schedule.async.upgrade.tasks\":true,\"sd.kb.primary.nav\":true,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"sd.kb.issueview.panel.phase2\":true,\"sd.email.outsider.comments\":true,\"jira.create.linked.issue\":true,\"sd.kb.issueview.panel\":true,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"sd.approvals.light.weight\":false,\"sd.automation.then.webhook\":true,\"sd.respect.inline.edit.issue.off\":true,\"jira.jql.smartautoselectfirst\":false,\"sd.global.portal.search.atlassian.only.tracking\":false,\"sd.automation.if.condition.comment.primary.action\":true,\"jira.priorities.per.project\":true,\"sd.inline.noformat.renderer\":true,\"sd.customer.request.type.create.edit.screens\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/png,image/vnd.wap.wbmp,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data"]="{\"substitutionVariables\":{\"issue.summary\":\"Issue summary\",\"issue.description\":\"Issue description\",\"issue.key\":\"Issue key\",\"issue.reporter.name\":\"Issue reporter\",\"issue.resolution\":\"Issue resolution\",\"request.url\":\"Request URL\",\"request.status\":\"Request status\"}}";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-help-links.help-links"]="{\"help\":{\"email.settings\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"managing.queues\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+queues+for+your+team\",\"email.setup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"request.settings.help.bubble\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\",\"email.settings.suitablerequest\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email#Receivingrequestsbyemail-suitablerequest\",\"sla.import.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Importing+SLAs\",\"documentation.home\":\"https://docs.atlassian.com/jira/jsd-docs-039/JIRA+Service+Desk+Documentation\",\"default\":\"https://docs.atlassian.com/jira/jsd-docs-039/\",\"create.space.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base#serving-customers-with-a-knowledge-base-createpermission\",\"email.settings.troubleshooting\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+the+email+channel\",\"admin.notifications.config\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+service+desk+notifications\",\"troubleshoot.requesttype\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+request+types\",\"approvals.configuration\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+JIRA+Service+Desk+approvals\",\"setting.up.reports\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+service+desk+reports\",\"public.signup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+public+signup\",\"knowledge.base\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base\",\"resolve.permission.scheme.errors\":\"https://docs.atlassian.com/jira/jsd-docs-039/Resolving+permission+scheme+errors\",\"getting.started\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+with+JIRA+Service+Desk\",\"getting.started.agent\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+for+service+desk+agents\",\"invite.customers\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\"},\"kb\":{\"default\":\"https://confluence.atlassian.com/display/SDKB/\",\"troubleshooting.user.management.issues\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\",\"legacytransition\":\"https://confluence.atlassian.com/display/SDKB/Replacing+legacy+automatic+transitions+with+automation+rules\",\"umtroubleshoot\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\"}}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-base-url.base-url"]="\"https://issues.apache.org/jira\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"bcd59f25cba54a\"";
WRM._unparsedData["project-id"]="12310110";
WRM._unparsedData["project-key"]="\"LUCENE\"";
WRM._unparsedData["project-name"]="\"Lucene - Core\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310110";
WRM._unparsedData["projectKey"]="\"LUCENE\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/1a6b21131945f6f49ff48336b49ca3fe-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/d8484c9183f546511a8e336a8779bcd9-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d3b35d835f8f46fc3b53bb4db7f85158-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/71d42e74136d842a3ef4d5d136484843-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/95a4826c265852f4904f1e0e7300df68-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/944bb39eced1b35cfc7194aa02eb5a5a/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/5a8f0f8b8aa8f96a4f0f7e9e248d62f3-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="LUCENE-6422"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[LUCENE-6422] Add PackedQuadPrefixTree - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[LUCENE-6422] Add PackedQuadPrefixTree - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/LUCENE" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-6422">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310110" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Lucene - Core'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310110&amp;avatarId=10061"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/LUCENE">Lucene - Core</a></li>
                 <li><a class="issue-link" data-issue-key="LUCENE-6422" href="/jira/browse/LUCENE-6422" id="key-val" rel="12820937">LUCENE-6422</a></li>
                </ol>
                <h1 id="summary-val">Add PackedQuadPrefixTree</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-6422"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/LUCENE-6422/LUCENE-6422.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/LUCENE-6422/LUCENE-6422.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/LUCENE-6422/LUCENE-6422.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/LUCENE-6422/LUCENE-6422.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" title="Improvement - An improvement or enhancement to an existing feature or task." width="16"> Improvement </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+5.2" title="5.2 Major release after 5.1">5.2</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+component+%3D+%22modules%2Fspatial%22" title="modules/spatial issues related to Spatial module">modules/spatial</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12820937-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310120" class="item"> 
                     <div class="wrap"> 
                      <strong title="Lucene Fields" class="name">Lucene Fields:</strong> 
                      <div id="customfield_12310120-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310120-field"> 
                        <span>New</span>, 
                        <span>Patch Available</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>This task introduces a PackedQuadPrefixTree that includes two things:</p> 
                  <p>1. A packed 8 byte representation for a QuadCell, including more efficient implementations of the SPT API than the existing QuadPrefixTree or GeoHashPrefixTree.<br> 2. An alternative implementation to RPT's "pruneLeafyBranches" that streams the cells without buffering them all, which is way more memory efficient. However pruning is limited to the target detail level, where it accomplishes the most good.</p> 
                  <p>Future improvements over this approach may include the generation of the packed cells using an AutoPrefixAutomaton</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/LUCENE-6422?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/LUCENE-6422?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/LUCENE-6422?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/LUCENE-6422?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12725780" data-issue-id="12820937" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12725780/LUCENE-6422_with_SPT_factory_and_benchmark.patch" draggable="true" data-downloadurl="text/plain:LUCENE-6422_with_SPT_factory_and_benchmark.patch:https://issues.apache.org/jira/secure/attachment/12725780/LUCENE-6422_with_SPT_factory_and_benchmark.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12725780/LUCENE-6422_with_SPT_factory_and_benchmark.patch" title="Latest  16/Apr/15 05:01 - David Smiley" draggable="true" data-downloadurl="text/plain:LUCENE-6422_with_SPT_factory_and_benchmark.patch:https://issues.apache.org/jira/secure/attachment/12725780/LUCENE-6422_with_SPT_factory_and_benchmark.patch">LUCENE-6422_with_SPT_factory_and_benchmark.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-04-16T05:01:43.814Z">16/Apr/15 05:01</time>
                   </dd>
                   <dd class="attachment-size">
                    30 kB
                   </dd>
                   <dd class="attachment-author">
                    David Smiley
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12727300" data-issue-id="12820937" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12727300/LUCENE-6422.patch" draggable="true" data-downloadurl="text/plain:LUCENE-6422.patch:https://issues.apache.org/jira/secure/attachment/12727300/LUCENE-6422.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12727300/LUCENE-6422.patch" title="Latest  22/Apr/15 18:38 - David Smiley" draggable="true" data-downloadurl="text/plain:LUCENE-6422.patch:https://issues.apache.org/jira/secure/attachment/12727300/LUCENE-6422.patch">LUCENE-6422.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-04-22T18:38:21.431Z">22/Apr/15 18:38</time>
                   </dd>
                   <dd class="attachment-size">
                    35 kB
                   </dd>
                   <dd class="attachment-author">
                    David Smiley
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12727125" data-issue-id="12820937" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12727125/LUCENE-6422.patch" draggable="true" data-downloadurl="text/plain:LUCENE-6422.patch:https://issues.apache.org/jira/secure/attachment/12727125/LUCENE-6422.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12727125/LUCENE-6422.patch" title=" 22/Apr/15 05:29 - David Smiley" draggable="true" data-downloadurl="text/plain:LUCENE-6422.patch:https://issues.apache.org/jira/secure/attachment/12727125/LUCENE-6422.patch">LUCENE-6422.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-04-22T05:29:30.293Z">22/Apr/15 05:29</time>
                   </dd>
                   <dd class="attachment-size">
                    29 kB
                   </dd>
                   <dd class="attachment-author">
                    David Smiley
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12726932" data-issue-id="12820937" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12726932/LUCENE-6422.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6422.patch:https://issues.apache.org/jira/secure/attachment/12726932/LUCENE-6422.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12726932/LUCENE-6422.patch" title=" 21/Apr/15 18:02 - Nicholas Knize" draggable="true" data-downloadurl="text/x-patch:LUCENE-6422.patch:https://issues.apache.org/jira/secure/attachment/12726932/LUCENE-6422.patch">LUCENE-6422.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-04-21T18:02:47.153Z">21/Apr/15 18:02</time>
                   </dd>
                   <dd class="attachment-size">
                    28 kB
                   </dd>
                   <dd class="attachment-author">
                    Nicholas Knize
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12726212" data-issue-id="12820937" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12726212/LUCENE-6422.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6422.patch:https://issues.apache.org/jira/secure/attachment/12726212/LUCENE-6422.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12726212/LUCENE-6422.patch" title=" 17/Apr/15 18:04 - Nicholas Knize" draggable="true" data-downloadurl="text/x-patch:LUCENE-6422.patch:https://issues.apache.org/jira/secure/attachment/12726212/LUCENE-6422.patch">LUCENE-6422.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-04-17T18:04:47.610Z">17/Apr/15 18:04</time>
                   </dd>
                   <dd class="attachment-size">
                    27 kB
                   </dd>
                   <dd class="attachment-author">
                    Nicholas Knize
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12725382" data-issue-id="12820937" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12725382/LUCENE-6422.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6422.patch:https://issues.apache.org/jira/secure/attachment/12725382/LUCENE-6422.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12725382/LUCENE-6422.patch" title=" 14/Apr/15 21:06 - Nicholas Knize" draggable="true" data-downloadurl="text/x-patch:LUCENE-6422.patch:https://issues.apache.org/jira/secure/attachment/12725382/LUCENE-6422.patch">LUCENE-6422.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-04-14T21:06:04.868Z">14/Apr/15 21:06</time>
                   </dd>
                   <dd class="attachment-size">
                    26 kB
                   </dd>
                   <dd class="attachment-author">
                    Nicholas Knize
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12727224" data-issue-id="12820937" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12727224/LUCENE-6422-TRUNK.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6422-TRUNK.patch:https://issues.apache.org/jira/secure/attachment/12727224/LUCENE-6422-TRUNK.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12727224/LUCENE-6422-TRUNK.patch" title="Latest  22/Apr/15 13:21 - Nicholas Knize" draggable="true" data-downloadurl="text/x-patch:LUCENE-6422-TRUNK.patch:https://issues.apache.org/jira/secure/attachment/12727224/LUCENE-6422-TRUNK.patch">LUCENE-6422-TRUNK.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-04-22T13:21:42.492Z">22/Apr/15 13:21</time>
                   </dd>
                   <dd class="attachment-size">
                    29 kB
                   </dd>
                   <dd class="attachment-author">
                    Nicholas Knize
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_dsmiley" rel="dsmiley" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;David Smiley&quot;,&quot;emailAddress&quot;:&quot;dsmiley@apache.org&quot;,&quot;username&quot;:&quot;dsmiley&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="dsmiley"></span></span> David Smiley </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_nknize" rel="nknize" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Nicholas Knize&quot;,&quot;emailAddress&quot;:&quot;nknize@gmail.com&quot;,&quot;username&quot;:&quot;nknize&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="nknize"></span></span> Nicholas Knize </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">5</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="14/Apr/15 19:35"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2015-04-14T19:35:28+0000">14/Apr/15 19:35</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="15/Jun/15 21:43"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2015-06-15T21:43:39+0000">15/Jun/15 21:43</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="23/Apr/15 04:31"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2015-04-23T04:31:00+0000">23/Apr/15 04:31</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for n/a, Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6422?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6422?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6422?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6422?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6422?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6422?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6422?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6422?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6422?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6422?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6422?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6422?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-14494884\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14494884&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14494884\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14494884_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14494884_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/15 21:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-14T21:06:04+0000\'\u003e14\\/Apr\\/15 21:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eDeveloped and tested against branch_5x. I need to run more rigorous (and systematic) benchmarking but preliminary tests show a 90% reduction in index size on exotic cases (high precision).\u003c\\/p\u003e\\n\\n\u003cp\u003eOne particular shape (the political boundary of Wales): using QuadPrefixTree (w\\/ RecursivePrefixStrategy) consumed 1G of memory at TreeLevel 26 with distance_error_pct: 0.  The new PackedQuadPrefixTree brought this down to just over 80mb with the same precision.\u003c\\/p\u003e\\n\\n\u003cp\u003eThere are many improvements remaining (including using variable byte array instead of 8 bytes for even the lowest levels). But this provides initial progress that should open the door for better precision on extreme shapes.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14494884_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14494884_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/15 21:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-14T21:06:04+0000\'\u003e14\\/Apr\\/15 21:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Developed and tested against branch_5x. I need to run more rigorous (and systematic) benchmarking but preliminary tests show a 90% reduction in index size on exotic cases (high precision). \\n\\n One particular shape (the political boundary of Wales): using QuadPrefixTree (w\\/ RecursivePrefixStrategy) consumed 1G of memory at TreeLevel 26 with distance_error_pct: 0.  The new PackedQuadPrefixTree brought this down to just over 80mb with the same precision. \\n\\n There are many improvements remaining (including using variable byte array instead of 8 bytes for even the lowest levels). But this provides initial progress that should open the door for better precision on extreme shapes.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14496135\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14496135&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14496135\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14496135_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14496135_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Apr\\/15 12:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-15T12:54:34+0000\'\u003e15\\/Apr\\/15 12:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003cb\u003eAwesome work Nick!\u003c\\/b\u003e  It\'s so nice to see meaty spatial contributions like this (Geo3d is another example).\u003c\\/p\u003e\\n\\n\u003cp\u003eRE \\\"Streaming\\\" (transient memory use while indexing):  I appreciate that the out-of-the box configuration of RPT with either LegacyPrefixTree (be it quad or geohash)  will use a lot of memory for indexing.  But since... I don\'t know how long now, this only occurs if the \\\"leafy branch pruning\\\" optimization is enabled on RPT.  That algorithm, existing on RecursivePrefixTreeStrategy, unfortunately buffers all the cells. It\'s somewhat simple; it could be improved to not buffer all cells but it would need to buffer some.  Recently I did some benchmarking and found that the leafy branch pruning yielded lots of index size savings, particularly with the quad tree.  I\'d love to chat with you about the subject of \\\"leaves\\\" on the SPT and an idea I have on doing better.  Any way, I suggest you do another memory benchmark with leafy branch pruning disabled with the PackedQuadTree but not the StreamingQuad...Strategy.  With it disabled, the underlying BytesRefIteratortokenStream will consume a Iterator&lt;Cell&gt; that is a direct instance of TreeCellIterator, and then you get the \\\"streaming\\\" effect.  The existing TreeCellIterator is quite similar to the Streaming...PrefixTreeIterator here.  If I\'m right about there being no appreciable memory savings, then this part of the patch can be removed as it\'s redundant.\u003c\\/p\u003e\\n\\n\u003cp\u003eI really like the new PackedQuadPrefixTree.java.  (IMO that\'s what this JIRA issue is mostly about)  Can you consider \u003cem\u003enot\u003c\\/em\u003e subclassing Legacy* ?  I\'d like to leave the legacy trees as-is and new SPTs not inherit from it.  Can you base your next patch off of trunk?  And can you \u003cb\u003eeither\u003c\\/b\u003e post on reviewboard.apache.org or use a GitHub fork &amp; branch so I can provide by-line feedback?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14496135_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14496135_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Apr\\/15 12:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-15T12:54:34+0000\'\u003e15\\/Apr\\/15 12:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Awesome work Nick!   It\'s so nice to see meaty spatial contributions like this (Geo3d is another example). \\n\\n RE \\\"Streaming\\\" (transient memory use while indexing):  I appreciate that the out-of-the box configuration of RPT with either LegacyPrefixTree (be it quad or geohash)  will use a lot of memory for indexing.  But since... I don\'t know how long now, this only occurs if the \\\"leafy branch pruning\\\" optimization is enabled on RPT.  That algorithm, existing on RecursivePrefixTreeStrategy, unfortunately buffers all the cells. It\'s somewhat simple; it could be improved to not buffer all cells but it would need to buffer some.  Recently I did some benchmarking and found that the leafy branch pruning yielded lots of index size savings, particularly with the quad tree.  I\'d love to chat with you about the subject of \\\"leaves\\\" on the SPT and an idea I have on doing better.  Any way, I suggest you do another memory benchmark with leafy branch pruning disabled with the PackedQuadTree but not the StreamingQuad...Strategy.  With it disabled, the underlying BytesRefIteratortokenStream will consume a Iterator&lt;Cell&gt; that is a direct instance of TreeCellIterator, and then you get the \\\"streaming\\\" effect.  The existing TreeCellIterator is quite similar to the Streaming...PrefixTreeIterator here.  If I\'m right about there being no appreciable memory savings, then this part of the patch can be removed as it\'s redundant. \\n\\n I really like the new PackedQuadPrefixTree.java.  (IMO that\'s what this JIRA issue is mostly about)  Can you consider  not  subclassing Legacy* ?  I\'d like to leave the legacy trees as-is and new SPTs not inherit from it.  Can you base your next patch off of trunk?  And can you  either  post on reviewboard.apache.org or use a GitHub fork &amp; branch so I can provide by-line feedback?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14496326\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14496326&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14496326\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14496326_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14496326_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Apr\\/15 15:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-15T15:17:15+0000\'\u003e15\\/Apr\\/15 15:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks David. I will certainly be doing a more thorough benchmark and will start with the suggestions. I imagine the savings will not be as extreme as in the situation with Wales (that was just the most interesting case.)  \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eWith it disabled, the underlying BytesRefIteratortokenStream will consume a Iterator&lt;Cell&gt; that is a direct instance of TreeCellIterator, and then you get the \\\"streaming\\\" effect.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eJust a few thoughts, the StreamingPrefixTreeIterator gives the benefit of a few worlds:  \u003cbr\\/\u003e\\n1. It uses an on-demand DFS through bit shifting completely eliminating the need for the stack DFS logic in TreeCellIterator.hasNext.  I suppose code-wise it would be cleaner to subclass TreeCellIterator and just override hasNext (and possibly next since I don\'t set thisCell\\/current in next)?  That\'s a good idea for code maintenance and reuse.\u003cbr\\/\u003e\\n2. The on-demand DFS traversal already achieves a \\\"leafy branch pruning\\\" effect by not descending on Cells that already fall \\\"within\\\" the shape. This gives you pruning without having to buffer anything (other than the current and next cell). This does vary a little bit in that the RPT simply prunes all 4 \\\"leaves\\\" that \\\"intersect\\\" the shape.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eCan you consider not subclassing Legacy* ?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI\'ll certainly take a look at this. I saw the comment about not subclassing and thought about it, but since there is so much reuse with the bytes[], b_off, and b_len (which could be a BytesRef) it didn\'t make much sense duplicating code. Are you suggesting duplicating code and eventually deprecating the LegacyCell?\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14496326_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14496326_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Apr\\/15 15:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-15T15:17:15+0000\'\u003e15\\/Apr\\/15 15:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks David. I will certainly be doing a more thorough benchmark and will start with the suggestions. I imagine the savings will not be as extreme as in the situation with Wales (that was just the most interesting case.)   \\n\\n  With it disabled, the underlying BytesRefIteratortokenStream will consume a Iterator&lt;Cell&gt; that is a direct instance of TreeCellIterator, and then you get the \\\"streaming\\\" effect.  \\n\\n Just a few thoughts, the StreamingPrefixTreeIterator gives the benefit of a few worlds:   \\n1. It uses an on-demand DFS through bit shifting completely eliminating the need for the stack DFS logic in TreeCellIterator.hasNext.  I suppose code-wise it would be cleaner to subclass TreeCellIterator and just override hasNext (and possibly next since I don\'t set thisCell\\/current in next)?  That\'s a good idea for code maintenance and reuse. \\n2. The on-demand DFS traversal already achieves a \\\"leafy branch pruning\\\" effect by not descending on Cells that already fall \\\"within\\\" the shape. This gives you pruning without having to buffer anything (other than the current and next cell). This does vary a little bit in that the RPT simply prunes all 4 \\\"leaves\\\" that \\\"intersect\\\" the shape. \\n\\n  Can you consider not subclassing Legacy* ?  \\n\\n I\'ll certainly take a look at this. I saw the comment about not subclassing and thought about it, but since there is so much reuse with the bytes[], b_off, and b_len (which could be a BytesRef) it didn\'t make much sense duplicating code. Are you suggesting duplicating code and eventually deprecating the LegacyCell? \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14496658\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14496658&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14496658\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14496658_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14496658_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Apr\\/15 18:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-15T18:32:46+0000\'\u003e15\\/Apr\\/15 18:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003e1. It uses an on-demand DFS through bit shifting completely eliminating the need for the stack DFS logic in TreeCellIterator.hasNext. I suppose code-wise it would be cleaner to subclass TreeCellIterator and just override hasNext (and possibly next since I don\'t set thisCell\\/current in next)? That\'s a good idea for code maintenance and reuse.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eInteresting; I need to look at that code closer.  Nonetheless, I think a stack vs completely stream one by one is unlikely to be noticeable in a benchmark.  The memory use is capped at a small amount either way.  If we find there are measurable advantages here, then couldn\'t you provide this via overriding SpatialPrefixTree.getTreeCellIterator instead of overriding the SpatialStrategy?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003e2. The on-demand DFS traversal already achieves a \\\"leafy branch pruning\\\" effect by not descending on Cells that already fall \\\"within\\\" the shape. This gives you pruning without having to buffer anything (other than the current and next cell). This does vary a little bit in that the RPT simply prunes all 4 \\\"leaves\\\" that \\\"intersect\\\" the shape.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI think we may be talking about different things.  A \\\"leafy branch\\\" as I defined it in Lucene spatial is a parent cell in which all sub-cells that could theoretically exist are there for this shape and are also leaves.  So for a quad-tree, it\'s a parent with 4 sub-cells that are all leaves.  A \\\"leaf\\\" is a cell that is \u003cem\u003eeither\u003c\\/em\u003e within the shape from which it was derived \u003cem\u003eor\u003c\\/em\u003e it overlaps the edge but we\'ve reached a precision threshold.  Indexing the 4 leaves produces a larger index than not emitting those leaves at all and instead marking the parent as a leaf &#8211; and the end effect is semantically equivalent in terms of the search predicates.  There are some trade-offs; but I won\'t digress now.  \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eAre you suggesting duplicating code and eventually deprecating the LegacyCell?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eYes but I need to apply the patch and see how much code is at stake here.  At the time I introduced \\\"LegacyCell\\\", I refined the SpatialPrefixTree API and was unsatisfied with the only two implementations at that time, in terms of efficiencies, so I called it LegacyPrefixTree and LegacyCell.  Perhaps these could still stick around still; I welcome your input on what it might be named or if there is too little code to worry about.  But keeping having this extend \\\"LegacyCell\\\" is problematic because RecursivePrefixTreeStrategy makes an assumption for the branch pruning you can see there, right at the beginning.\u003c\\/p\u003e\\n\\n\u003cp\u003eI welcome whatever thoughts you may have on the API to make it more clear, faster, whatever.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14496658_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14496658_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Apr\\/15 18:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-15T18:32:46+0000\'\u003e15\\/Apr\\/15 18:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     1. It uses an on-demand DFS through bit shifting completely eliminating the need for the stack DFS logic in TreeCellIterator.hasNext. I suppose code-wise it would be cleaner to subclass TreeCellIterator and just override hasNext (and possibly next since I don\'t set thisCell\\/current in next)? That\'s a good idea for code maintenance and reuse.  \\n\\n Interesting; I need to look at that code closer.  Nonetheless, I think a stack vs completely stream one by one is unlikely to be noticeable in a benchmark.  The memory use is capped at a small amount either way.  If we find there are measurable advantages here, then couldn\'t you provide this via overriding SpatialPrefixTree.getTreeCellIterator instead of overriding the SpatialStrategy? \\n\\n  2. The on-demand DFS traversal already achieves a \\\"leafy branch pruning\\\" effect by not descending on Cells that already fall \\\"within\\\" the shape. This gives you pruning without having to buffer anything (other than the current and next cell). This does vary a little bit in that the RPT simply prunes all 4 \\\"leaves\\\" that \\\"intersect\\\" the shape.  \\n\\n I think we may be talking about different things.  A \\\"leafy branch\\\" as I defined it in Lucene spatial is a parent cell in which all sub-cells that could theoretically exist are there for this shape and are also leaves.  So for a quad-tree, it\'s a parent with 4 sub-cells that are all leaves.  A \\\"leaf\\\" is a cell that is  either  within the shape from which it was derived  or  it overlaps the edge but we\'ve reached a precision threshold.  Indexing the 4 leaves produces a larger index than not emitting those leaves at all and instead marking the parent as a leaf &#8211; and the end effect is semantically equivalent in terms of the search predicates.  There are some trade-offs; but I won\'t digress now.   \\n\\n  Are you suggesting duplicating code and eventually deprecating the LegacyCell?  \\n\\n Yes but I need to apply the patch and see how much code is at stake here.  At the time I introduced \\\"LegacyCell\\\", I refined the SpatialPrefixTree API and was unsatisfied with the only two implementations at that time, in terms of efficiencies, so I called it LegacyPrefixTree and LegacyCell.  Perhaps these could still stick around still; I welcome your input on what it might be named or if there is too little code to worry about.  But keeping having this extend \\\"LegacyCell\\\" is problematic because RecursivePrefixTreeStrategy makes an assumption for the branch pruning you can see there, right at the beginning. \\n\\n I welcome whatever thoughts you may have on the API to make it more clear, faster, whatever.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14496686\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14496686&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14496686\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_14496686_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14496686_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Apr\\/15 18:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-15T18:47:32+0000\'\u003e15\\/Apr\\/15 18:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCan we commit both approaches for \\\"streaming\\\" and refactor later (progress not perfection)?\u003c\\/p\u003e\\n\\n\u003cp\u003eI like that the new streaming approach has fewer abstractions on quick glance.\u003c\\/p\u003e\\n\\n\u003cp\u003eI also think further benchmarks need not block progress: they can come later.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_14496686_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14496686_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Apr\\/15 18:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-15T18:47:32+0000\'\u003e15\\/Apr\\/15 18:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Can we commit both approaches for \\\"streaming\\\" and refactor later (progress not perfection)? \\n\\n I like that the new streaming approach has fewer abstractions on quick glance. \\n\\n I also think further benchmarks need not block progress: they can come later.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14496796\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14496796&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14496796\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14496796_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14496796_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Apr\\/15 19:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-15T19:52:55+0000\'\u003e15\\/Apr\\/15 19:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eI think a stack vs completely stream one by one is unlikely to be noticeable in a benchmark.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThat\'s a possibility. It definitely warrants a benchmark to know for sure. I think it could be noticeable for \\\"deep\\\" QuadTrees? (aka: anything with high precision) as the string representation for one child can get upwards of 29 bytes vs. 8. But its really speculation without benchmark confirmation.  Also, just eliminating the need for stack-based DFS logic is a more straightforward approach, no? (no crazy data structures with transient state needed since we\'re just lexicographically incrementing a compact bit representation on demand)\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003e...couldn\'t you provide this via overriding SpatialPrefixTree.getTreeCellIterator instead of overriding the SpatialStrategy?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI like this suggestion.  If I set pruneLeafyBranches to false and override getTreeCellIterator in PackedQuadPrefixTree then, yes, RPT will call the PackedQuadPrefixTree.getTreeCellIterator from RPT.createCellIteratorToIndex and I can eliminate the StreamingPrefixTreeStrategy class altogether.  At that point I would suggest we rename RecursivePrefixTreeStrategy to something more \\\"accurate\\\", but that can be an API discussion.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI think we may be talking about different things.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWe\'re talking about the same thing.  With one difference in this implementation.  At the moment leaves that are on the edge (e.g., intersects) are not pruned. They probably could be - and this optimization would save even more space than its already saving. \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eand the end effect is semantically equivalent in terms of the search predicates.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI forgot to mention, this enhancement allows one to disable that \\\"memory saving error factor\\\" (by setting distance_error_pct to 0) and the result is quad cell precision regardless of shape size (with minimal increase in index size).  This was the initial driver for the improvement.  Allowing one to eliminate false positives - achieve results that are within the precision they specify without having a fuzzy error factor based on the size of the shape.  It doesn\'t eliminate that factor, it just provides the ability to disable it and achieve your desired precision (subject to earth curvature error) without saturating memory and blowing out the index.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eYes but I need to apply the patch and see how much code is at stake here.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI honestly think leaving that to another issue is the best strategy (progress not perfection).  That\'s something I can look at as a next step.  Until that time comes I don\'t think there\'s a problem having this enhancement subclass QuadCell and QuadPrefixTree.  Refactoring can be deferred to a separate issue.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14496796_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14496796_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Apr\\/15 19:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-15T19:52:55+0000\'\u003e15\\/Apr\\/15 19:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     I think a stack vs completely stream one by one is unlikely to be noticeable in a benchmark.  \\n\\n That\'s a possibility. It definitely warrants a benchmark to know for sure. I think it could be noticeable for \\\"deep\\\" QuadTrees? (aka: anything with high precision) as the string representation for one child can get upwards of 29 bytes vs. 8. But its really speculation without benchmark confirmation.  Also, just eliminating the need for stack-based DFS logic is a more straightforward approach, no? (no crazy data structures with transient state needed since we\'re just lexicographically incrementing a compact bit representation on demand) \\n\\n  ...couldn\'t you provide this via overriding SpatialPrefixTree.getTreeCellIterator instead of overriding the SpatialStrategy?  \\n\\n I like this suggestion.  If I set pruneLeafyBranches to false and override getTreeCellIterator in PackedQuadPrefixTree then, yes, RPT will call the PackedQuadPrefixTree.getTreeCellIterator from RPT.createCellIteratorToIndex and I can eliminate the StreamingPrefixTreeStrategy class altogether.  At that point I would suggest we rename RecursivePrefixTreeStrategy to something more \\\"accurate\\\", but that can be an API discussion. \\n\\n  I think we may be talking about different things.  \\n\\n We\'re talking about the same thing.  With one difference in this implementation.  At the moment leaves that are on the edge (e.g., intersects) are not pruned. They probably could be - and this optimization would save even more space than its already saving.  \\n\\n  and the end effect is semantically equivalent in terms of the search predicates.  \\n\\n I forgot to mention, this enhancement allows one to disable that \\\"memory saving error factor\\\" (by setting distance_error_pct to 0) and the result is quad cell precision regardless of shape size (with minimal increase in index size).  This was the initial driver for the improvement.  Allowing one to eliminate false positives - achieve results that are within the precision they specify without having a fuzzy error factor based on the size of the shape.  It doesn\'t eliminate that factor, it just provides the ability to disable it and achieve your desired precision (subject to earth curvature error) without saturating memory and blowing out the index. \\n\\n  Yes but I need to apply the patch and see how much code is at stake here.  \\n\\n I honestly think leaving that to another issue is the best strategy (progress not perfection).  That\'s something I can look at as a next step.  Until that time comes I don\'t think there\'s a problem having this enhancement subclass QuadCell and QuadPrefixTree.  Refactoring can be deferred to a separate issue.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14497475\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14497475&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14497475\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14497475_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14497475_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 02:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T02:27:56+0000\'\u003e16\\/Apr\\/15 02:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eJust a quick comment... I can see this patch assumes Java 8, yet Lucene 5x is on Java 7.  Long.BYTES doesn\'t exist, and there is no \\\"default\\\" remove method on Iterator (for PrefixTreeIterator).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14497475_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14497475_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 02:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T02:27:56+0000\'\u003e16\\/Apr\\/15 02:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Just a quick comment... I can see this patch assumes Java 8, yet Lucene 5x is on Java 7.  Long.BYTES doesn\'t exist, and there is no \\\"default\\\" remove method on Iterator (for PrefixTreeIterator).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14497561\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14497561&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14497561\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14497561_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14497561_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 05:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T05:01:43+0000\'\u003e16\\/Apr\\/15 05:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSee this new patch.\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eFixed compilation against Java 7\u003c\\/li\u003e\\n\\t\u003cli\u003eAdded SpatialPrefixTreeFactory support so this tree can be chosen by-name (in e.g. the benchmark module or Solr for that matter)\u003c\\/li\u003e\\n\\t\u003cli\u003eAdded benchmark module support by enhancing SpatialDocMaker (which uses the aforementioned factory).\u003c\\/li\u003e\\n\\t\u003cli\u003eincluded a tweaked spatial.alg\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI did some benchmarking &#8211; pretty quick &amp; rough right now.  I set max levels to 20 (chosen arbitrarily; with 27 it choked on memory given 2GB heap), with distErrPct of 0.0, and indexing random circles up to 3 decimal degrees (a few hundred KM or so), and disabling leafy branch pruning to compare apples to apples.\u003c\\/p\u003e\\n\\n\u003cp\u003eI ran it with \\\"quad\\\" and \\\"packedQuad\\\" with the same settings otherwise.\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eIndex size: Quad: 1.4GB, PackedQuad 1.6GB\u003c\\/li\u003e\\n\\t\u003cli\u003eIndex time: Quad: 1.46 rec\\/sec, PackedQuad: 1.91 rec\\/sec\u003c\\/li\u003e\\n\\t\u003cli\u003eQuery time: Quad: 6.35 rec\\/sec, PackedQuad: 7.21 rec\\/sec\u003c\\/li\u003e\\n\\t\u003cli\u003eThe benchmark module shows average memory use but I always look at that with a grain of salt.  Seems PackedQuad \u003cb\u003emight\u003c\\/b\u003e use a little more mem during indexing and less during search.  Shrug.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI was skeptical there would be index size savings and the benchmark shows there aren\'t any.  Please prove me wrong, Nick!  I like the indexing &amp; query speed improvements &#8211; not surprised given the nice code here without the ugly recursion that was in legacy Quad.\u003c\\/p\u003e\\n\\n\u003cp\u003eoff to bed now...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14497561_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14497561_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 05:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T05:01:43+0000\'\u003e16\\/Apr\\/15 05:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    See this new patch. \\n \\n\\t Fixed compilation against Java 7 \\n\\t Added SpatialPrefixTreeFactory support so this tree can be chosen by-name (in e.g. the benchmark module or Solr for that matter) \\n\\t Added benchmark module support by enhancing SpatialDocMaker (which uses the aforementioned factory). \\n\\t included a tweaked spatial.alg \\n \\n\\n\\n I did some benchmarking &#8211; pretty quick &amp; rough right now.  I set max levels to 20 (chosen arbitrarily; with 27 it choked on memory given 2GB heap), with distErrPct of 0.0, and indexing random circles up to 3 decimal degrees (a few hundred KM or so), and disabling leafy branch pruning to compare apples to apples. \\n\\n I ran it with \\\"quad\\\" and \\\"packedQuad\\\" with the same settings otherwise. \\n \\n\\t Index size: Quad: 1.4GB, PackedQuad 1.6GB \\n\\t Index time: Quad: 1.46 rec\\/sec, PackedQuad: 1.91 rec\\/sec \\n\\t Query time: Quad: 6.35 rec\\/sec, PackedQuad: 7.21 rec\\/sec \\n\\t The benchmark module shows average memory use but I always look at that with a grain of salt.  Seems PackedQuad  might  use a little more mem during indexing and less during search.  Shrug. \\n \\n\\n\\n I was skeptical there would be index size savings and the benchmark shows there aren\'t any.  Please prove me wrong, Nick!  I like the indexing &amp; query speed improvements &#8211; not surprised given the nice code here without the ugly recursion that was in legacy Quad. \\n\\n off to bed now...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14498096\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14498096&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14498096\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14498096_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14498096_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 14:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T14:43:16+0000\'\u003e16\\/Apr\\/15 14:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAwesome for putting together the benchmark (even a rough one).  Can you attach the spatial.alg file you used so I can verify (I\'m assuming its a variant on one you\'ve posted before?) I\'m getting very different numbers with \\\"production\\\" data sets (e.g., high res peninsulas, islands, global political boundaries, planet osm data - e.g., more exotic shapes than circles larger than a few hundred KM)\u003c\\/p\u003e\\n\\n\u003cp\u003eA few questions... and other observations.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003echosen arbitrarily; with 27 it choked on memory given 2GB heap\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWhat choked specifically? I\'m using PackedQuad with depth between 26 and 29. 1GB heap size using the shapes I described above.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003edisabling leafy branch pruning to compare apples to apples\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eOut of curiosity, why is this option enabled by default if it uses transient storage that doubles memory consumption? Seems backwards to me. \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI was skeptical there would be index size savings and the benchmark shows there aren\'t any.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIMHO I would avoid these kinds of absolute statements (especially with the highly variable nature of spatial use-cases). In this situation your numbers do not surprise me when disabling that leafyBranchPrune option (which still confuses me why its there?), and using a single shape type with variable size.  There is an outstanding issue in the existing patch (I\'ll see if I can\'t push out a fix today) - the TermsEnum is returning Terms with BytesRef containing bytes[] that are double the size than they should be (e.g., 16 bytes instead of 8 - all padded w\\/ zeros). I suspect its some improper configuration in the reader?  So for every high res cell (e.g.), the term will be 16 bytes (still better than, say, 27).  \u003c\\/p\u003e\\n\\n\u003cp\u003eI think we can do better on simulated test data in the test framework. I love the randomization and what minimal \\\"real\\\" data sets that are there are great. It does not provide the coverage necessary, though, to best simulate some real world scenarios. That\'s okay, to steal Mike\'s quote \\\"progress not perfection\\\". I\'ll definitely work to provide some more real world tests so we have better coverage and benchmarking options using \\\"real world\\\" data. Its a good way to recommend one indexing structure over another (this one\'s just the beginning. There are more indexing structures in trial mode, and even more improvements for the packed version)\u003c\\/p\u003e\\n\\n\u003cp\u003eLet\'s keep this going... Since this patch is non-destructive I don\'t see a reason it can\'t be committed as another option and I can submit enhancement patches to this feature.  That would be up to the community. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14498096_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14498096_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 14:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T14:43:16+0000\'\u003e16\\/Apr\\/15 14:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Awesome for putting together the benchmark (even a rough one).  Can you attach the spatial.alg file you used so I can verify (I\'m assuming its a variant on one you\'ve posted before?) I\'m getting very different numbers with \\\"production\\\" data sets (e.g., high res peninsulas, islands, global political boundaries, planet osm data - e.g., more exotic shapes than circles larger than a few hundred KM) \\n\\n A few questions... and other observations. \\n\\n  chosen arbitrarily; with 27 it choked on memory given 2GB heap  \\n\\n What choked specifically? I\'m using PackedQuad with depth between 26 and 29. 1GB heap size using the shapes I described above. \\n\\n  disabling leafy branch pruning to compare apples to apples  \\n\\n Out of curiosity, why is this option enabled by default if it uses transient storage that doubles memory consumption? Seems backwards to me.  \\n\\n  I was skeptical there would be index size savings and the benchmark shows there aren\'t any.  \\n\\n IMHO I would avoid these kinds of absolute statements (especially with the highly variable nature of spatial use-cases). In this situation your numbers do not surprise me when disabling that leafyBranchPrune option (which still confuses me why its there?), and using a single shape type with variable size.  There is an outstanding issue in the existing patch (I\'ll see if I can\'t push out a fix today) - the TermsEnum is returning Terms with BytesRef containing bytes[] that are double the size than they should be (e.g., 16 bytes instead of 8 - all padded w\\/ zeros). I suspect its some improper configuration in the reader?  So for every high res cell (e.g.), the term will be 16 bytes (still better than, say, 27).   \\n\\n I think we can do better on simulated test data in the test framework. I love the randomization and what minimal \\\"real\\\" data sets that are there are great. It does not provide the coverage necessary, though, to best simulate some real world scenarios. That\'s okay, to steal Mike\'s quote \\\"progress not perfection\\\". I\'ll definitely work to provide some more real world tests so we have better coverage and benchmarking options using \\\"real world\\\" data. Its a good way to recommend one indexing structure over another (this one\'s just the beginning. There are more indexing structures in trial mode, and even more improvements for the packed version) \\n\\n Let\'s keep this going... Since this patch is non-destructive I don\'t see a reason it can\'t be committed as another option and I can submit enhancement patches to this feature.  That would be up to the community.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14498260\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14498260&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14498260\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14498260_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14498260_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 16:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T16:42:58+0000\'\u003e16\\/Apr\\/15 16:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eCan you attach the spatial.alg file you used so I can verify \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIt\'s in the patch.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eWhat choked specifically? I\'m using PackedQuad with depth between 26 and 29. 1GB heap size using the shapes I described above.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e-Xmx2G resulted in an OutOfMemoryError, be it for the legacy quad or this new quad one.  \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eOut of curiosity, why is this option enabled by default if it uses transient storage that doubles memory consumption? Seems backwards to me.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e\\\"leafy branch pruning\\\" is enabled by default for RPT, although \\\"StreamingPrefixTreeStrategy\\\" overrides the method that would trigger it.  In order to compare another tree (legacy quad in this case) fairly to packed-quad, I disabled leafy branch pruning.\u003c\\/p\u003e\\n\\n\u003cp\u003ePlease don\'t call what StreamingPrefixTreeStrategy does as leafy branch pruning; it confuses the important distinction I\'m trying to make.  All SPTs should stop traversing when the relation is \u003cem\u003ewithin\u003c\\/em\u003e &#8211; that\'s expected\\/normal.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eIMHO I would avoid these kinds of absolute statements (especially with the highly variable nature of spatial use-cases).\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI\'m sorry.  To be more clear, I just don\'t yet understand how this packed quad encoding is going to allow for distErrPct=0.  I\'d like to understand; please help me.  Knowing what I do know about the SPTs, the results were what I expected &#8211; similar disk size to existing quad.  \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI think we can do better on simulated test data in the test framework.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eYes!  I would love to have more realistic shapes to test with.\u003c\\/p\u003e\\n\\n\u003cp\u003eRE progress not perfection:\u003cbr\\/\u003e\\nYes, Mike uses that quote constantly and I even saw it in your code \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e  I have my catch-phrases too.  Are you and Mike in a hurry to see this committed?  It\'s very normal, in this open-source project anyway, that there is back &amp; forth &amp; peer-review and changes that are asked of the contributor.  Don\'t worry; something is going to get committed &#8211; the query speed is a nice improvement!  It\'s not quite done &#8211; that\'s all.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14498260_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14498260_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 16:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T16:42:58+0000\'\u003e16\\/Apr\\/15 16:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Can you attach the spatial.alg file you used so I can verify   \\n\\n It\'s in the patch. \\n\\n  What choked specifically? I\'m using PackedQuad with depth between 26 and 29. 1GB heap size using the shapes I described above.  \\n\\n -Xmx2G resulted in an OutOfMemoryError, be it for the legacy quad or this new quad one.   \\n\\n  Out of curiosity, why is this option enabled by default if it uses transient storage that doubles memory consumption? Seems backwards to me.  \\n\\n \\\"leafy branch pruning\\\" is enabled by default for RPT, although \\\"StreamingPrefixTreeStrategy\\\" overrides the method that would trigger it.  In order to compare another tree (legacy quad in this case) fairly to packed-quad, I disabled leafy branch pruning. \\n\\n Please don\'t call what StreamingPrefixTreeStrategy does as leafy branch pruning; it confuses the important distinction I\'m trying to make.  All SPTs should stop traversing when the relation is  within  &#8211; that\'s expected\\/normal. \\n\\n  IMHO I would avoid these kinds of absolute statements (especially with the highly variable nature of spatial use-cases).  \\n\\n I\'m sorry.  To be more clear, I just don\'t yet understand how this packed quad encoding is going to allow for distErrPct=0.  I\'d like to understand; please help me.  Knowing what I do know about the SPTs, the results were what I expected &#8211; similar disk size to existing quad.   \\n\\n  I think we can do better on simulated test data in the test framework.  \\n\\n Yes!  I would love to have more realistic shapes to test with. \\n\\n RE progress not perfection: \\nYes, Mike uses that quote constantly and I even saw it in your code    I have my catch-phrases too.  Are you and Mike in a hurry to see this committed?  It\'s very normal, in this open-source project anyway, that there is back &amp; forth &amp; peer-review and changes that are asked of the contributor.  Don\'t worry; something is going to get committed &#8211; the query speed is a nice improvement!  It\'s not quite done &#8211; that\'s all.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14498476\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14498476&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14498476\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14498476_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14498476_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 18:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T18:37:34+0000\'\u003e16\\/Apr\\/15 18:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Nicholas Knize - 16\\/Apr\\/15 18:39\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003ePlease don\'t call what StreamingPrefixTreeStrategy does as leafy branch pruning; it confuses the important distinction I\'m trying to make.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThat\'s fair. pruneLeafyBranches isn\'t a Geo text book term and I didn\'t have a common nomenclature within this context for discussion re: the behavior so I used the closest shared term, for discussion.  If I change it so the leaves are pruned on intersects then its the same behavior. I\'ll add that to the patch for benchmarking and it will result in a smaller index.  Thinking about it more, I think it\'s the right way to go and a simple enough change that can be iterated in future improvements.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eAll SPTs should stop traversing when the relation is within \\u2013 that\'s expected\\/normal.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI want to make sure there is no confusion here (especially for anyone else willing to participate and the sensitivity surrounding my use of the pruneLeafyBranches term).  SPT\'s in the context of lucene-spatial\'s definition, no? (since SPT is not a common name for a geo data structure its a derivative)  There are use-cases for traversing beyond the within state in GeoSpatial data structures. So someone might come along and contribute the \\\"unexpected\\\".  Just want to be prepared for that future discussion.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI just don\'t yet understand how this packed quad encoding is going to allow for distErrPct=0\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThat helps me better understand the confusion. Your description of the transient memory behavior surrounding pruneLeafyBranches helped me understand why high res shapes w\\/ distErrPct=0 causes QuadTree to OOM on even reasonably sized shapes (thank you for that clarification).  In your benchmark there\'s a closer performance to the PackedQuad with it disabled (so I still don\'t understand why enabled is the default).  In essence, the rough benchmark you performed doesn\'t benchmark default Lucene spatial behavior. Is that not a problem?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI would love to have more realistic shapes to test with.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eAwesome! I\'ll work on adding some of the realistic data to the benchmark. A lot of it is quite big so I\'ll have to add to the build.xml to pull a compressed version from somewhere.  What\'s cool is that It includes a healthy amount of exotic shapes which better reflect complex geospatial use-cases.  Again, that\'s where you see drastic performance improvements with PackedQuad.  The Leaves are always 8 bytes regardless of depth (to a max depth of 29)  It introduces at most a 7 byte overhead at low precision (which are fewer terms anyway), so just use QuadTree in those cases, but there\'s a 21 byte savings on leaves (again, exotic shapes).  This is how it improves over QuadTree with distErrPct=0. You don\'t need to reduce resolution for those large shapes.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eAre you and Mike in a hurry to see this committed?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eApologies if you perceived a level of urgency on my behalf. Regarding Mike, I was giving credit for his quote because I agree re: non-destructive enhancements such as this. Other than that, I can\'t speak on his behalf and I don\'t think its fair to speculate on his level of interest re: this single contribution.\u003c\\/p\u003e\\n\\n\u003cp\u003e(soapbox)  So you know where I stand, I would simply prefer this (and future spatial contributions) not drag out as long as the geo3d contribution has. IMHO, I agree with you 100% that peer review and discussion is healthy and necessary.  I would add, though, there\'s a tipping point where it becomes a blocker and prevents others from participating.  And for this package to improve beyond the great work already done, there needs to be more involvement and some level of organic growth (iterative improvements).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14498476_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14498476_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 18:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T18:37:34+0000\'\u003e16\\/Apr\\/15 18:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Nicholas Knize - 16\\/Apr\\/15 18:39\\\"\u003eedited\u003c\\/span\u003e                    Please don\'t call what StreamingPrefixTreeStrategy does as leafy branch pruning; it confuses the important distinction I\'m trying to make.  \\n\\n That\'s fair. pruneLeafyBranches isn\'t a Geo text book term and I didn\'t have a common nomenclature within this context for discussion re: the behavior so I used the closest shared term, for discussion.  If I change it so the leaves are pruned on intersects then its the same behavior. I\'ll add that to the patch for benchmarking and it will result in a smaller index.  Thinking about it more, I think it\'s the right way to go and a simple enough change that can be iterated in future improvements. \\n\\n  All SPTs should stop traversing when the relation is within \\u2013 that\'s expected\\/normal.  \\n\\n I want to make sure there is no confusion here (especially for anyone else willing to participate and the sensitivity surrounding my use of the pruneLeafyBranches term).  SPT\'s in the context of lucene-spatial\'s definition, no? (since SPT is not a common name for a geo data structure its a derivative)  There are use-cases for traversing beyond the within state in GeoSpatial data structures. So someone might come along and contribute the \\\"unexpected\\\".  Just want to be prepared for that future discussion. \\n\\n  I just don\'t yet understand how this packed quad encoding is going to allow for distErrPct=0  \\n\\n That helps me better understand the confusion. Your description of the transient memory behavior surrounding pruneLeafyBranches helped me understand why high res shapes w\\/ distErrPct=0 causes QuadTree to OOM on even reasonably sized shapes (thank you for that clarification).  In your benchmark there\'s a closer performance to the PackedQuad with it disabled (so I still don\'t understand why enabled is the default).  In essence, the rough benchmark you performed doesn\'t benchmark default Lucene spatial behavior. Is that not a problem? \\n\\n  I would love to have more realistic shapes to test with.  \\n\\n Awesome! I\'ll work on adding some of the realistic data to the benchmark. A lot of it is quite big so I\'ll have to add to the build.xml to pull a compressed version from somewhere.  What\'s cool is that It includes a healthy amount of exotic shapes which better reflect complex geospatial use-cases.  Again, that\'s where you see drastic performance improvements with PackedQuad.  The Leaves are always 8 bytes regardless of depth (to a max depth of 29)  It introduces at most a 7 byte overhead at low precision (which are fewer terms anyway), so just use QuadTree in those cases, but there\'s a 21 byte savings on leaves (again, exotic shapes).  This is how it improves over QuadTree with distErrPct=0. You don\'t need to reduce resolution for those large shapes. \\n\\n  Are you and Mike in a hurry to see this committed?  \\n\\n Apologies if you perceived a level of urgency on my behalf. Regarding Mike, I was giving credit for his quote because I agree re: non-destructive enhancements such as this. Other than that, I can\'t speak on his behalf and I don\'t think its fair to speculate on his level of interest re: this single contribution. \\n\\n (soapbox)  So you know where I stand, I would simply prefer this (and future spatial contributions) not drag out as long as the geo3d contribution has. IMHO, I agree with you 100% that peer review and discussion is healthy and necessary.  I would add, though, there\'s a tipping point where it becomes a blocker and prevents others from participating.  And for this package to improve beyond the great work already done, there needs to be more involvement and some level of organic growth (iterative improvements).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14498567\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14498567&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14498567\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14498567_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14498567_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 19:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T19:40:29+0000\'\u003e16\\/Apr\\/15 19:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI welcome any suggestions you have pertaining naming (or again on anything).  If you can suggest a better name to what \\\"leafy branch pruning\\\" does, then at a minimum it could be expressed in the javadocs.  Not long ago it had another name but it was even worse \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/wink.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e.  Naming is hard.  Likewise... if SpatialPrefixTree might have a better literature\\/industry based name then I\'d love to know what that is.  When I named it as-such I looked around but didn\'t seem to find anything that was perfect.  It\'s a type of Trie, a spatial trie, and \\\"PrefixTree\\\" is a synonym for Trie, so... there you go.  Maybe I didn\'t look hard enough.  I\'m sorry if I \u003cem\u003eseemed\u003c\\/em\u003e touchy on the terminology; I merely want to ensure we mutually understood what we were and weren\'t talking about &#8211; that\'s all.  So when you proposed that what StreamingQuadPrefixTree did was leafy branch pruning, and as the coiner of the term I can see it didn\'t meet my definition; clarification is in order.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI want to make sure there is no confusion here (especially for anyone else willing to participate and the sensitivity surrounding my use of the pruneLeafyBranches term). SPT\'s in the context of lucene-spatial\'s definition, no? (since SPT is not a common name for a geo data structure its a derivative)\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eYes, in the context of lucene-spatial\'s definition.  \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eThere are use-cases for traversing beyond the within state in GeoSpatial data structures. So someone might come along and contribute the \\\"unexpected\\\". Just want to be prepared for that future discussion.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eInteresting; I\'m curious what that might be.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eA lot of it is quite big so I\'ll have to add to the build.xml to pull a compressed version from somewhere.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eYes, as you may have observed, this is how all existing test data is handled in the benchmark module:  fetched &amp; decompressed on-demand.  I added the Geonames point data.  And I added facilities to SpatialDocMaker to automatically turn the points into circles &amp; rects of random size.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m looking forward to seeing PackedQuadPrefixTree kick ass in being compressed allowing distErrPct=0 &#8211; I\'m still puzzled but I look forward to being pleasantly astonished. I do understand that it uses all 8 bits (instead of just 2 as the legacy impl) of the first number of bytes for the quadrant info, and that should lead to shorter terms \\/ prefixes for higher-precision data.  But I don\'t see that there would be any change in \u003cem\u003ethe number\u003c\\/em\u003e of terms, which is, as I see, the scalability challenge.  I have an idea on solving this floating in my head but maybe I needn\'t ponder it longer if PackedQuadPrefixTree handles it somehow.  It\'s not obvious to me but where in the code of PackedQuadCell are the 5 \\\"depth bits\\\" encoded &amp; decoded?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eIn essence, the rough benchmark you performed doesn\'t benchmark default Lucene spatial behavior. Is that not a problem?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIt is a problem &#8211; it\'s not ideal, that is.  Preferably it would stay enabled but I think you indicated it\'s not supported by PackedQuadTree?  I didn\'t look closer.\u003c\\/p\u003e\\n\\n\u003cp\u003eRE Geo3d:  As an example for anything with me; it\'s an outlier, not an example that proves the rule.  If I am blind to facts I can\'t  see then show me.  Hopefully you noticed that Karl and I are working together and it\'s come real far now (lots of discussion on ReviewBoard &amp; bugs I helped Karl find via randomized testing).  Your patch here has nothing in common with it &#8211; PackedQuadTree \u003cem\u003eobviously\u003c\\/em\u003e belongs here, and it should be quite evident that I\'m here helping by providing feedback and running a benchmark. And yes, being critical.  Anyway... lets get back to work.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe only thing about this patch that is a blocker (-1) for me is StreamingPrefixTreeStrategy.  Not most of the code in it, but it\'s existence as a SpatialStrategy subclass instead of an SPT subclass.  I don\'t mind that it optimizes something that I don\'t think needed optimization, though I suspect if you noticed TreeCellIterator originally you wouldn\'t have bothered.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have other by-line feedback I\'d like to give (and would \u003cem\u003eprefer\u003c\\/em\u003e to do so via ReviewBoard\\/GitHub) but we needn\'t steamroll this in  under the mantra of \\\"progress not perfection\\\".  \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14498567_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14498567_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 19:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T19:40:29+0000\'\u003e16\\/Apr\\/15 19:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I welcome any suggestions you have pertaining naming (or again on anything).  If you can suggest a better name to what \\\"leafy branch pruning\\\" does, then at a minimum it could be expressed in the javadocs.  Not long ago it had another name but it was even worse  .  Naming is hard.  Likewise... if SpatialPrefixTree might have a better literature\\/industry based name then I\'d love to know what that is.  When I named it as-such I looked around but didn\'t seem to find anything that was perfect.  It\'s a type of Trie, a spatial trie, and \\\"PrefixTree\\\" is a synonym for Trie, so... there you go.  Maybe I didn\'t look hard enough.  I\'m sorry if I  seemed  touchy on the terminology; I merely want to ensure we mutually understood what we were and weren\'t talking about &#8211; that\'s all.  So when you proposed that what StreamingQuadPrefixTree did was leafy branch pruning, and as the coiner of the term I can see it didn\'t meet my definition; clarification is in order. \\n\\n  I want to make sure there is no confusion here (especially for anyone else willing to participate and the sensitivity surrounding my use of the pruneLeafyBranches term). SPT\'s in the context of lucene-spatial\'s definition, no? (since SPT is not a common name for a geo data structure its a derivative)  \\n\\n Yes, in the context of lucene-spatial\'s definition.   \\n\\n  There are use-cases for traversing beyond the within state in GeoSpatial data structures. So someone might come along and contribute the \\\"unexpected\\\". Just want to be prepared for that future discussion.  \\n\\n Interesting; I\'m curious what that might be. \\n\\n  A lot of it is quite big so I\'ll have to add to the build.xml to pull a compressed version from somewhere.  \\n\\n Yes, as you may have observed, this is how all existing test data is handled in the benchmark module:  fetched &amp; decompressed on-demand.  I added the Geonames point data.  And I added facilities to SpatialDocMaker to automatically turn the points into circles &amp; rects of random size. \\n\\n I\'m looking forward to seeing PackedQuadPrefixTree kick ass in being compressed allowing distErrPct=0 &#8211; I\'m still puzzled but I look forward to being pleasantly astonished. I do understand that it uses all 8 bits (instead of just 2 as the legacy impl) of the first number of bytes for the quadrant info, and that should lead to shorter terms \\/ prefixes for higher-precision data.  But I don\'t see that there would be any change in  the number  of terms, which is, as I see, the scalability challenge.  I have an idea on solving this floating in my head but maybe I needn\'t ponder it longer if PackedQuadPrefixTree handles it somehow.  It\'s not obvious to me but where in the code of PackedQuadCell are the 5 \\\"depth bits\\\" encoded &amp; decoded? \\n\\n  In essence, the rough benchmark you performed doesn\'t benchmark default Lucene spatial behavior. Is that not a problem?  \\n\\n It is a problem &#8211; it\'s not ideal, that is.  Preferably it would stay enabled but I think you indicated it\'s not supported by PackedQuadTree?  I didn\'t look closer. \\n\\n RE Geo3d:  As an example for anything with me; it\'s an outlier, not an example that proves the rule.  If I am blind to facts I can\'t  see then show me.  Hopefully you noticed that Karl and I are working together and it\'s come real far now (lots of discussion on ReviewBoard &amp; bugs I helped Karl find via randomized testing).  Your patch here has nothing in common with it &#8211; PackedQuadTree  obviously  belongs here, and it should be quite evident that I\'m here helping by providing feedback and running a benchmark. And yes, being critical.  Anyway... lets get back to work. \\n\\n The only thing about this patch that is a blocker (-1) for me is StreamingPrefixTreeStrategy.  Not most of the code in it, but it\'s existence as a SpatialStrategy subclass instead of an SPT subclass.  I don\'t mind that it optimizes something that I don\'t think needed optimization, though I suspect if you noticed TreeCellIterator originally you wouldn\'t have bothered. \\n\\n I have other by-line feedback I\'d like to give (and would  prefer  to do so via ReviewBoard\\/GitHub) but we needn\'t steamroll this in  under the mantra of \\\"progress not perfection\\\".                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14498829\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14498829&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14498829\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_14498829_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14498829_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 22:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T22:05:55+0000\'\u003e16\\/Apr\\/15 22:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eIt\'s very normal, in this open-source project anyway, that there is back &amp; forth &amp; peer-review and changes that are asked of the contributor. Don\'t worry; something is going to get committed \\u2013 the query speed is a nice improvement! It\'s not quite done \\u2013 that\'s all.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI agree iterating\\/peer review is healthy, but growing the community is\u003cbr\\/\u003e\\nalso \u003cb\u003every\u003c\\/b\u003e important in open-source, and at least for the geo3d issue\u003cbr\\/\u003e\\nand now this one it worries me when I see barriers being put up that I\u003cbr\\/\u003e\\nfeel should not be blockers issues for committing.\u003c\\/p\u003e\\n\\n\u003cp\u003eEspecially when bus factor is essentially one, in an area as important\u003cbr\\/\u003e\\nas spatial, I think encouraging contributions \\/ growing community\u003cbr\\/\u003e\\nbecomes incredibly important.  It\'s like when we humans intervene for\u003cbr\\/\u003e\\nan endangered species... after having caused their predicament in\u003cbr\\/\u003e\\nthe first place ... sigh.\u003c\\/p\u003e\\n\\n\u003cp\u003eOf course, if there are real technical objection\\/problems\\/quality\u003cbr\\/\u003e\\nissues for a given patch, those \u003cb\u003eshould\u003c\\/b\u003e be addressed before committing.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt\'s important to show new people we are eager and excited for their\u003cbr\\/\u003e\\ncontributions, that the bar is not so high for them to have an impact.\u003cbr\\/\u003e\\nWe can always review\\/iterate\\/benchmark after they are committed, as\u003cbr\\/\u003e\\nlong as net\\/net the patch is a step forward as (I think?) this one is.\u003c\\/p\u003e\\n\\n\u003cp\u003eI also wonder whether we need a new, lighter weight spatial module\u003cbr\\/\u003e\\n(spatial2?  spatia_light?), or maybe spatial_sandbox, where the\u003cbr\\/\u003e\\nbarrier is lower?  The levels of abtractions in the current module\u003cbr\\/\u003e\\nlook excessive to me and with both the geo3d issue and this issue,\u003cbr\\/\u003e\\n\\\"correctly fitting in to the existing abstractions\\\" seemed to be one\u003cbr\\/\u003e\\nof the barriers (e.g. your only blocker here (\\\"The only thing about\u003cbr\\/\u003e\\nthis patch that is a blocker (-1) for me is\u003cbr\\/\u003e\\nStreamingPrefixTreeStrategy..\\\")  seems to be such an issue).  So if we\u003cbr\\/\u003e\\nhad a more free \\\"sandbox\\\" the barrier is lower by design.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_14498829_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14498829_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/15 22:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-16T22:05:55+0000\'\u003e16\\/Apr\\/15 22:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     It\'s very normal, in this open-source project anyway, that there is back &amp; forth &amp; peer-review and changes that are asked of the contributor. Don\'t worry; something is going to get committed \\u2013 the query speed is a nice improvement! It\'s not quite done \\u2013 that\'s all.  \\n\\n I agree iterating\\/peer review is healthy, but growing the community is \\nalso  very  important in open-source, and at least for the geo3d issue \\nand now this one it worries me when I see barriers being put up that I \\nfeel should not be blockers issues for committing. \\n\\n Especially when bus factor is essentially one, in an area as important \\nas spatial, I think encouraging contributions \\/ growing community \\nbecomes incredibly important.  It\'s like when we humans intervene for \\nan endangered species... after having caused their predicament in \\nthe first place ... sigh. \\n\\n Of course, if there are real technical objection\\/problems\\/quality \\nissues for a given patch, those  should  be addressed before committing. \\n\\n It\'s important to show new people we are eager and excited for their \\ncontributions, that the bar is not so high for them to have an impact. \\nWe can always review\\/iterate\\/benchmark after they are committed, as \\nlong as net\\/net the patch is a step forward as (I think?) this one is. \\n\\n I also wonder whether we need a new, lighter weight spatial module \\n(spatial2?  spatia_light?), or maybe spatial_sandbox, where the \\nbarrier is lower?  The levels of abtractions in the current module \\nlook excessive to me and with both the geo3d issue and this issue, \\n\\\"correctly fitting in to the existing abstractions\\\" seemed to be one \\nof the barriers (e.g. your only blocker here (\\\"The only thing about \\nthis patch that is a blocker (-1) for me is \\nStreamingPrefixTreeStrategy..\\\")  seems to be such an issue).  So if we \\nhad a more free \\\"sandbox\\\" the barrier is lower by design.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14499138\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14499138&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14499138\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14499138_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14499138_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/15 02:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-17T02:18:48+0000\'\u003e17\\/Apr\\/15 02:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eWe can always review\\/iterate\\/benchmark after they are committed, as long as net\\/net the patch is a step forward as (I think?) this one is.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eMike, this project is defacto run as review then commit, not the other way around.  This isn\'t news to you, of course; it\'s weird to feel I need to remind you &#8211; we all know this for good &amp; bad.  I have the same expectation of patches I send elsewhere.  I\'m not looking for perfection, just moving one thing around (a \\\"quality\\\" issue as-is IMO), and the rest is minor.  I appreciate the points you make generally, but I don\'t feel I\'m setting the bar too high on this issue.  Because of the fuss being made here; it\'s going to be harder for me to give quality feedback on future patches without fear of inducing needless drama.  And that\'s not good; Lucene improves through solid peer review that I see on many patches (particularly yours, by the way).\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eIt\'s important to show new people we are eager and excited for their contributions\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eLet it be known that weeks ago, upon discovery that Elastic had a new spatial SME, I contacted Nick to do a video chat so that I could basically welcome him into the Lucene\\/Spatial4j spatial area, that I looked forward to seeing what he will contribute, and that I seek\'ed his honest impressions \\/ feedback.  I simply can\'t be more sincere, and I hope this demonstrates that I don\'t want to be the only spatial person around here.\u003c\\/p\u003e\\n\\n\u003cp\u003eRE abstractions: I respect your opinion although I don\'t agree that there are too many here.  On the Geo3D front, it\'s extremely close now to being committed, and the \u003cem\u003eonly\u003c\\/em\u003e abstraction it is fitting into is a Spatial4j Shape interface (BTW Geo3D internally has a bunch of abstractions and I didn\'t complain to Karl as to the merits of them).  It would be good to have one more Spatial4j abstraction hook but it\'s not a blocker.  On this patch, I\'m asking Nick \u003cem\u003eto scale it back\u003c\\/em\u003e one, to just the SpatialPrefixTree (which technically includes \\\"Cell\\\" as that\'s what SPTs generate).  And because of these abstractions, both of them in fact (Shape &amp; SpatialPrefixTree), it\'s possible to re-use indexing and search predicates (Intersects, Within, Contains) and other code that work with these abstractions, without either implementations needing to know they exist.  I think it\'s very powerful and awesome that these things can be combined \\/ leveraged.  Of course I don\'t believe any of these APIs are perfect; the specifics are debatable and I wish there were more people improving it than just me to help make it even better.  Now it looks like there are \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003cem\u003eSigh\u003c\\/em\u003e; these conversations are stressfull &#8211; I look forward to getting back to the technical matters of the patch and moving it forward.  \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\" class=\\\"user-hover\\\" rel=\\\"nknize\\\"\u003eNicholas Knize\u003c\\/a\u003e can you please post a new patch:\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003ebaselined on Lucene trunk (standard practice for contributing to Lucene)\u003c\\/li\u003e\\n\\t\u003cli\u003ewith the streamlined cell iterator implementation (what you call \\\"streaming\\\") moved to the PackedQuadPrefixTree\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eMy added patch had two little extras: the factory &amp; benchmark module integration.  It would be nice if you could add those.  If you don\'t, I will any how, perhaps with a factory test which I didn\'t yet do.  In fact if I sadly never hear from you again, I\'ll do all that is spoken of here because we\'d all love for this awesomeness to get into Lucene spatial.  You\'ve done all the hard work; what remains is small.\u003c\\/p\u003e\\n\\n\u003cp\u003eYou certainly don\'t have to prove to me that the indexes are lean... or rather can be lean under \\\"realistic\\\" circumstances.  I remain very curious about that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14499138_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14499138_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/15 02:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-17T02:18:48+0000\'\u003e17\\/Apr\\/15 02:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     We can always review\\/iterate\\/benchmark after they are committed, as long as net\\/net the patch is a step forward as (I think?) this one is.  \\n\\n Mike, this project is defacto run as review then commit, not the other way around.  This isn\'t news to you, of course; it\'s weird to feel I need to remind you &#8211; we all know this for good &amp; bad.  I have the same expectation of patches I send elsewhere.  I\'m not looking for perfection, just moving one thing around (a \\\"quality\\\" issue as-is IMO), and the rest is minor.  I appreciate the points you make generally, but I don\'t feel I\'m setting the bar too high on this issue.  Because of the fuss being made here; it\'s going to be harder for me to give quality feedback on future patches without fear of inducing needless drama.  And that\'s not good; Lucene improves through solid peer review that I see on many patches (particularly yours, by the way). \\n\\n  It\'s important to show new people we are eager and excited for their contributions  \\n\\n Let it be known that weeks ago, upon discovery that Elastic had a new spatial SME, I contacted Nick to do a video chat so that I could basically welcome him into the Lucene\\/Spatial4j spatial area, that I looked forward to seeing what he will contribute, and that I seek\'ed his honest impressions \\/ feedback.  I simply can\'t be more sincere, and I hope this demonstrates that I don\'t want to be the only spatial person around here. \\n\\n RE abstractions: I respect your opinion although I don\'t agree that there are too many here.  On the Geo3D front, it\'s extremely close now to being committed, and the  only  abstraction it is fitting into is a Spatial4j Shape interface (BTW Geo3D internally has a bunch of abstractions and I didn\'t complain to Karl as to the merits of them).  It would be good to have one more Spatial4j abstraction hook but it\'s not a blocker.  On this patch, I\'m asking Nick  to scale it back  one, to just the SpatialPrefixTree (which technically includes \\\"Cell\\\" as that\'s what SPTs generate).  And because of these abstractions, both of them in fact (Shape &amp; SpatialPrefixTree), it\'s possible to re-use indexing and search predicates (Intersects, Within, Contains) and other code that work with these abstractions, without either implementations needing to know they exist.  I think it\'s very powerful and awesome that these things can be combined \\/ leveraged.  Of course I don\'t believe any of these APIs are perfect; the specifics are debatable and I wish there were more people improving it than just me to help make it even better.  Now it looks like there are   \\n\\n  Sigh ; these conversations are stressfull &#8211; I look forward to getting back to the technical matters of the patch and moving it forward.   Nicholas Knize  can you please post a new patch: \\n \\n\\t baselined on Lucene trunk (standard practice for contributing to Lucene) \\n\\t with the streamlined cell iterator implementation (what you call \\\"streaming\\\") moved to the PackedQuadPrefixTree \\n \\n\\n\\n My added patch had two little extras: the factory &amp; benchmark module integration.  It would be nice if you could add those.  If you don\'t, I will any how, perhaps with a factory test which I didn\'t yet do.  In fact if I sadly never hear from you again, I\'ll do all that is spoken of here because we\'d all love for this awesomeness to get into Lucene spatial.  You\'ve done all the hard work; what remains is small. \\n\\n You certainly don\'t have to prove to me that the indexes are lean... or rather can be lean under \\\"realistic\\\" circumstances.  I remain very curious about that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14499520\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14499520&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14499520\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_14499520_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14499520_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/15 09:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-17T09:16:55+0000\'\u003e17\\/Apr\\/15 09:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003ebaselined on Lucene trunk (standard practice for contributing to Lucene)\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003ePlease don\'t require this of contributors: it is not standard practice.  Make the bar as low as possible!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_14499520_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14499520_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/15 09:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-17T09:16:55+0000\'\u003e17\\/Apr\\/15 09:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     baselined on Lucene trunk (standard practice for contributing to Lucene)  \\n\\n Please don\'t require this of contributors: it is not standard practice.  Make the bar as low as possible!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14499814\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14499814&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14499814\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14499814_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14499814_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/15 13:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-17T13:25:59+0000\'\u003e17\\/Apr\\/15 13:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThat\'s fair; you\'re right that the bar shouldn\'t be the same for committers vs. contributors.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14499814_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14499814_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/15 13:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-17T13:25:59+0000\'\u003e17\\/Apr\\/15 13:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    That\'s fair; you\'re right that the bar shouldn\'t be the same for committers vs. contributors.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14500324\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14500324&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14500324\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14500324_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14500324_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/15 18:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-17T18:04:47+0000\'\u003e17\\/Apr\\/15 18:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Nicholas Knize - 17\\/Apr\\/15 18:42\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated to remove StreamingPrefixTreeStrategy.  PackedQuadTree is now self contained to one file and uses the RecursivePrefixTreeStrategy but ignores leafyBranchPruning.  \u003c\\/p\u003e\\n\\n\u003cp\u003eStill only integrated and tested on branch_5x, per discussion above.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14500324_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14500324_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/15 18:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-17T18:04:47+0000\'\u003e17\\/Apr\\/15 18:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Nicholas Knize - 17\\/Apr\\/15 18:42\\\"\u003eedited\u003c\\/span\u003e                   Updated to remove StreamingPrefixTreeStrategy.  PackedQuadTree is now self contained to one file and uses the RecursivePrefixTreeStrategy but ignores leafyBranchPruning.   \\n\\n Still only integrated and tested on branch_5x, per discussion above.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14500327\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14500327&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14500327\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14500327_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14500327_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/15 18:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-17T18:05:24+0000\'\u003e17\\/Apr\\/15 18:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eIf you can suggest a better name to what \\\"leafy branch pruning\\\" does, then at a minimum it could be expressed in the javadocs\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e++.  Just \'prune\' is probably more clear since its universally used all over data structures.  We can add a javadoc comment that describes it in further detail if necessary.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eif SpatialPrefixTree might have a better literature\\/industry based name then I\'d love to know what that is.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThere are trie based spatial trees all over (kd-Trie, kd-b-trie, buddy tree) industry and the literature. The one you call QuadPrefixTree was originally introduced in 1991 called the QuadTrie.  (reference: Gaston H. Gonnet and Ricardo Baeza-Yates, Handbook of Algorithms and Data Structures &#8211; in Pascal and C, 2nd edition, Addison-Wesley, 1991.)  Dr. Hanan Samet from UMD has a great section on MX and PR QuadTrees (same as QuadPrefixTree and a name someone mentioned to you in another issue).  He provides a nice discussion on the differences between MX, PR and their point based counterparts (compared by the decomposition methods).  There\'s certainly nothing wrong with an implementation specific name. If you are asking for suggestions then I offer: SpatialTrie, GeoHashTrie, QuadTrie as being shorter, more to the point, and probably more relate-able to other spatial SMEs (whom I\'m hoping would be willing to get more involved). \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eIt\'s not obvious to me but where in the code of PackedQuadCell are the 5 \\\"depth bits\\\" encoded &amp; decoded?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003ePackedQuadCell.getLevel() decodes, and its encoded in PackedQuadCell.nextTerm()\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003ePreferably it would stay enabled but I think you indicated it\'s not supported by PackedQuadTree? I didn\'t look closer.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThat\'s correct.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI also wonder whether we need a new, lighter weight spatial module (spatial2? spatia_light?), or maybe spatial_sandbox, where the barrier is lower?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e+++ I think this is a great idea for experimental\\/research features we don\'t want cluttering up the spatial module.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eRE abstractions: I respect your opinion although I don\'t agree that there are too many here.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIMHO, this is a slippery slope.  There are so many diverse spatial data structures we should be taking a look at for improving spatial search in higher order dimensions (4D space-time for just a start).  That\'s a personal interest area for me, in how the most powerful high dimension structures (that already exist) can fit within the design and implementation of lucene-core (a green field to explore).  Something like this does require a sophisticated abstraction framework and this particular one has a bit of a learning curve. I think that can work itself out over time with a bit of refactoring (which it sounds like all are open to?).  In the meantime it does set the bar rather high for new contributors. This is another +1 for a spatial sandbox for experimental research (heck make it a separate repo). \u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eSigh; these conversations are stressfull \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThey\'re very verbose, but maybe that\'s the kick in the pants needed to help the spatial module really take off. That is, after all, the common goal of the community?\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14500327_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14500327_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/15 18:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-17T18:05:24+0000\'\u003e17\\/Apr\\/15 18:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     If you can suggest a better name to what \\\"leafy branch pruning\\\" does, then at a minimum it could be expressed in the javadocs  \\n\\n ++.  Just \'prune\' is probably more clear since its universally used all over data structures.  We can add a javadoc comment that describes it in further detail if necessary. \\n\\n  if SpatialPrefixTree might have a better literature\\/industry based name then I\'d love to know what that is.  \\n\\n There are trie based spatial trees all over (kd-Trie, kd-b-trie, buddy tree) industry and the literature. The one you call QuadPrefixTree was originally introduced in 1991 called the QuadTrie.  (reference: Gaston H. Gonnet and Ricardo Baeza-Yates, Handbook of Algorithms and Data Structures &#8211; in Pascal and C, 2nd edition, Addison-Wesley, 1991.)  Dr. Hanan Samet from UMD has a great section on MX and PR QuadTrees (same as QuadPrefixTree and a name someone mentioned to you in another issue).  He provides a nice discussion on the differences between MX, PR and their point based counterparts (compared by the decomposition methods).  There\'s certainly nothing wrong with an implementation specific name. If you are asking for suggestions then I offer: SpatialTrie, GeoHashTrie, QuadTrie as being shorter, more to the point, and probably more relate-able to other spatial SMEs (whom I\'m hoping would be willing to get more involved).  \\n\\n  It\'s not obvious to me but where in the code of PackedQuadCell are the 5 \\\"depth bits\\\" encoded &amp; decoded?  \\n\\n PackedQuadCell.getLevel() decodes, and its encoded in PackedQuadCell.nextTerm() \\n\\n  Preferably it would stay enabled but I think you indicated it\'s not supported by PackedQuadTree? I didn\'t look closer.  \\n\\n That\'s correct. \\n\\n  I also wonder whether we need a new, lighter weight spatial module (spatial2? spatia_light?), or maybe spatial_sandbox, where the barrier is lower?  \\n\\n +++ I think this is a great idea for experimental\\/research features we don\'t want cluttering up the spatial module. \\n\\n  RE abstractions: I respect your opinion although I don\'t agree that there are too many here.  \\n\\n IMHO, this is a slippery slope.  There are so many diverse spatial data structures we should be taking a look at for improving spatial search in higher order dimensions (4D space-time for just a start).  That\'s a personal interest area for me, in how the most powerful high dimension structures (that already exist) can fit within the design and implementation of lucene-core (a green field to explore).  Something like this does require a sophisticated abstraction framework and this particular one has a bit of a learning curve. I think that can work itself out over time with a bit of refactoring (which it sounds like all are open to?).  In the meantime it does set the bar rather high for new contributors. This is another +1 for a spatial sandbox for experimental research (heck make it a separate repo).  \\n\\n  Sigh; these conversations are stressfull   \\n\\n They\'re very verbose, but maybe that\'s the kick in the pants needed to help the spatial module really take off. That is, after all, the common goal of the community? \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14502886\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14502886&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14502886\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14502886_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14502886_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Apr\\/15 14:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-20T14:06:45+0000\'\u003e20\\/Apr\\/15 14:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'ll check out your patch tonight, tomorrow at the latest.  Karl\\/Geo3d has kept me busy \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eRE naming: in both cases it seems the current names actually aren\'t bad relative to your suggestions.  \\\"prune\\\" is a suffix of \\\"pruneLeafyBranches\\\" (current name is more descriptive; in any case one would still need to look at the javadocs to understand), and SpatialTrie is synonymous with SpatialPrefixTree given that Trie and PrefixTree are synonyms.  I\'m +1 to rename these as you want to 6.x if you think it\'s worth it.  There are back-compat issues with renaming them \u003cem\u003enow\u003c\\/em\u003e.  Again, we agree more javadocs (including suggested alternative names) to add clarification now would be great.  I\'ll create a patch and seek your input.\u003c\\/p\u003e\\n\\n\u003cp\u003eRE sandbox: It\'s not clear to me what is really needed\\/useful.  If someone comes along with some newfangled index\\/search spatial approach, it could go in the module and not hook into any existing interface... except a Lucene Query class, and something like a Lucene TokenStream\\/Field for indexing.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14502886_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14502886_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Apr\\/15 14:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-20T14:06:45+0000\'\u003e20\\/Apr\\/15 14:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'ll check out your patch tonight, tomorrow at the latest.  Karl\\/Geo3d has kept me busy   \\n\\n RE naming: in both cases it seems the current names actually aren\'t bad relative to your suggestions.  \\\"prune\\\" is a suffix of \\\"pruneLeafyBranches\\\" (current name is more descriptive; in any case one would still need to look at the javadocs to understand), and SpatialTrie is synonymous with SpatialPrefixTree given that Trie and PrefixTree are synonyms.  I\'m +1 to rename these as you want to 6.x if you think it\'s worth it.  There are back-compat issues with renaming them  now .  Again, we agree more javadocs (including suggested alternative names) to add clarification now would be great.  I\'ll create a patch and seek your input. \\n\\n RE sandbox: It\'s not clear to me what is really needed\\/useful.  If someone comes along with some newfangled index\\/search spatial approach, it could go in the module and not hook into any existing interface... except a Lucene Query class, and something like a Lucene TokenStream\\/Field for indexing.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14505388\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14505388&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14505388\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14505388_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14505388_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Apr\\/15 18:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-21T18:02:47+0000\'\u003e21\\/Apr\\/15 18:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated PackedQuadPrefixTree to iinclude optional leafyBranchPruning.  Other minor code cleanup also included.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14505388_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14505388_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Apr\\/15 18:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-21T18:02:47+0000\'\u003e21\\/Apr\\/15 18:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated PackedQuadPrefixTree to iinclude optional leafyBranchPruning.  Other minor code cleanup also included.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14506453\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14506453&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14506453\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14506453_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14506453_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Apr\\/15 05:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-22T05:29:30+0000\'\u003e22\\/Apr\\/15 05:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLatest patch:\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eRemoved some redundant casts\u003c\\/li\u003e\\n\\t\u003cli\u003emoved PrefixTreeIterator.leaves to a local variable of pruned() since that\'s the only place it was used.\u003c\\/li\u003e\\n\\t\u003cli\u003eimplemented toString() so that the leafyPrune state could be printed\u003c\\/li\u003e\\n\\t\u003cli\u003eRemoved modifications to RecursivePrefixTreeStrategy &#8211; an instanceof check related to leafy branch pruning.  PackedQuadPrefixTree does in fact support RPT doing the leaf pruning, so there\'s no instance-of check needed.  It\'s up to the user to have this tree do it or have RPT do it.  They aren\'t the same since RPT\'s impl is recursive whereas PQPT\'s impl is only at the last level (the level where it has the most benefit, yes).  I also modified the fuzzy test to independently set the leafy branch prune option on them, just to test it works.\u003c\\/li\u003e\\n\\t\u003cli\u003eEnhanced getTreeCellIterator\\/PrefixTreeIterator to honor the \\\"detailLevel\\\" parameter instead of always going to maxLevels. This was a simple matter of passing through this parameter to the iterator and renaming maxLevels to detailLevel there.\u003c\\/li\u003e\\n\\t\u003cli\u003ePQPT.Cell.toString: moved Long.numberOfLeadingZeros out of the loop, and changed the O(N^2) String append to use a StringBuilder.\u003c\\/li\u003e\\n\\t\u003cli\u003eOptimized compareToNoLeaf to simply compare the longs instead of converting to bytes and comparing byte by byte.  I put in an assert to check for parity with the old algorithm.\u003c\\/li\u003e\\n\\t\u003cli\u003eAdded back in Benchmark SpatialDocMaker stuff, but with the leafy branch prune option set on PQPT grid if it\'s of that type instead of the strategy.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI did some testing; notably running the fuzzy test with 10k iterations and temporarily set to test just the packed quad.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think it\'s ready from my point of view but I\'d like to get your input on my changes Nick.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14506453_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14506453_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Apr\\/15 05:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-22T05:29:30+0000\'\u003e22\\/Apr\\/15 05:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Latest patch: \\n \\n\\t Removed some redundant casts \\n\\t moved PrefixTreeIterator.leaves to a local variable of pruned() since that\'s the only place it was used. \\n\\t implemented toString() so that the leafyPrune state could be printed \\n\\t Removed modifications to RecursivePrefixTreeStrategy &#8211; an instanceof check related to leafy branch pruning.  PackedQuadPrefixTree does in fact support RPT doing the leaf pruning, so there\'s no instance-of check needed.  It\'s up to the user to have this tree do it or have RPT do it.  They aren\'t the same since RPT\'s impl is recursive whereas PQPT\'s impl is only at the last level (the level where it has the most benefit, yes).  I also modified the fuzzy test to independently set the leafy branch prune option on them, just to test it works. \\n\\t Enhanced getTreeCellIterator\\/PrefixTreeIterator to honor the \\\"detailLevel\\\" parameter instead of always going to maxLevels. This was a simple matter of passing through this parameter to the iterator and renaming maxLevels to detailLevel there. \\n\\t PQPT.Cell.toString: moved Long.numberOfLeadingZeros out of the loop, and changed the O(N^2) String append to use a StringBuilder. \\n\\t Optimized compareToNoLeaf to simply compare the longs instead of converting to bytes and comparing byte by byte.  I put in an assert to check for parity with the old algorithm. \\n\\t Added back in Benchmark SpatialDocMaker stuff, but with the leafy branch prune option set on PQPT grid if it\'s of that type instead of the strategy. \\n \\n\\n\\n I did some testing; notably running the fuzzy test with 10k iterations and temporarily set to test just the packed quad. \\n\\n I think it\'s ready from my point of view but I\'d like to get your input on my changes Nick.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14507053\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14507053&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14507053\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14507053_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14507053_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Apr\\/15 13:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-22T13:21:42+0000\'\u003e22\\/Apr\\/15 13:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLGTM. I\'ve also attached a patch off trunk as requested. I\'ll have a look on LOE for deprecating LegacyCell, and LegacyPrefixTree along with some general code cleanup and javadoc clarity. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14507053_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14507053_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Apr\\/15 13:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-22T13:21:42+0000\'\u003e22\\/Apr\\/15 13:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    LGTM. I\'ve also attached a patch off trunk as requested. I\'ll have a look on LOE for deprecating LegacyCell, and LegacyPrefixTree along with some general code cleanup and javadoc clarity.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14507064\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14507064&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14507064\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14507064_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14507064_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Apr\\/15 13:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-22T13:31:14+0000\'\u003e22\\/Apr\\/15 13:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMy patch last night was also on trunk.  Is there anything in your -TRUNK patch of interest or can I ignore it?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14507064_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14507064_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Apr\\/15 13:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-22T13:31:14+0000\'\u003e22\\/Apr\\/15 13:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    My patch last night was also on trunk.  Is there anything in your -TRUNK patch of interest or can I ignore it?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14507076\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14507076&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14507076\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14507076_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14507076_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Apr\\/15 13:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-22T13:37:15+0000\'\u003e22\\/Apr\\/15 13:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGood deal. That was not clear so -TRUNK.patch is redundant and can be ignored.  Nothing additional since yesterday\'s changes so I\'m good as is for both trunk and _5x\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14507076_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14507076_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Apr\\/15 13:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-22T13:37:15+0000\'\u003e22\\/Apr\\/15 13:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Good deal. That was not clear so -TRUNK.patch is redundant and can be ignored.  Nothing additional since yesterday\'s changes so I\'m good as is for both trunk and _5x              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14507626\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14507626&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14507626\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14507626_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14507626_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Apr\\/15 18:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-22T18:38:21+0000\'\u003e22\\/Apr\\/15 18:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNew patch; minor changes.  I dressed up the javadocs a bit, including rewriting the setPruneLeafyBranches description, especially on RPT.  I moved the class javadocs from Cell to it\'s containing SPT level since user\'s generally don\'t look at SPT details (like the Cell) and just read the class javadocs.  I includes notes on setting the prune option.  I also included a modicum of Solr test &amp; integration.  That\'s basically it.  In the CHANGES.txt I called out that prune should be set on this grid and not on RPT, to help prevent less than ideal use.  Precommit is happy.\u003c\\/p\u003e\\n\\n\u003cp\u003eI plan to commit this tonight, subject to further feedback.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14507626_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14507626_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Apr\\/15 18:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-22T18:38:21+0000\'\u003e22\\/Apr\\/15 18:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    New patch; minor changes.  I dressed up the javadocs a bit, including rewriting the setPruneLeafyBranches description, especially on RPT.  I moved the class javadocs from Cell to it\'s containing SPT level since user\'s generally don\'t look at SPT details (like the Cell) and just read the class javadocs.  I includes notes on setting the prune option.  I also included a modicum of Solr test &amp; integration.  That\'s basically it.  In the CHANGES.txt I called out that prune should be set on this grid and not on RPT, to help prevent less than ideal use.  Precommit is happy. \\n\\n I plan to commit this tonight, subject to further feedback.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14508422\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14508422&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14508422\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_14508422_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14508422_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Apr\\/15 04:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-23T04:08:33+0000\'\u003e23\\/Apr\\/15 04:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1675538 from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\" class=\\\"user-hover\\\" rel=\\\"dsmiley\\\"\u003eDavid Smiley\u003c\\/a\u003e in branch \'dev\\/trunk\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1675538\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1675538\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-6422\\\" title=\\\"Add PackedQuadPrefixTree\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-6422\\\"\u003e\u003cdel\u003eLUCENE-6422\u003c\\/del\u003e\u003c\\/a\u003e: New spatial PackedQuadPrefixTree. Thanks Nick!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_14508422_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14508422_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Apr\\/15 04:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-23T04:08:33+0000\'\u003e23\\/Apr\\/15 04:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1675538 from  David Smiley  in branch \'dev\\/trunk\' \\n[  https:\\/\\/svn.apache.org\\/r1675538  ] \\n\\n   LUCENE-6422  : New spatial PackedQuadPrefixTree. Thanks Nick!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14508426\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14508426&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14508426\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_14508426_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14508426_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Apr\\/15 04:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-23T04:17:23+0000\'\u003e23\\/Apr\\/15 04:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1675539 from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\" class=\\\"user-hover\\\" rel=\\\"dsmiley\\\"\u003eDavid Smiley\u003c\\/a\u003e in branch \'dev\\/branches\\/branch_5x\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1675539\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1675539\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-6422\\\" title=\\\"Add PackedQuadPrefixTree\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-6422\\\"\u003e\u003cdel\u003eLUCENE-6422\u003c\\/del\u003e\u003c\\/a\u003e: New spatial PackedQuadPrefixTree. Thanks Nick!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_14508426_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14508426_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Apr\\/15 04:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-23T04:17:23+0000\'\u003e23\\/Apr\\/15 04:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1675539 from  David Smiley  in branch \'dev\\/branches\\/branch_5x\' \\n[  https:\\/\\/svn.apache.org\\/r1675539  ] \\n\\n   LUCENE-6422  : New spatial PackedQuadPrefixTree. Thanks Nick!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14508441\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14508441&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14508441\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14508441_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14508441_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Apr\\/15 04:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-23T04:31:00+0000\'\u003e23\\/Apr\\/15 04:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eBTW I did a little more benchmarking.  For point data there\'s a nice 10% improvement or so.  Smaller index size too.  For non-point data I used pruning and a distErrPct of 0.025 (default).  The recursive prune of RPT on legacy quad (does more pruning then packed quad) amounted to a 25% smaller index than PackedQuad, and the index &amp; search were practically the same.  I can only surmise PackedQuad required less memory while indexing, of course.  I \u003cem\u003esuspect\u003c\\/em\u003e that if RPT\'s recursive prune were to do its thing on PackedQuad, PackedQuad would have a better showing.  I\'ll leave that benchmark to another day.  My experience (&amp; benchmarks) have shown that there is a high correlation between index size and search, and that pruning helps a ton.  Some day I may write a better recursive prune that doesn\'t require buffering all tokens.\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks again for contributing this Nick!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14508441_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14508441_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Apr\\/15 04:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-23T04:31:00+0000\'\u003e23\\/Apr\\/15 04:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    BTW I did a little more benchmarking.  For point data there\'s a nice 10% improvement or so.  Smaller index size too.  For non-point data I used pruning and a distErrPct of 0.025 (default).  The recursive prune of RPT on legacy quad (does more pruning then packed quad) amounted to a 25% smaller index than PackedQuad, and the index &amp; search were practically the same.  I can only surmise PackedQuad required less memory while indexing, of course.  I  suspect  that if RPT\'s recursive prune were to do its thing on PackedQuad, PackedQuad would have a better showing.  I\'ll leave that benchmark to another day.  My experience (&amp; benchmarks) have shown that there is a high correlation between index size and search, and that pruning helps a ton.  Some day I may write a better recursive prune that doesn\'t require buffering all tokens. \\n\\n Thanks again for contributing this Nick!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14509762\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14509762&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14509762\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14509762_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14509762_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Apr\\/15 20:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-23T20:44:33+0000\'\u003e23\\/Apr\\/15 20:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGood to hear David, and thank you for committing the patch!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"nknize\\\" id=\\\"commentauthor_14509762_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=nknize\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"nknize\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Nicholas Knize\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14509762_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Apr\\/15 20:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-04-23T20:44:33+0000\'\u003e23\\/Apr\\/15 20:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Good to hear David, and thank you for committing the patch!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14530632\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14530632&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14530632\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_14530632_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14530632_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/May\\/15 14:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-05-06T14:32:36+0000\'\u003e06\\/May\\/15 14:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1678008 from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\" class=\\\"user-hover\\\" rel=\\\"dsmiley\\\"\u003eDavid Smiley\u003c\\/a\u003e in branch \'dev\\/trunk\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1678008\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1678008\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003eFix CHANGES.txt formatting for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-6422\\\" title=\\\"Add PackedQuadPrefixTree\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-6422\\\"\u003e\u003cdel\u003eLUCENE-6422\u003c\\/del\u003e\u003c\\/a\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_14530632_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14530632_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/May\\/15 14:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-05-06T14:32:36+0000\'\u003e06\\/May\\/15 14:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1678008 from  David Smiley  in branch \'dev\\/trunk\' \\n[  https:\\/\\/svn.apache.org\\/r1678008  ] \\n\\n Fix CHANGES.txt formatting for   LUCENE-6422                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14530634\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14530634&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14530634\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_14530634_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14530634_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/May\\/15 14:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-05-06T14:33:35+0000\'\u003e06\\/May\\/15 14:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1678009 from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\" class=\\\"user-hover\\\" rel=\\\"dsmiley\\\"\u003eDavid Smiley\u003c\\/a\u003e in branch \'dev\\/branches\\/branch_5x\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1678009\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1678009\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003eFix CHANGES.txt formatting for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-6422\\\" title=\\\"Add PackedQuadPrefixTree\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-6422\\\"\u003e\u003cdel\u003eLUCENE-6422\u003c\\/del\u003e\u003c\\/a\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_14530634_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14530634_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/May\\/15 14:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-05-06T14:33:35+0000\'\u003e06\\/May\\/15 14:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1678009 from  David Smiley  in branch \'dev\\/branches\\/branch_5x\' \\n[  https:\\/\\/svn.apache.org\\/r1678009  ] \\n\\n Fix CHANGES.txt formatting for   LUCENE-6422                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14586867\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6422?focusedCommentId=14586867&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14586867\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anshumg\\\" id=\\\"commentauthor_14586867_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anshumg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anshumg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anshum Gupta\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14586867_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/15 21:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-06-15T21:43:39+0000\'\u003e15\\/Jun\\/15 21:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eBulk close for 5.2.0.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anshumg\\\" id=\\\"commentauthor_14586867_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anshumg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anshumg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anshum Gupta\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14586867_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jun\\/15 21:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-06-15T21:43:39+0000\'\u003e15\\/Jun\\/15 21:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Bulk close for 5.2.0.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310110";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310110&amp;avatarId=10061\\\" alt=\\\"Lucene - Core\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\"\u003eLucene - Core\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1516206146361"> 
    <input type="hidden" title="jira.request.server.time" value="427"> 
    <input type="hidden" title="jira.request.id" value="982x7831131x6"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="4"> 
    <input type="hidden" title="db.reads.time.in.ms" value="67"> 
    <input type="hidden" title="db.conns.time.in.ms" value="74"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 982x7831131x6
	          REQUEST TIMESTAMP : [17/Jan/2018:16:22:26 +0000]
	               REQUEST TIME : 0.4270
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 4

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=16, elapsedTotal=67365297, elapsedMin=594051, elapsedMax=42971363, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=20, elapsedTotal=74170118, elapsedMin=621153, elapsedMax=43021036, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
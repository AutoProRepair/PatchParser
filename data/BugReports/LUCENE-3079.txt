<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|d9573483565773261c7a0b8096a15841b38e5531|lout"> 
  <link rel="shortcut icon" href="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"sd.customer.profile.multi.languages\":true,\"sd.customer.portal.transitions\":true,\"sd.customer.portal.transitions.config\":true,\"sd.custom.email.stripping.rules\":false,\"sd.sla.lucene.issue.id.callback.performance\":true,\"sd.new.settings.sidebar.location\":true,\"sd.workload.report.paginator\":true,\"sd.experimental.portal.search.algorithm.default.1\":false,\"sd.customer.portal.help.center.agent.announcement\":true,\"sd.sla.improved.rendering\":false,\"sd.experimental.portal.search.algorithm.default.2\":false,\"sd.customer.feedback.validate.reporter.on.token\":true,\"sd.custom.email.notifications.utf8.csat.star\":true,\"sd.who.create.customers.by.email.setting\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.renderer.consider.variable.format\":true,\"sd.stats.event.tracking\":true,\"sd.password.helper.dialog\":true,\"sd.canned.responses\":false,\"sd.portal.help.center.customer.signup.secondary.email\":true,\"sd.custom.email.notifications.manage.language\":true,\"sd.use.search.by.permissions\":true,\"sd.slavalue.record.updated.date\":false,\"sd.report.custom.date.range\":false,\"sd.kb.article.helpfulness.report\":false,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"sd.custom.email.notifications.styling\":true,\"sd.workinghours.new.page.bulldog.1\":false,\"sd.customer.portal.two.step.login\":false,\"sd.automation.psmq.async.executor\":true,\"sd.customer.org.list.page.lazy.search\":true,\"sd.approval.requested.when.handler\":true,\"sd.request.type.field.rest.api.filtering.bugfix\":true,\"sd.automation.then.action.auto.answer.approval\":true,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"sla.will.only.be.paused.if.they.are.already.started\":true,\"sd.kb.comment.share.stats.collection\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"sd.customer.orgs.group.participants\":true,\"sd.portal.help.center.customer.signup\":true,\"sd.sla.agent.jql.security.restricted\":true,\"sd.test.feature.flag.x\":true,\"sd.test.feature.flag.y\":false,\"sd.cluster.safe.mail.channel.shutdown\":true,\"sd.email.channel.folders\":false,\"sd.email.analytics.open\":false,\"sd.kb.project.creation.create.link.space\":true,\"sd.workinghours.new.page\":false,\"sd.confluence.anonymous.permission.fix\":true,\"com.atlassian.jira.issuetable.draggable\":true,\"sd.customer.portal.project.agent.announcement\":true,\"sd.automation.audit.log\":true,\"jira.jql.suggestrecentfields\":false,\"sd.canned.responses.check.index.startup\":false,\"sd.new.project.templates\":true,\"sd.custom.email.notifications.custom.rules.simple.ui\":false,\"sd.custom.email.notifications.cut.over\":true,\"sd.dismiss.all.misconfiguration.warnings.setting\":true,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"sd.sla.configurations.export\":true,\"sd.canned.responses.variable.substitution\":true,\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"sd.customer.portal.prioties.per.project.fix\":true,\"jira.instrumentation.laas\":false,\"sd.kb.self.service.report\":false,\"sla.improved.request.handling\":true,\"sd.no.schedule.async.upgrade.tasks\":true,\"sd.kb.primary.nav\":true,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"sd.kb.issueview.panel.phase2\":true,\"sd.email.outsider.comments\":true,\"jira.create.linked.issue\":true,\"sd.kb.issueview.panel\":true,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"sd.approvals.light.weight\":false,\"sd.automation.then.webhook\":true,\"sd.respect.inline.edit.issue.off\":true,\"jira.jql.smartautoselectfirst\":false,\"sd.global.portal.search.atlassian.only.tracking\":false,\"sd.automation.if.condition.comment.primary.action\":true,\"jira.priorities.per.project\":true,\"sd.inline.noformat.renderer\":true,\"sd.customer.request.type.create.edit.screens\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/png,image/vnd.wap.wbmp,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data"]="{\"substitutionVariables\":{\"issue.summary\":\"Issue summary\",\"issue.description\":\"Issue description\",\"issue.key\":\"Issue key\",\"issue.reporter.name\":\"Issue reporter\",\"issue.resolution\":\"Issue resolution\",\"request.url\":\"Request URL\",\"request.status\":\"Request status\"}}";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-help-links.help-links"]="{\"help\":{\"email.settings\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"managing.queues\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+queues+for+your+team\",\"email.setup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"request.settings.help.bubble\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\",\"email.settings.suitablerequest\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email#Receivingrequestsbyemail-suitablerequest\",\"sla.import.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Importing+SLAs\",\"documentation.home\":\"https://docs.atlassian.com/jira/jsd-docs-039/JIRA+Service+Desk+Documentation\",\"default\":\"https://docs.atlassian.com/jira/jsd-docs-039/\",\"create.space.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base#serving-customers-with-a-knowledge-base-createpermission\",\"email.settings.troubleshooting\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+the+email+channel\",\"admin.notifications.config\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+service+desk+notifications\",\"troubleshoot.requesttype\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+request+types\",\"approvals.configuration\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+JIRA+Service+Desk+approvals\",\"setting.up.reports\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+service+desk+reports\",\"public.signup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+public+signup\",\"knowledge.base\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base\",\"resolve.permission.scheme.errors\":\"https://docs.atlassian.com/jira/jsd-docs-039/Resolving+permission+scheme+errors\",\"getting.started\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+with+JIRA+Service+Desk\",\"getting.started.agent\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+for+service+desk+agents\",\"invite.customers\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\"},\"kb\":{\"default\":\"https://confluence.atlassian.com/display/SDKB/\",\"troubleshooting.user.management.issues\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\",\"legacytransition\":\"https://confluence.atlassian.com/display/SDKB/Replacing+legacy+automatic+transitions+with+automation+rules\",\"umtroubleshoot\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\"}}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-base-url.base-url"]="\"https://issues.apache.org/jira\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"b31c17df4eaaab\"";
WRM._unparsedData["project-id"]="12310110";
WRM._unparsedData["project-key"]="\"LUCENE\"";
WRM._unparsedData["project-name"]="\"Lucene - Core\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310110";
WRM._unparsedData["projectKey"]="\"LUCENE\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/1a6b21131945f6f49ff48336b49ca3fe-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/d8484c9183f546511a8e336a8779bcd9-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d3b35d835f8f46fc3b53bb4db7f85158-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/71d42e74136d842a3ef4d5d136484843-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/95a4826c265852f4904f1e0e7300df68-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/944bb39eced1b35cfc7194aa02eb5a5a/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/5a8f0f8b8aa8f96a4f0f7e9e248d62f3-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="LUCENE-3079"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[LUCENE-3079] Faceting module - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[LUCENE-3079] Faceting module - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/LUCENE" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-3079">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310110" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Lucene - Core'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310110&amp;avatarId=10061"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/LUCENE">Lucene - Core</a></li>
                 <li><a class="issue-link" data-issue-key="LUCENE-3079" href="/jira/browse/LUCENE-3079" id="key-val" rel="12506488">LUCENE-3079</a></li>
                </ol>
                <h1 id="summary-val">Faceting module</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-3079"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/LUCENE-3079/LUCENE-3079.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/LUCENE-3079/LUCENE-3079.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/LUCENE-3079/LUCENE-3079.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/LUCENE-3079/LUCENE-3079.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" title="Improvement - An improvement or enhancement to an existing feature or task." width="16"> Improvement </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+3.4" title="3.4 Major release after 3.3">3.4</a>, <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+4.0-ALPHA" title="4.0-ALPHA Alpha release of the 4.x series">4.0-ALPHA</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+component+%3D+%22modules%2Ffacet%22" title="modules/facet Faceted Indexing &amp; Search module">modules/facet</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12506488-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310120" class="item"> 
                     <div class="wrap"> 
                      <strong title="Lucene Fields" class="name">Lucene Fields:</strong> 
                      <div id="customfield_12310120-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310120-field"> 
                        <span>New</span>, 
                        <span>Patch Available</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>Faceting is a hugely important feature, available in Solr today but<br> not <span class="error">[easily]</span> usable by Lucene-only apps.</p> 
                  <p>We should fix this, by creating a shared faceting module.</p> 
                  <p>Ideally, we factor out Solr's faceting impl, and maybe poach/merge<br> from other impls (eg Bobo browse).</p> 
                  <p>Hoss describes some important challenges we'll face in doing this<br> (<a href="http://markmail.org/message/5w35c2fr4zkiwsz6" class="external-link" rel="nofollow">http://markmail.org/message/5w35c2fr4zkiwsz6</a>), copied here:</p> 
                  <div class="preformatted panel" style="border-width: 1px;">
                   <div class="preformattedContent panelContent"> 
                    <pre>To look at "faceting" as a concrete example, there are big the reasons 
faceting works so well in Solr: Solr has total control over the 
index, knows exactly when the index has changed to rebuild caches, has a 
strict schema so it can make sense of field types and 
pick faceting algos accordingly, has multi-phase distributed search 
approach to get exact counts efficiently across multiple shards, etc...
(and there are still a lot of additional enhancements and improvements 
that can be made to take even more advantage of knowledge solr has because 
it "owns" the index that we no one has had time to tackle)
</pre> 
                   </div>
                  </div> 
                  <p>This is a great list of the things we face in refactoring. It's also<br> important because, if Solr needed to be so deeply intertwined with<br> caching, schema, etc., other apps that want to facet will have the<br> same "needs" and so we really have to address them in creating the<br> shared module.</p> 
                  <p>I think we should get a basic faceting module started, but should not<br> cut Solr over at first. We should iterate on the module, fold in<br> improvements, etc., and then, once we can fully verify that cutting<br> over doesn't hurt Solr (ie lose functionality or performance) we can<br> later cutover.</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/LUCENE-3079?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/LUCENE-3079?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/LUCENE-3079?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/LUCENE-3079?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12484629" data-issue-id="12506488" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12484629/facet-userguide.pdf" draggable="true" data-downloadurl="application/pdf:facet-userguide.pdf:https://issues.apache.org/jira/secure/attachment/12484629/facet-userguide.pdf" file-preview-id="12484629" file-preview-title="facet-userguide.pdf" file-preview-type="document"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-pdf" title="PDF File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12484629/facet-userguide.pdf" title="Latest  29/Jun/11 12:13 - Shai Erera" draggable="true" data-downloadurl="application/pdf:facet-userguide.pdf:https://issues.apache.org/jira/secure/attachment/12484629/facet-userguide.pdf" file-preview-id="12484629" file-preview-title="facet-userguide.pdf" file-preview-type="document">facet-userguide.pdf</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-29T12:13:52.219Z">29/Jun/11 12:13</time>
                   </dd>
                   <dd class="attachment-size">
                    283 kB
                   </dd>
                   <dd class="attachment-author">
                    Shai Erera
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12484663" data-issue-id="12506488" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12484663/LUCENE-3079_4x_broken.patch" draggable="true" data-downloadurl="text/plain:LUCENE-3079_4x_broken.patch:https://issues.apache.org/jira/secure/attachment/12484663/LUCENE-3079_4x_broken.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12484663/LUCENE-3079_4x_broken.patch" title="Latest  29/Jun/11 16:41 - Robert Muir" draggable="true" data-downloadurl="text/plain:LUCENE-3079_4x_broken.patch:https://issues.apache.org/jira/secure/attachment/12484663/LUCENE-3079_4x_broken.patch">LUCENE-3079_4x_broken.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-29T16:41:06.087Z">29/Jun/11 16:41</time>
                   </dd>
                   <dd class="attachment-size">
                    50 kB
                   </dd>
                   <dd class="attachment-author">
                    Robert Muir
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12484672" data-issue-id="12506488" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12484672/LUCENE-3079_4x.patch" draggable="true" data-downloadurl="text/plain:LUCENE-3079_4x.patch:https://issues.apache.org/jira/secure/attachment/12484672/LUCENE-3079_4x.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12484672/LUCENE-3079_4x.patch" title="Latest  29/Jun/11 18:34 - Robert Muir" draggable="true" data-downloadurl="text/plain:LUCENE-3079_4x.patch:https://issues.apache.org/jira/secure/attachment/12484672/LUCENE-3079_4x.patch">LUCENE-3079_4x.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-29T18:34:28.431Z">29/Jun/11 18:34</time>
                   </dd>
                   <dd class="attachment-size">
                    52 kB
                   </dd>
                   <dd class="attachment-author">
                    Robert Muir
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12484684" data-issue-id="12506488" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12484684/LUCENE-3079.patch" draggable="true" data-downloadurl="text/plain:LUCENE-3079.patch:https://issues.apache.org/jira/secure/attachment/12484684/LUCENE-3079.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12484684/LUCENE-3079.patch" title="Latest  29/Jun/11 20:37 - Robert Muir" draggable="true" data-downloadurl="text/plain:LUCENE-3079.patch:https://issues.apache.org/jira/secure/attachment/12484684/LUCENE-3079.patch">LUCENE-3079.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-29T20:37:02.530Z">29/Jun/11 20:37</time>
                   </dd>
                   <dd class="attachment-size">
                    53 kB
                   </dd>
                   <dd class="attachment-author">
                    Robert Muir
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12483957" data-issue-id="12506488" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12483957/LUCENE-3079.patch" draggable="true" data-downloadurl="text/plain:LUCENE-3079.patch:https://issues.apache.org/jira/secure/attachment/12483957/LUCENE-3079.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12483957/LUCENE-3079.patch" title=" 27/Jun/11 14:14 - Robert Muir" draggable="true" data-downloadurl="text/plain:LUCENE-3079.patch:https://issues.apache.org/jira/secure/attachment/12483957/LUCENE-3079.patch">LUCENE-3079.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-27T14:14:43.699Z">27/Jun/11 14:14</time>
                   </dd>
                   <dd class="attachment-size">
                    1.49 MB
                   </dd>
                   <dd class="attachment-author">
                    Robert Muir
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12483946" data-issue-id="12506488" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12483946/LUCENE-3079.patch" draggable="true" data-downloadurl="text/plain:LUCENE-3079.patch:https://issues.apache.org/jira/secure/attachment/12483946/LUCENE-3079.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12483946/LUCENE-3079.patch" title=" 27/Jun/11 13:02 - Shai Erera" draggable="true" data-downloadurl="text/plain:LUCENE-3079.patch:https://issues.apache.org/jira/secure/attachment/12483946/LUCENE-3079.patch">LUCENE-3079.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-27T13:02:56.286Z">27/Jun/11 13:02</time>
                   </dd>
                   <dd class="attachment-size">
                    1.55 MB
                   </dd>
                   <dd class="attachment-author">
                    Shai Erera
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12483461" data-issue-id="12506488" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12483461/LUCENE-3079.patch" draggable="true" data-downloadurl="text/x-diff:LUCENE-3079.patch:https://issues.apache.org/jira/secure/attachment/12483461/LUCENE-3079.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12483461/LUCENE-3079.patch" title=" 22/Jun/11 17:05 - Stefan Trcek" draggable="true" data-downloadurl="text/x-diff:LUCENE-3079.patch:https://issues.apache.org/jira/secure/attachment/12483461/LUCENE-3079.patch">LUCENE-3079.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-22T17:05:56.682Z">22/Jun/11 17:05</time>
                   </dd>
                   <dd class="attachment-size">
                    42 kB
                   </dd>
                   <dd class="attachment-author">
                    Stefan Trcek
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12483959" data-issue-id="12506488" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12483959/LUCENE-3079-dev-tools.patch" draggable="true" data-downloadurl="text/plain:LUCENE-3079-dev-tools.patch:https://issues.apache.org/jira/secure/attachment/12483959/LUCENE-3079-dev-tools.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12483959/LUCENE-3079-dev-tools.patch" title="Latest  27/Jun/11 14:43 - Shai Erera" draggable="true" data-downloadurl="text/plain:LUCENE-3079-dev-tools.patch:https://issues.apache.org/jira/secure/attachment/12483959/LUCENE-3079-dev-tools.patch">LUCENE-3079-dev-tools.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-27T14:43:00.142Z">27/Jun/11 14:43</time>
                   </dd>
                   <dd class="attachment-size">
                    4 kB
                   </dd>
                   <dd class="attachment-author">
                    Shai Erera
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12484466" data-issue-id="12506488" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12484466/TestPerformanceHack.java" draggable="true" data-downloadurl="text/x-java:TestPerformanceHack.java:https://issues.apache.org/jira/secure/attachment/12484466/TestPerformanceHack.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="Java Source File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12484466/TestPerformanceHack.java" title="Latest  28/Jun/11 15:38 - Toke Eskildsen" draggable="true" data-downloadurl="text/x-java:TestPerformanceHack.java:https://issues.apache.org/jira/secure/attachment/12484466/TestPerformanceHack.java">TestPerformanceHack.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-06-28T15:38:23.932Z">28/Jun/11 15:38</time>
                   </dd>
                   <dd class="attachment-size">
                    12 kB
                   </dd>
                   <dd class="attachment-author">
                    Toke Eskildsen
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="blocks">
                   blocks
                  </dt> 
                  <dd id="internal-12507220_10032"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype" width="16" height="16" title="New Feature - A new feature of the product, which has yet to be developed." alt="New Feature - A new feature of the product, which has yet to be developed."> <span title="LUCENE-3097: Post grouping faceting"> <a href="/jira/browse/LUCENE-3097" data-issue-key="LUCENE-3097" class="issue-link link-title resolution">LUCENE-3097</a> <span class="link-summary">Post grouping faceting</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/minor.svg" width="16" height="16" title="Minor - Minor loss of function, or other problem where easy workaround is present." alt="Minor - Minor loss of function, or other problem where easy workaround is present."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_shaie" rel="shaie" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Shai Erera&quot;,&quot;emailAddress&quot;:&quot;serera@gmail.com&quot;,&quot;username&quot;:&quot;shaie&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="shaie"></span></span> Shai Erera </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_mikemccand" rel="mikemccand" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Michael McCandless&quot;,&quot;emailAddress&quot;:&quot;lucene@mikemccandless.com&quot;,&quot;username&quot;:&quot;mikemccand&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="mikemccand"></span></span> Michael McCandless </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">2</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">15</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="07/May/11 11:01"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2011-05-07T11:01:14+0000">07/May/11 11:01</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="09/Mar/13 20:50"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2013-03-09T20:50:28+0000">09/Mar/13 20:50</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="30/Jun/11 09:07"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2011-06-30T09:07:29+0000">30/Jun/11 09:07</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for n/a, Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-3079?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-3079?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-3079?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-3079?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-3079?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-3079?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-3079?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-3079?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/LUCENE-3079?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-3079?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-3079?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/LUCENE-3079?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-13053361\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13053361&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13053361\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"stefant\\\" id=\\\"commentauthor_13053361_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=stefant\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"stefant\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Stefan Trcek\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053361_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Jun\\/11 17:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-22T17:33:07+0000\'\u003e22\\/Jun\\/11 17:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis patch was generated by git and tested to apply with\u003cbr\\/\u003e\\npatch -p0 -i \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e.patch --dry-run\u003cbr\\/\u003e\\nBe patient if anything went wrong.\u003c\\/p\u003e\\n\\n\u003cp\u003eReview starting points may be\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eFacetSearcherTest.testSimpleFacetWithIndexSearcher() or\u003c\\/li\u003e\\n\\t\u003cli\u003eFacetSearcher.facetCollectSearch()\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eFunctions.java may be  dismissed in favor of Guava.\u003cbr\\/\u003e\\nIf you are willing to keep it I\'ll strip it down to the required parts.\u003c\\/p\u003e\\n\\n\u003cp\u003e----------------------------------------------------------------------\u003c\\/p\u003e\\n\\n\u003cp\u003eThe implementation relies on field cache only, no index scheme, no \u003cbr\\/\u003e\\ncached filters etc. It supports\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003esingle valued facets (Facet.java)\u003c\\/li\u003e\\n\\t\u003cli\u003emulti valued facets (Facet.MultiValued.java)\u003c\\/li\u003e\\n\\t\u003cli\u003efacet filters (see FacetSearcher.java)\u003c\\/li\u003e\\n\\t\u003cli\u003eevaluation of facet values that would dismiss due to other facet\u003cbr\\/\u003e\\nfilters (Yonik says Solr calls this \\\"multi-select faceting\\\").\u003cbr\\/\u003e\\n(realized by FacetSearcher.fillFacetsForGuiMode())\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eLet me explain the last point: For the user a facet query\u003cbr\\/\u003e\\n\\u00A0 (color==green) AND (shape==circle OR shape==square)\u003cbr\\/\u003e\\nmay look like\u003c\\/p\u003e\\n\\n\u003cp\u003eFacet color\u003cbr\\/\u003e\\n[ ] (3) red\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;x&#93;\u003c\\/span\u003e (5) green\u003cbr\\/\u003e\\n[ ] (7) blue\u003c\\/p\u003e\\n\\n\u003cp\u003eFacet shape\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;x&#93;\u003c\\/span\u003e (9) circle\u003cbr\\/\u003e\\n[ ] (4) line\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;x&#93;\u003c\\/span\u003e (2) square\u003c\\/p\u003e\\n\\n\u003cp\u003eThe red\\/blue\\/line facet values will display even though the \u003cbr\\/\u003e\\ncorresponding documents are not in the result set. Also there is \u003cbr\\/\u003e\\nsupport for filtered facet values with zero results, so users \u003cbr\\/\u003e\\nunderstand why they do not get results.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"stefant\\\" id=\\\"commentauthor_13053361_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=stefant\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"stefant\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Stefan Trcek\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053361_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Jun\\/11 17:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-22T17:33:07+0000\'\u003e22\\/Jun\\/11 17:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This patch was generated by git and tested to apply with \\npatch -p0 -i   LUCENE-3079  .patch --dry-run \\nBe patient if anything went wrong. \\n\\n Review starting points may be \\n \\n\\t FacetSearcherTest.testSimpleFacetWithIndexSearcher() or \\n\\t FacetSearcher.facetCollectSearch() \\n \\n\\n\\n Functions.java may be  dismissed in favor of Guava. \\nIf you are willing to keep it I\'ll strip it down to the required parts. \\n\\n ---------------------------------------------------------------------- \\n\\n The implementation relies on field cache only, no index scheme, no  \\ncached filters etc. It supports \\n \\n\\t single valued facets (Facet.java) \\n\\t multi valued facets (Facet.MultiValued.java) \\n\\t facet filters (see FacetSearcher.java) \\n\\t evaluation of facet values that would dismiss due to other facet \\nfilters (Yonik says Solr calls this \\\"multi-select faceting\\\"). \\n(realized by FacetSearcher.fillFacetsForGuiMode()) \\n \\n\\n\\n Let me explain the last point: For the user a facet query \\n\\u00A0 (color==green) AND (shape==circle OR shape==square) \\nmay look like \\n\\n Facet color \\n[ ] (3) red \\n &#91;x&#93;  (5) green \\n[ ] (7) blue \\n\\n Facet shape \\n &#91;x&#93;  (9) circle \\n[ ] (4) line \\n &#91;x&#93;  (2) square \\n\\n The red\\/blue\\/line facet values will display even though the  \\ncorresponding documents are not in the result set. Also there is  \\nsupport for filtered facet values with zero results, so users  \\nunderstand why they do not get results.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13053580\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13053580&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13053580\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13053580_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053580_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 01:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T01:08:30+0000\'\u003e23\\/Jun\\/11 01:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eif Solr needed to be so deeply intertwined with caching, schema, etc., other apps that want to facet will have the same \\\"needs\\\"\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eSort of an aside, but not really.... specific applications are much easier.  A lot more indirection is required in Solr and a schema is needed for pretty much everything.  Without the schema, a client would specify \\\"sort=foo desc\\\" and Solr would have no idea how to do that.  A specific application just does it because they have the knowledge of what all the fields are.  It\'s why people have gotten along just fine without a schema in Lucene thus far.  If you\'re building another Solr... yes, you need something like a schema.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_13053580_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053580_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 01:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T01:08:30+0000\'\u003e23\\/Jun\\/11 01:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     if Solr needed to be so deeply intertwined with caching, schema, etc., other apps that want to facet will have the same \\\"needs\\\"  \\n\\n Sort of an aside, but not really.... specific applications are much easier.  A lot more indirection is required in Solr and a schema is needed for pretty much everything.  Without the schema, a client would specify \\\"sort=foo desc\\\" and Solr would have no idea how to do that.  A specific application just does it because they have the knowledge of what all the fields are.  It\'s why people have gotten along just fine without a schema in Lucene thus far.  If you\'re building another Solr... yes, you need something like a schema. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13053581\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13053581&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13053581\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jasonrutherglen\\\" id=\\\"commentauthor_13053581_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jasonrutherglen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jasonrutherglen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Jason Rutherglen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053581_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 01:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T01:19:22+0000\'\u003e23\\/Jun\\/11 01:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSchemas should probably be a module that makes use of embedding the field types per-segment, this is something the faceting module could\\/should use.  I think is what \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2308\\\" title=\\\"Separately specify a field&#39;s type\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2308\\\"\u003e\u003cdel\u003eLUCENE-2308\u003c\\/del\u003e\u003c\\/a\u003e is aiming for?  Though I thought there was another Jira issue created by Simon for this as well.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jasonrutherglen\\\" id=\\\"commentauthor_13053581_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jasonrutherglen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jasonrutherglen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Jason Rutherglen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053581_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 01:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T01:19:22+0000\'\u003e23\\/Jun\\/11 01:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Schemas should probably be a module that makes use of embedding the field types per-segment, this is something the faceting module could\\/should use.  I think is what   LUCENE-2308   is aiming for?  Though I thought there was another Jira issue created by Simon for this as well.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13053587\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13053587&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13053587\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"cmale\\\" id=\\\"commentauthor_13053587_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=cmale\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"cmale\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Chris Male\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053587_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 01:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T01:24:29+0000\'\u003e23\\/Jun\\/11 01:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI don\'t think any Facet module needs to be concerned with Schemas.  Instead the module can expose an API which asks for the information it needs to make the best choices.  Solr can then provide that information based on its Schema, pure Lucene users can do it however they want. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"cmale\\\" id=\\\"commentauthor_13053587_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=cmale\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"cmale\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Chris Male\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053587_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 01:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T01:24:29+0000\'\u003e23\\/Jun\\/11 01:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I don\'t think any Facet module needs to be concerned with Schemas.  Instead the module can expose an API which asks for the information it needs to make the best choices.  Solr can then provide that information based on its Schema, pure Lucene users can do it however they want.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13053591\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13053591&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13053591\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jasonrutherglen\\\" id=\\\"commentauthor_13053591_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jasonrutherglen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jasonrutherglen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Jason Rutherglen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053591_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 01:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T01:32:07+0000\'\u003e23\\/Jun\\/11 01:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eI don\'t think any Facet module needs to be concerned with Schemas\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eRight, they should be field type aware.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jasonrutherglen\\\" id=\\\"commentauthor_13053591_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jasonrutherglen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jasonrutherglen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Jason Rutherglen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053591_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 01:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T01:32:07+0000\'\u003e23\\/Jun\\/11 01:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     I don\'t think any Facet module needs to be concerned with Schemas  \\n\\n Right, they should be field type aware.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13053847\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13053847&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13053847\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13053847_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053847_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 13:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T13:36:09+0000\'\u003e23\\/Jun\\/11 13:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI would like to contribute IBM\'s faceted search package (been wanting to do that for quite a while). The package supports the following features\\/capabilities (at a high-level):\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eTaxonomy index &#8211; manages trees of \'categories\'. You can view example of taxonomies at e.g. the Open Directory Project.\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003eIt\'s a Lucene index managed alongside the content index.\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eBuilds the taxonomy on-the-fly (i.e. as categories are discovered).\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eIn general it maps a category hierarchy to ordinals (integers). For example, the category \\/date\\/2011\\/06\\/24 will create the following entry in the taxonomy index:\\n\\t\\t\u003cul\u003e\\n\\t\\t\\t\u003cli\u003e\\/date, ordinal=1\u003c\\/li\u003e\\n\\t\\t\\t\u003cli\u003e\\/date\\/2011, ordinal=2\u003c\\/li\u003e\\n\\t\\t\\t\u003cli\u003e\\/date\\/2011\\/06, ordinal=3\u003c\\/li\u003e\\n\\t\\t\\t\u003cli\u003e\\/date\\/2011\\/06\\/24, ordinal=4\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eFacetsDocumentBuilder which receives a list of categories that are associated w\\/ the document (can be of several dimensions) and:\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003eFetches the ordinals of the category components from the taxonomy index (adding them to it on-the-fly).\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eIndexes them in a (compressed) payload for the document (so for the above category example, 4 payloads will be indexed for the document).\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eFDB can be used to augment a Document with other fields for indexing (it adds its own Field objects).\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eFacetsCollector receives a handle to the taxonomy, a list of facet \'roots\' to count and returns the top-K categories for each requested facet:\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003eThe root can denote any node in the category tree (e.g., \'count all facets under \\/date\\/2011\')\u003c\\/li\u003e\\n\\t\\t\u003cli\u003etop-K can be returned for the top most K immediate children of root, or any top-K in the sub-tree of root.\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eCounting algorithm (at a high-level):\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003eFetch the payload for every matching document.\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eIncrement by 1 the count of every ordinal that was encountered (even for facets that were not requested by the user)\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eAfter all ordinals are counted, compute the top-K on the ones the user requested\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eLabel the result facets\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eMiscellaneous features:\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003e\u003cb\u003eSampling\u003c\\/b\u003e algorithm allows for more efficient facets counting\\/accumulation, while still returning exact counts for the top-K facets.\u003c\\/li\u003e\\n\\t\\t\u003cli\u003e\u003cb\u003eComplements\u003c\\/b\u003e algorithm allows for more efficient facets counting\\/accumulation, when the number of results is &gt; 50% of the docs in the index (we keep a total count of facets, count facets on the docs that did not match the query and subtract).\\n\\t\\t\u003cul\u003e\\n\\t\\t\\t\u003cli\u003eComplements can be used to count facets that do not appear in any of the matching documents (of this result set). This does not exist in the package though ... yet.\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\\t\u003cli\u003e\u003cb\u003eFacets partitioning\u003c\\/b\u003e &#8211; if the taxonomy is huge (i.e. millions of categories), it is better to partition them at indexing time, so that search time is faster and consumes less memory. Note that this is required because of the approach of counting all (allocating a count array) and then keeping only the results of interest.\u003c\\/li\u003e\\n\\t\\t\u003cli\u003e\u003cb\u003eCategory enhancements\u003c\\/b\u003e allow storing \'metadata\' with categories in the index, so that more than simple counting can be implemented:\\n\\t\\t\u003cul\u003e\\n\\t\\t\\t\u003cli\u003e\u003cb\u003eweighted facets\u003c\\/b\u003e (built on top of enhancements) allows associating a weight w\\/ each category, and use smarter counting techniques at runtime. For example, if facets are generated by an analytics component, the confidence level can be set as the category\'s weight. If tags are indexed as facets (for e.g. generating a tag cloud for the result set), the number of times the document was tagged by the tag can be set as the tag\'s weight.\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eThat that facets are indexed in the payloads of documents allows managing very large taxonomies and indexes, without blowing up the RAM at runtime (but incur some search performance overhead). However, the payloads can be loaded up to RAM (like in FieldCache) in which case runtime becomes much faster.\\n\\t\\t\u003cul\u003e\\n\\t\\t\\t\u003cli\u003eHowever facets are stored is abstracted though by a CountingList API, so we can definitely explore other means of storing the facet ordinals. Actually, the CountingList API allows us to read the ordinals from disk or RAM w\\/o affecting the rest of the algorithm at all.\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eI did not want to dive too deep on the API here, but the runtime API is very extensible and allows one to use FacetsCollector for the simple cases, or lower-level API to get more control on the process. You can look at: FacetRequest, FacetSearchParams, FacetResult, FacetResultNode, FacetsCollector, FacetsAccumulator, FacetsAggregator for a more extensive set of API to use.\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eThe package comes with example code which shows how to use the different features I\'ve mentioned. There are also unit tests for ensuring the example code works \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eThe package comes with a very extensive tests suite and is in use by many of our products for a long time, so I can state that it\'s very stable.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eSome rough performance numbers:\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003eCollection of 1M documents, few hierarchical facets per document (we call it the \'Amazon\' case)\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eQuery matches 49.8% of the docs (~500K)\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eNo sampling \\/ complements were used.\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eFacets read from disk\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eTakes 0.4 seconds to execute the query and count facets.\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eIt will take me a few days to prepare a patch (lots of code) - will upload it as soon as it\'s ready.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13053847_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053847_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 13:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T13:36:09+0000\'\u003e23\\/Jun\\/11 13:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I would like to contribute IBM\'s faceted search package (been wanting to do that for quite a while). The package supports the following features\\/capabilities (at a high-level): \\n\\n \\n\\t Taxonomy index &#8211; manages trees of \'categories\'. You can view example of taxonomies at e.g. the Open Directory Project.\\n\\t \\n\\t\\t It\'s a Lucene index managed alongside the content index. \\n\\t\\t Builds the taxonomy on-the-fly (i.e. as categories are discovered). \\n\\t\\t In general it maps a category hierarchy to ordinals (integers). For example, the category \\/date\\/2011\\/06\\/24 will create the following entry in the taxonomy index:\\n\\t\\t \\n\\t\\t\\t \\/date, ordinal=1 \\n\\t\\t\\t \\/date\\/2011, ordinal=2 \\n\\t\\t\\t \\/date\\/2011\\/06, ordinal=3 \\n\\t\\t\\t \\/date\\/2011\\/06\\/24, ordinal=4 \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n\\n\\n \\n\\t FacetsDocumentBuilder which receives a list of categories that are associated w\\/ the document (can be of several dimensions) and:\\n\\t \\n\\t\\t Fetches the ordinals of the category components from the taxonomy index (adding them to it on-the-fly). \\n\\t\\t Indexes them in a (compressed) payload for the document (so for the above category example, 4 payloads will be indexed for the document). \\n\\t\\t FDB can be used to augment a Document with other fields for indexing (it adds its own Field objects). \\n\\t \\n\\t \\n \\n\\n\\n \\n\\t FacetsCollector receives a handle to the taxonomy, a list of facet \'roots\' to count and returns the top-K categories for each requested facet:\\n\\t \\n\\t\\t The root can denote any node in the category tree (e.g., \'count all facets under \\/date\\/2011\') \\n\\t\\t top-K can be returned for the top most K immediate children of root, or any top-K in the sub-tree of root. \\n\\t \\n\\t \\n \\n\\n\\n \\n\\t Counting algorithm (at a high-level):\\n\\t \\n\\t\\t Fetch the payload for every matching document. \\n\\t\\t Increment by 1 the count of every ordinal that was encountered (even for facets that were not requested by the user) \\n\\t\\t After all ordinals are counted, compute the top-K on the ones the user requested \\n\\t\\t Label the result facets \\n\\t \\n\\t \\n \\n\\n\\n \\n\\t Miscellaneous features:\\n\\t \\n\\t\\t  Sampling  algorithm allows for more efficient facets counting\\/accumulation, while still returning exact counts for the top-K facets. \\n\\t\\t  Complements  algorithm allows for more efficient facets counting\\/accumulation, when the number of results is &gt; 50% of the docs in the index (we keep a total count of facets, count facets on the docs that did not match the query and subtract).\\n\\t\\t \\n\\t\\t\\t Complements can be used to count facets that do not appear in any of the matching documents (of this result set). This does not exist in the package though ... yet. \\n\\t\\t \\n\\t\\t \\n\\t\\t  Facets partitioning  &#8211; if the taxonomy is huge (i.e. millions of categories), it is better to partition them at indexing time, so that search time is faster and consumes less memory. Note that this is required because of the approach of counting all (allocating a count array) and then keeping only the results of interest. \\n\\t\\t  Category enhancements  allow storing \'metadata\' with categories in the index, so that more than simple counting can be implemented:\\n\\t\\t \\n\\t\\t\\t  weighted facets  (built on top of enhancements) allows associating a weight w\\/ each category, and use smarter counting techniques at runtime. For example, if facets are generated by an analytics component, the confidence level can be set as the category\'s weight. If tags are indexed as facets (for e.g. generating a tag cloud for the result set), the number of times the document was tagged by the tag can be set as the tag\'s weight. \\n\\t\\t \\n\\t\\t \\n\\t\\t That that facets are indexed in the payloads of documents allows managing very large taxonomies and indexes, without blowing up the RAM at runtime (but incur some search performance overhead). However, the payloads can be loaded up to RAM (like in FieldCache) in which case runtime becomes much faster.\\n\\t\\t \\n\\t\\t\\t However facets are stored is abstracted though by a CountingList API, so we can definitely explore other means of storing the facet ordinals. Actually, the CountingList API allows us to read the ordinals from disk or RAM w\\/o affecting the rest of the algorithm at all. \\n\\t\\t \\n\\t\\t \\n\\t\\t I did not want to dive too deep on the API here, but the runtime API is very extensible and allows one to use FacetsCollector for the simple cases, or lower-level API to get more control on the process. You can look at: FacetRequest, FacetSearchParams, FacetResult, FacetResultNode, FacetsCollector, FacetsAccumulator, FacetsAggregator for a more extensive set of API to use. \\n\\t \\n\\t \\n \\n\\n\\n \\n\\t The package comes with example code which shows how to use the different features I\'ve mentioned. There are also unit tests for ensuring the example code works  . \\n \\n\\n\\n \\n\\t The package comes with a very extensive tests suite and is in use by many of our products for a long time, so I can state that it\'s very stable. \\n \\n\\n\\n \\n\\t Some rough performance numbers:\\n\\t \\n\\t\\t Collection of 1M documents, few hierarchical facets per document (we call it the \'Amazon\' case) \\n\\t\\t Query matches 49.8% of the docs (~500K) \\n\\t\\t No sampling \\/ complements were used. \\n\\t\\t Facets read from disk \\n\\t\\t Takes 0.4 seconds to execute the query and count facets. \\n\\t \\n\\t \\n \\n\\n\\n It will take me a few days to prepare a patch (lots of code) - will upload it as soon as it\'s ready.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13053886\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13053886&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13053886\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"janhoy\\\" id=\\\"commentauthor_13053886_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=janhoy\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"janhoy\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Jan H\\u00F8ydahl\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053886_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 14:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T14:33:37+0000\'\u003e23\\/Jun\\/11 14:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eBravo Shai &amp; IBM!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"janhoy\\\" id=\\\"commentauthor_13053886_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=janhoy\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"janhoy\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Jan H\\u00F8ydahl\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053886_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 14:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T14:33:37+0000\'\u003e23\\/Jun\\/11 14:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Bravo Shai &amp; IBM!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13053940\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13053940&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13053940\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ryantxu\\\" id=\\\"commentauthor_13053940_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ryantxu\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ryantxu\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ryan McKinley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053940_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 16:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T16:00:48+0000\'\u003e23\\/Jun\\/11 16:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eBravo Shai &amp; IBM!\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e+1!  This sounds awesome, and I hope will prove how modules will help lucene \u003cb\u003eand\u003c\\/b\u003e solr\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ryantxu\\\" id=\\\"commentauthor_13053940_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ryantxu\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ryantxu\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ryan McKinley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13053940_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jun\\/11 16:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-23T16:00:48+0000\'\u003e23\\/Jun\\/11 16:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Bravo Shai &amp; IBM!  \\n\\n +1!  This sounds awesome, and I hope will prove how modules will help lucene  and  solr              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13055402\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13055402&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13055402\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13055402_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055402_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 08:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T08:51:35+0000\'\u003e27\\/Jun\\/11 08:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis is quite another design than the quarter-baked one I\'ve proposed with \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-2412\\\" title=\\\"Multipath hierarchical faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-2412\\\"\u003eSOLR-2412\u003c\\/a\u003e (which is really just a thin wrapper around \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e). While maintaining a sidecar index makes the workflow more complicated, I would expect that it is beneficial for re-open speed and scalability.\u003c\\/p\u003e\\n\\n\u003cp\u003eTechnical note: For hierarchical faceting, I find that it is possible to avoid storing all levels in the hierarchy. By maintaining two numbers for each tag, denoting the tag-level and the level for the previous tag that matches, only the relevant tags needs to be indexed (full explanation at \u003ca href=\\\"https:\\/\\/sbdevel.wordpress.com\\/2010\\/10\\/05\\/fast-hierarchical-faceting\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/sbdevel.wordpress.com\\/2010\\/10\\/05\\/fast-hierarchical-faceting\\/\u003c\\/a\u003e).\u003c\\/p\u003e\\n\\n\u003cp\u003eKudos for contributing solid code. I am looking forward to seeing the patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13055402_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055402_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 08:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T08:51:35+0000\'\u003e27\\/Jun\\/11 08:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This is quite another design than the quarter-baked one I\'ve proposed with  SOLR-2412  (which is really just a thin wrapper around  LUCENE-2369 ). While maintaining a sidecar index makes the workflow more complicated, I would expect that it is beneficial for re-open speed and scalability. \\n\\n Technical note: For hierarchical faceting, I find that it is possible to avoid storing all levels in the hierarchy. By maintaining two numbers for each tag, denoting the tag-level and the level for the previous tag that matches, only the relevant tags needs to be indexed (full explanation at  https:\\/\\/sbdevel.wordpress.com\\/2010\\/10\\/05\\/fast-hierarchical-faceting\\/ ). \\n\\n Kudos for contributing solid code. I am looking forward to seeing the patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13055443\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13055443&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13055443\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13055443_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055443_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 10:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T10:00:34+0000\'\u003e27\\/Jun\\/11 10:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Toke for the pointer. I think it\'s very interesting. We\'ve actually explored in the past storing just the category\\/leaf, instead of the entire hierarchy, in the document. The search response time was much slower than what I reported above (nearly 2x slowdown). While storing the entire hierarchy indeed consumes more space, it is more performing at search time, and we figure that space today is cheap, and usually search apps are more interested in faster search response times and are willing to spend some more time at indexing and analysis stages.\u003c\\/p\u003e\\n\\n\u003cp\u003eNevertheless, the link you provided proposes an interesting way to manage the hierarchy, and I think it\'s worth exploring at some point. Could be that it will perform better than how we managed it when we indexed just the leaf category for each document. We\'d also need to see how to update the taxonomy on the go. For example, it describes that for A\\/B\\/C you know that its level is 3 (that\'s easy) and that the previous category\\/tag that matches (P) is A. But what if at some point A\\/B is added to a document? What happens to the data indexed for the doc w\\/ A\\/B\\/C, which now its previous matching category is A\\/B? It\'s not clear to me, but could be that I\'ve missed the description in the proposal.\u003c\\/p\u003e\\n\\n\u003cp\u003eI am very close to uploading the patch. Hopefully I\'ll upload it by the end of my day.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13055443_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055443_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 10:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T10:00:34+0000\'\u003e27\\/Jun\\/11 10:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Toke for the pointer. I think it\'s very interesting. We\'ve actually explored in the past storing just the category\\/leaf, instead of the entire hierarchy, in the document. The search response time was much slower than what I reported above (nearly 2x slowdown). While storing the entire hierarchy indeed consumes more space, it is more performing at search time, and we figure that space today is cheap, and usually search apps are more interested in faster search response times and are willing to spend some more time at indexing and analysis stages. \\n\\n Nevertheless, the link you provided proposes an interesting way to manage the hierarchy, and I think it\'s worth exploring at some point. Could be that it will perform better than how we managed it when we indexed just the leaf category for each document. We\'d also need to see how to update the taxonomy on the go. For example, it describes that for A\\/B\\/C you know that its level is 3 (that\'s easy) and that the previous category\\/tag that matches (P) is A. But what if at some point A\\/B is added to a document? What happens to the data indexed for the doc w\\/ A\\/B\\/C, which now its previous matching category is A\\/B? It\'s not clear to me, but could be that I\'ve missed the description in the proposal. \\n\\n I am very close to uploading the patch. Hopefully I\'ll upload it by the end of my day.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13055480\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13055480&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13055480\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13055480_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055480_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 11:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T11:39:02+0000\'\u003e27\\/Jun\\/11 11:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-2412\\\" title=\\\"Multipath hierarchical faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-2412\\\"\u003eSOLR-2412\u003c\\/a\u003e\\/\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e were created with the trade-offs (relatively) long startup, low memory, high performance: When the index is (re)opened, the hierarchy is analyzed by iterating the terms (it could be offloaded to index-time, but it is still iterate-the-entire-term-list after each change). This does not play well with real-time, but should be a nice fit for large indexes with low update rate.\u003c\\/p\u003e\\n\\n\u003cp\u003eAs for speed, my theory is that the sparser hierarchy (only the concrete paths) wins due to less counting, but without another solution to compare against it has so far remained a theory. There are some measurements at \u003ca href=\\\"https:\\/\\/sbdevel.wordpress.com\\/2010\\/10\\/11\\/hierarchical-faceting\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/sbdevel.wordpress.com\\/2010\\/10\\/11\\/hierarchical-faceting\\/\u003c\\/a\u003e but I find that for hierarchical faceting, small changes to test-setups can easily have vast implications on performance, so they are not comparable to your million-document test.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13055480_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055480_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 11:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T11:39:02+0000\'\u003e27\\/Jun\\/11 11:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     SOLR-2412 \\/ LUCENE-2369  were created with the trade-offs (relatively) long startup, low memory, high performance: When the index is (re)opened, the hierarchy is analyzed by iterating the terms (it could be offloaded to index-time, but it is still iterate-the-entire-term-list after each change). This does not play well with real-time, but should be a nice fit for large indexes with low update rate. \\n\\n As for speed, my theory is that the sparser hierarchy (only the concrete paths) wins due to less counting, but without another solution to compare against it has so far remained a theory. There are some measurements at  https:\\/\\/sbdevel.wordpress.com\\/2010\\/10\\/11\\/hierarchical-faceting\\/  but I find that for hierarchical faceting, small changes to test-setups can easily have vast implications on performance, so they are not comparable to your million-document test.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13055517\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13055517&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13055517\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13055517_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055517_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 13:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T13:02:56+0000\'\u003e27\\/Jun\\/11 13:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached patch includes the faceted search module. It currently compiles \u003cbr\\/\u003e\\nagainst 3x, so I\'ve put it under lucene\\/contrib, but after we port it to \u003cbr\\/\u003e\\ntrunk, it should be under modules\\/.\u003c\\/p\u003e\\n\\n\u003cp\u003eThere isn\'t a short way to describe the content of the patch (as you can \u003cbr\\/\u003e\\nsee, it\'s huge), so instead I\'ll give a brief overview of some key \u003cbr\\/\u003e\\npackages: \u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003esrc\\/examples: contains code of different capabilities of the facets module. I\'d start w\\/ examples\\/simple.\u003c\\/li\u003e\\n\\t\u003cli\u003esrc\\/test: contains many tests, great place to start too\u003c\\/li\u003e\\n\\t\u003cli\u003eo.a.l.facet.taxonomy contains the taxonomy index management code. There are two interfaces TaxonomyWriter\\/Reader with a LuceneTW\\/TR impl\u003c\\/li\u003e\\n\\t\u003cli\u003eo.a.l.facet.index contains the indexing code of the different capabilities (e.g. simpl, enhancements etc.)\u003c\\/li\u003e\\n\\t\u003cli\u003eo.a.l.facet.search contains the respective search code\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eFew points:\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eI\'ve put the ASL on all files.\u003c\\/li\u003e\\n\\t\u003cli\u003eMarked all code as @lucene.experimental.\u003c\\/li\u003e\\n\\t\u003cli\u003eAfter you apply the patch you can run \'ant eclipse\' and it will build the facets code in eclipse (no maven integration yet - will need to look into it)\u003c\\/li\u003e\\n\\t\u003cli\u003eUnder o.a.l and o.a.l.util there are several utility classes that are not specific to facetted search, however the facets code uses them. I\'ve kept them there so that we can review and decide whether we want to move them to lucene-core at some point.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eTODOs:\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eAfter it\'s on trunk, I think we should explore replacing the payloads w\\/ DocValues.\u003c\\/li\u003e\\n\\t\u003cli\u003eLeverage Lucene\'s superb random testing framework !\u003c\\/li\u003e\\n\\t\u003cli\u003eThere are few TODOs in the code which I think can be addressed following this issue.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI will open follow-on issues for those.\u003c\\/p\u003e\\n\\n\u003cp\u003eGiven the amount of code, I am wondering if perhaps we should commit it \u003cbr\\/\u003e\\nas-is, and do more thorough reviews afterwards. The code does not modify \u003cbr\\/\u003e\\nany existing code (aside from a tiny change to LuceneTestCase), so I \u003cbr\\/\u003e\\nthink there\'s no risk in doing so. I am also not sure that it\'s sane to \u003cbr\\/\u003e\\nreview that amount of code (nearly 40K lines) in patch form. What do you \u003cbr\\/\u003e\\nthink?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13055517_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055517_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 13:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T13:02:56+0000\'\u003e27\\/Jun\\/11 13:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attached patch includes the faceted search module. It currently compiles  \\nagainst 3x, so I\'ve put it under lucene\\/contrib, but after we port it to  \\ntrunk, it should be under modules\\/. \\n\\n There isn\'t a short way to describe the content of the patch (as you can  \\nsee, it\'s huge), so instead I\'ll give a brief overview of some key  \\npackages:  \\n\\n \\n\\t src\\/examples: contains code of different capabilities of the facets module. I\'d start w\\/ examples\\/simple. \\n\\t src\\/test: contains many tests, great place to start too \\n\\t o.a.l.facet.taxonomy contains the taxonomy index management code. There are two interfaces TaxonomyWriter\\/Reader with a LuceneTW\\/TR impl \\n\\t o.a.l.facet.index contains the indexing code of the different capabilities (e.g. simpl, enhancements etc.) \\n\\t o.a.l.facet.search contains the respective search code \\n \\n\\n\\n Few points: \\n \\n\\t I\'ve put the ASL on all files. \\n\\t Marked all code as @lucene.experimental. \\n\\t After you apply the patch you can run \'ant eclipse\' and it will build the facets code in eclipse (no maven integration yet - will need to look into it) \\n\\t Under o.a.l and o.a.l.util there are several utility classes that are not specific to facetted search, however the facets code uses them. I\'ve kept them there so that we can review and decide whether we want to move them to lucene-core at some point. \\n \\n\\n\\n TODOs: \\n \\n\\t After it\'s on trunk, I think we should explore replacing the payloads w\\/ DocValues. \\n\\t Leverage Lucene\'s superb random testing framework ! \\n\\t There are few TODOs in the code which I think can be addressed following this issue. \\n \\n\\n\\n I will open follow-on issues for those. \\n\\n Given the amount of code, I am wondering if perhaps we should commit it  \\nas-is, and do more thorough reviews afterwards. The code does not modify  \\nany existing code (aside from a tiny change to LuceneTestCase), so I  \\nthink there\'s no risk in doing so. I am also not sure that it\'s sane to  \\nreview that amount of code (nearly 40K lines) in patch form. What do you  \\nthink?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13055526\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13055526&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13055526\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"cmale\\\" id=\\\"commentauthor_13055526_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=cmale\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"cmale\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Chris Male\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055526_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 13:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T13:10:43+0000\'\u003e27\\/Jun\\/11 13:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGreat contribution Shai.  What about putting it into a branch? I think it really does need a thorough review before we put it into trunk.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"cmale\\\" id=\\\"commentauthor_13055526_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=cmale\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"cmale\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Chris Male\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055526_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 13:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T13:10:43+0000\'\u003e27\\/Jun\\/11 13:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Great contribution Shai.  What about putting it into a branch? I think it really does need a thorough review before we put it into trunk.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13055532\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13055532&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13055532\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13055532_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055532_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 13:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T13:17:53+0000\'\u003e27\\/Jun\\/11 13:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Shai Erera - 27\\/Jun\\/11 13:24\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWe can put it in a branch for trunk, in case we plan to refactor the code right away (at first I just thought to get it to compile against trunk). I thought that at first people would like to get hands on experience with it, before we discuss changes and refactoring. I mean, this code can really be released with Lucene\'s next 3x release. And since everything is @lucene.experimental, and is in its own separate contrib\\/module, I don\'t think a branch will ease off the review or refactoring process?\u003c\\/p\u003e\\n\\n\u003cp\u003eI guess what I\'m aiming for is for our users to get this feature soon. And I\'m afraid that putting it in a branch will only delay it.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13055532_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055532_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 13:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T13:17:53+0000\'\u003e27\\/Jun\\/11 13:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Shai Erera - 27\\/Jun\\/11 13:24\\\"\u003eedited\u003c\\/span\u003e                   We can put it in a branch for trunk, in case we plan to refactor the code right away (at first I just thought to get it to compile against trunk). I thought that at first people would like to get hands on experience with it, before we discuss changes and refactoring. I mean, this code can really be released with Lucene\'s next 3x release. And since everything is @lucene.experimental, and is in its own separate contrib\\/module, I don\'t think a branch will ease off the review or refactoring process? \\n\\n I guess what I\'m aiming for is for our users to get this feature soon. And I\'m afraid that putting it in a branch will only delay it.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13055568\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13055568&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13055568\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13055568_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055568_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 14:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T14:14:43+0000\'\u003e27\\/Jun\\/11 14:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ejust some trivial test modifications so the tests work with an unmodified LuceneTestCase:\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003ein some cases, if an assertion failed it would print the seed... but LTC does this.\u003c\\/li\u003e\\n\\t\u003cli\u003ein other tests, the test wanted to repeat a random sequence, but instead of exposing LTC internals, the test just grabs random.nextLong, makes a new Random from this, and then resets it with .setSeed.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13055568_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055568_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 14:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T14:14:43+0000\'\u003e27\\/Jun\\/11 14:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    just some trivial test modifications so the tests work with an unmodified LuceneTestCase: \\n\\n \\n\\t in some cases, if an assertion failed it would print the seed... but LTC does this. \\n\\t in other tests, the test wanted to repeat a random sequence, but instead of exposing LTC internals, the test just grabs random.nextLong, makes a new Random from this, and then resets it with .setSeed. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13055570\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13055570&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13055570\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13055570_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055570_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 14:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T14:17:27+0000\'\u003e27\\/Jun\\/11 14:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eI guess what I\'m aiming for is for our users to get this feature soon. And I\'m afraid that putting it in a branch will only delay it.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e+1\u003c\\/p\u003e\\n\\n\u003cp\u003eMy suggestion:\u003c\\/p\u003e\\n\u003col\u003e\\n\\t\u003cli\u003ecommit to branch 3.x with @experimental.\u003c\\/li\u003e\\n\\t\u003cli\u003enext, do a \\\"fast\\\" port to trunk, this doesnt mean heavy refactoring to take advantage of things like docvalues, just get it working correctly on trunk\'s APIs.\u003c\\/li\u003e\\n\\t\u003cli\u003efinally, close this issue and do improvements as normal, backporting whichever ones are easy and make sense, like any other issue.\u003c\\/li\u003e\\n\u003c\\/ol\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13055570_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055570_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 14:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T14:17:27+0000\'\u003e27\\/Jun\\/11 14:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n I guess what I\'m aiming for is for our users to get this feature soon. And I\'m afraid that putting it in a branch will only delay it.  \\n\\n +1 \\n\\n My suggestion: \\n \\n\\t commit to branch 3.x with @experimental. \\n\\t next, do a \\\"fast\\\" port to trunk, this doesnt mean heavy refactoring to take advantage of things like docvalues, just get it working correctly on trunk\'s APIs. \\n\\t finally, close this issue and do improvements as normal, backporting whichever ones are easy and make sense, like any other issue. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13055583\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13055583&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13055583\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13055583_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055583_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 14:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T14:43:00+0000\'\u003e27\\/Jun\\/11 14:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Robert for the fix. This indeed looks better than patching LTC !\u003c\\/p\u003e\\n\\n\u003cp\u003ePatch for dev-tools only, this time w\\/ Maven \u003cbr\\/\u003e\\nsupport too. I hope it works well \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13055583_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055583_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 14:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T14:43:00+0000\'\u003e27\\/Jun\\/11 14:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Robert for the fix. This indeed looks better than patching LTC ! \\n\\n Patch for dev-tools only, this time w\\/ Maven  \\nsupport too. I hope it works well  .              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13055584\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13055584&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13055584\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13055584_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055584_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 14:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T14:45:29+0000\'\u003e27\\/Jun\\/11 14:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eMy suggestion:\u003c\\/p\u003e\\n\\n\u003cp\u003e1. commit to branch 3.x with @experimental.\u003cbr\\/\u003e\\n2. next, do a \\\"fast\\\" port to trunk, this doesnt mean heavy refactoring to take advantage of things like docvalues, just get it working correctly on trunk\'s APIs.\u003cbr\\/\u003e\\n3. finally, close this issue and do improvements as normal, backporting whichever ones are easy and make sense, like any other issue.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI agree. I\'ll give it a day or two before I commit, unless everyone agree it can be committed today, in which case I\'ll happily press the button \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13055584_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13055584_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jun\\/11 14:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-27T14:45:29+0000\'\u003e27\\/Jun\\/11 14:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n My suggestion: \\n\\n 1. commit to branch 3.x with @experimental. \\n2. next, do a \\\"fast\\\" port to trunk, this doesnt mean heavy refactoring to take advantage of things like docvalues, just get it working correctly on trunk\'s APIs. \\n3. finally, close this issue and do improvements as normal, backporting whichever ones are easy and make sense, like any other issue.  \\n\\n I agree. I\'ll give it a day or two before I commit, unless everyone agree it can be committed today, in which case I\'ll happily press the button  .              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056377\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056377&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056377\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13056377_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056377_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 08:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T08:11:54+0000\'\u003e28\\/Jun\\/11 08:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe patch compiles neatly against a 3x stable checkout and the examples worked fine. Unfortunately I could not locate the million document test you mentioned above. Is it part of the patch?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13056377_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056377_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 08:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T08:11:54+0000\'\u003e28\\/Jun\\/11 08:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The patch compiles neatly against a 3x stable checkout and the examples worked fine. Unfortunately I could not locate the million document test you mentioned above. Is it part of the patch?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056390\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056390&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056390\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056390_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056390_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 08:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T08:43:18+0000\'\u003e28\\/Jun\\/11 08:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eUnfortunately I could not locate the million document test you mentioned above. Is it part of the patch?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIt\'s not included. We wrote a proprietary (not extending Benchmark) test and would like to extend Lucene\'s benchmark for benchmarking facets. I think it will be interesting to define some facets on the Wikipedia collection, and benchmark it.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056390_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056390_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 08:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T08:43:18+0000\'\u003e28\\/Jun\\/11 08:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Unfortunately I could not locate the million document test you mentioned above. Is it part of the patch?  \\n\\n It\'s not included. We wrote a proprietary (not extending Benchmark) test and would like to extend Lucene\'s benchmark for benchmarking facets. I think it will be interesting to define some facets on the Wikipedia collection, and benchmark it.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056427\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056427&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056427\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"simonw\\\" id=\\\"commentauthor_13056427_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=simonw\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"simonw\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Simon Willnauer\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056427_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 10:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T10:08:53+0000\'\u003e28\\/Jun\\/11 10:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eShai, MASSIVE PATCH! phew I don\'t want to review this entire thing in a patch really but at a first glance this looks very good. Lots of tests, documentation etc. and obviously this has been used in production so its seen some cpu cycles \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e I think roberts proposed way is good!\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003e+1\u003c\\/p\u003e\\n\\n\u003cp\u003eMy suggestion:\u003c\\/p\u003e\\n\\n\u003cp\u003ecommit to branch 3.x with @experimental.\u003cbr\\/\u003e\\nnext, do a \\\"fast\\\" port to trunk, this doesnt mean heavy refactoring to take advantage of things like docvalues, just get it working correctly on trunk\'s APIs.\u003cbr\\/\u003e\\nfinally, close this issue and do improvements as normal, backporting whichever ones are easy and make sense, like any other issue.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003ehere is my +1\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"simonw\\\" id=\\\"commentauthor_13056427_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=simonw\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"simonw\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Simon Willnauer\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056427_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 10:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T10:08:53+0000\'\u003e28\\/Jun\\/11 10:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Shai, MASSIVE PATCH! phew I don\'t want to review this entire thing in a patch really but at a first glance this looks very good. Lots of tests, documentation etc. and obviously this has been used in production so its seen some cpu cycles   I think roberts proposed way is good! \\n\\n \\n +1 \\n\\n My suggestion: \\n\\n commit to branch 3.x with @experimental. \\nnext, do a \\\"fast\\\" port to trunk, this doesnt mean heavy refactoring to take advantage of things like docvalues, just get it working correctly on trunk\'s APIs. \\nfinally, close this issue and do improvements as normal, backporting whichever ones are easy and make sense, like any other issue.  \\n\\n here is my +1              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056517\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056517&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056517\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13056517_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056517_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 13:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T13:54:47+0000\'\u003e28\\/Jun\\/11 13:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Toke Eskildsen - 28\\/Jun\\/11 15:17\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSome preliminary performance testing: I hacked together a test where 1M documents were created with an average of 3.5 paths, down to a depth of 4 (resulting in 1.4M unique paths). A search that hit every other document was issued and the top 5 facets\\/tags was requested. Hopefully this is somewhat similar to your test.\u003c\\/p\u003e\\n\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003cth class=\'confluenceTh\'\u003e&nbsp;\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e \u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e \u003c\\/th\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Index build time \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e  52 s \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e  23 s \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Memory required for indexing \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 192 MB \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 48 MB \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e First facet request \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 432 ms \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 12,000 ms \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Best of 5 requests \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 228 ms \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 159 ms \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Memory usage after faceting (after gc()) \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 21 MB \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 22 MB \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\\n\u003cp\u003eUpping the ante to 5M documents, 6.8 paths\\/docs, max depth 6 (22M unique paths) resulted in\u003c\\/p\u003e\\n\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003cth class=\'confluenceTh\'\u003e&nbsp;\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e \u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e \u003c\\/th\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Index build time \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e  752 s \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e  238 s \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Memory required for indexing \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 2500 MB \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 128 MB \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e First facet request \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 3370 ms \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 147,000 ms \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Best of 5 requests \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 2400 ms \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 2673 ms \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Memory usage after faceting \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 435 MB \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 294 MB \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\\n\u003cp\u003eScaling down to 100K documents, 1.6 paths\\/doc, max depth 4 (63K unique paths) resulted in\u003c\\/p\u003e\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003cth class=\'confluenceTh\'\u003e&nbsp;\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e \u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e \u003c\\/th\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Index build time \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e  5317 ms \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e  2563 ms \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Memory required for indexing \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 48 MB \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 32 MB \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e First facet request \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 245 ms \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 1425 ms \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Best of 5 requests \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 15 ms \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 8 ms \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Memory usage after faceting \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 1 MB \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 2 MB \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\\n\u003cp\u003eSome observations: It seems clear that some trade-offs are very different for the two solutions. \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e has brilliant startup time and slows analyzing time a bit through the whole indexing process. \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e is dog slow at startup but does not impact indexing. They seem similar with regards to search-time speed and memory usage.\u003c\\/p\u003e\\n\\n\u003cp\u003eNow, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e patches some semi-random Lucene-4, so this is not a fair test. Likewise, the tests were just quick hacks; the disk cache was not flushed, the laptop was used for browsing etc. When \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e patches trunk, a proper comparison can be made.\u003c\\/p\u003e\\n\\n\u003cp\u003eI am a bit worried about the observed memory usage for index build. It seems that \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e uses a lot of heap there? I created the documents one at a time just before adding them to the index, so the memory usage is for the writers and a quick profile told me that it was mainly used for int-arrays. Does that sound right?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13056517_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056517_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 13:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T13:54:47+0000\'\u003e28\\/Jun\\/11 13:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Toke Eskildsen - 28\\/Jun\\/11 15:17\\\"\u003eedited\u003c\\/span\u003e                   Some preliminary performance testing: I hacked together a test where 1M documents were created with an average of 3.5 paths, down to a depth of 4 (resulting in 1.4M unique paths). A search that hit every other document was issued and the top 5 facets\\/tags was requested. Hopefully this is somewhat similar to your test. \\n\\n \\n  \\n \\n &nbsp; \\n    LUCENE-3079    \\n   LUCENE-2369   \\n \\n \\n  Index build time  \\n   52 s  \\n   23 s  \\n \\n \\n  Memory required for indexing  \\n  192 MB  \\n  48 MB  \\n \\n \\n  First facet request  \\n  432 ms  \\n  12,000 ms  \\n \\n \\n  Best of 5 requests  \\n  228 ms  \\n  159 ms  \\n \\n \\n  Memory usage after faceting (after gc())  \\n  21 MB  \\n  22 MB  \\n \\n  \\n \\n\\n\\n Upping the ante to 5M documents, 6.8 paths\\/docs, max depth 6 (22M unique paths) resulted in \\n\\n \\n  \\n \\n &nbsp; \\n    LUCENE-3079    \\n   LUCENE-2369   \\n \\n \\n  Index build time  \\n   752 s  \\n   238 s  \\n \\n \\n  Memory required for indexing  \\n  2500 MB  \\n  128 MB  \\n \\n \\n  First facet request  \\n  3370 ms  \\n  147,000 ms  \\n \\n \\n  Best of 5 requests  \\n  2400 ms  \\n  2673 ms  \\n \\n \\n  Memory usage after faceting  \\n  435 MB  \\n  294 MB  \\n \\n  \\n \\n\\n\\n Scaling down to 100K documents, 1.6 paths\\/doc, max depth 4 (63K unique paths) resulted in \\n \\n  \\n \\n &nbsp; \\n    LUCENE-3079    \\n   LUCENE-2369   \\n \\n \\n  Index build time  \\n   5317 ms  \\n   2563 ms  \\n \\n \\n  Memory required for indexing  \\n  48 MB  \\n  32 MB  \\n \\n \\n  First facet request  \\n  245 ms  \\n  1425 ms  \\n \\n \\n  Best of 5 requests  \\n  15 ms  \\n  8 ms  \\n \\n \\n  Memory usage after faceting  \\n  1 MB  \\n  2 MB  \\n \\n  \\n \\n\\n\\n Some observations: It seems clear that some trade-offs are very different for the two solutions.   LUCENE-3079   has brilliant startup time and slows analyzing time a bit through the whole indexing process.  LUCENE-2369  is dog slow at startup but does not impact indexing. They seem similar with regards to search-time speed and memory usage. \\n\\n Now,  LUCENE-2369  patches some semi-random Lucene-4, so this is not a fair test. Likewise, the tests were just quick hacks; the disk cache was not flushed, the laptop was used for browsing etc. When   LUCENE-3079   patches trunk, a proper comparison can be made. \\n\\n I am a bit worried about the observed memory usage for index build. It seems that   LUCENE-3079   uses a lot of heap there? I created the documents one at a time just before adding them to the index, so the memory usage is for the writers and a quick profile told me that it was mainly used for int-arrays. Does that sound right?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056553\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056553&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056553\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056553_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056553_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 14:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T14:58:17+0000\'\u003e28\\/Jun\\/11 14:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eYou write \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3097\\\" title=\\\"Post grouping faceting\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3097\\\"\u003e\u003cdel\u003eLUCENE-3097\u003c\\/del\u003e\u003c\\/a\u003e which is about \\\"post group faceting\\\", while this issue is \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e. I assume you meant the latter, but want to confirm \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e. You also write \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2309\\\" title=\\\"Fully decouple IndexWriter from analyzers\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2309\\\"\u003e\u003cdel\u003eLUCENE-2309\u003c\\/del\u003e\u003c\\/a\u003e which is about decoupling IW from Analyzers. Are you perhaps referring to a Solr issue, or a different Lucene issue? If so can you please let me know which one?\u003c\\/p\u003e\\n\\n\u003cp\u003eThis is a great test, and it matches more or less the test we\'ve been running. Is it in \'benchmark\' form? Can you post it on this issue so I can try the same?\u003c\\/p\u003e\\n\\n\u003cp\u003eWhat do you mean by \\\"top 5 facets\\/tags\\\"? If I were to speak of dimensions, where a dimensions is like \\\"tags\\\", \\\"authors\\\", \\\"date\\\", then do you mean you\'ve requested to count 5 dimensions, or you indexed just one dimension (i.e. one \\\"root\\\") and requested to fetch the top-5 results for it? I assume it\'s the latter, but again, confirming my understanding.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo assuming I understood correctly the terminology and test setup, you execute one query which matches 50% of the documents and ask to count the top-5 facets under a single \\\"root\\\"\\/\\\"dimension\\\", and record the time as \'first facet request\'. And then you execute it 4-5 additional times, and record \'best of 5 requests\'. Do I understand it correctly?\u003c\\/p\u003e\\n\\n\u003cp\u003eOne difference between the two approaches, assuming you\'re referring to a faceting approach that uses the FieldCache is that by default, the faceting approach here reads everything from disk. So it would be interesting to run w\\/ the facets-in-memory feature.\u003c\\/p\u003e\\n\\n\u003cp\u003eI don\'t know how to relate to the memory usage &#8211; on the last test it consumed 50% less than the other approach, on the first it consumed nearly the same and on the second test it consumed 150% more. This is odd. Do you trust this measurement?\u003c\\/p\u003e\\n\\n\u003cp\u003eThe \'first facet request\' result is not surprising, because it takes time to warm up the FieldCache (assuming that\'s what you use).\u003c\\/p\u003e\\n\\n\u003cp\u003eI am interested in the memory observed for indexing because that too seems fluctuating? I.e., in the second test the difference is nearly x20 more, which is weird.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso, the difference in indexing time is interesting too, as it too is not very consistent. And I find the x2 factor suspicious - would like to understand it better. Since trunk reports to improve indexing speed by a large factor (nearly 200%), I think it will be wise if we wait with this comparison until I bring the patch up w\\/ trunk.\u003c\\/p\u003e\\n\\n\u003cp\u003eI like it that you test the default behavior. I think it\'s very important that we have the greatest out-of-the-box experience. Since the two approaches read from disk\\/memory, I first would like to test the in-memory facets using this approach, so we can at least compare the same thing. I know that trunk plays some role here (definitely at indexing time), so we can focus on search time for now.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis is great stuff Toke !\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056553_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056553_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 14:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T14:58:17+0000\'\u003e28\\/Jun\\/11 14:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    You write   LUCENE-3097   which is about \\\"post group faceting\\\", while this issue is   LUCENE-3079  . I assume you meant the latter, but want to confirm  . You also write   LUCENE-2309   which is about decoupling IW from Analyzers. Are you perhaps referring to a Solr issue, or a different Lucene issue? If so can you please let me know which one? \\n\\n This is a great test, and it matches more or less the test we\'ve been running. Is it in \'benchmark\' form? Can you post it on this issue so I can try the same? \\n\\n What do you mean by \\\"top 5 facets\\/tags\\\"? If I were to speak of dimensions, where a dimensions is like \\\"tags\\\", \\\"authors\\\", \\\"date\\\", then do you mean you\'ve requested to count 5 dimensions, or you indexed just one dimension (i.e. one \\\"root\\\") and requested to fetch the top-5 results for it? I assume it\'s the latter, but again, confirming my understanding. \\n\\n So assuming I understood correctly the terminology and test setup, you execute one query which matches 50% of the documents and ask to count the top-5 facets under a single \\\"root\\\"\\/\\\"dimension\\\", and record the time as \'first facet request\'. And then you execute it 4-5 additional times, and record \'best of 5 requests\'. Do I understand it correctly? \\n\\n One difference between the two approaches, assuming you\'re referring to a faceting approach that uses the FieldCache is that by default, the faceting approach here reads everything from disk. So it would be interesting to run w\\/ the facets-in-memory feature. \\n\\n I don\'t know how to relate to the memory usage &#8211; on the last test it consumed 50% less than the other approach, on the first it consumed nearly the same and on the second test it consumed 150% more. This is odd. Do you trust this measurement? \\n\\n The \'first facet request\' result is not surprising, because it takes time to warm up the FieldCache (assuming that\'s what you use). \\n\\n I am interested in the memory observed for indexing because that too seems fluctuating? I.e., in the second test the difference is nearly x20 more, which is weird. \\n\\n Also, the difference in indexing time is interesting too, as it too is not very consistent. And I find the x2 factor suspicious - would like to understand it better. Since trunk reports to improve indexing speed by a large factor (nearly 200%), I think it will be wise if we wait with this comparison until I bring the patch up w\\/ trunk. \\n\\n I like it that you test the default behavior. I think it\'s very important that we have the greatest out-of-the-box experience. Since the two approaches read from disk\\/memory, I first would like to test the in-memory facets using this approach, so we can at least compare the same thing. I know that trunk plays some role here (definitely at indexing time), so we can focus on search time for now. \\n\\n This is great stuff Toke !              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056560\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056560&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056560\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056560_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056560_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 15:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T15:06:15+0000\'\u003e28\\/Jun\\/11 15:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eEdited the issue title (it had an extra \'i\' in \'faceting\'), as well as added fix versions etc. I intend to commit the patch to the 3x branch either later today or tomorrow.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056560_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056560_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 15:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T15:06:15+0000\'\u003e28\\/Jun\\/11 15:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Edited the issue title (it had an extra \'i\' in \'faceting\'), as well as added fix versions etc. I intend to commit the patch to the 3x branch either later today or tomorrow.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056561\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056561&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056561\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056561_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056561_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 15:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T15:07:57+0000\'\u003e28\\/Jun\\/11 15:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCreated component modules\\/facet\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056561_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056561_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 15:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T15:07:57+0000\'\u003e28\\/Jun\\/11 15:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Created component modules\\/facet              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056585\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056585&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056585\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13056585_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056585_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 15:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T15:36:54+0000\'\u003e28\\/Jun\\/11 15:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eShai: I completely messed up the JIRA-numbers, clearly I need to go home and cool my brain. It is fixed now. Sorry for the inconvenience.\u003c\\/p\u003e\\n\\n\u003cp\u003eYes, I only created a single root (one dimension) and requested the top-5 facets. You understood the timing measurements correctly. I am sorry that my table was confusing with regards to memory. The first numbers was the Xmx required for index build (binary search until I got bored), while the second if what the JVM reported after the faceting calls were finished. For \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e in the middle test, the faceted search required more memory (aka higher Xmx) than index build (which could probably have gotten by with even less).\u003c\\/p\u003e\\n\\n\u003cp\u003eI do not use field cance for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e. It holds a compressed list of ordinals for tags for the documents in memory, with a few levels of indirections to handle doublettes. The startup time is basically due to doublette elimination.\u003c\\/p\u003e\\n\\n\u003cp\u003eRegarding the memory difference, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e does not operate at index-time. This means that is it plain Lucene indexing of terms like hierarchy:a\\/b\\/c\\/d. Actually I am surprised that it took 128MB for the larger test and I should probably re-run that with a lower allocation.\u003c\\/p\u003e\\n\\n\u003cp\u003eMy guesstimage, based purely on observation, is that \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e requires heap relative to the taxonomy size at indexing time. At least with the (assumedly default) settings I used. Thus the 22M unique values in test #2 is the cause for the large memory requirement. Looking at the number of unique tags vs. index memory requirements for case #1 and #2, the factor seems nearly linear. It seems to fit your recommendation of splitting on large taxonomies?\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll upload my test class for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e now. I apologize for its hackish nature - this was just meant as explorative work.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13056585_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056585_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 15:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T15:36:54+0000\'\u003e28\\/Jun\\/11 15:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Shai: I completely messed up the JIRA-numbers, clearly I need to go home and cool my brain. It is fixed now. Sorry for the inconvenience. \\n\\n Yes, I only created a single root (one dimension) and requested the top-5 facets. You understood the timing measurements correctly. I am sorry that my table was confusing with regards to memory. The first numbers was the Xmx required for index build (binary search until I got bored), while the second if what the JVM reported after the faceting calls were finished. For  LUCENE-2369  in the middle test, the faceted search required more memory (aka higher Xmx) than index build (which could probably have gotten by with even less). \\n\\n I do not use field cance for  LUCENE-2369 . It holds a compressed list of ordinals for tags for the documents in memory, with a few levels of indirections to handle doublettes. The startup time is basically due to doublette elimination. \\n\\n Regarding the memory difference,  LUCENE-2369  does not operate at index-time. This means that is it plain Lucene indexing of terms like hierarchy:a\\/b\\/c\\/d. Actually I am surprised that it took 128MB for the larger test and I should probably re-run that with a lower allocation. \\n\\n My guesstimage, based purely on observation, is that   LUCENE-3079   requires heap relative to the taxonomy size at indexing time. At least with the (assumedly default) settings I used. Thus the 22M unique values in test #2 is the cause for the large memory requirement. Looking at the number of unique tags vs. index memory requirements for case #1 and #2, the factor seems nearly linear. It seems to fit your recommendation of splitting on large taxonomies? \\n\\n I\'ll upload my test class for   LUCENE-3079   now. I apologize for its hackish nature - this was just meant as explorative work.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056586\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056586&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056586\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13056586_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056586_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 15:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T15:38:23+0000\'\u003e28\\/Jun\\/11 15:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eA quick hack to get an idea of performance characteristics for hierarchical faceting.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13056586_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056586_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 15:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T15:38:23+0000\'\u003e28\\/Jun\\/11 15:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    A quick hack to get an idea of performance characteristics for hierarchical faceting.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056673\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056673&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056673\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056673_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056673_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 17:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T17:50:01+0000\'\u003e28\\/Jun\\/11 17:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eresulting in 1.4M unique paths\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eAND\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e requires heap relative to the taxonomy size at indexing time\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eOk now I see what\'s happening. The taxonomy index maintains a category cache, which maps a category to its ordinal. It\'s maintained at both indexing and search time. At indexing time, it\'s used to quickly determine if an incoming category already exists, and if so returns its ordinal. At search time its used to quickly label ordinals, as well as determining hierarchy information.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe default settings of LuceneTaxonomyWriter uses Cl2oTaxonomyWriterCache, which maintains a mapping of \u003cb\u003eall\u003c\\/b\u003e categories to their ordinal, although the mapping is maintained compact. There is another cache LruTaxonomyWriterCache which as its javadocs states \\\"good choice for huge taxonomies\\\".\u003c\\/p\u003e\\n\\n\u003cp\u003eThe taxonomy you create is HUGE by all standards (and I\'m not speaking on the 22M case \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e). The largest \'normal\' taxonomy we\'ve seen was in the order of few 100K nodes (when people names were maintained, and social tags), while the largest \'abnormal\' taxonomy we\'ve seen contained ~5M nodes, and that is considered a very extreme case for taxonomies.\u003c\\/p\u003e\\n\\n\u003cp\u003eJust to be clear, I\'m not trying to make excuses. Your perf test is still great in that it tests an extreme case. But I\'d expect an extreme case to require some mods to the defaults, and using LruTWC is one of them (w\\/ a cacheSize of let\'s say 100\\/200K). Another thing I\'ve mentioned this package can do is the partitions &#8211; because at runtime we allocate an array the size of the taxonomy, in your case (1.4M nodes), we\'ll create an array that is ~6MB size for every query. While if you use partitions, and partition the categories into 10\\/100K-categories buckets, you\'d allocate less RAM, but might incur some search performance overhead.\u003c\\/p\u003e\\n\\n\u003cp\u003eOut of curiosity, w\\/ 1.4M unique paths, and 1M docs, how many categories are assigned to each document and how many documents are associated w\\/ each category? When we ran our test, we used a Zipf distribution for categories. If in this test we end up associating only a couple of documents per category, then this is not a too realistic scenario. And while the package can handle it, by not using defaults, perhaps we should define a scenario that makes sense (a common one that is) and run with it?\u003c\\/p\u003e\\n\\n\u003cp\u003eI don\'t think there can be one \\\"right\\\" faceted search solution, but rather a collection of tools that can match different scenarios. And if it turns out that for one case one implementation is better than another, then our job will be to create a faceted search layer which allows the user to choose what\'s best for him, and leave the rest of his app code unmodified.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhat do you think? Perhaps we should open a separate issue, let\'s call it \\\"facet benchmarking\\\", where we define some scenarios, work on extending the benchmark package (we have done some preliminary work there) and then compare few approaches?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056673_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056673_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 17:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T17:50:01+0000\'\u003e28\\/Jun\\/11 17:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     resulting in 1.4M unique paths  \\n\\n AND \\n\\n    LUCENE-3079   requires heap relative to the taxonomy size at indexing time  \\n\\n Ok now I see what\'s happening. The taxonomy index maintains a category cache, which maps a category to its ordinal. It\'s maintained at both indexing and search time. At indexing time, it\'s used to quickly determine if an incoming category already exists, and if so returns its ordinal. At search time its used to quickly label ordinals, as well as determining hierarchy information. \\n\\n The default settings of LuceneTaxonomyWriter uses Cl2oTaxonomyWriterCache, which maintains a mapping of  all  categories to their ordinal, although the mapping is maintained compact. There is another cache LruTaxonomyWriterCache which as its javadocs states \\\"good choice for huge taxonomies\\\". \\n\\n The taxonomy you create is HUGE by all standards (and I\'m not speaking on the 22M case  ). The largest \'normal\' taxonomy we\'ve seen was in the order of few 100K nodes (when people names were maintained, and social tags), while the largest \'abnormal\' taxonomy we\'ve seen contained ~5M nodes, and that is considered a very extreme case for taxonomies. \\n\\n Just to be clear, I\'m not trying to make excuses. Your perf test is still great in that it tests an extreme case. But I\'d expect an extreme case to require some mods to the defaults, and using LruTWC is one of them (w\\/ a cacheSize of let\'s say 100\\/200K). Another thing I\'ve mentioned this package can do is the partitions &#8211; because at runtime we allocate an array the size of the taxonomy, in your case (1.4M nodes), we\'ll create an array that is ~6MB size for every query. While if you use partitions, and partition the categories into 10\\/100K-categories buckets, you\'d allocate less RAM, but might incur some search performance overhead. \\n\\n Out of curiosity, w\\/ 1.4M unique paths, and 1M docs, how many categories are assigned to each document and how many documents are associated w\\/ each category? When we ran our test, we used a Zipf distribution for categories. If in this test we end up associating only a couple of documents per category, then this is not a too realistic scenario. And while the package can handle it, by not using defaults, perhaps we should define a scenario that makes sense (a common one that is) and run with it? \\n\\n I don\'t think there can be one \\\"right\\\" faceted search solution, but rather a collection of tools that can match different scenarios. And if it turns out that for one case one implementation is better than another, then our job will be to create a faceted search layer which allows the user to choose what\'s best for him, and leave the rest of his app code unmodified. \\n\\n What do you think? Perhaps we should open a separate issue, let\'s call it \\\"facet benchmarking\\\", where we define some scenarios, work on extending the benchmark package (we have done some preliminary work there) and then compare few approaches?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056687\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056687&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056687\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056687_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056687_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 18:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T18:11:46+0000\'\u003e28\\/Jun\\/11 18:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAbout the TaxonomyWriterCache, looking at its API now, I think that an FST-based TWC might be a good fit here? FST is known for its performance and low RAM consumption, and TWC maps from a CategoryPath (or String) to an integer, which sounds like a typical usage for FST. So we can have both the keep-all-in-RAM-TWC and LRU use FST and consume less memory.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll open an issue for that.\u003c\\/p\u003e\\n\\n\u003cp\u003eOne small correction - TWC is used only at indexing time, mapping from category-&gt;ordinal. For labeling ordinals you use TaxonomyReader which maintains its own int-&gt;String cache (LRU). Can FST aid in that case as well? I assume it will consume less space than an Integer-&gt;String hash map.\u003c\\/p\u003e\\n\\n\u003cp\u003e-------------\u003c\\/p\u003e\\n\\n\u003cp\u003eBack to performance &#8211; Toke, did you verify that you get the same top-5 categories from both implementations? Also, can you try running the test asking for top-5 categories of a node below the root? I.e., if the paths are in the form \\/a\\/b\\/c\\/d and you request to count \\\"\\/a\\\", then I\'m interested in how this performs if you ask to count \\\"\\/a\\/b\\\".\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056687_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056687_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 18:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T18:11:46+0000\'\u003e28\\/Jun\\/11 18:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    About the TaxonomyWriterCache, looking at its API now, I think that an FST-based TWC might be a good fit here? FST is known for its performance and low RAM consumption, and TWC maps from a CategoryPath (or String) to an integer, which sounds like a typical usage for FST. So we can have both the keep-all-in-RAM-TWC and LRU use FST and consume less memory. \\n\\n I\'ll open an issue for that. \\n\\n One small correction - TWC is used only at indexing time, mapping from category-&gt;ordinal. For labeling ordinals you use TaxonomyReader which maintains its own int-&gt;String cache (LRU). Can FST aid in that case as well? I assume it will consume less space than an Integer-&gt;String hash map. \\n\\n ------------- \\n\\n Back to performance &#8211; Toke, did you verify that you get the same top-5 categories from both implementations? Also, can you try running the test asking for top-5 categories of a node below the root? I.e., if the paths are in the form \\/a\\/b\\/c\\/d and you request to count \\\"\\/a\\\", then I\'m interested in how this performs if you ask to count \\\"\\/a\\/b\\\".              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056696\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056696&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056696\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056696_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056696_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 18:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T18:26:13+0000\'\u003e28\\/Jun\\/11 18:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOh Toke ... I just reviewed your test and there is a problem in it:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e    CountFacetRequest facetRequest = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e CountFacetRequest(\\n        \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e CategoryPath(HIERARCHICAL), num);\\n    facetRequest.setDepth(5);\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eYou create a CountFacetRequest, requesting to count HIERARCHICAL (which is the root), and fetch the top &lt;num&gt;, which is 5. BUT, you set the depth of the request to 5, which means it will compute the top-5 categories at each level !\u003c\\/p\u003e\\n\\n\u003cp\u003eThis is a nice feature of the package, which lets you get not only the top-N child nodes of the immediate \\\"root\\\", but also the top-N of their child nodes and it\'s applied recursively until \'depth\'. This is a nice feature, but not very performance friendly \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e.\u003c\\/p\u003e\\n\\n\u003cp\u003eCan you please rerun the test then, commenting out that line? I can run it on my laptop, but I don\'t have the env. setup w\\/ the patch from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e, so I cannot compare.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn general, this looks like a very useful test. I think we can commit it too, but rename it so that it doesn\'t run regularly w\\/ our tests, but rather selectively.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056696_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056696_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 18:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T18:26:13+0000\'\u003e28\\/Jun\\/11 18:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Oh Toke ... I just reviewed your test and there is a problem in it: \\n\\n  \\n     CountFacetRequest facetRequest =  new  CountFacetRequest(\\n         new  CategoryPath(HIERARCHICAL), num);\\n    facetRequest.setDepth(5);\\n \\n  \\n\\n You create a CountFacetRequest, requesting to count HIERARCHICAL (which is the root), and fetch the top &lt;num&gt;, which is 5. BUT, you set the depth of the request to 5, which means it will compute the top-5 categories at each level ! \\n\\n This is a nice feature of the package, which lets you get not only the top-N child nodes of the immediate \\\"root\\\", but also the top-N of their child nodes and it\'s applied recursively until \'depth\'. This is a nice feature, but not very performance friendly  . \\n\\n Can you please rerun the test then, commenting out that line? I can run it on my laptop, but I don\'t have the env. setup w\\/ the patch from  LUCENE-2369 , so I cannot compare. \\n\\n In general, this looks like a very useful test. I think we can commit it too, but rename it so that it doesn\'t run regularly w\\/ our tests, but rather selectively.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056785\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056785&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056785\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13056785_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056785_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 21:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T21:07:51+0000\'\u003e28\\/Jun\\/11 21:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI must admit that my choices of tests were more aimed at probing edge cases than simulating real taxonomies. Nevertheless, it is good to hear that \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e can be tweaked to handle it. I fully support the idea of a facet benchmarking issue -  perhaps with an associated wiki page?\u003c\\/p\u003e\\n\\n\u003cp\u003eAs for the 1M test case, the number of tags\\/documents were random with the average being the stated 3.5 tags\\/document. Seen from the other side, there were an average of 1M*3.5\\/1.4M ~= 2.5 documents\\/tag.\u003c\\/p\u003e\\n\\n\u003cp\u003eI did verify the facet-results and they did fit my expectations. I will try requesting from further down the tree later - hopefully tomorrow. I am a bit confused about your protest on depth=5, but I suspect that we have different ideas of what is relevant when issuing a hierarchical request. The API states that specifying a depth of 5 will count all sub-tags until depth 5. I used the number 5 to effectively count all the way to the bottom (whoops! It should be 6 for the second case. That might explain why \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e was faster than \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e in that one as \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e counted to the bottom). The reason for the complete counting was that I implicitly found this to be the \\\"correct\\\" behavior, internally visioning a taxonomy of species or something similar, with the wish to get the number of unique elements at the finest level.\u003c\\/p\u003e\\n\\n\u003cp\u003eThinking about this, I now have a better understanding of the duplication of data by indexing all levels of the paths. This speeds up shallow counting tremendously.\u003c\\/p\u003e\\n\\n\u003cp\u003eAll this confusion supports the need for at coordinated effort to get some test cases with clear goals and realistic data.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13056785_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056785_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/11 21:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-28T21:07:51+0000\'\u003e28\\/Jun\\/11 21:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I must admit that my choices of tests were more aimed at probing edge cases than simulating real taxonomies. Nevertheless, it is good to hear that   LUCENE-3079   can be tweaked to handle it. I fully support the idea of a facet benchmarking issue -  perhaps with an associated wiki page? \\n\\n As for the 1M test case, the number of tags\\/documents were random with the average being the stated 3.5 tags\\/document. Seen from the other side, there were an average of 1M*3.5\\/1.4M ~= 2.5 documents\\/tag. \\n\\n I did verify the facet-results and they did fit my expectations. I will try requesting from further down the tree later - hopefully tomorrow. I am a bit confused about your protest on depth=5, but I suspect that we have different ideas of what is relevant when issuing a hierarchical request. The API states that specifying a depth of 5 will count all sub-tags until depth 5. I used the number 5 to effectively count all the way to the bottom (whoops! It should be 6 for the second case. That might explain why   LUCENE-3079   was faster than  LUCENE-2369  in that one as  LUCENE-2369  counted to the bottom). The reason for the complete counting was that I implicitly found this to be the \\\"correct\\\" behavior, internally visioning a taxonomy of species or something similar, with the wish to get the number of unique elements at the finest level. \\n\\n Thinking about this, I now have a better understanding of the duplication of data by indexing all levels of the paths. This speeds up shallow counting tremendously. \\n\\n All this confusion supports the need for at coordinated effort to get some test cases with clear goals and realistic data.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13056972\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13056972&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13056972\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056972_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056972_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 03:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T03:22:52+0000\'\u003e29\\/Jun\\/11 03:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eI fully support the idea of a facet benchmarking issue - perhaps with an associated wiki page?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eYes. And on the Wiki page you should clearly describe the scenario that is tested, along with results for \'default config\' + \'optimized config\'. That way, a user coming to the page can pick the scenario that best matches his app and config the facets package (whatever we end up with) accordingly.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eSeen from the other side, there were an average of 1M*3.5\\/1.4M ~= 2.5 documents\\/tag\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThat\'s indeed an extreme case. We\'ve seen it when an analytics module extracted facets automatically from documents (such as places, people etc.), and in that case the taxonomy was very \'flat\' and wide.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI am a bit confused about your protest on depth=5\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI did not protest \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e. Actually, the common scenario is to count the immediate children and fetch the top-K. And I thought that that\'s what you do in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e. But counting all the way down is a valid scenario - and shows another reason why we should have a benchmark page with clear description.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eThinking about this, I now have a better understanding of the duplication of data by indexing all levels of the paths. This speeds up shallow counting tremendously.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIt actually speeds up counting overall. If you think about it, when we encounter category ordinals, we just increment the count by 1 in the respective location in the count array. No need to ask whether this is an ordinal the user asked to count at all. Later when we compute the top-K, we know more efficiently while root ordinal the user requested to count, and its children, so it\'s just a matter of putting everything into a heap and returning the top-K.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eAll this confusion supports the need for at coordinated effort to get some test cases with clear goals and realistic data.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIndeed. And we shouldn\'t pursue only \'realistic data\', but edge cases too. As long as everything is clearly documented, it should be easy to interpret results.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think that setting up facet benchmarking is more important than working on improving any implementation. Mostly because it will allow measuring the how much the improvements really improved. I\'ll open an issue for that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13056972_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13056972_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 03:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T03:22:52+0000\'\u003e29\\/Jun\\/11 03:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     I fully support the idea of a facet benchmarking issue - perhaps with an associated wiki page?  \\n\\n Yes. And on the Wiki page you should clearly describe the scenario that is tested, along with results for \'default config\' + \'optimized config\'. That way, a user coming to the page can pick the scenario that best matches his app and config the facets package (whatever we end up with) accordingly. \\n\\n  Seen from the other side, there were an average of 1M*3.5\\/1.4M ~= 2.5 documents\\/tag  \\n\\n That\'s indeed an extreme case. We\'ve seen it when an analytics module extracted facets automatically from documents (such as places, people etc.), and in that case the taxonomy was very \'flat\' and wide. \\n\\n  I am a bit confused about your protest on depth=5  \\n\\n I did not protest  . Actually, the common scenario is to count the immediate children and fetch the top-K. And I thought that that\'s what you do in  LUCENE-2369 . But counting all the way down is a valid scenario - and shows another reason why we should have a benchmark page with clear description. \\n\\n  Thinking about this, I now have a better understanding of the duplication of data by indexing all levels of the paths. This speeds up shallow counting tremendously.  \\n\\n It actually speeds up counting overall. If you think about it, when we encounter category ordinals, we just increment the count by 1 in the respective location in the count array. No need to ask whether this is an ordinal the user asked to count at all. Later when we compute the top-K, we know more efficiently while root ordinal the user requested to count, and its children, so it\'s just a matter of putting everything into a heap and returning the top-K. \\n\\n  All this confusion supports the need for at coordinated effort to get some test cases with clear goals and realistic data.  \\n\\n Indeed. And we shouldn\'t pursue only \'realistic data\', but edge cases too. As long as everything is clearly documented, it should be easy to interpret results. \\n\\n I think that setting up facet benchmarking is more important than working on improving any implementation. Mostly because it will allow measuring the how much the improvements really improved. I\'ll open an issue for that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13057148\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13057148&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13057148\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13057148_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057148_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 10:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T10:54:28+0000\'\u003e29\\/Jun\\/11 10:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Toke Eskildsen - 29\\/Jun\\/11 11:02\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI re-ran the edge case 5M documents, 6.8 paths\\/docs, max depth 6 (22M unique paths) to drill down to level 6 (d6) and to level 1 (d1). A test for the path \'root\\/a\\/b\' as starting point for the facet request was added. I also checked that indexing does indeed run with 48MB for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e, but again this is just plain Lucene indexing.\u003c\\/p\u003e\\n\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003cth class=\'confluenceTh\'\u003e&nbsp;\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e (d6) \u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e (d1) \u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e (d1+\'deep\\/a\\/b\') \u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e (d6) \u003c\\/th\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Index build time             \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e  752 s            \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e   771 s           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003e\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e     347 s         \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Memory required for indexing \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 2500 MB           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 2500 MB           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e   2500 MB           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e      48 MB        \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e First facet request          \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 3840 ms           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 1929 ms           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e   1963 ms           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 147,000 ms        \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Best of 5 requests           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 2688 ms           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 1172 ms           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e   1246 ms           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e    2673 ms        \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Memory usage after faceting  \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e  435 MB           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e  435 MB           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e   435 MB           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e     294 MB        \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\\n\u003cp\u003eGoing to depth 1 helped a lot. I would have expected that requesting from \'deep\\/a\\/b\' was even faster, but I guess I\'ll have to dig into the code to understand why it was not.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eIt actually speeds up counting overall. If you think about it, when we encounter category ordinals, we just increment the count by 1 in the respective location in the count array. No need to ask whether this is an ordinal the user asked to count at all. Later when we compute the top-K, we know more efficiently while root ordinal the user requested to count, and its children, so it\'s just a matter of putting everything into a heap and returning the top-K.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e uses exactly the same counting strategy (brute counting of everything). Not having explicit duplicates speeds this phase up and saves memory, but the numbers for d6 and d1 very clearly shows that it is faster overall to skip the drill-down in the extraction phase. At least for this test (and then we\'re back to creating a proper test suite).\u003c\\/p\u003e\\n\\n\u003cp\u003eJust for kicks, I tried guesstimating the layout of a corpus with addresses by upping the docs and lowering the paths: 100M documents, 0.84 paths\\/doc, max depth 4 (2.5M unique paths)\u003c\\/p\u003e\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003cth class=\'confluenceTh\'\u003e&nbsp;\u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e (d4) \u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3079\\\" title=\\\"Faceting module\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3079\\\"\u003e\u003cdel\u003eLUCENE-3079\u003c\\/del\u003e\u003c\\/a\u003e (d1) \u003c\\/th\u003e\\n\u003cth class=\'confluenceTh\'\u003e \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-2369\\\" title=\\\"Locale-based sort by field with low memory overhead\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-2369\\\"\u003eLUCENE-2369\u003c\\/a\u003e (d6) \u003c\\/th\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Index build time             \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e   28 min          \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003e\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e     17 min        \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Memory required for indexing \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e    ? MB           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e    ? MB           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e      ? MB         \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e First facet request          \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e13933 ms           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e13367 ms           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e 46,000 ms         \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Best of 5 requests           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e11718 ms           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e11036 ms           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e   2989 ms         \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e Memory usage after faceting  \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e  240 MB           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e  240 MB           \u003c\\/td\u003e\\n\u003ctd class=\'confluenceTd\'\u003e    475 MB         \u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"toke\\\" id=\\\"commentauthor_13057148_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=toke\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"toke\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Toke Eskildsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057148_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 10:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T10:54:28+0000\'\u003e29\\/Jun\\/11 10:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Toke Eskildsen - 29\\/Jun\\/11 11:02\\\"\u003eedited\u003c\\/span\u003e                   I re-ran the edge case 5M documents, 6.8 paths\\/docs, max depth 6 (22M unique paths) to drill down to level 6 (d6) and to level 1 (d1). A test for the path \'root\\/a\\/b\' as starting point for the facet request was added. I also checked that indexing does indeed run with 48MB for  LUCENE-2369 , but again this is just plain Lucene indexing. \\n\\n \\n  \\n \\n &nbsp; \\n    LUCENE-3079   (d6)  \\n    LUCENE-3079   (d1)  \\n    LUCENE-3079   (d1+\'deep\\/a\\/b\')  \\n   LUCENE-2369  (d6)  \\n \\n \\n  Index build time              \\n   752 s             \\n    771 s            \\n  \\n\\t  \\n \\n \\n      347 s          \\n \\n \\n  Memory required for indexing  \\n  2500 MB            \\n  2500 MB            \\n    2500 MB            \\n       48 MB         \\n \\n \\n  First facet request           \\n  3840 ms            \\n  1929 ms            \\n    1963 ms            \\n  147,000 ms         \\n \\n \\n  Best of 5 requests            \\n  2688 ms            \\n  1172 ms            \\n    1246 ms            \\n     2673 ms         \\n \\n \\n  Memory usage after faceting   \\n   435 MB            \\n   435 MB            \\n    435 MB            \\n      294 MB         \\n \\n  \\n \\n\\n\\n Going to depth 1 helped a lot. I would have expected that requesting from \'deep\\/a\\/b\' was even faster, but I guess I\'ll have to dig into the code to understand why it was not. \\n\\n  It actually speeds up counting overall. If you think about it, when we encounter category ordinals, we just increment the count by 1 in the respective location in the count array. No need to ask whether this is an ordinal the user asked to count at all. Later when we compute the top-K, we know more efficiently while root ordinal the user requested to count, and its children, so it\'s just a matter of putting everything into a heap and returning the top-K.  \\n\\n  LUCENE-2369  uses exactly the same counting strategy (brute counting of everything). Not having explicit duplicates speeds this phase up and saves memory, but the numbers for d6 and d1 very clearly shows that it is faster overall to skip the drill-down in the extraction phase. At least for this test (and then we\'re back to creating a proper test suite). \\n\\n Just for kicks, I tried guesstimating the layout of a corpus with addresses by upping the docs and lowering the paths: 100M documents, 0.84 paths\\/doc, max depth 4 (2.5M unique paths) \\n \\n  \\n \\n &nbsp; \\n    LUCENE-3079   (d4)  \\n    LUCENE-3079   (d1)  \\n   LUCENE-2369  (d6)  \\n \\n \\n  Index build time              \\n    28 min           \\n  \\n\\t  \\n \\n \\n      17 min         \\n \\n \\n  Memory required for indexing  \\n     ? MB            \\n     ? MB            \\n       ? MB          \\n \\n \\n  First facet request           \\n 13933 ms            \\n 13367 ms            \\n  46,000 ms          \\n \\n \\n  Best of 5 requests            \\n 11718 ms            \\n 11036 ms            \\n    2989 ms          \\n \\n \\n  Memory usage after faceting   \\n   240 MB            \\n   240 MB            \\n     475 MB          \\n \\n  \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13057190\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13057190&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13057190\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13057190_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057190_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 12:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T12:13:52+0000\'\u003e29\\/Jun\\/11 12:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommitted revision 1141060 (3x). Will start the port to trunk.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m also attaching a userguide we wrote which should help newcomers get up to speed w\\/ the package. It is not meant to be an end-to-end cover of all the functionality and API, but rather as a complementary asset to the Javadocs, example code and source code itself.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think it will be good if we check it in with the source, e.g. under contrib\\/facet\\/docs or something, in ODT (+PDF?) format, and that it will be included in the release binaries (i.e. along with the .jar).\u003c\\/p\u003e\\n\\n\u003cp\u003eWhat do you think?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13057190_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057190_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 12:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T12:13:52+0000\'\u003e29\\/Jun\\/11 12:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Committed revision 1141060 (3x). Will start the port to trunk. \\n\\n I\'m also attaching a userguide we wrote which should help newcomers get up to speed w\\/ the package. It is not meant to be an end-to-end cover of all the functionality and API, but rather as a complementary asset to the Javadocs, example code and source code itself. \\n\\n I think it will be good if we check it in with the source, e.g. under contrib\\/facet\\/docs or something, in ODT (+PDF?) format, and that it will be included in the release binaries (i.e. along with the .jar). \\n\\n What do you think?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13057338\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13057338&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13057338\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13057338_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057338_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 16:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T16:41:06+0000\'\u003e29\\/Jun\\/11 16:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ehere\'s a hack patch, tried to quickly move this thing to trunk apis... 3 out of the 250 tests fail though, I\'m 99% positive i jacked something up in the taxonomywriter (this is the most complicated one to convert), so maybe that one should just be started over.\u003c\\/p\u003e\\n\\n\u003cp\u003ebut maybe some of the patch (except taxonomywriter, again i think its broken) would be useful in getting it ported to 4.x\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13057338_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057338_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 16:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T16:41:06+0000\'\u003e29\\/Jun\\/11 16:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    here\'s a hack patch, tried to quickly move this thing to trunk apis... 3 out of the 250 tests fail though, I\'m 99% positive i jacked something up in the taxonomywriter (this is the most complicated one to convert), so maybe that one should just be started over. \\n\\n but maybe some of the patch (except taxonomywriter, again i think its broken) would be useful in getting it ported to 4.x              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13057386\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13057386&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13057386\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13057386_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057386_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 18:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T18:34:28+0000\'\u003e29\\/Jun\\/11 18:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eupdated patch, one of the fails was caused by my use of seekExact, i think at least for MultiTermsEnum, if you seekExact, and even if it finds your term, its not positioned correctly, so if you then call next() its unsafe.\u003c\\/p\u003e\\n\\n\u003cp\u003eanother one of the fails, is calling getPayload() before hasPayload() will not work with SepCodec.\u003c\\/p\u003e\\n\\n\u003cp\u003ethanks to mike for helping track some of these down. \u003c\\/p\u003e\\n\\n\u003cp\u003ei also added to build.xml the logic to depend on the analyzers module, now all tests pass (some of the time).\u003c\\/p\u003e\\n\\n\u003cp\u003ebut i have at least one random fail:NOTE: reproduce with: ant test -Dtestcase=FacetsPayloadProcessorProviderTest -Dtestmethod=testTaxonomyMergeUtils -Dtests.seed=3732021887561370529:1102439953879128238\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13057386_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057386_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 18:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T18:34:28+0000\'\u003e29\\/Jun\\/11 18:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    updated patch, one of the fails was caused by my use of seekExact, i think at least for MultiTermsEnum, if you seekExact, and even if it finds your term, its not positioned correctly, so if you then call next() its unsafe. \\n\\n another one of the fails, is calling getPayload() before hasPayload() will not work with SepCodec. \\n\\n thanks to mike for helping track some of these down.  \\n\\n i also added to build.xml the logic to depend on the analyzers module, now all tests pass (some of the time). \\n\\n but i have at least one random fail:NOTE: reproduce with: ant test -Dtestcase=FacetsPayloadProcessorProviderTest -Dtestmethod=testTaxonomyMergeUtils -Dtests.seed=3732021887561370529:1102439953879128238              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13057399\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13057399&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13057399\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13057399_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057399_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 18:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T18:56:23+0000\'\u003e29\\/Jun\\/11 18:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ethe previous fail is somehow a bug in memorycodec (the seed randomly selected it):\u003cbr\\/\u003e\\nant test -Dtestcase=FacetsPayloadProcessorProviderTest -Dtests.codec=Memory\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13057399_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057399_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 18:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T18:56:23+0000\'\u003e29\\/Jun\\/11 18:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    the previous fail is somehow a bug in memorycodec (the seed randomly selected it): \\nant test -Dtestcase=FacetsPayloadProcessorProviderTest -Dtests.codec=Memory              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13057428\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13057428&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13057428\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13057428_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057428_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 19:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T19:46:49+0000\'\u003e29\\/Jun\\/11 19:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003ethe previous fail is somehow a bug in memorycodec (the seed randomly selected it)\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI just committed a fix for this; it was because .getPayload() in MemoryCodec was (incorrectly) assuming caller did not change the .bytes of the returned BytesRef between calls.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13057428_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057428_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 19:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T19:46:49+0000\'\u003e29\\/Jun\\/11 19:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     the previous fail is somehow a bug in memorycodec (the seed randomly selected it)  \\n\\n I just committed a fix for this; it was because .getPayload() in MemoryCodec was (incorrectly) assuming caller did not change the .bytes of the returned BytesRef between calls.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13057445\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13057445&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13057445\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13057445_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057445_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 20:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T20:08:02+0000\'\u003e29\\/Jun\\/11 20:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks guys for doing this port so quickly. The patch looks good. I suggest that we change the \'nocommit\' to TODO (Facet): and commit it (under modules\\/). Then we can iterate on the TODOs and resolve them one by one, in followup issues. Makes sense?\u003c\\/p\u003e\\n\\n\u003cp\u003eRobert, would you like to do the honors? \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13057445_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057445_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 20:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T20:08:02+0000\'\u003e29\\/Jun\\/11 20:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks guys for doing this port so quickly. The patch looks good. I suggest that we change the \'nocommit\' to TODO (Facet): and commit it (under modules\\/). Then we can iterate on the TODOs and resolve them one by one, in followup issues. Makes sense? \\n\\n Robert, would you like to do the honors?                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13057457\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13057457&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13057457\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13057457_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057457_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 20:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T20:37:02+0000\'\u003e29\\/Jun\\/11 20:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eupdated patch: all tests pass.\u003c\\/p\u003e\\n\\n\u003cp\u003eI changed the nocommits to TODO (Facet):\'s, and added verbage for the reason to each one.\u003c\\/p\u003e\\n\\n\u003cp\u003ewe also have two TODOs for two bugs (The MTE.seekExact and SepCodec hasPayload bug) that we should fix, but currently we have workarounds in place (when we fix these bugs we can then remove the workarounds).\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll svn move to modules, and doublecheck things like javadoc warnings, and commit later today.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13057457_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057457_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 20:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T20:37:02+0000\'\u003e29\\/Jun\\/11 20:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    updated patch: all tests pass. \\n\\n I changed the nocommits to TODO (Facet):\'s, and added verbage for the reason to each one. \\n\\n we also have two TODOs for two bugs (The MTE.seekExact and SepCodec hasPayload bug) that we should fix, but currently we have workarounds in place (when we fix these bugs we can then remove the workarounds). \\n\\n I\'ll svn move to modules, and doublecheck things like javadoc warnings, and commit later today.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13057468\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13057468&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13057468\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13057468_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057468_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 21:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T21:03:29+0000\'\u003e29\\/Jun\\/11 21:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommitted revision 1141246.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think we should close this issue soon, and open followup issues?\u003cbr\\/\u003e\\nMaybe just start with a separate issue for the documentation guide?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_13057468_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057468_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jun\\/11 21:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-29T21:03:29+0000\'\u003e29\\/Jun\\/11 21:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Committed revision 1141246. \\n\\n I think we should close this issue soon, and open followup issues? \\nMaybe just start with a separate issue for the documentation guide?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13057599\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13057599&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13057599\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13057599_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057599_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jun\\/11 03:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-30T03:25:49+0000\'\u003e30\\/Jun\\/11 03:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Shai Erera - 30\\/Jun\\/11 05:55\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI opened \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3261\\\" title=\\\"Faceting module userguide\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3261\\\"\u003e\u003cdel\u003eLUCENE-3261\u003c\\/del\u003e\u003c\\/a\u003e and \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-3262\\\" title=\\\"Facet benchmarking\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-3262\\\"\u003eLUCENE-3262\u003c\\/a\u003e to track userguide + benchmark issues. Will update more as we go along.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI think we should close this issue\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e+1.\u003c\\/p\u003e\\n\\n\u003cp\u003eWe can now say Lucene has a faceting module ! Perhaps we should advertise it on the user-list?\u003c\\/p\u003e\\n\\n\u003cp\u003eGreat job at porting to trunk Robert !\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13057599_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057599_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jun\\/11 03:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-30T03:25:49+0000\'\u003e30\\/Jun\\/11 03:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Shai Erera - 30\\/Jun\\/11 05:55\\\"\u003eedited\u003c\\/span\u003e                   I opened   LUCENE-3261   and  LUCENE-3262  to track userguide + benchmark issues. Will update more as we go along. \\n\\n  I think we should close this issue  \\n\\n +1. \\n\\n We can now say Lucene has a faceting module ! Perhaps we should advertise it on the user-list? \\n\\n Great job at porting to trunk Robert !              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13057703\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13057703&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13057703\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13057703_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057703_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jun\\/11 09:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-30T09:07:29+0000\'\u003e30\\/Jun\\/11 09:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFaceting module in 3.x and trunk, tests pass, opened follow up issues. I think we can close this.\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks for everyone for helping get this in so quickly !\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shaie\\\" id=\\\"commentauthor_13057703_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shaie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shaie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shai Erera\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13057703_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jun\\/11 09:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-06-30T09:07:29+0000\'\u003e30\\/Jun\\/11 09:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Faceting module in 3.x and trunk, tests pass, opened follow up issues. I think we can close this. \\n\\n Thanks for everyone for helping get this in so quickly !              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13597853\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13597853&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13597853\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"billnbell\\\" id=\\\"commentauthor_13597853_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=billnbell\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"billnbell\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bill Bell\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13597853_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Mar\\/13 05:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-09T05:53:02+0000\'\u003e09\\/Mar\\/13 05:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHas this been integrated into SOLR? Even if we just add it to SOLR as an option with hooks would be good. Or as an override in the lower levels?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"billnbell\\\" id=\\\"commentauthor_13597853_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=billnbell\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"billnbell\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bill Bell\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13597853_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Mar\\/13 05:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-09T05:53:02+0000\'\u003e09\\/Mar\\/13 05:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Has this been integrated into SOLR? Even if we just add it to SOLR as an option with hooks would be good. Or as an override in the lower levels?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13598066\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-3079?focusedCommentId=13598066&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13598066\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13598066_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13598066_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Mar\\/13 20:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-09T20:50:28+0000\'\u003e09\\/Mar\\/13 20:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eHas this been integrated into SOLR?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eHi Bill,\u003c\\/p\u003e\\n\\n\u003cp\u003eNo, not yet ... the separate taxonomy index makes it tricky.  Although, the new facet method based on SortedSetDocValues is being used in Solr and is a patch (\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-4795\\\" title=\\\"Add FacetsCollector based on SortedSetDocValues\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-4795\\\"\u003e\u003cdel\u003eLUCENE-4795\u003c\\/del\u003e\u003c\\/a\u003e) to add to the faceting module, so there\'s a small overlap there...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_13598066_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13598066_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Mar\\/13 20:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-03-09T20:50:28+0000\'\u003e09\\/Mar\\/13 20:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Has this been integrated into SOLR?  \\n\\n Hi Bill, \\n\\n No, not yet ... the separate taxonomy index makes it tricky.  Although, the new facet method based on SortedSetDocValues is being used in Solr and is a patch (  LUCENE-4795  ) to add to the faceting module, so there\'s a small overlap there...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310110";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310110&amp;avatarId=10061\\\" alt=\\\"Lucene - Core\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\"\u003eLucene - Core\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1516203419111"> 
    <input type="hidden" title="jira.request.server.time" value="575"> 
    <input type="hidden" title="jira.request.id" value="936x7715806x2"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="6"> 
    <input type="hidden" title="db.reads.time.in.ms" value="46"> 
    <input type="hidden" title="db.conns.time.in.ms" value="55"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 936x7715806x2
	          REQUEST TIMESTAMP : [17/Jan/2018:15:36:59 +0000]
	               REQUEST TIME : 0.5750
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 6

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=32, elapsedTotal=46731834, elapsedMin=599647, elapsedMax=12394114, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=36, elapsedTotal=55977666, elapsedMin=627130, elapsedMax=12481896, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|66b6570defa114c4423cd574f94081fc3a2edb4c|lout"> 
  <link rel="shortcut icon" href="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"jira.instrumentation.laas\":false,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"com.atlassian.jira.issuetable.draggable\":true,\"jira.create.linked.issue\":true,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"jira.jql.suggestrecentfields\":false,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"jira.jql.smartautoselectfirst\":false,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.priorities.per.project\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"jira.renderer.consider.variable.format\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/vnd.wap.wbmp,image/png,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"ce4fba8cb23ca9\"";
WRM._unparsedData["project-id"]="12310230";
WRM._unparsedData["project-key"]="\"SOLR\"";
WRM._unparsedData["project-name"]="\"Solr\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310230";
WRM._unparsedData["projectKey"]="\"SOLR\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/74ac580603ca910fff0cfdf319e54add-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/98ceb006e504d7924d5ffc411626c6bc-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/c1e4d26ea276469807c3dc0918df482c-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/6bf9253c8d533109c3b02e26794be24e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/ccd2e67b523185973473e8bd5735c8f9-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/33e5e0166867c8c9228d44506f60b2e8/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/6579b6b8ba67abaa496e39b9242a18a4-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="SOLR-9835"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[SOLR-9835] Create another replication mode for SolrCloud - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[SOLR-9835] Create another replication mode for SolrCloud - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/SOLR" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FSOLR-9835">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310230" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Solr'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310230&amp;avatarId=22151"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/SOLR">Solr</a></li>
                 <li><a class="issue-link" data-issue-key="SOLR-9835" href="/jira/browse/SOLR-9835" id="key-val" rel="13026378">SOLR-9835</a></li>
                </ol>
                <h1 id="summary-val">Create another replication mode for SolrCloud</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FSOLR-9835"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/SOLR-9835/SOLR-9835.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/SOLR-9835/SOLR-9835.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/SOLR-9835/SOLR-9835.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/SOLR-9835/SOLR-9835.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" title="Bug - A problem which impairs or prevents the functions of the product." width="16"> Bug </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Resolved</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.</span>">Resolved</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+SOLR+AND+fixVersion+%3D+7.0" title="7.0 First 7x release, major release after 6.6">7.0</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Security Level:</strong> 
                   <span id="security-val" class="value"> <span class="note">Public</span> (Default Security Level. Issues are Public) </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-13026378-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>The current replication mechanism of SolrCloud is called state machine, which replicas start in same initial state and for each input, the input is distributed across replicas so all replicas will end up with same next state. </p> 
                  <p>But this type of replication have some drawbacks</p> 
                  <ul class="alternate" type="square"> 
                   <li>The commit (which costly) have to run on all replicas</li> 
                   <li>Slow recovery, because if replica miss more than N updates on its down time, the replica have to download entire index from its leader.</li> 
                  </ul> 
                  <p>So we create create another replication mode for SolrCloud called state transfer, which acts like master/slave replication. In basically</p> 
                  <ul class="alternate" type="square"> 
                   <li>Leader distribute the update to other replicas, but the leader only apply the update to IW, other replicas just store the update to UpdateLog (act like replication).</li> 
                   <li>Replicas frequently polling the latest segments from leader.</li> 
                  </ul> 
                  <p>Pros:</p> 
                  <ul class="alternate" type="square"> 
                   <li>Lightweight for indexing, because only leader are running the commit, updates.</li> 
                   <li>Very fast recovery, replicas just have to download the missing segments.</li> 
                  </ul> 
                  <p>On CAP point of view, this ticket will trying to promise to end users a distributed systems :</p> 
                  <ul class="alternate" type="square"> 
                   <li>Partition tolerance</li> 
                   <li>Weak Consistency for normal query : clusters can serve stale data. This happen when leader finish a commit and slave is fetching for latest segment. This period can at most <tt>pollInterval + time to fetch latest segment</tt>.</li> 
                   <li>Consistency for RTG : if we <b>do not use DQBs</b>, replicas will consistence with master just like original SolrCloud mode</li> 
                   <li>Weak Availability : just like original SolrCloud mode. If a leader down, client must wait until new leader being elected.</li> 
                  </ul> 
                  <p>To use this new replication mode, a new collection must be created with an additional parameter <tt>liveReplicas=1</tt></p> 
                  <div class="code panel" style="border-width: 1px;">
                   <div class="codeContent panelContent"> 
                    <pre class="code-java">http:<span class="code-comment">//localhost:8983/solr/admin/collections?action=CREATE&amp;name=newCollection&amp;numShards=2&amp;replicationFactor=1&amp;realtimeReplicas=1</span>
</pre> 
                   </div>
                  </div> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/SOLR-9835?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/SOLR-9835?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/SOLR-9835?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/SOLR-9835?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12859409" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12859409/OnlyLeaderIndexesTest-fail-1.zip" draggable="true" data-downloadurl="application/zip:OnlyLeaderIndexesTest-fail-1.zip:https://issues.apache.org/jira/secure/attachment/12859409/OnlyLeaderIndexesTest-fail-1.zip"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-zip" title="Zip Archive"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12859409/OnlyLeaderIndexesTest-fail-1.zip" title="Latest  18/Mar/17 05:24 - Mark Miller" draggable="true" data-downloadurl="application/zip:OnlyLeaderIndexesTest-fail-1.zip:https://issues.apache.org/jira/secure/attachment/12859409/OnlyLeaderIndexesTest-fail-1.zip">OnlyLeaderIndexesTest-fail-1.zip</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-03-18T05:24:20.366Z">18/Mar/17 05:24</time>
                   </dd>
                   <dd class="attachment-size">
                    79 kB
                   </dd>
                   <dd class="attachment-author">
                    Mark Miller
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12858621" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12858621/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12858621/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12858621/SOLR-9835.patch" title="Latest  14/Mar/17 04:47 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12858621/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-03-14T04:47:46.708Z">14/Mar/17 04:47</time>
                   </dd>
                   <dd class="attachment-size">
                    96 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12855795" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12855795/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12855795/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12855795/SOLR-9835.patch" title=" 03/Mar/17 07:21 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12855795/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-03-03T07:21:37.425Z">03/Mar/17 07:21</time>
                   </dd>
                   <dd class="attachment-size">
                    93 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12855080" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12855080/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12855080/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12855080/SOLR-9835.patch" title=" 28/Feb/17 07:37 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12855080/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-02-28T07:37:36.395Z">28/Feb/17 07:37</time>
                   </dd>
                   <dd class="attachment-size">
                    91 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12854358" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12854358/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12854358/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12854358/SOLR-9835.patch" title=" 24/Feb/17 01:51 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12854358/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-02-24T01:51:19.413Z">24/Feb/17 01:51</time>
                   </dd>
                   <dd class="attachment-size">
                    91 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12852956" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12852956/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12852956/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12852956/SOLR-9835.patch" title=" 16/Feb/17 03:14 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12852956/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-02-16T03:14:36.871Z">16/Feb/17 03:14</time>
                   </dd>
                   <dd class="attachment-size">
                    88 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12852520" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12852520/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12852520/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12852520/SOLR-9835.patch" title=" 14/Feb/17 07:47 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12852520/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-02-14T07:47:14.581Z">14/Feb/17 07:47</time>
                   </dd>
                   <dd class="attachment-size">
                    88 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12850753" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12850753/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12850753/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12850753/SOLR-9835.patch" title=" 03/Feb/17 02:58 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12850753/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-02-03T02:58:01.377Z">03/Feb/17 02:58</time>
                   </dd>
                   <dd class="attachment-size">
                    77 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12847337" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12847337/SOLR-9835.patch" draggable="true" data-downloadurl="text/x-diff:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12847337/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12847337/SOLR-9835.patch" title=" 13/Jan/17 14:01 - Cao Manh Dat" draggable="true" data-downloadurl="text/x-diff:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12847337/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-01-13T14:01:54.558Z">13/Jan/17 14:01</time>
                   </dd>
                   <dd class="attachment-size">
                    77 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12847143" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12847143/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12847143/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12847143/SOLR-9835.patch" title=" 12/Jan/17 03:49 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12847143/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-01-12T03:49:34.684Z">12/Jan/17 03:49</time>
                   </dd>
                   <dd class="attachment-size">
                    80 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12845758" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12845758/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12845758/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12845758/SOLR-9835.patch" title=" 05/Jan/17 09:29 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12845758/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-01-05T09:29:10.360Z">05/Jan/17 09:29</time>
                   </dd>
                   <dd class="attachment-size">
                    84 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12845351" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12845351/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12845351/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12845351/SOLR-9835.patch" title=" 03/Jan/17 09:04 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12845351/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-01-03T09:04:55.757Z">03/Jan/17 09:04</time>
                   </dd>
                   <dd class="attachment-size">
                    86 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12845317" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12845317/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12845317/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12845317/SOLR-9835.patch" title=" 03/Jan/17 02:23 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12845317/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2017-01-03T02:23:41.498Z">03/Jan/17 02:23</time>
                   </dd>
                   <dd class="attachment-size">
                    78 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12844914" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12844914/SOLR-9835.patch" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12844914/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12844914/SOLR-9835.patch" title=" 28/Dec/16 10:47 - Cao Manh Dat" draggable="true" data-downloadurl="text/plain:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12844914/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2016-12-28T10:47:12.961Z">28/Dec/16 10:47</time>
                   </dd>
                   <dd class="attachment-size">
                    74 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12843416" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12843416/SOLR-9835.patch" draggable="true" data-downloadurl="text/x-patch:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12843416/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12843416/SOLR-9835.patch" title=" 15/Dec/16 13:37 - Cao Manh Dat" draggable="true" data-downloadurl="text/x-patch:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12843416/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2016-12-15T13:37:51.373Z">15/Dec/16 13:37</time>
                   </dd>
                   <dd class="attachment-size">
                    51 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12843366" data-issue-id="13026378" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12843366/SOLR-9835.patch" draggable="true" data-downloadurl="text/x-patch:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12843366/SOLR-9835.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12843366/SOLR-9835.patch" title=" 15/Dec/16 07:59 - Cao Manh Dat" draggable="true" data-downloadurl="text/x-patch:SOLR-9835.patch:https://issues.apache.org/jira/secure/attachment/12843366/SOLR-9835.patch">SOLR-9835.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2016-12-15T07:59:12.098Z">15/Dec/16 07:59</time>
                   </dd>
                   <dd class="attachment-size">
                    51 kB
                   </dd>
                   <dd class="attachment-author">
                    Cao Manh Dat
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="is depended upon by">
                   is depended upon by
                  </dt> 
                  <dd id="internal-13041507_10001"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" width="16" height="16" title="Improvement - An improvement or enhancement to an existing feature or task." alt="Improvement - An improvement or enhancement to an existing feature or task."> <span title="SOLR-10106: Avoid deserializing SolrInputDocument if the node does not index the document"> <a href="/jira/browse/SOLR-10106" data-issue-key="SOLR-10106" class="issue-link link-title">SOLR-10106</a> <span class="link-summary">Avoid deserializing SolrInputDocument if the node does not index the document</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-blue-gray jira-issue-status-lozenge-new aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Open</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is open and ready for the assignee to start work on it.</span>">Open</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                 <dl class="links-list "> 
                  <dt title="is related to">
                   is related to
                  </dt> 
                  <dd id="internal-13048668_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype" width="16" height="16" title="New Feature - A new feature of the product, which has yet to be developed." alt="New Feature - A new feature of the product, which has yet to be developed."> <span title="SOLR-10233: Add support for different replica types in Solr"> <a href="/jira/browse/SOLR-10233" data-issue-key="SOLR-10233" class="issue-link link-title resolution">SOLR-10233</a> <span class="link-summary">Add support for different replica types in Solr</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Resolved</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.</span>">Resolved</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                  <dd id="internal-13016639_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" width="16" height="16" title="Improvement - An improvement or enhancement to an existing feature or task." alt="Improvement - An improvement or enhancement to an existing feature or task."> <span title="SOLR-9706: fetchIndex blocks incoming queries when issued on a replica in SolrCloud"> <a href="/jira/browse/SOLR-9706" data-issue-key="SOLR-9706" class="issue-link link-title">SOLR-9706</a> <span class="link-summary">fetchIndex blocks incoming queries when issued on a replica in SolrCloud</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-blue-gray jira-issue-status-lozenge-new aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Open</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is open and ready for the assignee to start work on it.</span>">Open</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                 <dl class="links-list "> 
                  <dt title="relates to">
                   relates to
                  </dt> 
                  <dd id="internal-12726683_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype" width="16" height="16" title="New Feature - A new feature of the product, which has yet to be developed." alt="New Feature - A new feature of the product, which has yet to be developed."> <span title="SOLR-6237: An option to have only leaders write and replicas read when using a shared file system with SolrCloud."> <a href="/jira/browse/SOLR-6237" data-issue-key="SOLR-6237" class="issue-link link-title">SOLR-6237</a> <span class="link-summary">An option to have only leaders write and replicas read when using a shared file system with SolrCloud.</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-blue-gray jira-issue-status-lozenge-new aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Open</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is open and ready for the assignee to start work on it.</span>">Open</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_shalinmangar" rel="shalinmangar" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Shalin Shekhar Mangar&quot;,&quot;emailAddress&quot;:&quot;shalin.mangar@lucidworks.com&quot;,&quot;username&quot;:&quot;shalinmangar&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="shalinmangar"></span></span> Shalin Shekhar Mangar </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_caomanhdat" rel="caomanhdat" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Cao Manh Dat&quot;,&quot;emailAddress&quot;:&quot;caomanhdat317@gmail.com&quot;,&quot;username&quot;:&quot;caomanhdat&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="caomanhdat"></span></span> Cao Manh Dat </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">2</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">17</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="07/Dec/16 15:20"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2016-12-07T15:20:57+0000">07/Dec/16 15:20</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="11/Jul/17 16:58"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2017-07-11T16:58:47+0000">11/Jul/17 16:58</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="03/Jul/17 23:00"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2017-07-03T23:00:42+0000">03/Jul/17 23:00</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-9835?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-9835?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-9835?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-9835?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-9835?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-9835?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-9835?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-9835?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/SOLR-9835?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-9835?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-9835?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/SOLR-9835?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-15729828\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15729828&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15729828\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15729828_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15729828_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Dec\\/16 20:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-07T20:27:51+0000\'\u003e07\\/Dec\\/16 20:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI believe that if we do implement this, it should make \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9706\\\" title=\\\"fetchIndex blocks incoming queries when issued on a replica in SolrCloud\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9706\\\"\u003eSOLR-9706\u003c\\/a\u003e obsolete. The proposed replication mode sounds like it would make manually issuing a fetchIndex unnecessary since the use-case for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9706\\\" title=\\\"fetchIndex blocks incoming queries when issued on a replica in SolrCloud\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9706\\\"\u003eSOLR-9706\u003c\\/a\u003e I\'m familiar with is exactly only indexing to the leader and having the followers use the regular polling mechanism which doesn\'t block during replication.\u003c\\/p\u003e\\n\\n\u003cp\u003eAt least we should verify whether \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9706\\\" title=\\\"fetchIndex blocks incoming queries when issued on a replica in SolrCloud\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9706\\\"\u003eSOLR-9706\u003c\\/a\u003e is made obsolete by this proposal.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15729828_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15729828_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Dec\\/16 20:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-07T20:27:51+0000\'\u003e07\\/Dec\\/16 20:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I believe that if we do implement this, it should make  SOLR-9706  obsolete. The proposed replication mode sounds like it would make manually issuing a fetchIndex unnecessary since the use-case for  SOLR-9706  I\'m familiar with is exactly only indexing to the leader and having the followers use the regular polling mechanism which doesn\'t block during replication. \\n\\n At least we should verify whether  SOLR-9706  is made obsolete by this proposal.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15732174\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15732174&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15732174\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"praste\\\" id=\\\"commentauthor_15732174_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=praste\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"praste\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Pushkar Raste\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15732174_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Dec\\/16 13:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-08T13:12:43+0000\'\u003e08\\/Dec\\/16 13:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI am curious to know how soft commits (in memory segments) would be handled.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"praste\\\" id=\\\"commentauthor_15732174_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=praste\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"praste\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Pushkar Raste\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15732174_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Dec\\/16 13:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-08T13:12:43+0000\'\u003e08\\/Dec\\/16 13:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I am curious to know how soft commits (in memory segments) would be handled.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15732527\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15732527&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15732527\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_15732527_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15732527_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Dec\\/16 15:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-08T15:33:07+0000\'\u003e08\\/Dec\\/16 15:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSoft commits are for near realtime and doing master-&gt;slave replication won\'t benefit from that. Effectively, soft commits won\'t be useful.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_15732527_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15732527_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Dec\\/16 15:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-08T15:33:07+0000\'\u003e08\\/Dec\\/16 15:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Soft commits are for near realtime and doing master-&gt;slave replication won\'t benefit from that. Effectively, soft commits won\'t be useful.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15732554\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15732554&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15732554\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ichattopadhyaya\\\" id=\\\"commentauthor_15732554_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ichattopadhyaya\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ichattopadhyaya\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ishan Chattopadhyaya\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15732554_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Dec\\/16 15:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-08T15:43:40+0000\'\u003e08\\/Dec\\/16 15:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m curious about the handling of searcher reopens (which would create a new segment, afaict). Such a searcher reopen can happen if an RTG request uses filters. \u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e                 ulog.openRealtimeSearcher();  \u003cspan class=\\\"code-comment\\\"\u003e\\/\\/ force open a \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e realtime searcher\u003c\\/span\u003e\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ichattopadhyaya\\\" id=\\\"commentauthor_15732554_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ichattopadhyaya\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ichattopadhyaya\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ishan Chattopadhyaya\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15732554_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Dec\\/16 15:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-08T15:43:40+0000\'\u003e08\\/Dec\\/16 15:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m curious about the handling of searcher reopens (which would create a new segment, afaict). Such a searcher reopen can happen if an RTG request uses filters.  \\n  \\n                  ulog.openRealtimeSearcher();   \\/\\/ force open a  new  realtime searcher \\n \\n               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15732576\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15732576&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15732576\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15732576_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15732576_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Dec\\/16 15:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-08T15:53:15+0000\'\u003e08\\/Dec\\/16 15:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHold your questions for a bit. Dat and I are working on a design and we will try to answer your questions as much as we can. We will post it in a couple of days.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15732576_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15732576_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Dec\\/16 15:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-08T15:53:15+0000\'\u003e08\\/Dec\\/16 15:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hold your questions for a bit. Dat and I are working on a design and we will try to answer your questions as much as we can. We will post it in a couple of days.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15735547\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15735547&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15735547\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15735547_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15735547_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Dec\\/16 15:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-09T15:05:15+0000\'\u003e09\\/Dec\\/16 15:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere are the detail design that I and Shalin have been working for recently\u003c\\/p\u003e\\n\\n\u003ch2\u003e\u003ca name=\\\"Overview\\\"\u003e\u003c\\/a\u003eOverview\u003c\\/h2\u003e\\n\u003cp\u003eThe current replication mechanism of SolrCloud is called state machine, which replicas start in same initial state and for each input, the input is distributed across replicas so all replicas will end up with same next state.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut this type of replication has some drawbacks :\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eThe indexing and commits have to run on all replicas\u003c\\/li\u003e\\n\\t\u003cli\u003eSlow recovery, because if replica miss more than N updates on its down time, the replica has to (usually) download the entire index from its leader.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eSo we introduce another replication for SolrCloud called state transfer, which acts like master\\/slave replication. Basically:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eLeader distribute the update to other replicas, but only the leader applies the update to IndexWriter; other replicas just store the update to UpdateLog (act like replication)\u003c\\/li\u003e\\n\\t\u003cli\u003eReplicas frequently polling the latest segments from leader.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003ePros:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eLightweight for indexing, because only leader are running the updates and commits\u003c\\/li\u003e\\n\\t\u003cli\u003eVery fast recovery. If a replica fails, it just has to download newest segments, instead of re-downloading entire index.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eCons :\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eLeader can become a hotspot when there are many replicas (we can optimize later)\u003c\\/li\u003e\\n\\t\u003cli\u003eLonger turnaround time compared to current NRT replication\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003ch2\u003e\u003ca name=\\\"Commit\\\"\u003e\u003c\\/a\u003eCommit\u003c\\/h2\u003e\\n\u003cp\u003eWhen we commit, we write the version of update command into the commit data in addition to the timestamp that is written today.\u003c\\/p\u003e\\n\\n\u003ch2\u003e\u003ca name=\\\"Update\\\"\u003e\u003c\\/a\u003eUpdate\u003c\\/h2\u003e\\n\u003col\u003e\\n\\t\u003cli\u003eWhen a replica receive an update request it will forward the update request to\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003eCorrect leader ( in case of add document, delete by id )\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eAll leaders ( in case of delete by query, commit )\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\\t\u003cli\u003eLeader assigns version to update as it does today, writes to update log and applies the update to IndexWriter\u003c\\/li\u003e\\n\\t\u003cli\u003eLeader distributes the update to its replicas\u003c\\/li\u003e\\n\\t\u003cli\u003eWhen replica receives an update, it writes the update to update log and return successfully\u003c\\/li\u003e\\n\\t\u003cli\u003eLeader return successful\u003c\\/li\u003e\\n\u003c\\/ol\u003e\\n\\n\\n\u003ch2\u003e\u003ca name=\\\"PeriodicSegmentReplication\\\"\u003e\u003c\\/a\u003ePeriodic Segment Replication\u003c\\/h2\u003e\\n\u003cp\u003eReplica will poll the leader for the latest commit point generation and version and compare against the latest commit point locally. If it is the same, then replication is successful and nothing needs to be done. If not, then:\u003c\\/p\u003e\\n\u003col\u003e\\n\\t\u003cli\u003eReplica downloads all files since the local commit point from the leader\u003c\\/li\u003e\\n\\t\u003cli\u003eInstalls into the index, synchronize on the update log, close the old tlog, create a new one and copy over all records from the old tlog which have version greater than the latest commit point\\u2019s version. This is to ensure that any update which hasn\\u2019t made it to the index is preserved in the current tlog. This might lead to duplication of updates in the previous and the current tlogs but that is okay.\u003c\\/li\u003e\\n\\t\u003cli\u003eReplica re-opens the searcher\u003c\\/li\u003e\\n\u003c\\/ol\u003e\\n\\n\\n\u003cp\u003eFor example:\u003cbr\\/\u003e\\nLeader has the following tlogs\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eTLog1 has versions 1,2,3,commit\u003c\\/li\u003e\\n\\t\u003cli\u003eTLog2 has versions 4,5\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eBefore segment replication, the replica have the following tlogs:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eTLog1 - 1,2,3,4,commit\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eAfter segment replication, the replica will have the following tlogs:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eTLog1 - 1,2,3,4,commit\u003c\\/li\u003e\\n\\t\u003cli\u003eTLog2 - 4,5\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\\n\u003cp\u003eDuring this process, the replica does not need to be put into \\u2018recovery\\u2019 state. It continues to be \\u2018active\\u2019 and participate in indexing and searches.\u003c\\/p\u003e\\n\\n\u003ch2\u003e\u003ca name=\\\"Replicarecovery\\\"\u003e\u003c\\/a\u003eReplica recovery\u003c\\/h2\u003e\\n\u003col\u003e\\n\\t\u003cli\u003eReplica puts itself in \\u2018recovery\\u2019 state.\u003c\\/li\u003e\\n\\t\u003cli\u003eReplica compares its latest commit point against the leader\u003c\\/li\u003e\\n\\t\u003cli\u003eIf the index is same as leader, then it performs \\u2018peersync\\u2019 with the leader but only writes the peersync updates to its update log\u003c\\/li\u003e\\n\\t\u003cli\u003eIf the index is not the same as leader or if peersync fails, the replica:\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003ePuts its update log in \\u201Cbuffering\\u201D state\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eIssues a hard commit to the leader\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eCopies the index commit points from the leader that do not exist locally\u003c\\/li\u003e\\n\\t\\t\u003cli\u003ePublishes itself as \\u2018active\\u2019\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\\t\u003cli\u003eThe \\u201Cbuffering\\u201D state in the above steps ensures that any updates that haven\\u2019t been committed to the leader are also present\\/replicated to the replica\\u2019s current transaction log\u003c\\/li\u003e\\n\u003c\\/ol\u003e\\n\\n\\n\u003cp\u003eWith respect to the current recovery strategy in Solr, we need only one change which is to check the index version of leader vs replica before we attempt a peersync.\u003c\\/p\u003e\\n\\n\u003ch2\u003e\u003ca name=\\\"LeaderElection\\\"\u003e\u003c\\/a\u003eLeader Election\u003c\\/h2\u003e\\n\u003cp\u003eWhen a leader dies, a candidate replica will become a new leader. The leader election algorithm remains mostly the same except that after the \\u201Csync\\u201D step, the leader candidate will replay its transaction log before publishing itself as the leader.\u003c\\/p\u003e\\n\\n\u003ch2\u003e\u003ca name=\\\"Collectionpropertytoswitchreplicationscheme\\\"\u003e\u003c\\/a\u003eCollection property to switch replication scheme\u003c\\/h2\u003e\\n\u003cp\u003eA new property called \\u201ConlyLeaderIndexes\\u201D will be added to the collection. Any collection that has this property set to true will only index to the elected leader and the rest of the replicas will only fetch index segments from the leader as described above in the document. This property must be set during collection creation. It will default to \\u201Cfalse\\u201D. Existing collections cannot be switched to using the new replication scheme. Future work can attempt to fix that.\u003c\\/p\u003e\\n\\n\u003ch2\u003e\u003ca name=\\\"FAQ\\\"\u003e\u003c\\/a\u003eFAQ\u003c\\/h2\u003e\\n\\n\u003cp\u003eQ: What happens on a soft-commit?\u003cbr\\/\u003e\\nA: soft-commit is nothing but a searcher opened using the IndexWriter which flushes a new segment to the disk but does not commit it. In this case, the newly written segment not being part of a commit point, is not replicated at all. Effectively, soft commits are not useful in this new design currently. Future work may attempt to solve this problem. This same answer applies to searcher re-opens due to real-time-get.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15735547_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15735547_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Dec\\/16 15:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-09T15:05:15+0000\'\u003e09\\/Dec\\/16 15:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here are the detail design that I and Shalin have been working for recently \\n\\n   Overview \\n The current replication mechanism of SolrCloud is called state machine, which replicas start in same initial state and for each input, the input is distributed across replicas so all replicas will end up with same next state. \\n\\n But this type of replication has some drawbacks : \\n \\n\\t The indexing and commits have to run on all replicas \\n\\t Slow recovery, because if replica miss more than N updates on its down time, the replica has to (usually) download the entire index from its leader. \\n \\n\\n\\n So we introduce another replication for SolrCloud called state transfer, which acts like master\\/slave replication. Basically: \\n \\n\\t Leader distribute the update to other replicas, but only the leader applies the update to IndexWriter; other replicas just store the update to UpdateLog (act like replication) \\n\\t Replicas frequently polling the latest segments from leader. \\n \\n\\n\\n Pros: \\n \\n\\t Lightweight for indexing, because only leader are running the updates and commits \\n\\t Very fast recovery. If a replica fails, it just has to download newest segments, instead of re-downloading entire index. \\n \\n\\n\\n Cons : \\n \\n\\t Leader can become a hotspot when there are many replicas (we can optimize later) \\n\\t Longer turnaround time compared to current NRT replication \\n \\n\\n\\n   Commit \\n When we commit, we write the version of update command into the commit data in addition to the timestamp that is written today. \\n\\n   Update \\n \\n\\t When a replica receive an update request it will forward the update request to\\n\\t \\n\\t\\t Correct leader ( in case of add document, delete by id ) \\n\\t\\t All leaders ( in case of delete by query, commit ) \\n\\t \\n\\t \\n\\t Leader assigns version to update as it does today, writes to update log and applies the update to IndexWriter \\n\\t Leader distributes the update to its replicas \\n\\t When replica receives an update, it writes the update to update log and return successfully \\n\\t Leader return successful \\n \\n\\n\\n   Periodic Segment Replication \\n Replica will poll the leader for the latest commit point generation and version and compare against the latest commit point locally. If it is the same, then replication is successful and nothing needs to be done. If not, then: \\n \\n\\t Replica downloads all files since the local commit point from the leader \\n\\t Installs into the index, synchronize on the update log, close the old tlog, create a new one and copy over all records from the old tlog which have version greater than the latest commit point\\u2019s version. This is to ensure that any update which hasn\\u2019t made it to the index is preserved in the current tlog. This might lead to duplication of updates in the previous and the current tlogs but that is okay. \\n\\t Replica re-opens the searcher \\n \\n\\n\\n For example: \\nLeader has the following tlogs \\n \\n\\t TLog1 has versions 1,2,3,commit \\n\\t TLog2 has versions 4,5 \\n \\n\\n\\n Before segment replication, the replica have the following tlogs: \\n \\n\\t TLog1 - 1,2,3,4,commit \\n \\n\\n\\n After segment replication, the replica will have the following tlogs: \\n \\n\\t TLog1 - 1,2,3,4,commit \\n\\t TLog2 - 4,5 \\n \\n\\n\\n\\n During this process, the replica does not need to be put into \\u2018recovery\\u2019 state. It continues to be \\u2018active\\u2019 and participate in indexing and searches. \\n\\n   Replica recovery \\n \\n\\t Replica puts itself in \\u2018recovery\\u2019 state. \\n\\t Replica compares its latest commit point against the leader \\n\\t If the index is same as leader, then it performs \\u2018peersync\\u2019 with the leader but only writes the peersync updates to its update log \\n\\t If the index is not the same as leader or if peersync fails, the replica:\\n\\t \\n\\t\\t Puts its update log in \\u201Cbuffering\\u201D state \\n\\t\\t Issues a hard commit to the leader \\n\\t\\t Copies the index commit points from the leader that do not exist locally \\n\\t\\t Publishes itself as \\u2018active\\u2019 \\n\\t \\n\\t \\n\\t The \\u201Cbuffering\\u201D state in the above steps ensures that any updates that haven\\u2019t been committed to the leader are also present\\/replicated to the replica\\u2019s current transaction log \\n \\n\\n\\n With respect to the current recovery strategy in Solr, we need only one change which is to check the index version of leader vs replica before we attempt a peersync. \\n\\n   Leader Election \\n When a leader dies, a candidate replica will become a new leader. The leader election algorithm remains mostly the same except that after the \\u201Csync\\u201D step, the leader candidate will replay its transaction log before publishing itself as the leader. \\n\\n   Collection property to switch replication scheme \\n A new property called \\u201ConlyLeaderIndexes\\u201D will be added to the collection. Any collection that has this property set to true will only index to the elected leader and the rest of the replicas will only fetch index segments from the leader as described above in the document. This property must be set during collection creation. It will default to \\u201Cfalse\\u201D. Existing collections cannot be switched to using the new replication scheme. Future work can attempt to fix that. \\n\\n   FAQ \\n\\n Q: What happens on a soft-commit? \\nA: soft-commit is nothing but a searcher opened using the IndexWriter which flushes a new segment to the disk but does not commit it. In this case, the newly written segment not being part of a commit point, is not replicated at all. Effectively, soft commits are not useful in this new design currently. Future work may attempt to solve this problem. This same answer applies to searcher re-opens due to real-time-get.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15736051\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15736051&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15736051\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"praste\\\" id=\\\"commentauthor_15736051_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=praste\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"praste\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Pushkar Raste\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15736051_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Dec\\/16 19:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-09T19:16:26+0000\'\u003e09\\/Dec\\/16 19:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eInstead of periodic polling, can leader upon receiving and processing a commit command, send a notification to replicas asking them to sync up?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"praste\\\" id=\\\"commentauthor_15736051_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=praste\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"praste\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Pushkar Raste\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15736051_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Dec\\/16 19:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-09T19:16:26+0000\'\u003e09\\/Dec\\/16 19:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Instead of periodic polling, can leader upon receiving and processing a commit command, send a notification to replicas asking them to sync up?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15741742\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15741742&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15741742\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15741742_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15741742_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Dec\\/16 12:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-12T12:09:58+0000\'\u003e12\\/Dec\\/16 12:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eInstead of periodic polling, can leader upon receiving and processing a commit command, send a notification to replicas asking them to sync up?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWe thought about that but we ended up favoring the polling model because the poll request is cheap and we can use existing replication handler code. We will keep the poll interval at half the auto commit time for a start. For this issue, we want to keep the changes limited as much as possible but we can consider a notification feature in later enhancements.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15741742_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15741742_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Dec\\/16 12:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-12T12:09:58+0000\'\u003e12\\/Dec\\/16 12:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Instead of periodic polling, can leader upon receiving and processing a commit command, send a notification to replicas asking them to sync up?  \\n\\n We thought about that but we ended up favoring the polling model because the poll request is cheap and we can use existing replication handler code. We will keep the poll interval at half the auto commit time for a start. For this issue, we want to keep the changes limited as much as possible but we can consider a notification feature in later enhancements.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15748538\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15748538&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15748538\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ichattopadhyaya\\\" id=\\\"commentauthor_15748538_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ichattopadhyaya\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ichattopadhyaya\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ishan Chattopadhyaya\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15748538_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Dec\\/16 14:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-14T14:54:31+0000\'\u003e14\\/Dec\\/16 14:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eCollection property to switch replication scheme\u003c\\/p\u003e\\n\\n\u003cp\u003eA new property called \\u201ConlyLeaderIndexes\\u201D will be added to the collection. Any collection that has this property set to true will only index to the elected leader and the rest of the replicas will only fetch index segments from the leader as described above in the document. This property must be set during collection creation. It will default to \\u201Cfalse\\u201D. Existing collections cannot be switched to using the new replication scheme. Future work can attempt to fix that.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eInstead of a hardcoded property name, i.e. onlyLeaderIndexes=true\\/false, I suggest that we have something like \\\"replicationScheme=onlyLeaderIndexes\\\" (or some other value for the current replication scheme). That would keep the door open for us to add any other replication scheme in future.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ichattopadhyaya\\\" id=\\\"commentauthor_15748538_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ichattopadhyaya\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ichattopadhyaya\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ishan Chattopadhyaya\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15748538_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Dec\\/16 14:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-14T14:54:31+0000\'\u003e14\\/Dec\\/16 14:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n Collection property to switch replication scheme \\n\\n A new property called \\u201ConlyLeaderIndexes\\u201D will be added to the collection. Any collection that has this property set to true will only index to the elected leader and the rest of the replicas will only fetch index segments from the leader as described above in the document. This property must be set during collection creation. It will default to \\u201Cfalse\\u201D. Existing collections cannot be switched to using the new replication scheme. Future work can attempt to fix that.  \\n\\n Instead of a hardcoded property name, i.e. onlyLeaderIndexes=true\\/false, I suggest that we have something like \\\"replicationScheme=onlyLeaderIndexes\\\" (or some other value for the current replication scheme). That would keep the door open for us to add any other replication scheme in future.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15750712\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15750712&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15750712\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15750712_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15750712_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Dec\\/16 07:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-15T07:59:12+0000\'\u003e15\\/Dec\\/16 07:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere a the patch for this issue, I didn\'t do anything related to Leader Recovery, just wanna upload the patch soon so anyone can comment first.\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eAdd \u003ctt\u003eonlyLeaderIndexes\u003c\\/tt\u003e property to \u003ctt\u003eDocCollection\u003c\\/tt\u003e\u003c\\/li\u003e\\n\\t\u003cli\u003eModified \u003ctt\u003eSolrIndexWriter#setCommitData(IndexWriter iw, long commitCommandVersion)\u003c\\/tt\u003e to store version of commit command to commit point.\u003c\\/li\u003e\\n\\t\u003cli\u003eStart replication process to periodically poll latest segments from leader when replica become active\u003c\\/li\u003e\\n\\t\u003cli\u003eAdd \u003ctt\u003eUpdateCommand.IGNORE_INDEXWRITER\u003c\\/tt\u003e so\u003cbr\\/\u003e\\n  + DistributedUpdateProcessor can look into the role of current core to add the flag to command\u003cbr\\/\u003e\\n  + DirectUpdateHandler2 based on the existence of \u003ctt\u003eIGNORE_INDEXWRITER\u003c\\/tt\u003e to skip making changes to IW, just write down the updateCommand to its tlog\u003c\\/li\u003e\\n\\t\u003cli\u003eMake sure that the current tlog of replicas have all uncommit updates\u003cbr\\/\u003e\\n  + When replication process is complete\u003cbr\\/\u003e\\n  + When replica restart\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15750712_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15750712_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Dec\\/16 07:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-15T07:59:12+0000\'\u003e15\\/Dec\\/16 07:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here a the patch for this issue, I didn\'t do anything related to Leader Recovery, just wanna upload the patch soon so anyone can comment first. \\n \\n\\t Add  onlyLeaderIndexes  property to  DocCollection  \\n\\t Modified  SolrIndexWriter#setCommitData(IndexWriter iw, long commitCommandVersion)  to store version of commit command to commit point. \\n\\t Start replication process to periodically poll latest segments from leader when replica become active \\n\\t Add  UpdateCommand.IGNORE_INDEXWRITER  so \\n  + DistributedUpdateProcessor can look into the role of current core to add the flag to command \\n  + DirectUpdateHandler2 based on the existence of  IGNORE_INDEXWRITER  to skip making changes to IW, just write down the updateCommand to its tlog \\n\\t Make sure that the current tlog of replicas have all uncommit updates \\n  + When replication process is complete \\n  + When replica restart \\n \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15751394\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15751394&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15751394\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15751394_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15751394_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Dec\\/16 13:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-15T13:37:51+0000\'\u003e15\\/Dec\\/16 13:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated patch for this issue\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eWhen a new tlog is created, it copy all old updates that not have been made to its local index.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15751394_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15751394_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Dec\\/16 13:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-15T13:37:51+0000\'\u003e15\\/Dec\\/16 13:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated patch for this issue \\n \\n\\t When a new tlog is created, it copy all old updates that not have been made to its local index. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15778369\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15778369&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15778369\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15778369_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15778369_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Dec\\/16 13:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-26T13:50:22+0000\'\u003e26\\/Dec\\/16 13:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Cao Manh Dat - 26\\/Dec\\/16 13:50\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=yonik%40apache.org\\\" class=\\\"user-hover\\\" rel=\\\"yonik@apache.org\\\"\u003eYonik Seeley\u003c\\/a\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\" class=\\\"user-hover\\\" rel=\\\"yseeley@gmail.com\\\"\u003eYonik Seeley\u003c\\/a\u003e : Here are scenario for the problem that I encountered today\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003ean replica ( let\'s call it rep1 ) is on recovering mode -&gt; its ulog will be on buffering state.\u003c\\/li\u003e\\n\\t\u003cli\u003erep1 receives an update ( contain doc1 ), rep1 will write the update to its tlog without updating ulog.map for real-time-get\u003c\\/li\u003e\\n\\t\u003cli\u003erep1 replay buffered updates, rep1 will write doc1 to its index, and update ulog.map for real-time-get ( but in this case, ulog.map will point doc1 -&gt; position = -1 because we don\'t write updateCommand with REPLAY flag to tlog )\u003c\\/li\u003e\\n\\t\u003cli\u003eclient call real-time-get for doc1\u003c\\/li\u003e\\n\\t\u003cli\u003erep1 will always open a real-time-searcher for this case. Because ulog.map for doc 1 return position = -1\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI just wonder why we do that currently? Why don\'t we just write the update to tlog and ulog.map so we don\'t have to open a new real-time-searcher for this case?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15778369_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15778369_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Dec\\/16 13:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-26T13:50:22+0000\'\u003e26\\/Dec\\/16 13:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Cao Manh Dat - 26\\/Dec\\/16 13:50\\\"\u003eedited\u003c\\/span\u003e                    Yonik Seeley  Yonik Seeley  : Here are scenario for the problem that I encountered today \\n \\n\\t an replica ( let\'s call it rep1 ) is on recovering mode -&gt; its ulog will be on buffering state. \\n\\t rep1 receives an update ( contain doc1 ), rep1 will write the update to its tlog without updating ulog.map for real-time-get \\n\\t rep1 replay buffered updates, rep1 will write doc1 to its index, and update ulog.map for real-time-get ( but in this case, ulog.map will point doc1 -&gt; position = -1 because we don\'t write updateCommand with REPLAY flag to tlog ) \\n\\t client call real-time-get for doc1 \\n\\t rep1 will always open a real-time-searcher for this case. Because ulog.map for doc 1 return position = -1 \\n \\n\\n\\n I just wonder why we do that currently? Why don\'t we just write the update to tlog and ulog.map so we don\'t have to open a new real-time-searcher for this case?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15782633\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15782633&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15782633\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15782633_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15782633_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Dec\\/16 10:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-28T10:47:12+0000\'\u003e28\\/Dec\\/16 10:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated patch\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eLeader Recovery\u003c\\/li\u003e\\n\\t\u003cli\u003eReplica recovery will always do replication ( skip peersync ) because I found it very complex to fix all the bugs caused by peersync in this mode. We can support peersync for this mode in future.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15782633_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15782633_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Dec\\/16 10:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-28T10:47:12+0000\'\u003e28\\/Dec\\/16 10:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated patch \\n \\n\\t Leader Recovery \\n\\t Replica recovery will always do replication ( skip peersync ) because I found it very complex to fix all the bugs caused by peersync in this mode. We can support peersync for this mode in future. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15788716\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15788716&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15788716\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"praste\\\" id=\\\"commentauthor_15788716_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=praste\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"praste\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Pushkar Raste\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15788716_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Dec\\/16 01:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-31T01:49:23+0000\'\u003e31\\/Dec\\/16 01:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHow are we handling leader failure here. if replicas are some what out of sync with the original leader, how would we elect a new leader. \u003c\\/p\u003e\\n\\n\u003cp\u003eWhen the leader fails and a new leader gets elected, the  new leader asks all the replicas to sync with the new leader. My understanding is, \\\"since we are replicating index by fetching segments from leader, most of the segments on all the replicas should look the same, hence all the replicas will not go into full index copying\\\". Is that correct ?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"praste\\\" id=\\\"commentauthor_15788716_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=praste\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"praste\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Pushkar Raste\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15788716_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Dec\\/16 01:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-31T01:49:23+0000\'\u003e31\\/Dec\\/16 01:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    How are we handling leader failure here. if replicas are some what out of sync with the original leader, how would we elect a new leader.  \\n\\n When the leader fails and a new leader gets elected, the  new leader asks all the replicas to sync with the new leader. My understanding is, \\\"since we are replicating index by fetching segments from leader, most of the segments on all the replicas should look the same, hence all the replicas will not go into full index copying\\\". Is that correct ?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15788811\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15788811&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15788811\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15788811_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15788811_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Dec\\/16 03:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-31T03:10:44+0000\'\u003e31\\/Dec\\/16 03:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCurrently, PeerSync sync on tlog, so it is not a problem if the indexes on all replicas are the same. So Leader Election will be the same as today except that when new leader sync success with other replicas, it must replay its tlog to make all necessary changes to its index.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15788811_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15788811_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Dec\\/16 03:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-12-31T03:10:44+0000\'\u003e31\\/Dec\\/16 03:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Currently, PeerSync sync on tlog, so it is not a problem if the indexes on all replicas are the same. So Leader Election will be the same as today except that when new leader sync success with other replicas, it must replay its tlog to make all necessary changes to its index.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15793929\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15793929&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15793929\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15793929_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15793929_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jan\\/17 02:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-03T02:23:41+0000\'\u003e03\\/Jan\\/17 02:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated patch for this issues, the changes are pretty solid now. \u003c\\/p\u003e\\n\\n\u003cp\u003eThe main difference between \u003ctt\u003eonlyLeaderIndexes\u003c\\/tt\u003e mode and current mode is in \u003ctt\u003eonlyLeaderIndexes\u003c\\/tt\u003e mode we can serve stale data. So I modified TestInjection to make replicas wait for indexFetcher finish upon receiving commit request, then we can reuse existing tests for SolrCloud to test for \u003ctt\u003eonlyLeaderIndexes\u003c\\/tt\u003e mode. These are failed tests (5\\/206 tests of SolrCloud)\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eCdcrVersionReplicationTest, ShardSplitTest, SyncSliceTest: we can notify to users that \u003ctt\u003eonlyLeaderIndexes\u003c\\/tt\u003e hasn\'t  supported for CDCR, ShardSplit and SyncSlice yet.\u003c\\/li\u003e\\n\\t\u003cli\u003eLeaderFailureAfterFreshStartTest, PeerSyncReplicationTest : we don\'t support peersync yet.\u003cbr\\/\u003e\\nI think all these tests can be ignored for this issue, we can tackle these failed on other tickets.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI also run the jepsen tests for this mode ( \u003ca href=\\\"https:\\/\\/lucidworks.com\\/blog\\/2014\\/12\\/10\\/call-maybe-solrcloud-jepsen-flaky-networks\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/lucidworks.com\\/blog\\/2014\\/12\\/10\\/call-maybe-solrcloud-jepsen-flaky-networks\\/\u003c\\/a\u003e ). The tests are passed so I think we can pretty sure that new mode is consistency and partition tolerance.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15793929_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15793929_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jan\\/17 02:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-03T02:23:41+0000\'\u003e03\\/Jan\\/17 02:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated patch for this issues, the changes are pretty solid now.  \\n\\n The main difference between  onlyLeaderIndexes  mode and current mode is in  onlyLeaderIndexes  mode we can serve stale data. So I modified TestInjection to make replicas wait for indexFetcher finish upon receiving commit request, then we can reuse existing tests for SolrCloud to test for  onlyLeaderIndexes  mode. These are failed tests (5\\/206 tests of SolrCloud) \\n \\n\\t CdcrVersionReplicationTest, ShardSplitTest, SyncSliceTest: we can notify to users that  onlyLeaderIndexes  hasn\'t  supported for CDCR, ShardSplit and SyncSlice yet. \\n\\t LeaderFailureAfterFreshStartTest, PeerSyncReplicationTest : we don\'t support peersync yet. \\nI think all these tests can be ignored for this issue, we can tackle these failed on other tickets. \\n \\n\\n\\n I also run the jepsen tests for this mode (  https:\\/\\/lucidworks.com\\/blog\\/2014\\/12\\/10\\/call-maybe-solrcloud-jepsen-flaky-networks\\/  ). The tests are passed so I think we can pretty sure that new mode is consistency and partition tolerance.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15794569\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15794569&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15794569\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15794569_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15794569_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jan\\/17 09:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-03T09:04:55+0000\'\u003e03\\/Jan\\/17 09:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eClean up the patch.\u003c\\/li\u003e\\n\\t\u003cli\u003eEnable \u003ctt\u003eonlyLeaderIndexes\u003c\\/tt\u003e mode on some tests.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15794569_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15794569_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jan\\/17 09:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-03T09:04:55+0000\'\u003e03\\/Jan\\/17 09:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n\\t Clean up the patch. \\n\\t Enable  onlyLeaderIndexes  mode on some tests. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15795916\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15795916&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15795916\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15795916_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15795916_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jan\\/17 19:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-03T19:16:07+0000\'\u003e03\\/Jan\\/17 19:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWhat is the public interface for this feature? How do I enable\\/disable this feature? Is there a command?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15795916_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15795916_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jan\\/17 19:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-03T19:16:07+0000\'\u003e03\\/Jan\\/17 19:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    What is the public interface for this feature? How do I enable\\/disable this feature? Is there a command?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15796970\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15796970&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15796970\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15796970_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15796970_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jan\\/17 02:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-04T02:50:45+0000\'\u003e04\\/Jan\\/17 02:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Cao Manh Dat - 04\\/Jan\\/17 02:51\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRight now, to create a collection in \u003ctt\u003eonlyLeaderIndexesMode\u003c\\/tt\u003e we must use \\\"Create Collection API\\\" with additional parameter : onlyLeaderIndexes=true. When a collection is created on a mode, it will stick to that mode.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn further ticket, we can support switch between modes.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15796970_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15796970_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jan\\/17 02:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-04T02:50:45+0000\'\u003e04\\/Jan\\/17 02:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Cao Manh Dat - 04\\/Jan\\/17 02:51\\\"\u003eedited\u003c\\/span\u003e                   Right now, to create a collection in  onlyLeaderIndexesMode  we must use \\\"Create Collection API\\\" with additional parameter : onlyLeaderIndexes=true. When a collection is created on a mode, it will stick to that mode. \\n\\n In further ticket, we can support switch between modes.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15796982\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15796982&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15796982\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15796982_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15796982_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jan\\/17 02:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-04T02:59:34+0000\'\u003e04\\/Jan\\/17 02:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI would like this to be added to the description of the ticket\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15796982_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15796982_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Jan\\/17 02:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-04T02:59:34+0000\'\u003e04\\/Jan\\/17 02:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I would like this to be added to the description of the ticket              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15800881\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15800881&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15800881\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15800881_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15800881_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Jan\\/17 09:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-05T09:29:10+0000\'\u003e05\\/Jan\\/17 09:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated patch, change \u003ctt\u003eboolean onlyLeaderIndexes\u003c\\/tt\u003e to \u003ctt\u003eint liveReplicas\u003c\\/tt\u003e. \u003ctt\u003eliveReplicas\u003c\\/tt\u003e indicate the number of replica ( running on old replication mode ). If \u003ctt\u003eliveReplicas = 1\u003c\\/tt\u003e it will be the same as \u003ctt\u003eonlyLeaderIndexes = true\u003c\\/tt\u003e, all non-leader replicas will fetch latest index from leader. If \u003ctt\u003eliveReplicas = -1\u003c\\/tt\u003e it will be the same as \u003ctt\u003eonlyLeaderIndexes = false\u003c\\/tt\u003e.\u003c\\/p\u003e\\n\\n\u003cp\u003eRight now the valid value for \u003ctt\u003eliveReplicas\u003c\\/tt\u003e are 1 and -1.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis will enable the opportunity to configure a cluster with some replicas run in old mode and some replicas run in new replication mode.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15800881_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15800881_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Jan\\/17 09:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-05T09:29:10+0000\'\u003e05\\/Jan\\/17 09:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated patch, change  boolean onlyLeaderIndexes  to  int liveReplicas .  liveReplicas  indicate the number of replica ( running on old replication mode ). If  liveReplicas = 1  it will be the same as  onlyLeaderIndexes = true , all non-leader replicas will fetch latest index from leader. If  liveReplicas = -1  it will be the same as  onlyLeaderIndexes = false . \\n\\n Right now the valid value for  liveReplicas  are 1 and -1. \\n\\n This will enable the opportunity to configure a cluster with some replicas run in old mode and some replicas run in new replication mode.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15815930\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15815930&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15815930\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15815930_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15815930_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 19:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T19:29:13+0000\'\u003e10\\/Jan\\/17 19:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGreat idea! just took a quick look at the patch to understand this better. I have a couple of questions\\/comments, I know this is work in progress, so feel free to disregard any of my comments if you are working on them:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003eonlyLeaderIndexes = zkStateReader.getClusterState().getCollection(collection).getLiveReplicas() == 1;\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003eMaybe add a method to DocCollection like \u003ctt\u003eisOnlyLeaderIndexes()\u003c\\/tt\u003e (or choose other name)? I understand why you did this, but this code is repeated many times, maybe can be improved for now.\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e\u003cspan class=\\\"code-keyword\\\"\u003eprivate\u003c\\/span\u003e Map&lt;\u003cspan class=\\\"code-object\\\"\u003eString\u003c\\/span\u003e, ReplicateFromLeader&gt; replicateFromLeaders = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e HashMap&lt;&gt;();\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003eDoes this need to be synchronized?\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e-  \u003cspan class=\\\"code-keyword\\\"\u003eprivate\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003efinal\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003eString\u003c\\/span\u003e masterUrl;\\n+  \u003cspan class=\\\"code-keyword\\\"\u003eprivate\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003eString\u003c\\/span\u003e masterUrl;\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003eshould \u003ctt\u003emasterUrl\u003c\\/tt\u003e now be volatile?\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e+  \u003cspan class=\\\"code-keyword\\\"\u003epublic\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003estatic\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003eboolean\u003c\\/span\u003e waitForInSyncWithLeader(SolrCore core, Replica leaderReplica) \u003cspan class=\\\"code-keyword\\\"\u003ethrows\u003c\\/span\u003e InterruptedException {\\n+    \u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (waitForReplicasInSync == \u003cspan class=\\\"code-keyword\\\"\u003enull\u003c\\/span\u003e) \u003cspan class=\\\"code-keyword\\\"\u003ereturn\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003etrue\u003c\\/span\u003e;\\n+\\n+    Pair&lt;\u003cspan class=\\\"code-object\\\"\u003eBoolean\u003c\\/span\u003e,\u003cspan class=\\\"code-object\\\"\u003eInteger\u003c\\/span\u003e&gt; pair = parseValue(waitForReplicasInSync);\\n+    \u003cspan class=\\\"code-object\\\"\u003eboolean\u003c\\/span\u003e enabled = pair.first();\\n+    \u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (!enabled) \u003cspan class=\\\"code-keyword\\\"\u003ereturn\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003etrue\u003c\\/span\u003e;\\n+\\n+    \u003cspan class=\\\"code-object\\\"\u003eThread\u003c\\/span\u003e.sleep(1000);\\n+    HttpSolrClient leaderClient = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e HttpSolrClient.Builder(leaderReplica.getCoreUrl()).build();\\n+    \u003cspan class=\\\"code-object\\\"\u003elong\u003c\\/span\u003e leaderVersion = -1;\\n+    \u003cspan class=\\\"code-object\\\"\u003eString\u003c\\/span\u003e localVersion = \u003cspan class=\\\"code-keyword\\\"\u003enull\u003c\\/span\u003e;\\n+    \u003cspan class=\\\"code-keyword\\\"\u003etry\u003c\\/span\u003e {\\n+      \u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e (\u003cspan class=\\\"code-object\\\"\u003eint\u003c\\/span\u003e i = 0; i &lt; pair.second(); i++) {\\n+        \u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (core.isClosed()) \u003cspan class=\\\"code-keyword\\\"\u003ereturn\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003etrue\u003c\\/span\u003e;\\n+        ModifiableSolrParams params = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e ModifiableSolrParams();\\n+        params.set(CommonParams.QT, ReplicationHandler.PATH);\\n+        params.set(COMMAND, CMD_DETAILS);\\n+\\n+        NamedList&lt;\u003cspan class=\\\"code-object\\\"\u003eObject\u003c\\/span\u003e&gt; response = leaderClient.request(\u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e QueryRequest(params));\\n+        leaderVersion = (\u003cspan class=\\\"code-object\\\"\u003elong\u003c\\/span\u003e) ((NamedList)response.get(\u003cspan class=\\\"code-quote\\\"\u003e\\\"details\\\"\u003c\\/span\u003e)).get(\u003cspan class=\\\"code-quote\\\"\u003e\\\"indexVersion\\\"\u003c\\/span\u003e);\\n+\\n+        localVersion = core.getDeletionPolicy().getLatestCommit().getUserData().get(SolrIndexWriter.COMMIT_TIME_MSEC_KEY);\\n+        \u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (localVersion == \u003cspan class=\\\"code-keyword\\\"\u003enull\u003c\\/span\u003e &amp;&amp; leaderVersion == 0) \u003cspan class=\\\"code-keyword\\\"\u003ereturn\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003etrue\u003c\\/span\u003e;\\n+\\n+        \u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (localVersion != \u003cspan class=\\\"code-keyword\\\"\u003enull\u003c\\/span\u003e &amp;&amp; \u003cspan class=\\\"code-object\\\"\u003eLong\u003c\\/span\u003e.parseLong(localVersion) == leaderVersion) {\\n+          \u003cspan class=\\\"code-keyword\\\"\u003ereturn\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003etrue\u003c\\/span\u003e;\\n+        } \u003cspan class=\\\"code-keyword\\\"\u003eelse\u003c\\/span\u003e {\\n+          \u003cspan class=\\\"code-object\\\"\u003eThread\u003c\\/span\u003e.sleep(500);\\n+        }\\n+      }\\n+\\n+    } \u003cspan class=\\\"code-keyword\\\"\u003ecatch\u003c\\/span\u003e (Exception e) {\\n+      log.error(\u003cspan class=\\\"code-quote\\\"\u003e\\\"Exception when wait \u003cspan class=\\\"code-keyword\\\"\u003efor\u003c\\/span\u003e replicas in sync with master\\\"\u003c\\/span\u003e);\\n+    } \u003cspan class=\\\"code-keyword\\\"\u003efinally\u003c\\/span\u003e {\\n+      \u003cspan class=\\\"code-keyword\\\"\u003etry\u003c\\/span\u003e {\\n+        \u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (leaderClient != \u003cspan class=\\\"code-keyword\\\"\u003enull\u003c\\/span\u003e) leaderClient.close();\\n+      } \u003cspan class=\\\"code-keyword\\\"\u003ecatch\u003c\\/span\u003e (IOException e) {\\n+        e.printStackTrace();\\n+      }\\n+    }\\n+\\n+    \u003cspan class=\\\"code-keyword\\\"\u003ereturn\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003efalse\u003c\\/span\u003e;\\n+  }\\n\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003eIn many cases in the tests the leader will change before the replication happens, right? Does it make sense to discover the leader inside of the loop? Also, is there a way to remove that Thread.sleep(1000) at the beginning? This code will be called very frequently in tests.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15815930_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15815930_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 19:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T19:29:13+0000\'\u003e10\\/Jan\\/17 19:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Great idea! just took a quick look at the patch to understand this better. I have a couple of questions\\/comments, I know this is work in progress, so feel free to disregard any of my comments if you are working on them: \\n\\n  \\n onlyLeaderIndexes = zkStateReader.getClusterState().getCollection(collection).getLiveReplicas() == 1;\\n \\n  \\n Maybe add a method to DocCollection like  isOnlyLeaderIndexes()  (or choose other name)? I understand why you did this, but this code is repeated many times, maybe can be improved for now. \\n\\n  \\n  private  Map&lt; String , ReplicateFromLeader&gt; replicateFromLeaders =  new  HashMap&lt;&gt;();\\n \\n  \\n Does this need to be synchronized? \\n\\n  \\n -   private   final   String  masterUrl;\\n+   private   String  masterUrl;\\n \\n  \\n should  masterUrl  now be volatile? \\n\\n  \\n +   public   static   boolean  waitForInSyncWithLeader(SolrCore core, Replica leaderReplica)  throws  InterruptedException {\\n+     if  (waitForReplicasInSync ==  null )  return   true ;\\n+\\n+    Pair&lt; Boolean , Integer &gt; pair = parseValue(waitForReplicasInSync);\\n+     boolean  enabled = pair.first();\\n+     if  (!enabled)  return   true ;\\n+\\n+     Thread .sleep(1000);\\n+    HttpSolrClient leaderClient =  new  HttpSolrClient.Builder(leaderReplica.getCoreUrl()).build();\\n+     long  leaderVersion = -1;\\n+     String  localVersion =  null ;\\n+     try  {\\n+       for  ( int  i = 0; i &lt; pair.second(); i++) {\\n+         if  (core.isClosed())  return   true ;\\n+        ModifiableSolrParams params =  new  ModifiableSolrParams();\\n+        params.set(CommonParams.QT, ReplicationHandler.PATH);\\n+        params.set(COMMAND, CMD_DETAILS);\\n+\\n+        NamedList&lt; Object &gt; response = leaderClient.request( new  QueryRequest(params));\\n+        leaderVersion = ( long ) ((NamedList)response.get( \\\"details\\\" )).get( \\\"indexVersion\\\" );\\n+\\n+        localVersion = core.getDeletionPolicy().getLatestCommit().getUserData().get(SolrIndexWriter.COMMIT_TIME_MSEC_KEY);\\n+         if  (localVersion ==  null  &amp;&amp; leaderVersion == 0)  return   true ;\\n+\\n+         if  (localVersion !=  null  &amp;&amp;  Long .parseLong(localVersion) == leaderVersion) {\\n+           return   true ;\\n+        }  else  {\\n+           Thread .sleep(500);\\n+        }\\n+      }\\n+\\n+    }  catch  (Exception e) {\\n+      log.error( \\\"Exception when wait  for  replicas in sync with master\\\" );\\n+    }  finally  {\\n+       try  {\\n+         if  (leaderClient !=  null ) leaderClient.close();\\n+      }  catch  (IOException e) {\\n+        e.printStackTrace();\\n+      }\\n+    }\\n+\\n+     return   false ;\\n+  }\\n\\n \\n  \\n In many cases in the tests the leader will change before the replication happens, right? Does it make sense to discover the leader inside of the loop? Also, is there a way to remove that Thread.sleep(1000) at the beginning? This code will be called very frequently in tests.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15816241\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15816241&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15816241\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15816241_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816241_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 21:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T21:28:59+0000\'\u003e10\\/Jan\\/17 21:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eMaybe add a method to DocCollection like isOnlyLeaderIndexes() (or choose other name)? \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003ehow about \u003ctt\u003egetLiveReplicasCount()\u003c\\/tt\u003e ?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15816241_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816241_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 21:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T21:28:59+0000\'\u003e10\\/Jan\\/17 21:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Maybe add a method to DocCollection like isOnlyLeaderIndexes() (or choose other name)?   \\n\\n how about  getLiveReplicasCount()  ?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15816283\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15816283&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15816283\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15816283_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816283_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 21:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T21:44:59+0000\'\u003e10\\/Jan\\/17 21:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m just saying, we use the count to detect the mode, and everywhere we are getting the count and inferring the mode depending on the count (count==1 -&gt; onlyLeaderIndexes, count==-1 -&gt; default mode), Instead of that, lets put that logic inside of the DocCollection and ask it for the mode. Anyway, this is not too important, just a suggestion. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15816283_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816283_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 21:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T21:44:59+0000\'\u003e10\\/Jan\\/17 21:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m just saying, we use the count to detect the mode, and everywhere we are getting the count and inferring the mode depending on the count (count==1 -&gt; onlyLeaderIndexes, count==-1 -&gt; default mode), Instead of that, lets put that logic inside of the DocCollection and ask it for the mode. Anyway, this is not too important, just a suggestion.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15816535\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15816535&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15816535\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yriveiro\\\" id=\\\"commentauthor_15816535_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yriveiro\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yriveiro\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yago Riveiro\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816535_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 23:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T23:32:09+0000\'\u003e10\\/Jan\\/17 23:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003ehow about getLiveReplicasCount() ?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIf I\'m reading the code and found a method called getLiveReplicasCount(), I expected that return the number of live replicas for a shard, and if the only value that can return is 1 for onlyLeaderIndexes and -1 for the rest is not a good name.\u003c\\/p\u003e\\n\\n\u003cp\u003eSomething like: \u003ctt\u003ezkStateReader.getClusterState().getCollection(collection).getReplicationMode()\u003c\\/tt\u003e that returns an enum(ONLY_LEADER_INDEXES, ALL_REPLICAS_INDEXES) or something like that.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yriveiro\\\" id=\\\"commentauthor_15816535_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yriveiro\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yriveiro\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yago Riveiro\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816535_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 23:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T23:32:09+0000\'\u003e10\\/Jan\\/17 23:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     how about getLiveReplicasCount() ?  \\n\\n If I\'m reading the code and found a method called getLiveReplicasCount(), I expected that return the number of live replicas for a shard, and if the only value that can return is 1 for onlyLeaderIndexes and -1 for the rest is not a good name. \\n\\n Something like:  zkStateReader.getClusterState().getCollection(collection).getReplicationMode()  that returns an enum(ONLY_LEADER_INDEXES, ALL_REPLICAS_INDEXES) or something like that. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15816564\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15816564&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15816564\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15816564_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816564_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 23:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T23:48:21+0000\'\u003e10\\/Jan\\/17 23:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIt will have a proper count in the future. A mixed mode has to be there eventually. Enum can\'t accommodate that\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15816564_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816564_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 23:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T23:48:21+0000\'\u003e10\\/Jan\\/17 23:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    It will have a proper count in the future. A mixed mode has to be there eventually. Enum can\'t accommodate that              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15816584\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15816584&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15816584\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15816584_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816584_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 23:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T23:58:29+0000\'\u003e10\\/Jan\\/17 23:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAs I said, I understand the reason why it was done this way, but the code right now is only using the count to identify the mode. In the future, the count alone won\'t be enough in any of those sections to determine what to do, you\'ll have to identify the mode first and then take some more actions (e.g. Am I in the list of replicas that index or not?). \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15816584_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816584_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Jan\\/17 23:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-10T23:58:29+0000\'\u003e10\\/Jan\\/17 23:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    As I said, I understand the reason why it was done this way, but the code right now is only using the count to identify the mode. In the future, the count alone won\'t be enough in any of those sections to determine what to do, you\'ll have to identify the mode first and then take some more actions (e.g. Am I in the list of replicas that index or not?).               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15816918\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15816918&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15816918\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15816918_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816918_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/17 02:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-11T02:35:19+0000\'\u003e11\\/Jan\\/17 02:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks a lot for your comments!\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eMaybe add a method to DocCollection like \u003ctt\u003eisOnlyLeaderIndexes()\u003c\\/tt\u003e\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eAs you know, we won\'t use \u003ctt\u003eisOnlyLeaderIndexes()\u003c\\/tt\u003e in the future ( it won\'t have enough information ), so I just do not want to add a public method on DocCollection ( solrj ) and remove it in the future.\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eDoes this need to be synchronized?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eYeah, I think we should.\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eshould masterUrl now be volatile?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eI don\'t see any reason why we need masterUrl to be volatile? IndexFetcher instance is not being shared across threads.\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eIn many cases in the tests the leader will change before the replication happens, right? Does it make sense to discover the leader inside of the loop? Also, is there a way to remove that Thread.sleep(1000) at the beginning? This code will be called very frequently in tests.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eThat\'s a good idea.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15816918_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816918_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/17 02:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-11T02:35:19+0000\'\u003e11\\/Jan\\/17 02:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks a lot for your comments! \\n\\n  Maybe add a method to DocCollection like  isOnlyLeaderIndexes()   \\n As you know, we won\'t use  isOnlyLeaderIndexes()  in the future ( it won\'t have enough information ), so I just do not want to add a public method on DocCollection ( solrj ) and remove it in the future. \\n  Does this need to be synchronized?  \\n Yeah, I think we should. \\n  should masterUrl now be volatile?  \\n I don\'t see any reason why we need masterUrl to be volatile? IndexFetcher instance is not being shared across threads. \\n  In many cases in the tests the leader will change before the replication happens, right? Does it make sense to discover the leader inside of the loop? Also, is there a way to remove that Thread.sleep(1000) at the beginning? This code will be called very frequently in tests.  \\n That\'s a good idea. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15816951\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15816951&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15816951\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15816951_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816951_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/17 02:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-11T02:49:11+0000\'\u003e11\\/Jan\\/17 02:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eI don\'t see any reason why we need masterUrl to be volatile? IndexFetcher instance is not being shared across threads.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eIsn\'t it being used by the ReplicationHandler? Different requests would use the same instance from different threads, right? \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15816951_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816951_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/17 02:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-11T02:49:11+0000\'\u003e11\\/Jan\\/17 02:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     I don\'t see any reason why we need masterUrl to be volatile? IndexFetcher instance is not being shared across threads.  \\n Isn\'t it being used by the ReplicationHandler? Different requests would use the same instance from different threads, right?               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15816959\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15816959&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15816959\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15816959_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816959_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/17 02:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-11T02:52:09+0000\'\u003e11\\/Jan\\/17 02:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI created a new ReplicationHandler to do the replication process, so it will not use the same instance from different threads.\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003ereplicationProcess = \u003cspan class=\\\"code-keyword\\\"\u003enew\u003c\\/span\u003e ReplicationHandler();\\nreplicationProcess.init(replicationConfig);\\nreplicationProcess.inform(core);\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15816959_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15816959_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jan\\/17 02:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-11T02:52:09+0000\'\u003e11\\/Jan\\/17 02:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I created a new ReplicationHandler to do the replication process, so it will not use the same instance from different threads. \\n  \\n replicationProcess =  new  ReplicationHandler();\\nreplicationProcess.init(replicationConfig);\\nreplicationProcess.inform(core);\\n \\n               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15820080\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15820080&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15820080\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15820080_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15820080_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Jan\\/17 03:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-12T03:49:34+0000\'\u003e12\\/Jan\\/17 03:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Cao Manh Dat - 12\\/Jan\\/17 03:50\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated patch for this issue :\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eRemove \u003ctt\u003eUpdateCommand.NOTICE_INDEXWRITER\u003c\\/tt\u003e flag by not replaying buffer log if the updates is not made to IW. This changes help the patch more compact\u003c\\/li\u003e\\n\\t\u003cli\u003eWhen replica recover,\\n\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\u003cli\u003ereplica won\'t apply buffer updates\u003c\\/li\u003e\\n\\t\\t\u003cli\u003efix bug: RTG support for buffering updates ( along with test )\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\\t\u003cli\u003e\u003ctt\u003eZkController.replicateFromLeaders\u003c\\/tt\u003e is thread-safe now\u003c\\/li\u003e\\n\\t\u003cli\u003eWhen cluster restart, only leaders should call \u003ctt\u003eulog.recoverFromLog()\u003c\\/tt\u003e, tested by TestCloudRecovery\u003c\\/li\u003e\\n\\t\u003cli\u003e\u003ctt\u003eOnlyLeaderIndexesTest\u003c\\/tt\u003e\\n\\t\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\\t\u003cli\u003etest for RTG\u003c\\/li\u003e\\n\\t\\t\u003cli\u003etest for replicas are consistent\u003c\\/li\u003e\\n\\t\\t\u003cli\u003emore test for replica recovery\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\\t\u003cli\u003eMore tests and fixed bugs\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eI will try to write more tests for all possible cases during Replica Recovery and Leader Election. Hoping that I can find more bugs by doing this.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15820080_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15820080_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Jan\\/17 03:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-12T03:49:34+0000\'\u003e12\\/Jan\\/17 03:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Cao Manh Dat - 12\\/Jan\\/17 03:50\\\"\u003eedited\u003c\\/span\u003e                   Updated patch for this issue : \\n \\n\\t Remove  UpdateCommand.NOTICE_INDEXWRITER  flag by not replaying buffer log if the updates is not made to IW. This changes help the patch more compact \\n\\t When replica recover,\\n\\t \\n\\t\\t replica won\'t apply buffer updates \\n\\t\\t fix bug: RTG support for buffering updates ( along with test ) \\n\\t \\n\\t \\n\\t  ZkController.replicateFromLeaders  is thread-safe now \\n\\t When cluster restart, only leaders should call  ulog.recoverFromLog() , tested by TestCloudRecovery \\n\\t  OnlyLeaderIndexesTest \\n\\t \\n\\t\\t test for RTG \\n\\t\\t test for replicas are consistent \\n\\t\\t more test for replica recovery \\n\\t \\n\\t \\n\\t More tests and fixed bugs \\n \\n\\n\\n I will try to write more tests for all possible cases during Replica Recovery and Leader Election. Hoping that I can find more bugs by doing this.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15821813\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15821813&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15821813\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15821813_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15821813_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Jan\\/17 14:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-13T14:01:54+0000\'\u003e13\\/Jan\\/17 14:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis is my final patch, cleanup to make the patch more robust. ( all related tests are passed, included jepsen tests ).\u003cbr\\/\u003e\\n\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\" class=\\\"user-hover\\\" rel=\\\"shalinmangar\\\"\u003eShalin Shekhar Mangar\u003c\\/a\u003e Can you review this patch?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15821813_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15821813_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Jan\\/17 14:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-13T14:01:54+0000\'\u003e13\\/Jan\\/17 14:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This is my final patch, cleanup to make the patch more robust. ( all related tests are passed, included jepsen tests ). \\n Shalin Shekhar Mangar  Can you review this patch?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15822697\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15822697&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15822697\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15822697_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15822697_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jan\\/17 05:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-14T05:36:00+0000\'\u003e14\\/Jan\\/17 05:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Dat. I have started reviewing your patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15822697_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15822697_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jan\\/17 05:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-14T05:36:00+0000\'\u003e14\\/Jan\\/17 05:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Dat. I have started reviewing your patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15850983\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15850983&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15850983\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15850983_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15850983_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Feb\\/17 02:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-03T02:58:01+0000\'\u003e03\\/Feb\\/17 02:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated patch to latest source.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15850983_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15850983_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Feb\\/17 02:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-03T02:58:01+0000\'\u003e03\\/Feb\\/17 02:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated patch to latest source.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15865297\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15865297&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15865297\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15865297_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15865297_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/17 07:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-14T07:47:14+0000\'\u003e14\\/Feb\\/17 07:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated patch, resolve the potential problem with \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-5944\\\" title=\\\"Support updates of numeric DocValues\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-5944\\\"\u003e\u003cdel\u003eSOLR-5944\u003c\\/del\u003e\u003c\\/a\u003e. \u003cbr\\/\u003e\\nIn this patch, updates is being sorted before applying when a replica become new leader.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15865297_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15865297_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/17 07:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-14T07:47:14+0000\'\u003e14\\/Feb\\/17 07:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated patch, resolve the potential problem with   SOLR-5944  .  \\nIn this patch, updates is being sorted before applying when a replica become new leader.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15869050\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15869050&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15869050\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15869050_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15869050_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/17 03:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-16T03:14:36+0000\'\u003e16\\/Feb\\/17 03:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated patch, change \u003ctt\u003eliveReplicas\u003c\\/tt\u003e to \u003ctt\u003erealtimeReplicas\u003c\\/tt\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15869050_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15869050_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/17 03:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-16T03:14:36+0000\'\u003e16\\/Feb\\/17 03:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated patch, change  liveReplicas  to  realtimeReplicas               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15879022\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15879022&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15879022\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15879022_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15879022_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/17 19:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-22T19:24:18+0000\'\u003e22\\/Feb\\/17 19:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Dat. Sorry it took me a while to finish reviewing. A few questions\\/comments\u003c\\/p\u003e\\n\\n\u003col\u003e\\n\\t\u003cli\u003eLeaderInitiatedRecoveryThread &#8211; What is the reason behind adding SocketTimeoutException in the list of communication errors on which no more retries are made?\u003c\\/li\u003e\\n\\t\u003cli\u003eZkController.register method &#8211; The condition for !isLeader &amp;&amp; onlyLeaderIndexes can be replaced by the isReplicaInOnlyLeaderIndexes variable.\u003c\\/li\u003e\\n\\t\u003cli\u003eSince there is no log replay on startup on replicas anymore, what if the replica is killed (which keeps its state as \'active\' in ZK) and then the cluster is restarted and the replica becomes leader candidate? If we do not replay the discarded log then it could lead to data loss?\u003c\\/li\u003e\\n\\t\u003cli\u003eUpdateLog &#8211; Can you please add javadocs outlining the motivation\\/purpose of the new methods such as copyOverBufferingUpdates and switchToNewTlog e.g. why does switchToNewTlog require copying over some updates from the old tlog?\u003c\\/li\u003e\\n\\t\u003cli\u003eIt seems that any commits that might be triggered explicitly by the user can interfere with the index replication. Suppose that a replication is in progress and a user explicitly calls commit which is distributed to all replicas, in such a case the tlogs will be rolled over and then when the ReplicateFromLeader calls switchToNewTlog(), the previous tlog may not have all the updates that should have been copied over. We should have a way to either disable explicit commits or protect against them on the replicas.\u003c\\/li\u003e\\n\\t\u003cli\u003eUpdateLog &#8211; why does copyOverBufferUpdates block updates while calling switchToNewTlog but ReplicateFromLeader doesn\'t? How are they both safe?\u003c\\/li\u003e\\n\\t\u003cli\u003eCan we add tests for testing CDCR and backup\\/restore with this new replication scheme?\u003c\\/li\u003e\\n\\t\u003cli\u003eZkController.startReplicationFromLeader &#8211; Using a ConcurrentHashMap is not enough to prevent two simultaneous replications from happening concurrently. You should use the atomic putIfAbsent to put a core to the map before starting replication.\u003c\\/li\u003e\\n\\t\u003cli\u003eAren\'t some of the guarantees of real-time-get are relaxed in this new mode especially around delete-by-queries which no longer apply on replicas? Can you please document them as a comment on the issue that we can transfer to the ref guide in future?\u003c\\/li\u003e\\n\u003c\\/ol\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15879022_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15879022_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/17 19:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-22T19:24:18+0000\'\u003e22\\/Feb\\/17 19:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Dat. Sorry it took me a while to finish reviewing. A few questions\\/comments \\n\\n \\n\\t LeaderInitiatedRecoveryThread &#8211; What is the reason behind adding SocketTimeoutException in the list of communication errors on which no more retries are made? \\n\\t ZkController.register method &#8211; The condition for !isLeader &amp;&amp; onlyLeaderIndexes can be replaced by the isReplicaInOnlyLeaderIndexes variable. \\n\\t Since there is no log replay on startup on replicas anymore, what if the replica is killed (which keeps its state as \'active\' in ZK) and then the cluster is restarted and the replica becomes leader candidate? If we do not replay the discarded log then it could lead to data loss? \\n\\t UpdateLog &#8211; Can you please add javadocs outlining the motivation\\/purpose of the new methods such as copyOverBufferingUpdates and switchToNewTlog e.g. why does switchToNewTlog require copying over some updates from the old tlog? \\n\\t It seems that any commits that might be triggered explicitly by the user can interfere with the index replication. Suppose that a replication is in progress and a user explicitly calls commit which is distributed to all replicas, in such a case the tlogs will be rolled over and then when the ReplicateFromLeader calls switchToNewTlog(), the previous tlog may not have all the updates that should have been copied over. We should have a way to either disable explicit commits or protect against them on the replicas. \\n\\t UpdateLog &#8211; why does copyOverBufferUpdates block updates while calling switchToNewTlog but ReplicateFromLeader doesn\'t? How are they both safe? \\n\\t Can we add tests for testing CDCR and backup\\/restore with this new replication scheme? \\n\\t ZkController.startReplicationFromLeader &#8211; Using a ConcurrentHashMap is not enough to prevent two simultaneous replications from happening concurrently. You should use the atomic putIfAbsent to put a core to the map before starting replication. \\n\\t Aren\'t some of the guarantees of real-time-get are relaxed in this new mode especially around delete-by-queries which no longer apply on replicas? Can you please document them as a comment on the issue that we can transfer to the ref guide in future? \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15879721\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15879721&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15879721\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15879721_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15879721_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Feb\\/17 02:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-23T02:09:38+0000\'\u003e23\\/Feb\\/17 02:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\" class=\\\"user-hover\\\" rel=\\\"shalinmangar\\\"\u003eShalin Shekhar Mangar\u003c\\/a\u003e!\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eLeaderInitiatedRecoveryThread \\u2013 What is the reason behind adding SocketTimeoutException in the list of communication errors on which no more retries are made?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eThis change come from a jepsen test. This bug is also affect current mode. I created another issue for this bug \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9913\\\" title=\\\"LIR should continue on SocketTimeoutException\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9913\\\"\u003eSOLR-9913\u003c\\/a\u003e. We can skip this change for this ticket.\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eZkController.register method \\u2013 The condition for !isLeader &amp;&amp; onlyLeaderIndexes can be replaced by the isReplicaInOnlyLeaderIndexes variable.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eYeah, that\'s right\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eSince there is no log replay on startup on replicas anymore, what if the replica is killed (which keeps its state as \'active\' in ZK) and then the cluster is restarted and the replica becomes leader candidate? If we do not replay the discarded log then it could lead to data loss?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eVery good catch, I try to resolve this problem.\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eUpdateLog \\u2013 Can you please add javadocs outlining the motivation\\/purpose of the new methods such as copyOverBufferingUpdates and switchToNewTlog e.g. why does switchToNewTlog require copying over some updates from the old tlog?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eSure!\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eIt seems that any commits that might be triggered explicitly by the user can interfere with the index replication. Suppose that a replication is in progress and a user explicitly calls commit which is distributed to all replicas, in such a case the tlogs will be rolled over and then when the ReplicateFromLeader calls switchToNewTlog(), the previous tlog may not have all the updates that should have been copied over. We should have a way to either disable explicit commits or protect against them on the replicas.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eI don\'t think so, switchToNewTlog() is based on commit version at lucene index level (\u003ctt\u003ecommit.getUserData().get(SolrIndexWriter.COMMIT_COMMAND_VERSION)\u003c\\/tt\u003e), so we will always roll over updates in right way.\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eUpdateLog \\u2013 why does copyOverBufferUpdates block updates while calling switchToNewTlog but ReplicateFromLeader doesn\'t? How are they both safe?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eGood catch I think we should blockUpdates in switchToNewTlog as well.\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eCan we add tests for testing CDCR and backup\\/restore with this new replication scheme?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eCDCR is very complex, I don\'t think we should support CDCR in this new replication mode now.\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eZkController.startReplicationFromLeader \\u2013 Using a ConcurrentHashMap is not enough to prevent two simultaneous replications from happening concurrently. You should use the atomic putIfAbsent to put a core to the map before starting replication.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eYeah, that\'s sounds a good idea.\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eAren\'t some of the guarantees of real-time-get are relaxed in this new mode especially around delete-by-queries which no longer apply on replicas? Can you please document them as a comment on the issue that we can transfer to the ref guide in future?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eI will update the ticket description now. Basically RTG is not consistency for DBQs\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15879721_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15879721_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Feb\\/17 02:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-23T02:09:38+0000\'\u003e23\\/Feb\\/17 02:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks  Shalin Shekhar Mangar ! \\n  LeaderInitiatedRecoveryThread \\u2013 What is the reason behind adding SocketTimeoutException in the list of communication errors on which no more retries are made?  \\n This change come from a jepsen test. This bug is also affect current mode. I created another issue for this bug  SOLR-9913 . We can skip this change for this ticket. \\n  ZkController.register method \\u2013 The condition for !isLeader &amp;&amp; onlyLeaderIndexes can be replaced by the isReplicaInOnlyLeaderIndexes variable.  \\n Yeah, that\'s right \\n  Since there is no log replay on startup on replicas anymore, what if the replica is killed (which keeps its state as \'active\' in ZK) and then the cluster is restarted and the replica becomes leader candidate? If we do not replay the discarded log then it could lead to data loss?  \\n Very good catch, I try to resolve this problem. \\n  UpdateLog \\u2013 Can you please add javadocs outlining the motivation\\/purpose of the new methods such as copyOverBufferingUpdates and switchToNewTlog e.g. why does switchToNewTlog require copying over some updates from the old tlog?  \\n Sure! \\n  It seems that any commits that might be triggered explicitly by the user can interfere with the index replication. Suppose that a replication is in progress and a user explicitly calls commit which is distributed to all replicas, in such a case the tlogs will be rolled over and then when the ReplicateFromLeader calls switchToNewTlog(), the previous tlog may not have all the updates that should have been copied over. We should have a way to either disable explicit commits or protect against them on the replicas.  \\n I don\'t think so, switchToNewTlog() is based on commit version at lucene index level ( commit.getUserData().get(SolrIndexWriter.COMMIT_COMMAND_VERSION) ), so we will always roll over updates in right way. \\n  UpdateLog \\u2013 why does copyOverBufferUpdates block updates while calling switchToNewTlog but ReplicateFromLeader doesn\'t? How are they both safe?  \\n Good catch I think we should blockUpdates in switchToNewTlog as well. \\n  Can we add tests for testing CDCR and backup\\/restore with this new replication scheme?  \\n CDCR is very complex, I don\'t think we should support CDCR in this new replication mode now. \\n  ZkController.startReplicationFromLeader \\u2013 Using a ConcurrentHashMap is not enough to prevent two simultaneous replications from happening concurrently. You should use the atomic putIfAbsent to put a core to the map before starting replication.  \\n Yeah, that\'s sounds a good idea. \\n  Aren\'t some of the guarantees of real-time-get are relaxed in this new mode especially around delete-by-queries which no longer apply on replicas? Can you please document them as a comment on the issue that we can transfer to the ref guide in future?  \\n I will update the ticket description now. Basically RTG is not consistency for DBQs              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15879841\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15879841&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15879841\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ichattopadhyaya\\\" id=\\\"commentauthor_15879841_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ichattopadhyaya\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ichattopadhyaya\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ishan Chattopadhyaya\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15879841_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Feb\\/17 04:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-23T04:38:09+0000\'\u003e23\\/Feb\\/17 04:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAlso, lets add a simple test to ensure that in-place updates work on a replica:\u003c\\/p\u003e\\n\u003col\u003e\\n\\t\u003cli\u003eIndex few documents to leader, including a full document with id=0.\u003c\\/li\u003e\\n\\t\u003cli\u003eCommit\u003c\\/li\u003e\\n\\t\u003cli\u003eIndex few more documents\u003c\\/li\u003e\\n\\t\u003cli\u003eCommit\u003c\\/li\u003e\\n\\t\u003cli\u003eUpdate id=0 document in-place\u003c\\/li\u003e\\n\\t\u003cli\u003eCommit\u003c\\/li\u003e\\n\\t\u003cli\u003eAssert that the document with id=0 has the same updated value in the leader and the replica.\u003c\\/li\u003e\\n\u003c\\/ol\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ichattopadhyaya\\\" id=\\\"commentauthor_15879841_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ichattopadhyaya\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ichattopadhyaya\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ishan Chattopadhyaya\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15879841_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Feb\\/17 04:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-23T04:38:09+0000\'\u003e23\\/Feb\\/17 04:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Also, lets add a simple test to ensure that in-place updates work on a replica: \\n \\n\\t Index few documents to leader, including a full document with id=0. \\n\\t Commit \\n\\t Index few more documents \\n\\t Commit \\n\\t Update id=0 document in-place \\n\\t Commit \\n\\t Assert that the document with id=0 has the same updated value in the leader and the replica. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15880130\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15880130&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15880130\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15880130_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15880130_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Feb\\/17 08:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-23T08:51:15+0000\'\u003e23\\/Feb\\/17 08:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eI don\'t think so, switchToNewTlog() is based on commit version at lucene index level (commit.getUserData().get(SolrIndexWriter.COMMIT_COMMAND_VERSION)), so we will always roll over updates in right way.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI understand that we use the commit version of the latest commit but the copyOverOldUpdates method only copies updates from the last tlog. If a hard commit happened between the time that we started replication and finished replication, the last tlog will not have all updates that should be copied over. Example:\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eLeader has the following tlog with these versions:\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003etlog0: 1,2,3,4,commit\u003c\\/li\u003e\\n\\t\\t\u003cli\u003etlog1: 5,6\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\\t\u003cli\u003eReplica has tlogs:\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003etlog0: 1,2,3,4,5\u003c\\/li\u003e\\n\\t\\t\u003cli\u003ereplication from leader starts\u003c\\/li\u003e\\n\\t\\t\u003cli\u003euser calls explicit commit on replica\u003c\\/li\u003e\\n\\t\\t\u003cli\u003etlog1: 6\u003c\\/li\u003e\\n\\t\\t\u003cli\u003ereplication completes and we call switchToNewTLog which copies over all versions greater than 4 from the last tlog\u003c\\/li\u003e\\n\\t\\t\u003cli\u003etlog2: 6\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eIn this case, the update with version 5 is lost and will no longer be available in case this replica becomes leader.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eCDCR is very complex, I don\'t think we should support CDCR in this new replication mode now.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eOkay, let\'s create a follow-up issue for this. CDCR is important enough that we must support it eventually. But I think backup\\/restore must be supported and tested.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15880130_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15880130_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Feb\\/17 08:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-23T08:51:15+0000\'\u003e23\\/Feb\\/17 08:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     I don\'t think so, switchToNewTlog() is based on commit version at lucene index level (commit.getUserData().get(SolrIndexWriter.COMMIT_COMMAND_VERSION)), so we will always roll over updates in right way.  \\n\\n I understand that we use the commit version of the latest commit but the copyOverOldUpdates method only copies updates from the last tlog. If a hard commit happened between the time that we started replication and finished replication, the last tlog will not have all updates that should be copied over. Example: \\n \\n\\t Leader has the following tlog with these versions:\\n\\t \\n\\t\\t tlog0: 1,2,3,4,commit \\n\\t\\t tlog1: 5,6 \\n\\t \\n\\t \\n\\t Replica has tlogs:\\n\\t \\n\\t\\t tlog0: 1,2,3,4,5 \\n\\t\\t replication from leader starts \\n\\t\\t user calls explicit commit on replica \\n\\t\\t tlog1: 6 \\n\\t\\t replication completes and we call switchToNewTLog which copies over all versions greater than 4 from the last tlog \\n\\t\\t tlog2: 6 \\n\\t \\n\\t \\n \\n\\n\\n In this case, the update with version 5 is lost and will no longer be available in case this replica becomes leader. \\n\\n  CDCR is very complex, I don\'t think we should support CDCR in this new replication mode now.  \\n\\n Okay, let\'s create a follow-up issue for this. CDCR is important enough that we must support it eventually. But I think backup\\/restore must be supported and tested.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15881765\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15881765&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15881765\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15881765_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15881765_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Feb\\/17 01:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-24T01:50:52+0000\'\u003e24\\/Feb\\/17 01:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated patch based on comments of \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\" class=\\\"user-hover\\\" rel=\\\"shalinmangar\\\"\u003eShalin Shekhar Mangar\u003c\\/a\u003e and \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=ichattopadhyaya\\\" class=\\\"user-hover\\\" rel=\\\"ichattopadhyaya\\\"\u003eIshan Chattopadhyaya\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003e2. ZkController.register method \\u2013 The condition for !isLeader &amp;&amp; onlyLeaderIndexes can be replaced by the isReplicaInOnlyLeaderIndexes variable.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eDone!\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003e3. Since there is no log replay on startup on replicas anymore, what if the replica is killed (which keeps its state as \'active\' in ZK) and then the cluster is restarted and the replica becomes leader candidate? If we do not replay the discarded log then it could lead to data loss?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eTo solve this problem, we call \u003ctt\u003ecopyOverOldUpdates\u003c\\/tt\u003e from the last recent tlog on startup.\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003e4. UpdateLog \\u2013 Can you please add javadocs outlining the motivation\\/purpose of the new methods such as copyOverBufferingUpdates and switchToNewTlog e.g. why does switchToNewTlog require copying over some updates from the old tlog?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eDone!\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003e6. UpdateLog \\u2013 why does copyOverBufferUpdates block updates while calling switchToNewTlog but ReplicateFromLeader doesn\'t? How are they both safe?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eBoth of them are blocking updates now.\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003e8. ZkController.startReplicationFromLeader \\u2013 Using a ConcurrentHashMap is not enough to prevent two simultaneous replications from happening concurrently. You should use the atomic putIfAbsent to put a core to the map before starting replication.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eDone!\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eAlso, lets add a simple test to ensure that in-place updates work on a replica\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI modified \u003ctt\u003eTestInPlaceUpdatesDistrib\u003c\\/tt\u003e to run in random mode. If the tests run on the new mode, we will skip some outOfOderDBQs tests.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15881765_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15881765_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Feb\\/17 01:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-24T01:50:52+0000\'\u003e24\\/Feb\\/17 01:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated patch based on comments of  Shalin Shekhar Mangar  and  Ishan Chattopadhyaya  \\n\\n  2. ZkController.register method \\u2013 The condition for !isLeader &amp;&amp; onlyLeaderIndexes can be replaced by the isReplicaInOnlyLeaderIndexes variable.  \\n Done! \\n  3. Since there is no log replay on startup on replicas anymore, what if the replica is killed (which keeps its state as \'active\' in ZK) and then the cluster is restarted and the replica becomes leader candidate? If we do not replay the discarded log then it could lead to data loss?  \\n To solve this problem, we call  copyOverOldUpdates  from the last recent tlog on startup. \\n  4. UpdateLog \\u2013 Can you please add javadocs outlining the motivation\\/purpose of the new methods such as copyOverBufferingUpdates and switchToNewTlog e.g. why does switchToNewTlog require copying over some updates from the old tlog?  \\n Done! \\n  6. UpdateLog \\u2013 why does copyOverBufferUpdates block updates while calling switchToNewTlog but ReplicateFromLeader doesn\'t? How are they both safe?  \\n Both of them are blocking updates now. \\n  8. ZkController.startReplicationFromLeader \\u2013 Using a ConcurrentHashMap is not enough to prevent two simultaneous replications from happening concurrently. You should use the atomic putIfAbsent to put a core to the map before starting replication.  \\n Done! \\n\\n  Also, lets add a simple test to ensure that in-place updates work on a replica  \\n\\n I modified  TestInPlaceUpdatesDistrib  to run in random mode. If the tests run on the new mode, we will skip some outOfOderDBQs tests.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15885586\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15885586&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15885586\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15885586_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15885586_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/17 11:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-27T11:06:32+0000\'\u003e27\\/Feb\\/17 11:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003col\u003e\\n\\t\u003cli\u003eDat, can you please add javadocs for all the new methods in UpdateLog?\u003c\\/li\u003e\\n\\t\u003cli\u003eI was looking into \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9706\\\" title=\\\"fetchIndex blocks incoming queries when issued on a replica in SolrCloud\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9706\\\"\u003eSOLR-9706\u003c\\/a\u003e and it applies to this patch too. However, the fix is easy because most of the corruption checks added by \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-6640\\\" title=\\\"Replication can cause index corruption.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-6640\\\"\u003e\u003cdel\u003eSOLR-6640\u003c\\/del\u003e\u003c\\/a\u003e aren\'t necessary in this new replication mode so we can safely skip them.\u003c\\/li\u003e\\n\u003c\\/ol\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_15885586_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15885586_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/17 11:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-27T11:06:32+0000\'\u003e27\\/Feb\\/17 11:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n\\t Dat, can you please add javadocs for all the new methods in UpdateLog? \\n\\t I was looking into  SOLR-9706  and it applies to this patch too. However, the fix is easy because most of the corruption checks added by   SOLR-6640   aren\'t necessary in this new replication mode so we can safely skip them. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15887477\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15887477&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15887477\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15887477_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15887477_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/17 07:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-28T07:37:36+0000\'\u003e28\\/Feb\\/17 07:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\" class=\\\"user-hover\\\" rel=\\\"shalinmangar\\\"\u003eShalin Shekhar Mangar\u003c\\/a\u003e sure,\u003cbr\\/\u003e\\nThis is the updated patch, that I added doc for all new public methods at \u003ctt\u003eUpdateLog\u003c\\/tt\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15887477_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15887477_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/17 07:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-02-28T07:37:36+0000\'\u003e28\\/Feb\\/17 07:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Shalin Shekhar Mangar  sure, \\nThis is the updated patch, that I added doc for all new public methods at  UpdateLog               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15893851\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15893851&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15893851\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15893851_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15893851_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Mar\\/17 07:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-03T07:21:37+0000\'\u003e03\\/Mar\\/17 07:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\" class=\\\"user-hover\\\" rel=\\\"shalinmangar\\\"\u003eShalin Shekhar Mangar\u003c\\/a\u003e Newest patch, ignore block introduced by \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-6640\\\" title=\\\"Replication can cause index corruption.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-6640\\\"\u003e\u003cdel\u003eSOLR-6640\u003c\\/del\u003e\u003c\\/a\u003e.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15893851_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15893851_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Mar\\/17 07:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-03T07:21:37+0000\'\u003e03\\/Mar\\/17 07:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Shalin Shekhar Mangar  Newest patch, ignore block introduced by   SOLR-6640  .              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15898427\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15898427&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15898427\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15898427_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15898427_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Mar\\/17 00:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-07T00:08:00+0000\'\u003e07\\/Mar\\/17 00:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\" class=\\\"user-hover\\\" rel=\\\"caomanhdat\\\"\u003eCao Manh Dat\u003c\\/a\u003e, I created \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-10233\\\" title=\\\"Add support for different replica types in Solr\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-10233\\\"\u003e\u003cdel\u003eSOLR-10233\u003c\\/del\u003e\u003c\\/a\u003e with some related work\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15898427_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15898427_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Mar\\/17 00:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-07T00:08:00+0000\'\u003e07\\/Mar\\/17 00:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Cao Manh Dat , I created   SOLR-10233   with some related work              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15898465\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15898465&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15898465\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15898465_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15898465_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Mar\\/17 00:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-07T00:38:05+0000\'\u003e07\\/Mar\\/17 00:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\" class=\\\"user-hover\\\" rel=\\\"tomasflobbe\\\"\u003eTom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e That sounds great. I will create a branch for this ticket and run some jenkins tests for the patch before committing.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15898465_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15898465_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Mar\\/17 00:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-07T00:38:05+0000\'\u003e07\\/Mar\\/17 00:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe  That sounds great. I will create a branch for this ticket and run some jenkins tests for the patch before committing.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15905479\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15905479&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15905479\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15905479_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15905479_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/17 17:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-10T17:52:53+0000\'\u003e10\\/Mar\\/17 17:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\" class=\\\"user-hover\\\" rel=\\\"caomanhdat\\\"\u003eCao Manh Dat\u003c\\/a\u003e, I do see some random failures in \u003ctt\u003eOnlyLeaderIndexesTest\u003c\\/tt\u003e when beasting, do you too?\u003cbr\\/\u003e\\nAlso, I noticed this code in the test\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e    \u003cspan class=\\\"code-keyword\\\"\u003etry\u003c\\/span\u003e {\\n      checkRTG(1, 1, cluster.getJettySolrRunners());\\n      fail(\u003cspan class=\\\"code-quote\\\"\u003e\\\"Doc1 is deleted but it\'s still exist\\\"\u003c\\/span\u003e);\\n    } \u003cspan class=\\\"code-keyword\\\"\u003ecatch\u003c\\/span\u003e (AssertionError e) {}\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003ewhich seems wrong\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15905479_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15905479_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/17 17:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-10T17:52:53+0000\'\u003e10\\/Mar\\/17 17:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Cao Manh Dat , I do see some random failures in  OnlyLeaderIndexesTest  when beasting, do you too? \\nAlso, I noticed this code in the test \\n  \\n      try  {\\n      checkRTG(1, 1, cluster.getJettySolrRunners());\\n      fail( \\\"Doc1 is deleted but it\'s still exist\\\" );\\n    }  catch  (AssertionError e) {}\\n \\n  \\n which seems wrong              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15905973\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15905973&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15905973\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15905973_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15905973_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/17 01:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-11T01:13:43+0000\'\u003e11\\/Mar\\/17 01:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e@tomasflobbe I also see the tests failed but in this line\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003echeckRTG(3,7, cluster.getJettySolrRunners());\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003eThe reason for that is LIR is being kicked off when we add document 7 ( \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9555\\\" title=\\\"Leader incorrectly publishes state for replica when it puts replica into LIR.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9555\\\"\u003e\u003cdel\u003eSOLR-9555\u003c\\/del\u003e\u003c\\/a\u003e ). But I don\'t think the code you mentioned is an error.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15905973_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15905973_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/17 01:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-11T01:13:43+0000\'\u003e11\\/Mar\\/17 01:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    @tomasflobbe I also see the tests failed but in this line \\n  \\n checkRTG(3,7, cluster.getJettySolrRunners());\\n \\n  \\n The reason for that is LIR is being kicked off when we add document 7 (   SOLR-9555   ). But I don\'t think the code you mentioned is an error.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15905980\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15905980&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15905980\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15905980_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15905980_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/17 01:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-11T01:24:02+0000\'\u003e11\\/Mar\\/17 01:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eThe reason for that is LIR is being kicked off when we add document 7 ( \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9555\\\" title=\\\"Leader incorrectly publishes state for replica when it puts replica into LIR.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9555\\\"\u003e\u003cdel\u003eSOLR-9555\u003c\\/del\u003e\u003c\\/a\u003e ). \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003eYes, saw that in my testing too\u003c\\/p\u003e\\n\u003cblockquote\u003e\u003cp\u003eBut I don\'t think the code you mentioned is an error.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cp\u003e\u003ctt\u003efail(\\\"Doc1 is deleted but it\'s still exist\\\")\u003c\\/tt\u003e will throw an \u003ctt\u003eAssertionError\u003c\\/tt\u003e if hit, but this code is swallowing that error\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_15905980_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15905980_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/17 01:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-11T01:24:02+0000\'\u003e11\\/Mar\\/17 01:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     The reason for that is LIR is being kicked off when we add document 7 (   SOLR-9555   ).   \\n Yes, saw that in my testing too \\n  But I don\'t think the code you mentioned is an error.  \\n  fail(\\\"Doc1 is deleted but it\'s still exist\\\")  will throw an  AssertionError  if hit, but this code is swallowing that error              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15905981\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15905981&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15905981\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15905981_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15905981_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/17 01:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-11T01:26:10+0000\'\u003e11\\/Mar\\/17 01:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThat\'s right. I will fix that problem today.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15905981_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15905981_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Mar\\/17 01:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-11T01:26:10+0000\'\u003e11\\/Mar\\/17 01:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    That\'s right. I will fix that problem today.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15923572\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15923572&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15923572\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15923572_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15923572_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/17 04:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-14T04:47:46+0000\'\u003e14\\/Mar\\/17 04:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLatest patch for this ticket. Will commit it soon.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_15923572_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15923572_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/17 04:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-14T04:47:46+0000\'\u003e14\\/Mar\\/17 04:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Latest patch for this ticket. Will commit it soon.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15923724\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15923724&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15923724\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15923724_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15923724_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/17 07:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-14T07:38:00+0000\'\u003e14\\/Mar\\/17 07:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 7830462d4b7da3acefff6353419e71cde62d5fee in lucene-solr\'s branch refs\\/heads\\/master from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\" class=\\\"user-hover\\\" rel=\\\"caomanhdat\\\"\u003eCao Manh Dat\u003c\\/a\u003e\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=7830462\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=7830462\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9835\\\" title=\\\"Create another replication mode for SolrCloud\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9835\\\"\u003e\u003cdel\u003eSOLR-9835\u003c\\/del\u003e\u003c\\/a\u003e: Create another replication mode for SolrCloud\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15923724_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15923724_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/17 07:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-14T07:38:00+0000\'\u003e14\\/Mar\\/17 07:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 7830462d4b7da3acefff6353419e71cde62d5fee in lucene-solr\'s branch refs\\/heads\\/master from  Cao Manh Dat  \\n[  https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=7830462  ] \\n\\n   SOLR-9835  : Create another replication mode for SolrCloud              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15923854\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15923854&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15923854\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15923854_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15923854_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/17 09:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-14T09:20:57+0000\'\u003e14\\/Mar\\/17 09:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 120274b451646ddd9e1de9e12a4904414f881c7c in lucene-solr\'s branch refs\\/heads\\/master from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\" class=\\\"user-hover\\\" rel=\\\"caomanhdat\\\"\u003eCao Manh Dat\u003c\\/a\u003e\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=120274b\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=120274b\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9835\\\" title=\\\"Create another replication mode for SolrCloud\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9835\\\"\u003e\u003cdel\u003eSOLR-9835\u003c\\/del\u003e\u003c\\/a\u003e: Update CHANGES.txt\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15923854_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15923854_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/17 09:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-14T09:20:57+0000\'\u003e14\\/Mar\\/17 09:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 120274b451646ddd9e1de9e12a4904414f881c7c in lucene-solr\'s branch refs\\/heads\\/master from  Cao Manh Dat  \\n[  https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=120274b  ] \\n\\n   SOLR-9835  : Update CHANGES.txt              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15923897\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15923897&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15923897\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_15923897_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15923897_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/17 09:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-14T09:54:43+0000\'\u003e14\\/Mar\\/17 09:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLooks like this broke the build? I compile errors about missing ZkController methods.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_15923897_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15923897_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/17 09:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-14T09:54:43+0000\'\u003e14\\/Mar\\/17 09:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Looks like this broke the build? I compile errors about missing ZkController methods.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15923899\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15923899&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15923899\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_15923899_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15923899_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/17 09:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-14T09:55:43+0000\'\u003e14\\/Mar\\/17 09:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNevermind, some local glitch. Got it cleaned up.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_15923899_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15923899_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/17 09:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-14T09:55:43+0000\'\u003e14\\/Mar\\/17 09:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Nevermind, some local glitch. Got it cleaned up.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15930253\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15930253&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15930253\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_15930253_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15930253_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Mar\\/17 16:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-17T16:30:06+0000\'\u003e17\\/Mar\\/17 16:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOnlyLeaderIndexesTest just failed for me. Seems like it fails sometimes for jenkins too:\u003cbr\\/\u003e\\n\u003ca href=\\\"https:\\/\\/jenkins.thetaphi.de\\/job\\/Lucene-Solr-master-Windows\\/6455\\/\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/jenkins.thetaphi.de\\/job\\/Lucene-Solr-master-Windows\\/6455\\/\u003c\\/a\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_15930253_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15930253_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Mar\\/17 16:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-17T16:30:06+0000\'\u003e17\\/Mar\\/17 16:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    OnlyLeaderIndexesTest just failed for me. Seems like it fails sometimes for jenkins too: \\n https:\\/\\/jenkins.thetaphi.de\\/job\\/Lucene-Solr-master-Windows\\/6455\\/               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15931066\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15931066&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15931066\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_15931066_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15931066_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Mar\\/17 05:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-18T05:23:52+0000\'\u003e18\\/Mar\\/17 05:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eYeah, I see this too. It doesn\'t beast too terribly though. I\'ll attach some fail logs.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_15931066_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15931066_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Mar\\/17 05:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-18T05:23:52+0000\'\u003e18\\/Mar\\/17 05:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Yeah, I see this too. It doesn\'t beast too terribly though. I\'ll attach some fail logs.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15932053\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15932053&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15932053\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15932053_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15932053_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Mar\\/17 01:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-20T01:22:05+0000\'\u003e20\\/Mar\\/17 01:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 4bc75dbf235145fad5ec1001004c663e15449523 in lucene-solr\'s branch refs\\/heads\\/master from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\" class=\\\"user-hover\\\" rel=\\\"caomanhdat\\\"\u003eCao Manh Dat\u003c\\/a\u003e\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=4bc75db\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=4bc75db\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9835\\\" title=\\\"Create another replication mode for SolrCloud\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9835\\\"\u003e\u003cdel\u003eSOLR-9835\u003c\\/del\u003e\u003c\\/a\u003e: Fix OnlyLeaderIndexesTest failure, inplace updates is not copied over properly\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15932053_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15932053_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Mar\\/17 01:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-20T01:22:05+0000\'\u003e20\\/Mar\\/17 01:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 4bc75dbf235145fad5ec1001004c663e15449523 in lucene-solr\'s branch refs\\/heads\\/master from  Cao Manh Dat  \\n[  https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=4bc75db  ] \\n\\n   SOLR-9835  : Fix OnlyLeaderIndexesTest failure, inplace updates is not copied over properly              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15942950\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15942950&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15942950\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15942950_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15942950_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Mar\\/17 09:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-27T09:44:33+0000\'\u003e27\\/Mar\\/17 09:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit d156aafd1d5cfda2d7b56e4c73c6ddee43d48e91 in lucene-solr\'s branch refs\\/heads\\/master from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\" class=\\\"user-hover\\\" rel=\\\"caomanhdat\\\"\u003eCao Manh Dat\u003c\\/a\u003e\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=d156aaf\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=d156aaf\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9835\\\" title=\\\"Create another replication mode for SolrCloud\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9835\\\"\u003e\u003cdel\u003eSOLR-9835\u003c\\/del\u003e\u003c\\/a\u003e: TestInjection.waitForInSyncWithLeader() should rely on commit point of searcher\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15942950_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15942950_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Mar\\/17 09:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-27T09:44:33+0000\'\u003e27\\/Mar\\/17 09:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit d156aafd1d5cfda2d7b56e4c73c6ddee43d48e91 in lucene-solr\'s branch refs\\/heads\\/master from  Cao Manh Dat  \\n[  https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=d156aaf  ] \\n\\n   SOLR-9835  : TestInjection.waitForInSyncWithLeader() should rely on commit point of searcher              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15943368\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15943368&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15943368\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15943368_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15943368_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Mar\\/17 14:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-27T14:36:19+0000\'\u003e27\\/Mar\\/17 14:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit cd66a5ff51b7a9ff55edaa9fb5d7df5af42707e4 in lucene-solr\'s branch refs\\/heads\\/master from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\" class=\\\"user-hover\\\" rel=\\\"shalinmangar\\\"\u003eShalin Shekhar Mangar\u003c\\/a\u003e\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=cd66a5f\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=cd66a5f\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9835\\\" title=\\\"Create another replication mode for SolrCloud\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9835\\\"\u003e\u003cdel\u003eSOLR-9835\u003c\\/del\u003e\u003c\\/a\u003e: Fixed precommit failure.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15943368_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15943368_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Mar\\/17 14:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-27T14:36:19+0000\'\u003e27\\/Mar\\/17 14:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit cd66a5ff51b7a9ff55edaa9fb5d7df5af42707e4 in lucene-solr\'s branch refs\\/heads\\/master from  Shalin Shekhar Mangar  \\n[  https:\\/\\/git-wip-us.apache.org\\/repos\\/asf?p=lucene-solr.git;h=cd66a5f  ] \\n\\n   SOLR-9835  : Fixed precommit failure.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15954328\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15954328&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15954328\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15954328_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15954328_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Apr\\/17 23:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-04-03T23:28:29+0000\'\u003e03\\/Apr\\/17 23:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ewill this be ported to 6x and what is the expected timeframe if so? Or will it just be a 7.0 feature?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15954328_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15954328_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Apr\\/17 23:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-04-03T23:28:29+0000\'\u003e03\\/Apr\\/17 23:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    will this be ported to 6x and what is the expected timeframe if so? Or will it just be a 7.0 feature?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15954479\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=15954479&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15954479\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ctargett\\\" id=\\\"commentauthor_15954479_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ctargett\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ctargett\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cassandra Targett\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15954479_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Apr\\/17 02:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-04-04T02:25:16+0000\'\u003e04\\/Apr\\/17 02:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003ewill this be ported to 6x and what is the expected timeframe if so? Or will it just be a 7.0 feature?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIn this comment to \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-10233\\\" title=\\\"Add support for different replica types in Solr\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-10233\\\"\u003e\u003cdel\u003eSOLR-10233\u003c\\/del\u003e\u003c\\/a\u003e: \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-10233?focusedCommentId=15901980&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15901980\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-10233?focusedCommentId=15901980&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15901980\u003c\\/a\u003e, Tom\\u00E1s notes that some API changes will be made in the course of developing that feature, and those changes will impact the work done on this issue already. Because of this, these changes will be kept on master for the time-being to avoid back-compat issues.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ctargett\\\" id=\\\"commentauthor_15954479_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ctargett\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ctargett\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cassandra Targett\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15954479_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Apr\\/17 02:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-04-04T02:25:16+0000\'\u003e04\\/Apr\\/17 02:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     will this be ported to 6x and what is the expected timeframe if so? Or will it just be a 7.0 feature?  \\n\\n In this comment to   SOLR-10233  :  https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-10233?focusedCommentId=15901980&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15901980 , Tom\\u00E1s notes that some API changes will be made in the course of developing that feature, and those changes will impact the work done on this issue already. Because of this, these changes will be kept on master for the time-being to avoid back-compat issues.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-16014895\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=16014895&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16014895\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_16014895_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_16014895_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/May\\/17 22:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-05-17T22:51:18+0000\'\u003e17\\/May\\/17 22:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\" class=\\\"user-hover\\\" rel=\\\"caomanhdat\\\"\u003eCao Manh Dat\u003c\\/a\u003e, I have a nocommit in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-10233\\\" title=\\\"Add support for different replica types in Solr\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-10233\\\"\u003e\u003cdel\u003eSOLR-10233\u003c\\/del\u003e\u003c\\/a\u003e related to a change you did as part of this Jira:\u003c\\/p\u003e\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e@@ -260,7 +263,7 @@ public class RecoveryStrategy extends Thread implements Closeable {\\n       UpdateRequest ureq = new UpdateRequest();\\n       ureq.setParams(new ModifiableSolrParams());\\n       ureq.getParams().set(DistributedUpdateProcessor.COMMIT_END_POINT, true);\\n-      ureq.getParams().set(UpdateParams.OPEN_SEARCHER, false);\\n+      ureq.getParams().set(UpdateParams.OPEN_SEARCHER, onlyLeaderIndexes);\\n       ureq.setAction(AbstractUpdateRequest.ACTION.COMMIT, false, true).process(\\n           client);\\n     }\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003eWhy do we need to open searcher in the leader when doing a commit on leader for recovery?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_16014895_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_16014895_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/May\\/17 22:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-05-17T22:51:18+0000\'\u003e17\\/May\\/17 22:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Cao Manh Dat , I have a nocommit in   SOLR-10233   related to a change you did as part of this Jira: \\n  \\n @@ -260,7 +263,7 @@ public class RecoveryStrategy extends Thread implements Closeable {\\n       UpdateRequest ureq = new UpdateRequest();\\n       ureq.setParams(new ModifiableSolrParams());\\n       ureq.getParams().set(DistributedUpdateProcessor.COMMIT_END_POINT, true);\\n-      ureq.getParams().set(UpdateParams.OPEN_SEARCHER, false);\\n+      ureq.getParams().set(UpdateParams.OPEN_SEARCHER, onlyLeaderIndexes);\\n       ureq.setAction(AbstractUpdateRequest.ACTION.COMMIT, false, true).process(\\n           client);\\n     }\\n \\n  \\n Why do we need to open searcher in the leader when doing a commit on leader for recovery?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-16072965\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=16072965&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16072965\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_16072965_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_16072965_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jul\\/17 23:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-07-03T23:00:42+0000\'\u003e03\\/Jul\\/17 23:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eMarking this as resolved. Any extra related work should have it\'s own Jira.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"tomasflobbe\\\" id=\\\"commentauthor_16072965_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"tomasflobbe\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_16072965_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jul\\/17 23:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-07-03T23:00:42+0000\'\u003e03\\/Jul\\/17 23:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Marking this as resolved. Any extra related work should have it\'s own Jira.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-16082512\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-9835?focusedCommentId=16082512&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16082512\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_16082512_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_16082512_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jul\\/17 16:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-07-11T16:58:47+0000\'\u003e11\\/Jul\\/17 16:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=tomasflobbe\\\" class=\\\"user-hover\\\" rel=\\\"tomasflobbe\\\"\u003eTom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe\u003c\\/a\u003e!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"caomanhdat\\\" id=\\\"commentauthor_16082512_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=caomanhdat\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"caomanhdat\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Cao Manh Dat\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_16082512_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jul\\/17 16:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-07-11T16:58:47+0000\'\u003e11\\/Jul\\/17 16:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks  Tom\\u00E1s Fern\\u00E1ndez L\\u00F6bbe !              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310230";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/SOLR\\/summary\\\" title=\\\"Solr\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310230&amp;avatarId=22151\\\" alt=\\\"Solr\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/SOLR\\/summary\\\" title=\\\"Solr\\\"\u003eSolr\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1520342560907"> 
    <input type="hidden" title="jira.request.server.time" value="370"> 
    <input type="hidden" title="jira.request.id" value="802x97522653x13"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="9"> 
    <input type="hidden" title="db.reads.time.in.ms" value="60"> 
    <input type="hidden" title="db.conns.time.in.ms" value="68"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 802x97522653x13
	          REQUEST TIMESTAMP : [06/Mar/2018:13:22:40 +0000]
	               REQUEST TIME : 0.3700
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 9

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=53, elapsedTotal=60407979, elapsedMin=317335, elapsedMax=21201102, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=57, elapsedTotal=68443007, elapsedMin=333917, elapsedMax=21236185, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|b356c0c2ddcc74b31bc5602ffcf2d8934c2dffc7|lout"> 
  <link rel="shortcut icon" href="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"jira.instrumentation.laas\":false,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"com.atlassian.jira.issuetable.draggable\":true,\"jira.create.linked.issue\":true,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"jira.jql.suggestrecentfields\":false,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"jira.jql.smartautoselectfirst\":false,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.priorities.per.project\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"jira.renderer.consider.variable.format\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/vnd.wap.wbmp,image/png,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"cd2e101cff9478\"";
WRM._unparsedData["project-id"]="10594";
WRM._unparsedData["project-key"]="\"DERBY\"";
WRM._unparsedData["project-name"]="\"Derby\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="10594";
WRM._unparsedData["projectKey"]="\"DERBY\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/74ac580603ca910fff0cfdf319e54add-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/98ceb006e504d7924d5ffc411626c6bc-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/c1e4d26ea276469807c3dc0918df482c-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/6bf9253c8d533109c3b02e26794be24e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/ccd2e67b523185973473e8bd5735c8f9-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/33e5e0166867c8c9228d44506f60b2e8/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/6579b6b8ba67abaa496e39b9242a18a4-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="DERBY-1866"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[DERBY-1866] Assert failure in sane mode for queries that used to work in 10.1.2.1 - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[DERBY-1866] Assert failure in sane mode for queries that used to work in 10.1.2.1 - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/DERBY" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-1866">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="10594" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Derby'" src="https://issues.apache.org/jira/secure/projectavatar?pid=10594&amp;avatarId=10122"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/DERBY">Derby</a></li>
                 <li><a class="issue-link" data-issue-key="DERBY-1866" href="/jira/browse/DERBY-1866" id="key-val" rel="12350272">DERBY-1866</a></li>
                </ol>
                <h1 id="summary-val">Assert failure in sane mode for queries that used to work in 10.1.2.1</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-1866"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/DERBY-1866/DERBY-1866.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/DERBY-1866/DERBY-1866.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/DERBY-1866/DERBY-1866.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/DERBY-1866/DERBY-1866.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" title="Bug - A problem which impairs or prevents the functions of the product." width="16"> Bug </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="10.1.3.2 ">10.1.3.2</span>, <span title="10.1.3.3 Head of 10.1 branch. Maintenance version bump for sps update ">10.1.3.3</span>, <span title="10.2.1.6 ">10.2.1.6</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+fixVersion+%3D+10.1.3.3" title="10.1.3.3 Head of 10.1 branch. Maintenance version bump for sps update ">10.1.3.3</a>, <a href="/jira/issues/?jql=project+%3D+DERBY+AND+fixVersion+%3D+10.2.1.6" title="10.2.1.6 ">10.2.1.6</a>, <a href="/jira/issues/?jql=project+%3D+DERBY+AND+fixVersion+%3D+10.3.1.4" title="10.3.1.4 ">10.3.1.4</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+component+%3D+SQL" title="SQL ">SQL</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12350272-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310050" class="item"> 
                     <div class="wrap"> 
                      <strong title="Urgency" class="name">Urgency:</strong> 
                      <div id="customfield_12310050-val" class="value type-select" data-fieldtype="select" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        Normal 
                      </div> 
                     </div> </li> 
                    <li id="rowForcustomfield_12310200" class="item"> 
                     <div class="wrap"> 
                      <strong title="Bug behavior facts" class="name">Bug behavior facts:</strong> 
                      <div id="customfield_12310200-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310200-field"> 
                        <span>Regression</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>Derby-1777 gives a database and a small program called "ViewerInit" that prepares a bunch of large queries involving nested subqueries, unions, and join predicates. The actual bug described in <a href="https://issues.apache.org/jira/browse/DERBY-1777" title="Regression: query works in 10.1.2.1 but fails with NullPointerException in 10.2.1.1" class="issue-link" data-issue-key="DERBY-1777"><del>DERBY-1777</del></a> is an NPE, and that's what the patch for <a href="https://issues.apache.org/jira/browse/DERBY-1777" title="Regression: query works in 10.1.2.1 but fails with NullPointerException in 10.2.1.1" class="issue-link" data-issue-key="DERBY-1777"><del>DERBY-1777</del></a> addresses.</p> 
                  <p>However, once the NPEs are fixed, some of the queries in that same program now fail with ASSERT failures when running in SANE mode; this Jira issue is for addressing those assert failures.</p> 
                  <p>While this does constitute a regression, I don't know yet what the root cause of the problem is, so I hesitate to make it a 10.2 blocker--hence urgency is "Normal". I'm still investigating the queries to try to track down where the problem is, but all I've been able to deduce so far is that a) the assertion occurs for a scoped predicate and thus the pushing of join predicates into UNIONs is somehow involved, and b) in INSANE mode the query compiles without problem and appears (based on some early and very incomplete testing) to execute without problem. But more investigation is required to determine if the execution/results are actually correct, and to understand more about why the assertion is being thrown.</p> 
                  <p>I'm marking the fixin as 10.2.2.0 for now since I don't enough to make this a blocker for 10.2.1. Hopefully more info will be forthcoming...</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/DERBY-1866?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/DERBY-1866?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/DERBY-1866?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/DERBY-1866?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12341513" data-issue-id="12350272" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12341513/d1866_v1.patch" draggable="true" data-downloadurl="text/plain:d1866_v1.patch:https://issues.apache.org/jira/secure/attachment/12341513/d1866_v1.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12341513/d1866_v1.patch" title="Latest  24/Sep/06 23:32 - A B" draggable="true" data-downloadurl="text/plain:d1866_v1.patch:https://issues.apache.org/jira/secure/attachment/12341513/d1866_v1.patch">d1866_v1.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2006-09-24T23:32:37.000Z">24/Sep/06 23:32</time>
                   </dd>
                   <dd class="attachment-size">
                    18 kB
                   </dd>
                   <dd class="attachment-author">
                    A B
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12341143" data-issue-id="12350272" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12341143/derby.log" draggable="true" data-downloadurl="text/plain:derby.log:https://issues.apache.org/jira/secure/attachment/12341143/derby.log"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12341143/derby.log" title="Latest  19/Sep/06 18:35 - A B" draggable="true" data-downloadurl="text/plain:derby.log:https://issues.apache.org/jira/secure/attachment/12341143/derby.log">derby.log</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2006-09-19T18:35:02.000Z">19/Sep/06 18:35</time>
                   </dd>
                   <dd class="attachment-size">
                    10 kB
                   </dd>
                   <dd class="attachment-author">
                    A B
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12341246" data-issue-id="12350272" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12341246/repro.sql" draggable="true" data-downloadurl="text/x-sql:repro.sql:https://issues.apache.org/jira/secure/attachment/12341246/repro.sql"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12341246/repro.sql" title="Latest  21/Sep/06 02:12 - A B" draggable="true" data-downloadurl="text/x-sql:repro.sql:https://issues.apache.org/jira/secure/attachment/12341246/repro.sql">repro.sql</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2006-09-21T02:12:59.000Z">21/Sep/06 02:12</time>
                   </dd>
                   <dd class="attachment-size">
                    2 kB
                   </dd>
                   <dd class="attachment-author">
                    A B
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="relates to">
                   relates to
                  </dt> 
                  <dd id="internal-12348858_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" width="16" height="16" title="Bug - A problem which impairs or prevents the functions of the product." alt="Bug - A problem which impairs or prevents the functions of the product."> <span title="DERBY-1777: Regression: query works in 10.1.2.1 but fails with NullPointerException in 10.2.1.1"> <a href="/jira/browse/DERBY-1777" data-issue-key="DERBY-1777" class="issue-link link-title resolution">DERBY-1777</a> <span class="link-summary">Regression: query works in 10.1.2.1 but fails with NullPointerException in 10.2.1.1</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_army" rel="army" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;A B&quot;,&quot;emailAddress&quot;:&quot;qozinx@gmail.com&quot;,&quot;username&quot;:&quot;army&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="army"></span></span> A B </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_army" rel="army" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;A B&quot;,&quot;emailAddress&quot;:&quot;qozinx@gmail.com&quot;,&quot;username&quot;:&quot;army&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="army"></span></span> A B </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">0</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="19/Sep/06 18:26"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2006-09-19T18:26:12+0000">19/Sep/06 18:26</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="05/Jul/10 17:32"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2010-07-05T17:32:45+0000">05/Jul/10 17:32</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="02/Oct/06 16:08"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2006-10-02T16:08:20+0000">02/Oct/06 16:08</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-1866?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-1866?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-1866?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-1866?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-1866?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-1866?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-1866?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-1866?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/DERBY-1866?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-1866?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-1866?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/DERBY-1866?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-12435965\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12435965&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12435965\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12435965_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12435965_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Sep\\/06 18:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-19T18:35:02+0000\'\u003e19\\/Sep\\/06 18:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttaching a derby.log file that contains the ASSERT failure.  Note that the query in this case is slightly modified from one of the queries in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1777\\\" title=\\\"Regression: query works in 10.1.2.1 but fails with NullPointerException in 10.2.1.1\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1777\\\"\u003e\u003cdel\u003eDERBY-1777\u003c\\/del\u003e\u003c\\/a\u003e (the queries in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1777\\\" title=\\\"Regression: query works in 10.1.2.1 but fails with NullPointerException in 10.2.1.1\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1777\\\"\u003e\u003cdel\u003eDERBY-1777\u003c\\/del\u003e\u003c\\/a\u003e tend to take a very long time to compile; I shortened the query a bit and was still able to see the error).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12435965_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12435965_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Sep\\/06 18:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-19T18:35:02+0000\'\u003e19\\/Sep\\/06 18:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attaching a derby.log file that contains the ASSERT failure.  Note that the query in this case is slightly modified from one of the queries in   DERBY-1777   (the queries in   DERBY-1777   tend to take a very long time to compile; I shortened the query a bit and was still able to see the error).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12436420\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12436420&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12436420\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12436420_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436420_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 02:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T02:12:59+0000\'\u003e21\\/Sep\\/06 02:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eQuick update on where things are with this issue:\u003c\\/p\u003e\\n\\n\u003cp\u003e  1. I was (finally) able to come up with a quick and easy repro to \u003cbr\\/\u003e\\n    demonstrate the ASSERT failure in SANE mode.  I\'m attaching \u003cbr\\/\u003e\\n    a script, repro.sql, that can be run to show the failure.  The repro \u003cbr\\/\u003e\\n    script also contains another query that is very similar to the first, \u003cbr\\/\u003e\\n    but the second query appears to hang or otherwise run for a very, \u003cbr\\/\u003e\\n    very long time, even though it should execute in about a second\u003cbr\\/\u003e\\n     or so.\u003c\\/p\u003e\\n\\n\u003cp\u003e  2. With the repro attached to this issue, attempts to run in INSANE mode will\u003cbr\\/\u003e\\n     result in an IndexOutOfBounds error--so this issue does not just \\\"go away\\\"\u003cbr\\/\u003e\\n     in insane mode; it is a legitimate regression.\u003c\\/p\u003e\\n\\n\u003cp\u003e  3. Now the interesting thing: both of the repro queries SUCCEED as expected against\u003cbr\\/\u003e\\n     the 10.1 codeline.  This means that the failures are not part of the initial\u003cbr\\/\u003e\\n     optimizer work (\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-805\\\" title=\\\"Push join predicates into union and other set operations. DERBY-649 implemented scalar (single table) predicate pushdown. Adding join predicate push down could improve performance significantly.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-805\\\"\u003e\u003cdel\u003eDERBY-805\u003c\\/del\u003e\u003c\\/a\u003e) that went into 10.1, nor are they inherently caused\u003cbr\\/\u003e\\n     by any of the recent optimizer changes that have been ported back to 10.1\u003cbr\\/\u003e\\n     (namely, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1365\\\" title=\\\"Address potential problems with optimizer logic in some rarely-exercised code.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1365\\\"\u003e\u003cdel\u003eDERBY-1365\u003c\\/del\u003e\u003c\\/a\u003e, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1633\\\" title=\\\"Regression: The fields of views are not being calculated properly since 10.1.2.4\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1633\\\"\u003e\u003cdel\u003eDERBY-1633\u003c\\/del\u003e\u003c\\/a\u003e, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1681\\\" title=\\\"Regression (wrong results): Join predicate can be ignored for left-most child in a chain of nested unions.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1681\\\"\u003e\u003cdel\u003eDERBY-1681\u003c\\/del\u003e\u003c\\/a\u003e, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1777\\\" title=\\\"Regression: query works in 10.1.2.1 but fails with NullPointerException in 10.2.1.1\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1777\\\"\u003e\u003cdel\u003eDERBY-1777\u003c\\/del\u003e\u003c\\/a\u003e, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1315\\\" title=\\\"Statement optimization\\/compilation fails with OutOfMemoryException in largeCodeGen test  with embedded and framework DerbyNetClient\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1315\\\"\u003e\u003cdel\u003eDERBY-1315\u003c\\/del\u003e\u003c\\/a\u003e).\u003c\\/p\u003e\\n\\n\u003cp\u003e     The repro script passes against the 10.1.3 jars and against a fully-synced\u003cbr\\/\u003e\\n     10.1 codeline.  But it fails against the first 10.2 beta candidate and\u003cbr\\/\u003e\\n     all subsequent candidates; it also fails against the current 10.2 codeline\u003cbr\\/\u003e\\n     and the 10.3 trunk.\u003c\\/p\u003e\\n\\n\u003cp\u003e     So my natural deduction was that some other optimizer-related change has\u003cbr\\/\u003e\\n     been checked into 10.2 and 10.3 that is not in 10.1, and that\'s the cause\u003cbr\\/\u003e\\n     of the failure.  But after I applied all such changes (that I could think\u003cbr\\/\u003e\\n     of) to the 10.1 codeline, the repro scripts still pass in 10.1 and fail\u003cbr\\/\u003e\\n     in 10.2\\/10.3.  The patches I ported to 10.1 (locally) were \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1357\\\" title=\\\"Short-circuit logic in optimizer appears to be incorrect...\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1357\\\"\u003e\u003cdel\u003eDERBY-1357\u003c\\/del\u003e\u003c\\/a\u003e,\u003cbr\\/\u003e\\n     \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-781\\\" title=\\\"Materialize subqueries in select list where possible to avoid creating invariant resultsets many times.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-781\\\"\u003e\u003cdel\u003eDERBY-781\u003c\\/del\u003e\u003c\\/a\u003e, and \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-634\\\" title=\\\"Subquery materialization can cause stack overflow\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-634\\\"\u003e\u003cdel\u003eDERBY-634\u003c\\/del\u003e\u003c\\/a\u003e.  As far as I could tell based on a quick glance\u003cbr\\/\u003e\\n     at the 10.2 release notes, no other optimizer changes were made after the\u003cbr\\/\u003e\\n     10.1.3 release.  I also did a diff of the latest 10.1 trunk with the\u003cbr\\/\u003e\\n     latest 10.3 trunk bewteen the files that have been involved in the\u003cbr\\/\u003e\\n     recent optimizer work, and I couldn\'t see any diffs that might suggest\u003cbr\\/\u003e\\n     why the repro queries pass for 10.1 but fail for everything else.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m still investigating the bizarre behavior for #3.  If anyone offhand can think of any changes that are in 10.2\\/10.3 but not in 10.1 that might be responsible for these failures, I\'d certainly appreciate the help.  Right now I\'m planning to 1) go back through the release notes for 10.2 more carefully to see if I\'ve missed anything, and 2) make sure all of the patches applied cleanly when I ported them (locally) to 10.1; maybe something went wrong somewhere...?\u003c\\/p\u003e\\n\\n\u003cp\u003eIn any event, to run the repro, do the following:\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; java -Dderby.optimizer.noTimeout=true org.apache.derby.tools.ij\u003cbr\\/\u003e\\nij&gt; connect \'jdbc:derby:tstdb;create=true\';\u003cbr\\/\u003e\\nij&gt; run \'repro.sql\';\u003c\\/p\u003e\\n\\n\u003cp\u003eAgainst 10.2 and 10.3 you should see an ASSERT failure for the first query; if you comment out the first query, you should see an apparent hang for the second query.  But against 10.1, both queries run successfully and quickly (less than a second).\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12436420_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436420_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 02:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T02:12:59+0000\'\u003e21\\/Sep\\/06 02:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Quick update on where things are with this issue: \\n\\n   1. I was (finally) able to come up with a quick and easy repro to  \\n    demonstrate the ASSERT failure in SANE mode.  I\'m attaching  \\n    a script, repro.sql, that can be run to show the failure.  The repro  \\n    script also contains another query that is very similar to the first,  \\n    but the second query appears to hang or otherwise run for a very,  \\n    very long time, even though it should execute in about a second \\n     or so. \\n\\n   2. With the repro attached to this issue, attempts to run in INSANE mode will \\n     result in an IndexOutOfBounds error--so this issue does not just \\\"go away\\\" \\n     in insane mode; it is a legitimate regression. \\n\\n   3. Now the interesting thing: both of the repro queries SUCCEED as expected against \\n     the 10.1 codeline.  This means that the failures are not part of the initial \\n     optimizer work (  DERBY-805  ) that went into 10.1, nor are they inherently caused \\n     by any of the recent optimizer changes that have been ported back to 10.1 \\n     (namely,   DERBY-1365  ,   DERBY-1633  ,   DERBY-1681  ,   DERBY-1777  ,   DERBY-1315  ). \\n\\n      The repro script passes against the 10.1.3 jars and against a fully-synced \\n     10.1 codeline.  But it fails against the first 10.2 beta candidate and \\n     all subsequent candidates; it also fails against the current 10.2 codeline \\n     and the 10.3 trunk. \\n\\n      So my natural deduction was that some other optimizer-related change has \\n     been checked into 10.2 and 10.3 that is not in 10.1, and that\'s the cause \\n     of the failure.  But after I applied all such changes (that I could think \\n     of) to the 10.1 codeline, the repro scripts still pass in 10.1 and fail \\n     in 10.2\\/10.3.  The patches I ported to 10.1 (locally) were   DERBY-1357  , \\n       DERBY-781  , and   DERBY-634  .  As far as I could tell based on a quick glance \\n     at the 10.2 release notes, no other optimizer changes were made after the \\n     10.1.3 release.  I also did a diff of the latest 10.1 trunk with the \\n     latest 10.3 trunk bewteen the files that have been involved in the \\n     recent optimizer work, and I couldn\'t see any diffs that might suggest \\n     why the repro queries pass for 10.1 but fail for everything else. \\n\\n I\'m still investigating the bizarre behavior for #3.  If anyone offhand can think of any changes that are in 10.2\\/10.3 but not in 10.1 that might be responsible for these failures, I\'d certainly appreciate the help.  Right now I\'m planning to 1) go back through the release notes for 10.2 more carefully to see if I\'ve missed anything, and 2) make sure all of the patches applied cleanly when I ported them (locally) to 10.1; maybe something went wrong somewhere...? \\n\\n In any event, to run the repro, do the following: \\n\\n &gt; java -Dderby.optimizer.noTimeout=true org.apache.derby.tools.ij \\nij&gt; connect \'jdbc:derby:tstdb;create=true\'; \\nij&gt; run \'repro.sql\'; \\n\\n Against 10.2 and 10.3 you should see an ASSERT failure for the first query; if you comment out the first query, you should see an apparent hang for the second query.  But against 10.1, both queries run successfully and quickly (less than a second). \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12436522\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12436522&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12436522\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12436522_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436522_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 12:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T12:56:50+0000\'\u003e21\\/Sep\\/06 12:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOkay, forget about #3 above:\u003c\\/p\u003e\\n\\n\u003cp\u003eAfter a night\'s sleep it occurred to me why the repro \\\"passes\\\" in 10.1 but not in 10.2 or 10.3.  The reason is that the repro relies on behavior dictated by optimizer overrides (DERBY-PROPERTIES), but such overrides are not recognized in 10.1 and thus they are treated as SQL comments and are ignored.\u003c\\/p\u003e\\n\\n\u003cp\u003eI haven\'t tried it yet, but I imagine that if I ported the optimizer overrides patch to 10.1, the repro would fail there; similarly, if I remove the optimizer overrides from the repro queries, they will probably pass in 10.2 and 10.3.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo short story: we do have a legitimate regression, and now that we have a repro, I\'m working to find the problem...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12436522_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436522_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 12:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T12:56:50+0000\'\u003e21\\/Sep\\/06 12:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Okay, forget about #3 above: \\n\\n After a night\'s sleep it occurred to me why the repro \\\"passes\\\" in 10.1 but not in 10.2 or 10.3.  The reason is that the repro relies on behavior dictated by optimizer overrides (DERBY-PROPERTIES), but such overrides are not recognized in 10.1 and thus they are treated as SQL comments and are ignored. \\n\\n I haven\'t tried it yet, but I imagine that if I ported the optimizer overrides patch to 10.1, the repro would fail there; similarly, if I remove the optimizer overrides from the repro queries, they will probably pass in 10.2 and 10.3. \\n\\n So short story: we do have a legitimate regression, and now that we have a repro, I\'m working to find the problem...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12436559\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12436559&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12436559\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12436559_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436559_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 15:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T15:40:57+0000\'\u003e21\\/Sep\\/06 15:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for looking into this, Army. I have a couple comments:\u003c\\/p\u003e\\n\\n\u003cp\u003e1) What happens if you run the repro against an insane (e.g., production-ready) 10.2?\u003c\\/p\u003e\\n\\n\u003cp\u003e2) I\'m confused about whether this is a regression. It sound as though, if you could force the query plan in 10.1 (as you can in 10.2), then the bug would surface in 10.1 as well. From your description, this seems like a pre-existing bug which we are now able to script and (eventually) fix because of optimizer overrides.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12436559_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436559_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 15:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T15:40:57+0000\'\u003e21\\/Sep\\/06 15:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for looking into this, Army. I have a couple comments: \\n\\n 1) What happens if you run the repro against an insane (e.g., production-ready) 10.2? \\n\\n 2) I\'m confused about whether this is a regression. It sound as though, if you could force the query plan in 10.1 (as you can in 10.2), then the bug would surface in 10.1 as well. From your description, this seems like a pre-existing bug which we are now able to script and (eventually) fix because of optimizer overrides.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12436569\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12436569&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12436569\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12436569_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436569_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 16:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T16:02:52+0000\'\u003e21\\/Sep\\/06 16:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; 1) What happens if you run the repro against an insane (e.g., production-ready) 10.2? \u003c\\/p\u003e\\n\\n\u003cp\u003eThe result is an IndexOutOfBoundsException at execution time:\u003c\\/p\u003e\\n\\n\u003cp\u003eERROR 38000: The exception \'java.lang.ArrayIndexOutOfBoundsException: -1\' was thrown while evaluating an expression.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; 2) I\'m confused about whether this is a regression.\u003c\\/p\u003e\\n\\n\u003cp\u003eGood question, sorry for not being clear here.  This is a regression in the same way that \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1633\\\" title=\\\"Regression: The fields of views are not being calculated properly since 10.1.2.4\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1633\\\"\u003e\u003cdel\u003eDERBY-1633\u003c\\/del\u003e\u003c\\/a\u003e, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1781\\\" title=\\\"Process handles appear to be leaking in queries using an IN clause during concurrent DB access\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1781\\\"\u003e\u003cdel\u003eDERBY-1781\u003c\\/del\u003e\u003c\\/a\u003e, etc. are regressions: namely, queries used to work correctly at one point in 10.2, but then as a result of optimizer changes (esp. \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-805\\\" title=\\\"Push join predicates into union and other set operations. DERBY-649 implemented scalar (single table) predicate pushdown. Adding join predicate push down could improve performance significantly.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-805\\\"\u003e\u003cdel\u003eDERBY-805\u003c\\/del\u003e\u003c\\/a\u003e) they no longer work.  As it turns out, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-805\\\" title=\\\"Push join predicates into union and other set operations. DERBY-649 implemented scalar (single table) predicate pushdown. Adding join predicate push down could improve performance significantly.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-805\\\"\u003e\u003cdel\u003eDERBY-805\u003c\\/del\u003e\u003c\\/a\u003e was also ported back to 10.1.2.4 and thus the regressions also occur in the recent 10.1 codeline\\/release.  That\'s why the changes for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1633\\\" title=\\\"Regression: The fields of views are not being calculated properly since 10.1.2.4\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1633\\\"\u003e\u003cdel\u003eDERBY-1633\u003c\\/del\u003e\u003c\\/a\u003e, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1681\\\" title=\\\"Regression (wrong results): Join predicate can be ignored for left-most child in a chain of nested unions.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1681\\\"\u003e\u003cdel\u003eDERBY-1681\u003c\\/del\u003e\u003c\\/a\u003e, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1777\\\" title=\\\"Regression: query works in 10.1.2.1 but fails with NullPointerException in 10.2.1.1\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1777\\\"\u003e\u003cdel\u003eDERBY-1777\u003c\\/del\u003e\u003c\\/a\u003e, and \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1315\\\" title=\\\"Statement optimization\\/compilation fails with OutOfMemoryException in largeCodeGen test  with embedded and framework DerbyNetClient\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1315\\\"\u003e\u003cdel\u003eDERBY-1315\u003c\\/del\u003e\u003c\\/a\u003e have all been ported back to 10.1.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo if you define \\\"regression\\\" as \\\"worked in the latest 10.1 release but fails in 10.2\\\", then neither this nor any of the other issues were technically \\\"regressions\\\" for 10.2--because they all demonstrate bugs that exist in 10.1.3 and 10.2 alike.  But the truth is that the queries \u003cb\u003edid\u003c\\/b\u003e work in 10.1 and they \u003cb\u003edid\u003c\\/b\u003e work in 10.2 before the \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-805\\\" title=\\\"Push join predicates into union and other set operations. DERBY-649 implemented scalar (single table) predicate pushdown. Adding join predicate push down could improve performance significantly.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-805\\\"\u003e\u003cdel\u003eDERBY-805\u003c\\/del\u003e\u003c\\/a\u003e changes went in, and now they don\'t work in either.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; then the bug would surface in 10.1 as well. From your description, this seems like a \u003cbr\\/\u003e\\n&gt; pre-existing bug which we are now able to script and (eventually) fix because of\u003cbr\\/\u003e\\n&gt; optimizer overrides.\u003c\\/p\u003e\\n\\n\u003cp\u003eYes, \\\"pre-existing\\\" in 10.1 because the code that caused the regression was (unfortunately) ported back to 10.1, as well...\u003c\\/p\u003e\\n\\n\u003cp\u003eI can\'t seem to put it in the right words, but hopefully that makes more sense...?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12436569_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436569_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 16:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T16:02:52+0000\'\u003e21\\/Sep\\/06 16:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; 1) What happens if you run the repro against an insane (e.g., production-ready) 10.2?  \\n\\n The result is an IndexOutOfBoundsException at execution time: \\n\\n ERROR 38000: The exception \'java.lang.ArrayIndexOutOfBoundsException: -1\' was thrown while evaluating an expression. \\n\\n &gt; 2) I\'m confused about whether this is a regression. \\n\\n Good question, sorry for not being clear here.  This is a regression in the same way that   DERBY-1633  ,   DERBY-1781  , etc. are regressions: namely, queries used to work correctly at one point in 10.2, but then as a result of optimizer changes (esp.   DERBY-805  ) they no longer work.  As it turns out,   DERBY-805   was also ported back to 10.1.2.4 and thus the regressions also occur in the recent 10.1 codeline\\/release.  That\'s why the changes for   DERBY-1633  ,   DERBY-1681  ,   DERBY-1777  , and   DERBY-1315   have all been ported back to 10.1. \\n\\n So if you define \\\"regression\\\" as \\\"worked in the latest 10.1 release but fails in 10.2\\\", then neither this nor any of the other issues were technically \\\"regressions\\\" for 10.2--because they all demonstrate bugs that exist in 10.1.3 and 10.2 alike.  But the truth is that the queries  did  work in 10.1 and they  did  work in 10.2 before the   DERBY-805   changes went in, and now they don\'t work in either. \\n\\n &gt; then the bug would surface in 10.1 as well. From your description, this seems like a  \\n&gt; pre-existing bug which we are now able to script and (eventually) fix because of \\n&gt; optimizer overrides. \\n\\n Yes, \\\"pre-existing\\\" in 10.1 because the code that caused the regression was (unfortunately) ported back to 10.1, as well... \\n\\n I can\'t seem to put it in the right words, but hopefully that makes more sense...?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12436572\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12436572&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12436572\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12436572_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436572_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 16:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T16:12:20+0000\'\u003e21\\/Sep\\/06 16:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for the quick response, Army. Does this bug appear in the current 10.1.3 release?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12436572_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436572_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 16:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T16:12:20+0000\'\u003e21\\/Sep\\/06 16:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for the quick response, Army. Does this bug appear in the current 10.1.3 release?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12436581\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12436581&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12436581\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12436581_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436581_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 16:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T16:52:36+0000\'\u003e21\\/Sep\\/06 16:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; Does this bug appear in the current 10.1.3 release?\u003c\\/p\u003e\\n\\n\u003cp\u003eSince 10.1.3 doesn\'t have support for optimizer overrides, I can\'t run the repro against it to see.  I also can\'t run the original query from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1777\\\" title=\\\"Regression: query works in 10.1.2.1 but fails with NullPointerException in 10.2.1.1\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1777\\\"\u003e\u003cdel\u003eDERBY-1777\u003c\\/del\u003e\u003c\\/a\u003e because the other regressions (esp. \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1633\\\" title=\\\"Regression: The fields of views are not being calculated properly since 10.1.2.4\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1633\\\"\u003e\u003cdel\u003eDERBY-1633\u003c\\/del\u003e\u003c\\/a\u003e) haven\'t been fixed in the 10.1.3 release and thus will cause the query to fail before ever reaching the condition for this issue.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut even though I can\'t demonstrate it easily, I\'m pretty sure the answer is \\\"Yes\\\".  I tried to run the repro script with a set of 10.2 jars that was built before any of the \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-805\\\" title=\\\"Push join predicates into union and other set operations. DERBY-649 implemented scalar (single table) predicate pushdown. Adding join predicate push down could improve performance significantly.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-805\\\"\u003e\u003cdel\u003eDERBY-805\u003c\\/del\u003e\u003c\\/a\u003e\u003cdel\u003erelated changes went in (but after optimizer overrides were added) and the queries pass.  So the queries used to work in 10.2 and now they don\'t\u003c\\/del\u003e-and I\'d be very (pleasantly) surprised if the optimizer changes for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-805\\\" title=\\\"Push join predicates into union and other set operations. DERBY-649 implemented scalar (single table) predicate pushdown. Adding join predicate push down could improve performance significantly.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-805\\\"\u003e\u003cdel\u003eDERBY-805\u003c\\/del\u003e\u003c\\/a\u003e weren\'t somehow responsible.  Given that, the 805 changes were ported to 10.1 so I imagine the issue exists in the 10.1.3 release, as well (it\'s just hidden behind the other regressions that have since been resolved).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12436581_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436581_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 16:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T16:52:36+0000\'\u003e21\\/Sep\\/06 16:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; Does this bug appear in the current 10.1.3 release? \\n\\n Since 10.1.3 doesn\'t have support for optimizer overrides, I can\'t run the repro against it to see.  I also can\'t run the original query from   DERBY-1777   because the other regressions (esp.   DERBY-1633  ) haven\'t been fixed in the 10.1.3 release and thus will cause the query to fail before ever reaching the condition for this issue. \\n\\n But even though I can\'t demonstrate it easily, I\'m pretty sure the answer is \\\"Yes\\\".  I tried to run the repro script with a set of 10.2 jars that was built before any of the   DERBY-805   related changes went in (but after optimizer overrides were added) and the queries pass.  So the queries used to work in 10.2 and now they don\'t -and I\'d be very (pleasantly) surprised if the optimizer changes for   DERBY-805   weren\'t somehow responsible.  Given that, the 805 changes were ported to 10.1 so I imagine the issue exists in the 10.1.3 release, as well (it\'s just hidden behind the other regressions that have since been resolved).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12436630\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12436630&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12436630\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12436630_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436630_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 20:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T20:20:31+0000\'\u003e21\\/Sep\\/06 20:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks, Army. As I understand it, this bug exists in the 10.1.3 release. It seems that, as far as this bug is concerned, 10.2 is no worse than 10.1.3. For that reason, I would not be inclined to hold up the 10.2 release for this bug fix.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12436630_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436630_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 20:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T20:20:31+0000\'\u003e21\\/Sep\\/06 20:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks, Army. As I understand it, this bug exists in the 10.1.3 release. It seems that, as far as this bug is concerned, 10.2 is no worse than 10.1.3. For that reason, I would not be inclined to hold up the 10.2 release for this bug fix.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12436637\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12436637&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12436637\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12436637_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436637_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 20:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T20:43:33+0000\'\u003e21\\/Sep\\/06 20:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; As I understand it, this bug exists in the 10.1.3 release. It seems that, as far as this bug is\u003cbr\\/\u003e\\n&gt; concerned, 10.2 is no worse than 10.1.3. For that reason, I would not be inclined to hold up\u003cbr\\/\u003e\\n&gt; the 10.2 release for this bug fix.\u003c\\/p\u003e\\n\\n\u003cp\u003eTwo things:\u003c\\/p\u003e\\n\\n\u003cp\u003e  1. Are we going to mention the known issues (esp. regressions) that exist with the 10.2 release (aside from intentional behavioral changes) somewhere in the release notes?  I looked at the html file attached to \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1860\\\" title=\\\"Create release notes for 10.2\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1860\\\"\u003e\u003cdel\u003eDERBY-1860\u003c\\/del\u003e\u003c\\/a\u003e and didn\'t see any (the \\\"issues\\\" section just holds release notes for intentional behavior changes and\\/or fixes).  Are we just leaving it up to the users to navigate Jira to find outstanding issues like \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1866\\\" title=\\\"Assert failure in sane mode for queries that used to work in 10.1.2.1\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1866\\\"\u003e\u003cdel\u003eDERBY-1866\u003c\\/del\u003e\u003c\\/a\u003e?\u003c\\/p\u003e\\n\\n\u003cp\u003e  2. Just as a note, this reasoning for not holding up the release also applies to \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1777\\\" title=\\\"Regression: query works in 10.1.2.1 but fails with NullPointerException in 10.2.1.1\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1777\\\"\u003e\u003cdel\u003eDERBY-1777\u003c\\/del\u003e\u003c\\/a\u003e, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1633\\\" title=\\\"Regression: The fields of views are not being calculated properly since 10.1.2.4\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1633\\\"\u003e\u003cdel\u003eDERBY-1633\u003c\\/del\u003e\u003c\\/a\u003e, and \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1681\\\" title=\\\"Regression (wrong results): Join predicate can be ignored for left-most child in a chain of nested unions.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1681\\\"\u003e\u003cdel\u003eDERBY-1681\u003c\\/del\u003e\u003c\\/a\u003e, since all of those fail with 10.1.3 release, as well.  (Oh, and \u003cb\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1854\\\" title=\\\"SYSCS_COMPRESS_TABLE corrupts table with a single column which is both a primary key and a foreign key\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1854\\\"\u003e\u003cdel\u003eDERBY-1854\u003c\\/del\u003e\u003c\\/a\u003e\u003c\\/b\u003e, for that matter!)  Am I to understand that if any of those was still unresolved, we\'d go ahead with the release nonetheless?  I\'m not disagreeing with the decision, just curious if the \\\"it\'s no worse than &lt;previous release&gt;\\\" rule is specific to this particular Jira or if it applies on a more general scale?\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks for following through with this discussion and making a final decision!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12436637_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12436637_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Sep\\/06 20:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-21T20:43:33+0000\'\u003e21\\/Sep\\/06 20:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; As I understand it, this bug exists in the 10.1.3 release. It seems that, as far as this bug is \\n&gt; concerned, 10.2 is no worse than 10.1.3. For that reason, I would not be inclined to hold up \\n&gt; the 10.2 release for this bug fix. \\n\\n Two things: \\n\\n   1. Are we going to mention the known issues (esp. regressions) that exist with the 10.2 release (aside from intentional behavioral changes) somewhere in the release notes?  I looked at the html file attached to   DERBY-1860   and didn\'t see any (the \\\"issues\\\" section just holds release notes for intentional behavior changes and\\/or fixes).  Are we just leaving it up to the users to navigate Jira to find outstanding issues like   DERBY-1866  ? \\n\\n   2. Just as a note, this reasoning for not holding up the release also applies to   DERBY-1777  ,   DERBY-1633  , and   DERBY-1681  , since all of those fail with 10.1.3 release, as well.  (Oh, and    DERBY-1854   , for that matter!)  Am I to understand that if any of those was still unresolved, we\'d go ahead with the release nonetheless?  I\'m not disagreeing with the decision, just curious if the \\\"it\'s no worse than &lt;previous release&gt;\\\" rule is specific to this particular Jira or if it applies on a more general scale? \\n\\n Thanks for following through with this discussion and making a final decision!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12437266\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12437266&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12437266\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12437266_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12437266_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Sep\\/06 23:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-24T23:32:37+0000\'\u003e24\\/Sep\\/06 23:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttaching a first patch for this issue, d1866_v1.patch.  In short, the problem was that, when pushing predicates to subqueries beneath UNIONs, the predicates were always being pushed to the \u003cb\u003efirst\u003c\\/b\u003e table in the subquery\'s FROM list, regardless of whether or not that was actually the correct table.  Thus it was possible to push a predicate down to a base table to which it didn\'t apply, thereby leading to an assertion failure in sane mode and an index out of bounds exception in insane mode.\u003c\\/p\u003e\\n\\n\u003cp\u003eFor details on how this occurred and what the fix is, please refer to the code comments in the patch.  The d1866_v1 patch does the following:\u003c\\/p\u003e\\n\\n\u003cp\u003e  1. Adds logic to ensure scoped predicates are only pushed\u003cbr\\/\u003e\\n     to the appropriate base tables.\u003c\\/p\u003e\\n\\n\u003cp\u003e  2. Adds one line to OptimizerImpl to solve the hang that\u003cbr\\/\u003e\\n     was occuring for the second query shown in repro.sql.\u003cbr\\/\u003e\\n     The problem there was just that one variable was not\u003cbr\\/\u003e\\n     being properly reset when beginning a new round of\u003cbr\\/\u003e\\n     optimization.\u003c\\/p\u003e\\n\\n\u003cp\u003e  3. Adds some test cases to verify the changes for #1 and\u003cbr\\/\u003e\\n     #2.\u003c\\/p\u003e\\n\\n\u003cp\u003eNote that the patch is mostly just explanatory comments for existing and new logic, plus the test cases.\u003c\\/p\u003e\\n\\n\u003cp\u003eI ran derbyall on Red Hat Linux with ibm142 using sane jars and there were no new failures.  I also ran the full ViewerInit program attached to \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-1777\\\" title=\\\"Regression: query works in 10.1.2.1 but fails with NullPointerException in 10.2.1.1\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-1777\\\"\u003e\u003cdel\u003eDERBY-1777\u003c\\/del\u003e\u003c\\/a\u003e and the program ran to completion without error.  (Note that the queries took a very, very long time to compile, though (longest one took almost 40 minutes).  Unfortunate though that is, I think that\'s a separate and more general issue with Derby optimization of subqueries--one to be addressed further down the road...)\u003c\\/p\u003e\\n\\n\u003cp\u003eI would appreciate any reviews of this patch--even if it\'s just a quick read of the code comments to see if they make sense.  Every little bit helps, and as I\'m sure everyone knows by now, optimizer changes are especially worthy of multiple reviews by as many people as possible...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12437266_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12437266_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Sep\\/06 23:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-24T23:32:37+0000\'\u003e24\\/Sep\\/06 23:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attaching a first patch for this issue, d1866_v1.patch.  In short, the problem was that, when pushing predicates to subqueries beneath UNIONs, the predicates were always being pushed to the  first  table in the subquery\'s FROM list, regardless of whether or not that was actually the correct table.  Thus it was possible to push a predicate down to a base table to which it didn\'t apply, thereby leading to an assertion failure in sane mode and an index out of bounds exception in insane mode. \\n\\n For details on how this occurred and what the fix is, please refer to the code comments in the patch.  The d1866_v1 patch does the following: \\n\\n   1. Adds logic to ensure scoped predicates are only pushed \\n     to the appropriate base tables. \\n\\n   2. Adds one line to OptimizerImpl to solve the hang that \\n     was occuring for the second query shown in repro.sql. \\n     The problem there was just that one variable was not \\n     being properly reset when beginning a new round of \\n     optimization. \\n\\n   3. Adds some test cases to verify the changes for #1 and \\n     #2. \\n\\n Note that the patch is mostly just explanatory comments for existing and new logic, plus the test cases. \\n\\n I ran derbyall on Red Hat Linux with ibm142 using sane jars and there were no new failures.  I also ran the full ViewerInit program attached to   DERBY-1777   and the program ran to completion without error.  (Note that the queries took a very, very long time to compile, though (longest one took almost 40 minutes).  Unfortunate though that is, I think that\'s a separate and more general issue with Derby optimization of subqueries--one to be addressed further down the road...) \\n\\n I would appreciate any reviews of this patch--even if it\'s just a quick read of the code comments to see if they make sense.  Every little bit helps, and as I\'m sure everyone knows by now, optimizer changes are especially worthy of multiple reviews by as many people as possible...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12437916\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12437916&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12437916\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12437916_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12437916_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Sep\\/06 19:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-26T19:19:52+0000\'\u003e26\\/Sep\\/06 19:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI ran  a success full set of tests against this patch against windows XP and ibm 1.4.2. jvm.  I reviewed the changes and the extensive comments seemed to match up with what the code was doing.  Looked like good tests were being added for the problem.  I am no optimizer expert so I suggest at least one more reviewer before we consider moving this patch from the trunk to 10.2 codeline.  Am committing this to the trunk to get it more testing.\u003c\\/p\u003e\\n\\n\u003cp\u003eIf possible it would be good if anyone dependent on this change can test out the fix in the trunk and verify it works for\u003cbr\\/\u003e\\nthem.\u003c\\/p\u003e\\n\\n\u003cp\u003eI committed this to the trunk:\u003cbr\\/\u003e\\nm1_ibm142:5&gt;svn commit\u003c\\/p\u003e\\n\\n\u003cp\u003eSending        java\\\\engine\\\\org\\\\apache\\\\derby\\\\impl\\\\sql\\\\compile\\\\OptimizerImpl.java\u003cbr\\/\u003e\\nSending        java\\\\testing\\\\org\\\\apache\\\\derbyTesting\\\\functionTests\\\\master\\\\predicatePushdown.out\u003cbr\\/\u003e\\nSending        java\\\\testing\\\\org\\\\apache\\\\derbyTesting\\\\functionTests\\\\tests\\\\lang\\\\predicatePushdown.sql\u003cbr\\/\u003e\\nTransmitting file data ...\u003cbr\\/\u003e\\nCommitted revision 450155.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12437916_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12437916_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Sep\\/06 19:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-26T19:19:52+0000\'\u003e26\\/Sep\\/06 19:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I ran  a success full set of tests against this patch against windows XP and ibm 1.4.2. jvm.  I reviewed the changes and the extensive comments seemed to match up with what the code was doing.  Looked like good tests were being added for the problem.  I am no optimizer expert so I suggest at least one more reviewer before we consider moving this patch from the trunk to 10.2 codeline.  Am committing this to the trunk to get it more testing. \\n\\n If possible it would be good if anyone dependent on this change can test out the fix in the trunk and verify it works for \\nthem. \\n\\n I committed this to the trunk: \\nm1_ibm142:5&gt;svn commit \\n\\n Sending        java\\\\engine\\\\org\\\\apache\\\\derby\\\\impl\\\\sql\\\\compile\\\\OptimizerImpl.java \\nSending        java\\\\testing\\\\org\\\\apache\\\\derbyTesting\\\\functionTests\\\\master\\\\predicatePushdown.out \\nSending        java\\\\testing\\\\org\\\\apache\\\\derbyTesting\\\\functionTests\\\\tests\\\\lang\\\\predicatePushdown.sql \\nTransmitting file data ... \\nCommitted revision 450155.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12438001\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12438001&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12438001\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12438001_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438001_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/06 02:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-27T02:34:12+0000\'\u003e27\\/Sep\\/06 02:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Army, I read through your code and tests; thanks for the clear and detailed comments!\u003c\\/p\u003e\\n\\n\u003cp\u003eI noticed that the crucial bit of the change had to do with a comparison of table numbers;\u003cbr\\/\u003e\\nI\'m not real familiar with how table numbers work, so I thought I\'d ask a pretty naive question:\u003c\\/p\u003e\\n\\n\u003cp\u003e   at this point in the processing, have constructs like views and synonyms already been\u003cbr\\/\u003e\\n   transformed and replaced by their underlying \\\"real\\\" tables?\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso, and related:\u003c\\/p\u003e\\n\\n\u003cp\u003e  If the optimizer is choosing to access an index for a table, rather than accessing the\u003cbr\\/\u003e\\n  table itself, does the table number change depending on whether it is an index or\u003cbr\\/\u003e\\n  a base table which is being processed by the ProjectRestrictNode?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12438001_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438001_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/06 02:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-27T02:34:12+0000\'\u003e27\\/Sep\\/06 02:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Army, I read through your code and tests; thanks for the clear and detailed comments! \\n\\n I noticed that the crucial bit of the change had to do with a comparison of table numbers; \\nI\'m not real familiar with how table numbers work, so I thought I\'d ask a pretty naive question: \\n\\n    at this point in the processing, have constructs like views and synonyms already been \\n   transformed and replaced by their underlying \\\"real\\\" tables? \\n\\n Also, and related: \\n\\n   If the optimizer is choosing to access an index for a table, rather than accessing the \\n  table itself, does the table number change depending on whether it is an index or \\n  a base table which is being processed by the ProjectRestrictNode?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12438165\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12438165&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12438165\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12438165_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438165_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/06 16:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-27T16:46:03+0000\'\u003e27\\/Sep\\/06 16:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Bryan, thanks for looking at the patch and for being willing to ask some good questions.  Below are my (perhaps slightly lengthy) responses.  If this doesn\'t address your questions or leaves you with new questions, please don\'t hesitate to ask again...\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks,\u003cbr\\/\u003e\\nArmy\u003c\\/p\u003e\\n\\n\u003chr \\/\u003e\\n\\n\u003cp\u003eQ1: At this point in the processing, have constructs like views\u003cbr\\/\u003e\\n   and synonyms already been transformed and replaced by their\u003cbr\\/\u003e\\n   underlying \\\"real\\\" tables? \u003c\\/p\u003e\\n\\n\u003cp\u003eYes.  Transformations and table resolution occur during the \\\"binding\\\" and \\\"preprocessing\\\" stages of query compilation--and both of those stages occur before optimization begins.  So at this point a view will be represented by a ProjectRestrictNode whose child is a SelectNode, and a synonym will be represented by whatever FromTable it (the synonym) is actually referring to.\u003c\\/p\u003e\\n\\n\u003cp\u003eTable numbers are also assigned during binding\\/preprocessing, so by the time we get to the code in d1866_v1.patch, all FromTables (aka  \\\"Optimizables\\\") in the entire query will have an assigned table number (if required--in some cases it\'s not necessary and thus will be -1).  Additionally any column reference which points to one of those FromTables will have the table number for that FromTable stored locally (namely, in ColumnReference.tableNumber).\u003c\\/p\u003e\\n\\n\u003cp\u003eNote that when a ColumnReference is \\\"remapped\\\" to point to a different FromTable, its local information-\u003cdel\u003eincluding tableNumber\u003c\\/del\u003e\u003cdel\u003eis updated accordingly.  Note also that a \\\"FromTable\\\" is not restricted to base tables\u003c\\/del\u003e-anything that can be specified in the FROM list of a SELECT query will be represented by some instance of FromTable, whether it be a subquery, a base table, a union node, etc.  Every FromTable has its own \\\"table number\\\", with the exception of ProjectRestrictNodes.  For a PRN, if the PRN\'s child is itself a FromTable (as opposed to, say, a SelectNode) then the PRN\'s table number will be -1 and any attempts to \\\"get\\\" the PRN\'s table number will return the table number of the PRN\'s child.  If the PRN\'s child is not a FromTable, then the PRN will have it\'s own table number.\u003c\\/p\u003e\\n\\n\u003cp\u003eQ2: If the optimizer is choosing to access an index for a table, rather\u003cbr\\/\u003e\\n  than accessing the table itself, does the table number change depending\u003cbr\\/\u003e\\n  on whether it is an index or a base table which is being processed\u003cbr\\/\u003e\\n  by the ProjectRestrictNode?\u003c\\/p\u003e\\n\\n\u003cp\u003eGreat question.  Short answer is \\\"no\\\" \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eThe thing to note here is that \\\"table number\\\" is strictly a language-created, compilation time value to allow binding, preprocessing, optimization, and code generation to distinguish between the various FromTables in the original query.  A table number is not stored on disk and it is independent of the access path decisions (including whether or not an index is used) made by the optimizer.  Furthermore, there is no link between a given table number and the actual on-disk table that it points to.  Table number 0 could be for T1 in one query, T2 in another query, and T100 in a third query.\u003c\\/p\u003e\\n\\n\u003cp\u003eAs a simple (but admittedly meaningless) example, take the following query:\u003c\\/p\u003e\\n\\n\u003cp\u003e  select t1.i, x1.j from t1, t1 x1 where t1.i = x1.j;\u003c\\/p\u003e\\n\\n\u003cp\u003eAt bind time Derby will assign every item in the FROM list a table number.  So in this case, \\\"T1\\\" gets table number 0 and \\\"T1 X1\\\" gets table number 1.  The fact that both FromTables are really pointing to the same base table doesn\'t matter.  For the duration of compilation\\/optimization, they are represented by two different instances of FromTable and are considered two different \\\"tables\\\", each having its own table number.  (For the record, in this particular example the different FromTables will in fact point to the same underlying tableDescriptor field).\u003c\\/p\u003e\\n\\n\u003cp\u003eGiven that, the predicate \\\"t1.i = x1.j\\\" will have a left ColumnReference pointing to a FromBaseTable representing T1 with table number \\\"0\\\" and a right ColumnReference pointing to a different FromBaseTable representing X1 (i.e. T1 again) with table number \\\"1\\\".\u003c\\/p\u003e\\n\\n\u003cp\u003eIf the optimizer then decides to use an index for T1, the table number doesn\'t change--the optimizer just decides that for \\\"the FromBaseTable whose table number is 0 we will use an index\\\".  In fact, once assigned, the table number for a specific FromTable remains the same for the duration of the compilation of the statement.\u003c\\/p\u003e\\n\\n\u003cp\u003eThat was a round-about way of getting to the answer, but hopefully that\'s more helpful than confusing...\u003c\\/p\u003e\\n\\n\u003cp\u003eAs I said, if you still have questions\\/confusion, please do ask again.  It\'s always good to answer questions like these, as it makes me re-check what I think I \\\"know\\\" and forces me to verify my replies by looking at the code again...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12438165_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438165_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/06 16:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-27T16:46:03+0000\'\u003e27\\/Sep\\/06 16:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Bryan, thanks for looking at the patch and for being willing to ask some good questions.  Below are my (perhaps slightly lengthy) responses.  If this doesn\'t address your questions or leaves you with new questions, please don\'t hesitate to ask again... \\n\\n Thanks, \\nArmy \\n\\n \\n\\n Q1: At this point in the processing, have constructs like views \\n   and synonyms already been transformed and replaced by their \\n   underlying \\\"real\\\" tables?  \\n\\n Yes.  Transformations and table resolution occur during the \\\"binding\\\" and \\\"preprocessing\\\" stages of query compilation--and both of those stages occur before optimization begins.  So at this point a view will be represented by a ProjectRestrictNode whose child is a SelectNode, and a synonym will be represented by whatever FromTable it (the synonym) is actually referring to. \\n\\n Table numbers are also assigned during binding\\/preprocessing, so by the time we get to the code in d1866_v1.patch, all FromTables (aka  \\\"Optimizables\\\") in the entire query will have an assigned table number (if required--in some cases it\'s not necessary and thus will be -1).  Additionally any column reference which points to one of those FromTables will have the table number for that FromTable stored locally (namely, in ColumnReference.tableNumber). \\n\\n Note that when a ColumnReference is \\\"remapped\\\" to point to a different FromTable, its local information- including tableNumber  is updated accordingly.  Note also that a \\\"FromTable\\\" is not restricted to base tables -anything that can be specified in the FROM list of a SELECT query will be represented by some instance of FromTable, whether it be a subquery, a base table, a union node, etc.  Every FromTable has its own \\\"table number\\\", with the exception of ProjectRestrictNodes.  For a PRN, if the PRN\'s child is itself a FromTable (as opposed to, say, a SelectNode) then the PRN\'s table number will be -1 and any attempts to \\\"get\\\" the PRN\'s table number will return the table number of the PRN\'s child.  If the PRN\'s child is not a FromTable, then the PRN will have it\'s own table number. \\n\\n Q2: If the optimizer is choosing to access an index for a table, rather \\n  than accessing the table itself, does the table number change depending \\n  on whether it is an index or a base table which is being processed \\n  by the ProjectRestrictNode? \\n\\n Great question.  Short answer is \\\"no\\\"   \\n\\n The thing to note here is that \\\"table number\\\" is strictly a language-created, compilation time value to allow binding, preprocessing, optimization, and code generation to distinguish between the various FromTables in the original query.  A table number is not stored on disk and it is independent of the access path decisions (including whether or not an index is used) made by the optimizer.  Furthermore, there is no link between a given table number and the actual on-disk table that it points to.  Table number 0 could be for T1 in one query, T2 in another query, and T100 in a third query. \\n\\n As a simple (but admittedly meaningless) example, take the following query: \\n\\n   select t1.i, x1.j from t1, t1 x1 where t1.i = x1.j; \\n\\n At bind time Derby will assign every item in the FROM list a table number.  So in this case, \\\"T1\\\" gets table number 0 and \\\"T1 X1\\\" gets table number 1.  The fact that both FromTables are really pointing to the same base table doesn\'t matter.  For the duration of compilation\\/optimization, they are represented by two different instances of FromTable and are considered two different \\\"tables\\\", each having its own table number.  (For the record, in this particular example the different FromTables will in fact point to the same underlying tableDescriptor field). \\n\\n Given that, the predicate \\\"t1.i = x1.j\\\" will have a left ColumnReference pointing to a FromBaseTable representing T1 with table number \\\"0\\\" and a right ColumnReference pointing to a different FromBaseTable representing X1 (i.e. T1 again) with table number \\\"1\\\". \\n\\n If the optimizer then decides to use an index for T1, the table number doesn\'t change--the optimizer just decides that for \\\"the FromBaseTable whose table number is 0 we will use an index\\\".  In fact, once assigned, the table number for a specific FromTable remains the same for the duration of the compilation of the statement. \\n\\n That was a round-about way of getting to the answer, but hopefully that\'s more helpful than confusing... \\n\\n As I said, if you still have questions\\/confusion, please do ask again.  It\'s always good to answer questions like these, as it makes me re-check what I think I \\\"know\\\" and forces me to verify my replies by looking at the code again...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12438200\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12438200&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12438200\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yipng\\\" id=\\\"commentauthor_12438200_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yipng\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yipng\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yip Ng\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438200_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/06 19:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-27T19:24:25+0000\'\u003e27\\/Sep\\/06 19:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi Army, I read through the patch and the changes seem reasonable to me.  \u003c\\/p\u003e\\n\\n\u003cp\u003eYou mentioned that:\u003c\\/p\u003e\\n\\n\u003cp\u003e\\\"all FromTables (aka \\\"Optimizables\\\") in the entire query will have an assigned table number (if required--in some cases it\'s not necessary and thus will be -1).\\\"  \u003c\\/p\u003e\\n\\n\u003cp\u003eCan you elaborate on this?  In what circumstances where the table number will be -1?  \u003c\\/p\u003e\\n\\n\u003cp\u003etNum = ((FromTable)curTable).getTableNumber();\u003cbr\\/\u003e\\n...\u003cbr\\/\u003e\\nif (tNum &gt;= 0)\u003cbr\\/\u003e\\n    curTableNums.set(tNum);\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yipng\\\" id=\\\"commentauthor_12438200_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yipng\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yipng\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yip Ng\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438200_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/06 19:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-27T19:24:25+0000\'\u003e27\\/Sep\\/06 19:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi Army, I read through the patch and the changes seem reasonable to me.   \\n\\n You mentioned that: \\n\\n \\\"all FromTables (aka \\\"Optimizables\\\") in the entire query will have an assigned table number (if required--in some cases it\'s not necessary and thus will be -1).\\\"   \\n\\n Can you elaborate on this?  In what circumstances where the table number will be -1?   \\n\\n tNum = ((FromTable)curTable).getTableNumber(); \\n... \\nif (tNum &gt;= 0) \\n    curTableNums.set(tNum);              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12438214\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12438214&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12438214\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12438214_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438214_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/06 20:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-27T20:37:58+0000\'\u003e27\\/Sep\\/06 20:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for the review, Yip!\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; Can you elaborate on this? In what circumstances where the table number will be -1? \u003c\\/p\u003e\\n\\n\u003cp\u003eI think the answer to this question was buried in my earlier reply, namely:\u003c\\/p\u003e\\n\\n\u003cp\u003e\\\"For a ProjectRestrictNode, if the PRN\'s child is itself a FromTable (as opposed to, say, a SelectNode) then the PRN\'s table number can be -1 and any attempts to \\\"get\\\" the PRN\'s table number will return the table number of the PRN\'s child. If the PRN\'s child is not a FromTable, then the PRN will have it\'s own table number. \\\"\u003c\\/p\u003e\\n\\n\u003cp\u003eThat said, I think the check for \\\"tNum &gt;= 0\\\" in this patch is probably unnecessary, since in the case just mentioned the call to \\\"getTableNumber()\\\" on a PRN will translate into a call to \\\"getTableNumber()\\\" on the child, which should then return a non-negative number.  I don\'t think it hurts to have the check in there, but since it\'s not expected to be -1, perhaps I can post a follow-up patch to remove the check and add an ASSERT to make sure that tNum is in fact positive...?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12438214_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438214_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/06 20:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-27T20:37:58+0000\'\u003e27\\/Sep\\/06 20:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for the review, Yip! \\n\\n &gt; Can you elaborate on this? In what circumstances where the table number will be -1?  \\n\\n I think the answer to this question was buried in my earlier reply, namely: \\n\\n \\\"For a ProjectRestrictNode, if the PRN\'s child is itself a FromTable (as opposed to, say, a SelectNode) then the PRN\'s table number can be -1 and any attempts to \\\"get\\\" the PRN\'s table number will return the table number of the PRN\'s child. If the PRN\'s child is not a FromTable, then the PRN will have it\'s own table number. \\\" \\n\\n That said, I think the check for \\\"tNum &gt;= 0\\\" in this patch is probably unnecessary, since in the case just mentioned the call to \\\"getTableNumber()\\\" on a PRN will translate into a call to \\\"getTableNumber()\\\" on the child, which should then return a non-negative number.  I don\'t think it hurts to have the check in there, but since it\'s not expected to be -1, perhaps I can post a follow-up patch to remove the check and add an ASSERT to make sure that tNum is in fact positive...?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12438215\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12438215&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12438215\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yipng\\\" id=\\\"commentauthor_12438215_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yipng\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yipng\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yip Ng\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438215_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/06 20:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-27T20:44:44+0000\'\u003e27\\/Sep\\/06 20:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRight.  You mentioned one case where this can be -1 on your earlier reply, but I was wondering if there are any other cases where table number can be -1 since you mentioned there are some cases.  I think the extra check for tNum &gt;= 0 is fine as is.   \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yipng\\\" id=\\\"commentauthor_12438215_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yipng\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yipng\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yip Ng\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438215_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/06 20:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-27T20:44:44+0000\'\u003e27\\/Sep\\/06 20:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Right.  You mentioned one case where this can be -1 on your earlier reply, but I was wondering if there are any other cases where table number can be -1 since you mentioned there are some cases.  I think the extra check for tNum &gt;= 0 is fine as is.                 \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12438527\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12438527&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12438527\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12438527_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438527_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Sep\\/06 19:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-28T19:02:56+0000\'\u003e28\\/Sep\\/06 19:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; You mentioned one case where this can be -1 on your earlier reply,\u003cbr\\/\u003e\\n&gt; but I was wondering if there are any other cases where table number\u003cbr\\/\u003e\\n&gt; can be -1 since you mentioned there are some cases.\u003c\\/p\u003e\\n\\n\u003cp\u003eSorry for misunderstanding your question.  When I wrote \\\"some\\\" cases I intended that to mean that there are \\\"some\\\" cases where a ProjectRestrictNode (PRN)\'s tableNumber can be -1 (namely, if it\'s child is an Optimizable).  Since that\'s the only time I\'ve ever seen a negative table number when tracing through code, I\'ve been assuming that\'s the only case when it can happen.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut inspired by your question, I decided to do a search through the codeline to see if there are any other situations when a table number can be -1 during optimization.  (Note: the emphasis here is on optimization, since that\'s the area of code at issue with this Jira).\u003c\\/p\u003e\\n\\n\u003cp\u003eThe only other case I found was for NormalizeResultSetNode, which is created for InsertNode and UpdateNode.  But NormalizeResultSetNodes are generated on top of a ResultSetNode to be optimized--they are not themselves optimized, which means that we wouldn\'t ever get to the code in d1866_v1.patch with a \\\"curTable\\\" that is a NormalizeResultSetNode.  So even though a NormalizeRSN can have a negative table number, that doesn\'t affect the proposed changes.\u003c\\/p\u003e\\n\\n\u003cp\u003eThus based on my understanding, the only time a FromTable\'s table number can be -1 during optimization is if it is in fact a ProjectRestrictNode with a non-FromTable subquery as its child.\u003c\\/p\u003e\\n\\n\u003cp\u003eAs a minor sort of sanity check for these results, I put a System.out in OptimizerImpl to print a message if we ever saw an Optimizable that had a negative table number but that was not a PRN, and then I ran derbylang.  The message was never printed.  This doesn\'t \\\"prove\\\" anything in particular, but it does lend evidence to the results of my code search...\u003c\\/p\u003e\\n\\n\u003cp\u003e&#8212;\u003c\\/p\u003e\\n\\n\u003cp\u003eDetails on my search:\u003c\\/p\u003e\\n\\n\u003cp\u003eBelow are the classes I found that extend FromTable.  I looked to see 1) where the various classes were instantiated, and 2) where their table numbers were set (if at all).  The breakdown based on my searching is as follows:\u003c\\/p\u003e\\n\\n\u003cp\u003eFromTables whose table numbers are always set during binding (and thus will not be -1 when it comes time to optimize):\u003c\\/p\u003e\\n\\n\u003cp\u003e CurrentOfNode\u003cbr\\/\u003e\\n FromBaseTable\u003cbr\\/\u003e\\n FromSubquery\u003cbr\\/\u003e\\n FromVTI\u003cbr\\/\u003e\\n RowResultSetNode\u003cbr\\/\u003e\\n TableOperatorNode\u003cbr\\/\u003e\\n -&gt;JoinNode (via inheritance from TableOp)\u003cbr\\/\u003e\\n ---&gt;HalfOuterJoinNode (inheritance from TableOp)\u003cbr\\/\u003e\\n -&gt;SetOperatorNode (inheritance from TableOp)\u003cbr\\/\u003e\\n ---&gt;IntersectOrExceptNode (inheritance from TableOp)\u003cbr\\/\u003e\\n ---&gt;UnionNode (inheritance from TableOp)\u003c\\/p\u003e\\n\\n\u003cp\u003eFromTables that are only instantiated AFTER optimization has completed, and thus even though their table numbers can be -1, that won\'t affect optimization.\u003c\\/p\u003e\\n\\n\u003cp\u003e IndexToBaseRowNode\u003cbr\\/\u003e\\n SingleChildResultSetNode\u003cbr\\/\u003e\\n -&gt;DistinctNode\u003cbr\\/\u003e\\n -&gt;GroupByNode\u003cbr\\/\u003e\\n -&gt;HashTableNode\u003cbr\\/\u003e\\n -&gt;MaterializeResultSetNode\u003cbr\\/\u003e\\n -&gt;OrderByNode\u003cbr\\/\u003e\\n -&gt;ScrollInsensitiveResultSetNode\u003c\\/p\u003e\\n\\n\u003cp\u003eFromTables that can be instantiated during preprocessing but that may not have their table numbers set (these are the ones of interest to the current discussion):\u003c\\/p\u003e\\n\\n\u003cp\u003e ProjectRestrictNode:\u003c\\/p\u003e\\n\\n\u003cp\u003e  If created during preprocessing, table number will only be set in\u003cbr\\/\u003e\\n  FromSubquery.extractSubquery(); in all other cases it will remain -1.\u003c\\/p\u003e\\n\\n\u003cp\u003e NormalizeResultSetNode:\u003c\\/p\u003e\\n\\n\u003cp\u003e  Instantiated during bind phase for InsertNode and UpdateNode\u003cbr\\/\u003e\\n  but table number is not set.  So it will be -1.  However,\u003cbr\\/\u003e\\n  a NormalizeresultSetNode never appears in an optimizer\'s\u003cbr\\/\u003e\\n  optimizableList, and thus such a node will never actually\u003cbr\\/\u003e\\n  be optimized.\u003c\\/p\u003e\\n\\n\u003chr \\/\u003e\\n\\n\u003cp\u003eHopefully that\'s more in line with what you were asking?\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks again for the review and great questions...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12438527_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438527_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Sep\\/06 19:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-28T19:02:56+0000\'\u003e28\\/Sep\\/06 19:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; You mentioned one case where this can be -1 on your earlier reply, \\n&gt; but I was wondering if there are any other cases where table number \\n&gt; can be -1 since you mentioned there are some cases. \\n\\n Sorry for misunderstanding your question.  When I wrote \\\"some\\\" cases I intended that to mean that there are \\\"some\\\" cases where a ProjectRestrictNode (PRN)\'s tableNumber can be -1 (namely, if it\'s child is an Optimizable).  Since that\'s the only time I\'ve ever seen a negative table number when tracing through code, I\'ve been assuming that\'s the only case when it can happen. \\n\\n But inspired by your question, I decided to do a search through the codeline to see if there are any other situations when a table number can be -1 during optimization.  (Note: the emphasis here is on optimization, since that\'s the area of code at issue with this Jira). \\n\\n The only other case I found was for NormalizeResultSetNode, which is created for InsertNode and UpdateNode.  But NormalizeResultSetNodes are generated on top of a ResultSetNode to be optimized--they are not themselves optimized, which means that we wouldn\'t ever get to the code in d1866_v1.patch with a \\\"curTable\\\" that is a NormalizeResultSetNode.  So even though a NormalizeRSN can have a negative table number, that doesn\'t affect the proposed changes. \\n\\n Thus based on my understanding, the only time a FromTable\'s table number can be -1 during optimization is if it is in fact a ProjectRestrictNode with a non-FromTable subquery as its child. \\n\\n As a minor sort of sanity check for these results, I put a System.out in OptimizerImpl to print a message if we ever saw an Optimizable that had a negative table number but that was not a PRN, and then I ran derbylang.  The message was never printed.  This doesn\'t \\\"prove\\\" anything in particular, but it does lend evidence to the results of my code search... \\n\\n &#8212; \\n\\n Details on my search: \\n\\n Below are the classes I found that extend FromTable.  I looked to see 1) where the various classes were instantiated, and 2) where their table numbers were set (if at all).  The breakdown based on my searching is as follows: \\n\\n FromTables whose table numbers are always set during binding (and thus will not be -1 when it comes time to optimize): \\n\\n  CurrentOfNode \\n FromBaseTable \\n FromSubquery \\n FromVTI \\n RowResultSetNode \\n TableOperatorNode \\n -&gt;JoinNode (via inheritance from TableOp) \\n ---&gt;HalfOuterJoinNode (inheritance from TableOp) \\n -&gt;SetOperatorNode (inheritance from TableOp) \\n ---&gt;IntersectOrExceptNode (inheritance from TableOp) \\n ---&gt;UnionNode (inheritance from TableOp) \\n\\n FromTables that are only instantiated AFTER optimization has completed, and thus even though their table numbers can be -1, that won\'t affect optimization. \\n\\n  IndexToBaseRowNode \\n SingleChildResultSetNode \\n -&gt;DistinctNode \\n -&gt;GroupByNode \\n -&gt;HashTableNode \\n -&gt;MaterializeResultSetNode \\n -&gt;OrderByNode \\n -&gt;ScrollInsensitiveResultSetNode \\n\\n FromTables that can be instantiated during preprocessing but that may not have their table numbers set (these are the ones of interest to the current discussion): \\n\\n  ProjectRestrictNode: \\n\\n   If created during preprocessing, table number will only be set in \\n  FromSubquery.extractSubquery(); in all other cases it will remain -1. \\n\\n  NormalizeResultSetNode: \\n\\n   Instantiated during bind phase for InsertNode and UpdateNode \\n  but table number is not set.  So it will be -1.  However, \\n  a NormalizeresultSetNode never appears in an optimizer\'s \\n  optimizableList, and thus such a node will never actually \\n  be optimized. \\n\\n \\n\\n Hopefully that\'s more in line with what you were asking? \\n\\n Thanks again for the review and great questions...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12438534\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12438534&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12438534\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yipng\\\" id=\\\"commentauthor_12438534_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yipng\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yipng\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yip Ng\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438534_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Sep\\/06 19:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-28T19:34:16+0000\'\u003e28\\/Sep\\/06 19:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eYes, that is what I was looking for.  Thanks for the extensive analysis and explanation on the table number logic in the optimizer, Army.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yipng\\\" id=\\\"commentauthor_12438534_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yipng\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yipng\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yip Ng\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12438534_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Sep\\/06 19:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-09-28T19:34:16+0000\'\u003e28\\/Sep\\/06 19:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Yes, that is what I was looking for.  Thanks for the extensive analysis and explanation on the table number logic in the optimizer, Army.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12439174\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12439174&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12439174\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12439174_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12439174_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Oct\\/06 14:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-02T14:37:12+0000\'\u003e02\\/Oct\\/06 14:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLooks like this one made it into 10.2.1.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12439174_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12439174_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Oct\\/06 14:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-02T14:37:12+0000\'\u003e02\\/Oct\\/06 14:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Looks like this one made it into 10.2.1.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12439190\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12439190&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12439190\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12439190_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12439190_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Oct\\/06 15:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-02T15:29:45+0000\'\u003e02\\/Oct\\/06 15:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI backported this fix to both the 10.2 and 10.1 branches.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12439190_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12439190_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Oct\\/06 15:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-02T15:29:45+0000\'\u003e02\\/Oct\\/06 15:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I backported this fix to both the 10.2 and 10.1 branches.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12443563\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-1866?focusedCommentId=12443563&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12443563\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12443563_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12443563_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Oct\\/06 16:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-19T16:20:52+0000\'\u003e19\\/Oct\\/06 16:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFix is in 10.3, 10.2, and 10.1, and I haven\'t heard any follow-up feedback, so marking is as closed.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12443563_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12443563_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Oct\\/06 16:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-19T16:20:52+0000\'\u003e19\\/Oct\\/06 16:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Fix is in 10.3, 10.2, and 10.1, and I haven\'t heard any follow-up feedback, so marking is as closed.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="10594";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=10594&amp;avatarId=10122\\\" alt=\\\"Derby\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\"\u003eDerby\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1520238555017"> 
    <input type="hidden" title="jira.request.server.time" value="194"> 
    <input type="hidden" title="jira.request.id" value="509x94361357x1"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="1"> 
    <input type="hidden" title="db.reads.time.in.ms" value="30"> 
    <input type="hidden" title="db.conns.time.in.ms" value="36"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 509x94361357x1
	          REQUEST TIMESTAMP : [05/Mar/2018:08:29:15 +0000]
	               REQUEST TIME : 0.1940
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 1

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=42, elapsedTotal=30890662, elapsedMin=277167, elapsedMax=7044351, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=46, elapsedTotal=36635322, elapsedMin=296571, elapsedMax=7173995, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
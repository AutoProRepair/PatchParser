<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|82d36e8f7660c95047b0e784e176efc3fe0965a1|lout"> 
  <link rel="shortcut icon" href="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"jira.instrumentation.laas\":false,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"com.atlassian.jira.issuetable.draggable\":true,\"jira.create.linked.issue\":true,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"jira.jql.suggestrecentfields\":false,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"jira.jql.smartautoselectfirst\":false,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.priorities.per.project\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"jira.renderer.consider.variable.format\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/vnd.wap.wbmp,image/png,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"d887d729cef828\"";
WRM._unparsedData["project-id"]="10594";
WRM._unparsedData["project-key"]="\"DERBY\"";
WRM._unparsedData["project-name"]="\"Derby\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="10594";
WRM._unparsedData["projectKey"]="\"DERBY\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/74ac580603ca910fff0cfdf319e54add-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/98ceb006e504d7924d5ffc411626c6bc-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/c1e4d26ea276469807c3dc0918df482c-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/6bf9253c8d533109c3b02e26794be24e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/ccd2e67b523185973473e8bd5735c8f9-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/33e5e0166867c8c9228d44506f60b2e8/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/6579b6b8ba67abaa496e39b9242a18a4-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="DERBY-3243"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[DERBY-3243] (jdbc net client) exception during normal iteration through "ResultSet" of "select * from t" - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[DERBY-3243] (jdbc net client) exception during normal iteration through &quot;ResultSet&quot; of &quot;select * from t&quot; - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/DERBY" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-3243">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="10594" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Derby'" src="https://issues.apache.org/jira/secure/projectavatar?pid=10594&amp;avatarId=10122"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/DERBY">Derby</a></li>
                 <li><a class="issue-link" data-issue-key="DERBY-3243" href="/jira/browse/DERBY-3243" id="key-val" rel="12383746">DERBY-3243</a></li>
                </ol>
                <h1 id="summary-val">(jdbc net client) exception during normal iteration through "ResultSet" of "select * from t"</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-3243"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/DERBY-3243/DERBY-3243.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/DERBY-3243/DERBY-3243.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/DERBY-3243/DERBY-3243.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/DERBY-3243/DERBY-3243.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" title="Bug - A problem which impairs or prevents the functions of the product." width="16"> Bug </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/critical.svg" title="Critical - Crashes, loss of data, severe memory leak." width="16"> Critical </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="10.3.2.1 ">10.3.2.1</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+fixVersion+%3D+10.3.3.0" title="10.3.3.0 ">10.3.3.0</a>, <a href="/jira/issues/?jql=project+%3D+DERBY+AND+fixVersion+%3D+10.4.1.3" title="10.4.1.3 ">10.4.1.3</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+component+%3D+JDBC" title="JDBC ">JDBC</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12383746-value">None</span> 
                   </div> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap"> 
                   <strong class="name">Environment:</strong> 
                   <div id="environment-val" class="value"> 
                    <div id="field-environment" class="twixi-block twixi-block-inverted collapsed "> 
                     <div class="twixi-wrap verbose"> 
                      <a href="#" class="twixi "><span class="icon-default aui-icon aui-icon-small aui-iconfont-expanded"><span>Hide</span></span></a> 
                      <div class="flooded">
                        ------------------ Java Information ------------------
                       <br> Java Version: 1.4.2_03
                       <br> Java Vendor: Sun Microsystems Inc.
                       <br> Java home: C:\Programme\Java\j2re1.4.2_03
                       <br> Java classpath: derbyclient.jar
                       <br> OS name: Windows XP
                       <br> OS architecture: x86
                       <br> OS version: 5.1
                       <br> Java user name: cbdqok
                       <br> Java user home: C:\Dokumente und Einstellungen\cbdqok
                       <br> Java user dir: D:\users\cbdqok\privat\osj\lib_derby_net\lib
                       <br> java.specification.name: Java Platform API Specification
                       <br> java.specification.version: 1.4
                       <br> --------- Derby Information --------
                       <br> JRE - JDBC: J2SE 1.4.2 - JDBC 3.0
                       <br> [D:\users\cbdqok\privat\osj\lib_derby_net\lib\derbyclient.jar] 10.3.1.4 - (561794)
                       <br> ------------------------------------------------------
                       <br> ----------------- Locale Information -----------------
                       <br> ------------------------------------------------------
                       <br> 
                      </div> 
                     </div> 
                     <div class="twixi-wrap concise"> 
                      <a href="#" class="twixi "><span class="icon-default aui-icon aui-icon-small aui-iconfont-collapsed"><span>Show</span></span></a> 
                      <div class="flooded">
                        ------------------ Java Information ------------------ Java Version: 1.4.2_03 Java Vendor: Sun Microsystems Inc. Java home: C:\Programme\Java\j2re1.4.2_03 Java classpath: derbyclient.jar OS name: Windows XP OS architecture: x86 OS version: 5.1 Java user name: cbdqok Java user home: C:\Dokumente und Einstellungen\cbdqok Java user dir: D:\users\cbdqok\privat\osj\lib_derby_net\lib java.specification.name: Java Platform API Specification java.specification.version: 1.4 --------- Derby Information -------- JRE - JDBC: J2SE 1.4.2 - JDBC 3.0 [D:\users\cbdqok\privat\osj\lib_derby_net\lib\derbyclient.jar] 10.3.1.4 - (561794) ------------------------------------------------------ ----------------- Locale Information ----------------- ------------------------------------------------------ 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310050" class="item"> 
                     <div class="wrap"> 
                      <strong title="Urgency" class="name">Urgency:</strong> 
                      <div id="customfield_12310050-val" class="value type-select" data-fieldtype="select" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        Low 
                      </div> 
                     </div> </li> 
                    <li id="rowForcustomfield_12310090" class="item"> 
                     <div class="wrap"> 
                      <strong title="Issue &amp; fix info" class="name">Issue &amp; fix info:</strong> 
                      <div id="customfield_12310090-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310090-field"> 
                        <span>Patch Available</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                    <li id="rowForcustomfield_12310200" class="item"> 
                     <div class="wrap"> 
                      <strong title="Bug behavior facts" class="name">Bug behavior facts:</strong> 
                      <div id="customfield_12310200-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310200-field"> 
                        <span>Regression</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>Thanks again to the DERBY developers.</p> 
                  <p>For my convenience I use the client/server variant of DERBY. This is where the error occurs. I have temporarily alleviated the problem for my case by using the embedded version.</p> 
                  <p>I'm forced to use outlook and have built a program which siphons the messages into a derby database (phase 1 – table has two varchar fields and a clob). When reading them back (phase 2 – simple select of all records in no particular order, all 3 attributes), it has developed an exception. This is a result of data volume. I have reduced the problem to a single demonstration program.</p> 
                  <p>This behaviour, and the fact that the error is not a "DERBY Exception", but a proper exception coming back from the JDBC call, leads me to the diagnosis that it is a derby network client jdbc problem.</p> 
                  <p>The problem has been reproduced once by Bryan Pendleton: <a href="http://www.nabble.com/IndexOutOfBoundsException-t4926228.html" class="external-link" rel="nofollow">http://www.nabble.com/IndexOutOfBoundsException-t4926228.html</a></p> 
                  <p>I'll try to attach the code "error.java"; it can also be found on: <a href="http://www.os10000.net/error.java" class="external-link" rel="nofollow">http://www.os10000.net/error.java</a></p> 
                  <p>Please use as follows:</p> 
                  <p>javac -classpath derby.jar:derbynet.jar error.java<br> java -cp .:derby.jar:derbynet.jar error</p> 
                  <p>It will create a directory "test_db" and fill it with approx 120mb data.<br> Then you will observe the failure. </p> 
                  <p>/* <del><b></b></del><b> Mode:Java; c-basic-offset:8 <del></del></b> */</p> 
                  <p>// --------------------------------------------------------------------------------</p> 
                  <p>public class error {</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static final int port = 1527;<br> public static final String host = "127.0.0.1";</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static void log(String x) </p> { System.out.println(x); } 
                  <p>;</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static void log_stacktrace(Exception e) </p> { java.io.StringWriter sw = new java.io.StringWriter(); java.io.PrintWriter pw = new java.io.PrintWriter(sw); e.printStackTrace(pw); log(sw.toString()); } 
                  <p>;</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static void start_server() {<br> try {<br> org.apache.derby.drda.NetworkServerControl server =<br> new org.apache.derby.drda.NetworkServerControl(java.net.InetAddress.getByName(host),port);<br> server.start(null);<br> try </p> { java.lang.Thread.sleep(5000); } 
                  <p> catch (Exception e) { };<br> log("started DERBY on host "<ins>host</ins>" port "<ins>Integer.toString(port)</ins>".");<br> } catch (Exception e) </p> { log_stacktrace(e); } 
                  <p>;<br> };</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static java.sql.Connection con()<br> throws java.sql.SQLException, java.lang.ClassNotFoundException </p> { Class.forName("org.apache.derby.jdbc.ClientDriver"); String x_dbse = "test_db"; String x_user = ";user=os10000"; String x_pass = ";password=ding"; String x_crte = ";create=true"; String x_msgs = ";retrieveMessagesFromServerOnGetMessage=true"; String connect = "jdbc:derby://"+host+":"+port+"/"+x_dbse+x_user+x_crte+x_msgs; return java.sql.DriverManager.getConnection(connect); } 
                  <p>;</p> 
                  <p> // ----------------------------------------------------------------------</p> 
                  <p> public static String getclob(java.sql.Clob b) {<br> java.io.CharArrayWriter caw = new java.io.CharArrayWriter();<br> try {<br> java.io.Reader rd = b.getCharacterStream();<br> char cb[] = new char<span class="error">[4096]</span>;<br> int off=0, bts = rd.read(cb);<br> while (bts&gt;0) </p> { caw.write(cb,off,bts); off+=bts; bts=rd.read(cb); } 
                  <p>;<br> rd.close();<br> } catch(Exception e) {};<br> String res = caw.toString();<br> caw.close();<br> return res;<br> };</p> 
                  <p> // ----------------------------------------------------------------------</p> 
                  <p> public static class myclob implements java.sql.Clob {<br> String v;<br> public myclob(String z) </p> { v=z; } 
                  <p>;<br> public java.io.InputStream getAsciiStream() </p> { return new java.io.ByteArrayInputStream(v.getBytes()); } 
                  <p>;<br> public java.io.Reader getCharacterStream() </p> { return new java.io.CharArrayReader(v.toCharArray()); } 
                  <p>;<br> public String getSubString(long pos, int length) </p> { return v.substring((int)pos,(int)(pos+length)); } 
                  <p>;<br> public long length() </p> { return v.length(); } 
                  <p>;<br> public long position(java.sql.Clob pattern, long start) </p> { return 0; };
                  <br> public long position(String pattern, long start) { return 0; } 
                  <p>;<br> public java.io.OutputStream setAsciiStream(long pos) </p> { new java.sql.SQLException("setAsciiStream not implemented."); return null; } 
                  <p>;<br> public java.io.Writer setCharacterStream(long pos) </p> { new java.sql.SQLException("setCharacterStream not implemented."); return null; } 
                  <p>;<br> public int setString(long pos, String s) </p> { new java.sql.SQLException("setString not implemented."); return -1; };
                  <br> public int setString(long pos, String s, int offset, int len) { new java.sql.SQLException("setString not implemented."); return -1; } 
                  <p>;<br> public void truncate(long len) </p> { new java.sql.SQLException("truncate not implemented."); } 
                  <p>;<br> };</p> 
                  <p> public static java.sql.Clob putclob(String x) </p> { return new myclob(x); } 
                  <p>;</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static String getLob(java.sql.ResultSet rs, int arg)<br> throws java.sql.SQLException </p> { return getclob(rs.getClob(arg)); } 
                  <p>;<br> public static void setLob(java.sql.PreparedStatement ps, int arg, String val)<br> throws java.sql.SQLException </p> { ps.setClob(arg,putclob(val)); } 
                  <p>;</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static String clean_string(String x) </p> { return x.replaceAll("[\0\r\\\\]","").replaceAll("'","\\\"").replaceAll(",+",","); } 
                  <p>;</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static String make_string(int digits) {<br> double dl = (Math.random()) * (Math.pow(10.0,digits*Math.random()));<br> int len = (int) dl;<br> byte buf[] = new byte<span class="error">[len]</span>;<br> while (len&gt;0) </p> { double db = 256*Math.random(); buf[--len] = (byte)db; } 
                  <p>;<br> return clean_string(new String(buf));<br> };</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static void update(java.sql.Connection c, String cmd)<br> throws java.sql.SQLException </p> { c.createStatement().execute(cmd); } 
                  <p>;</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static final int entries=100000;</p> 
                  <p> public static void fill_db(java.sql.Connection c)<br> throws java.sql.SQLException {<br> try </p> { update(c,"drop table mail_raw"); } 
                  <p> catch (Exception e) {};</p> 
                  <p> try </p> { update(c,"create table mail_raw ( msg varchar(999), att varchar(100), val clob )"); } 
                  <p> <br> catch (Exception e) </p> { log_stacktrace(e); };
                  <br> 
                  <br> java.sql.PreparedStatement pstmt = null;
                  <br> 
                  <br> try { pstmt = c.prepareStatement("insert into mail_raw values ( ?, ?, ? )"); }
                  <br> catch (Exception e) { log_stacktrace(e); } 
                  <p>;</p> 
                  <p> for (int i=0; i&lt;entries; i++) </p> { pstmt.setString(1,make_string(3)); pstmt.setString(2,"5 body"); setLob(pstmt,3,make_string(4)); pstmt.executeUpdate(); if (i%100==0) log("step "+i+"/"+entries); } 
                  <p>;<br> };</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static void dump_db(java.sql.Connection c)<br> throws java.sql.SQLException {<br> log("performing dump.");<br> java.sql.ResultSet rs = c.createStatement().executeQuery("select * from mail_raw");<br> while (rs.next()) </p> { String msg = rs.getString(1); String att = rs.getString(2); String val = getLob(rs,3); } 
                  <p>;<br> };</p> 
                  <p> // ------------------------------------------------------------------------</p> 
                  <p> public static void main(String args[]) {<br> start_server();<br> try </p> { java.sql.Connection c = con(); fill_db(c); dump_db(c); } 
                  <p> catch (Exception e) </p> { log_stacktrace(e); } 
                  <p>;<br> };</p> 
                  <p> // ------------------------------------------------------------------------<br> };</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/DERBY-3243?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/DERBY-3243?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/DERBY-3243?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/DERBY-3243?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374506" data-issue-id="12383746" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374506/derby-3243_diff.txt" draggable="true" data-downloadurl="text/plain:derby-3243_diff.txt:https://issues.apache.org/jira/secure/attachment/12374506/derby-3243_diff.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374506/derby-3243_diff.txt" title="Latest  31/Jan/08 21:50 - Kathey Marsden" draggable="true" data-downloadurl="text/plain:derby-3243_diff.txt:https://issues.apache.org/jira/secure/attachment/12374506/derby-3243_diff.txt">derby-3243_diff.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-31T21:50:20.528Z">31/Jan/08 21:50</time>
                   </dd>
                   <dd class="attachment-size">
                    2 kB
                   </dd>
                   <dd class="attachment-author">
                    Kathey Marsden
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374569" data-issue-id="12383746" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374569/derby-3243_diff2.txt" draggable="true" data-downloadurl="text/plain:derby-3243_diff2.txt:https://issues.apache.org/jira/secure/attachment/12374569/derby-3243_diff2.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374569/derby-3243_diff2.txt" title="Latest  01/Feb/08 17:48 - Kathey Marsden" draggable="true" data-downloadurl="text/plain:derby-3243_diff2.txt:https://issues.apache.org/jira/secure/attachment/12374569/derby-3243_diff2.txt">derby-3243_diff2.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-01T17:48:36.575Z">01/Feb/08 17:48</time>
                   </dd>
                   <dd class="attachment-size">
                    3 kB
                   </dd>
                   <dd class="attachment-author">
                    Kathey Marsden
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374130" data-issue-id="12383746" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374130/derby-3243_fix_double_hashmap_entry_diff.txt" draggable="true" data-downloadurl="text/plain:derby-3243_fix_double_hashmap_entry_diff.txt:https://issues.apache.org/jira/secure/attachment/12374130/derby-3243_fix_double_hashmap_entry_diff.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374130/derby-3243_fix_double_hashmap_entry_diff.txt" title="Latest  26/Jan/08 20:40 - Kathey Marsden" draggable="true" data-downloadurl="text/plain:derby-3243_fix_double_hashmap_entry_diff.txt:https://issues.apache.org/jira/secure/attachment/12374130/derby-3243_fix_double_hashmap_entry_diff.txt">derby-3243_fix_double_hashmap_entry_diff.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-26T20:40:38.045Z">26/Jan/08 20:40</time>
                   </dd>
                   <dd class="attachment-size">
                    7 kB
                   </dd>
                   <dd class="attachment-author">
                    Kathey Marsden
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374292" data-issue-id="12383746" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374292/derby-3243_fix_double_hashmap_entry_diff2.txt" draggable="true" data-downloadurl="text/plain:derby-3243_fix_double_hashmap_entry_diff2.txt:https://issues.apache.org/jira/secure/attachment/12374292/derby-3243_fix_double_hashmap_entry_diff2.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374292/derby-3243_fix_double_hashmap_entry_diff2.txt" title="Latest  29/Jan/08 21:06 - Kathey Marsden" draggable="true" data-downloadurl="text/plain:derby-3243_fix_double_hashmap_entry_diff2.txt:https://issues.apache.org/jira/secure/attachment/12374292/derby-3243_fix_double_hashmap_entry_diff2.txt">derby-3243_fix_double_hashmap_entry_diff2.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-29T21:06:16.105Z">29/Jan/08 21:06</time>
                   </dd>
                   <dd class="attachment-size">
                    8 kB
                   </dd>
                   <dd class="attachment-author">
                    Kathey Marsden
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374131" data-issue-id="12383746" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374131/derby-3243_fix_double_hashmap_entry_stat.txt" draggable="true" data-downloadurl="text/plain:derby-3243_fix_double_hashmap_entry_stat.txt:https://issues.apache.org/jira/secure/attachment/12374131/derby-3243_fix_double_hashmap_entry_stat.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374131/derby-3243_fix_double_hashmap_entry_stat.txt" title="Latest  26/Jan/08 20:40 - Kathey Marsden" draggable="true" data-downloadurl="text/plain:derby-3243_fix_double_hashmap_entry_stat.txt:https://issues.apache.org/jira/secure/attachment/12374131/derby-3243_fix_double_hashmap_entry_stat.txt">derby-3243_fix_double_hashmap_entry_stat.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-26T20:40:38.191Z">26/Jan/08 20:40</time>
                   </dd>
                   <dd class="attachment-size">
                    0.4 kB
                   </dd>
                   <dd class="attachment-author">
                    Kathey Marsden
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374507" data-issue-id="12383746" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374507/derby-3243_stat.txt" draggable="true" data-downloadurl="text/plain:derby-3243_stat.txt:https://issues.apache.org/jira/secure/attachment/12374507/derby-3243_stat.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374507/derby-3243_stat.txt" title="Latest  31/Jan/08 21:50 - Kathey Marsden" draggable="true" data-downloadurl="text/plain:derby-3243_stat.txt:https://issues.apache.org/jira/secure/attachment/12374507/derby-3243_stat.txt">derby-3243_stat.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-31T21:50:20.697Z">31/Jan/08 21:50</time>
                   </dd>
                   <dd class="attachment-size">
                    0.1 kB
                   </dd>
                   <dd class="attachment-author">
                    Kathey Marsden
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="is related to">
                   is related to
                  </dt> 
                  <dd id="internal-12370325_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype" width="16" height="16" title="Sub-task - The sub-task of the issue" alt="Sub-task - The sub-task of the issue"> <span title="DERBY-2702: Enable Clob locator support between NetworkServer and NetworkClient and modify tests that experience changed behaviour due to this(enabling Clob Locators)."> <a href="/jira/browse/DERBY-2702" data-issue-key="DERBY-2702" class="issue-link link-title resolution">DERBY-2702</a> <span class="link-summary">Enable Clob locator support between NetworkServer and NetworkClient and modify tests that experience changed behaviour due to this(enabling Clob Locators).</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                 <dl class="links-list "> 
                  <dt title="relates to">
                   relates to
                  </dt> 
                  <dd id="internal-12387486_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" width="16" height="16" title="Bug - A problem which impairs or prevents the functions of the product." alt="Bug - A problem which impairs or prevents the functions of the product."> <span title="DERBY-3365: Network Server stores a duplicate entry in the lob hash map for every lob"> <a href="/jira/browse/DERBY-3365" data-issue-key="DERBY-3365" class="issue-link link-title resolution">DERBY-3365</a> <span class="link-summary">Network Server stores a duplicate entry in the lob hash map for every lob</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/minor.svg" width="16" height="16" title="Minor - Minor loss of function, or other problem where easy workaround is present." alt="Minor - Minor loss of function, or other problem where easy workaround is present."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                  <dd id="internal-12387658_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" width="16" height="16" title="Improvement - An improvement or enhancement to an existing feature or task." alt="Improvement - An improvement or enhancement to an existing feature or task."> <span title="DERBY-3377: Network Client/Server should use sqlType instead of locator value to determine if lob was sent by locator/value"> <a href="/jira/browse/DERBY-3377" data-issue-key="DERBY-3377" class="issue-link link-title">DERBY-3377</a> <span class="link-summary">Network Client/Server should use sqlType instead of locator value to determine if lob was sent by locator/value</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/minor.svg" width="16" height="16" title="Minor - Minor loss of function, or other problem where easy workaround is present." alt="Minor - Minor loss of function, or other problem where easy workaround is present."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-blue-gray jira-issue-status-lozenge-new aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Open</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is open and ready for the assignee to start work on it.</span>">Open</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_kmarsden" rel="kmarsden" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Kathey Marsden&quot;,&quot;emailAddress&quot;:&quot;kmarsdenderby@sbcglobal.net&quot;,&quot;username&quot;:&quot;kmarsden&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="kmarsden"></span></span> Kathey Marsden </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_os10000" rel="os10000" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Oliver Seidel&quot;,&quot;emailAddress&quot;:&quot;derbyjira@os10000.net&quot;,&quot;username&quot;:&quot;os10000&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="os10000"></span></span> Oliver Seidel </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">1</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">1</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="02/Dec/07 19:02"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2007-12-02T19:02:25+0000">02/Dec/07 19:02</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="21/Jan/11 17:51"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2011-01-21T17:51:10+0000">21/Jan/11 17:51</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="05/Feb/08 16:13"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2008-02-05T16:13:24+0000">05/Feb/08 16:13</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3243?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3243?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/DERBY-3243?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-12562143\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12562143&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12562143\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562143_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562143_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Jan\\/08 17:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-24T17:45:22+0000\'\u003e24\\/Jan\\/08 17:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWhen I run the program at:\u003ca href=\\\"http:\\/\\/www.os10000.net\\/error.java\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.os10000.net\\/error.java\u003c\\/a\u003e  with trunk, 10.3.2.1, and 10.3.1.4 I get a different exception than the one reported:\u003c\\/p\u003e\\n\\n\u003cp\u003ejava.sql.SQLException: Insufficient data while reading from the network - expected a minimum of 6 bytes and received on\u003cbr\\/\u003e\\ny -1 bytes.  The connection has been terminated.\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:46)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.SqlException.getSQLException(SqlException.java:362)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.executeUpdate(PreparedStatement.java:391)\u003cbr\\/\u003e\\n        at error.fill_db(error.java:147)\u003cbr\\/\u003e\\n        at error.main(error.java:171)\u003cbr\\/\u003e\\nCaused by: org.apache.derby.client.am.DisconnectException: Insufficient data while reading from the network - expected\u003cbr\\/\u003e\\n minimum of 6 bytes and received only -1 bytes.  The connection has been terminated.\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Reply.fill(Reply.java:195)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Reply.ensureALayerDataInBuffer(Reply.java:215)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Reply.readDssHeader(Reply.java:317)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Reply.startSameIdChainParse(Reply.java:1147)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.NetStatementReply.readExecute(NetStatementReply.java:69)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.StatementReply.readExecute(StatementReply.java:55)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.NetPreparedStatement.readExecute_(NetPreparedStatement.java:183)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.readExecute(PreparedStatement.java:1796)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.flowExecute(PreparedStatement.java:2116)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.executeUpdateX(PreparedStatement.java:396)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.executeUpdate(PreparedStatement.java:382)\u003cbr\\/\u003e\\n        ... 2 more\u003c\\/p\u003e\\n\\n\\n\\n\u003cp\u003eWith 10.2.2.0 the program runs cleanly.  Marking as a regression.\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562143_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562143_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Jan\\/08 17:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-24T17:45:22+0000\'\u003e24\\/Jan\\/08 17:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    When I run the program at: http:\\/\\/www.os10000.net\\/error.java   with trunk, 10.3.2.1, and 10.3.1.4 I get a different exception than the one reported: \\n\\n java.sql.SQLException: Insufficient data while reading from the network - expected a minimum of 6 bytes and received on \\ny -1 bytes.  The connection has been terminated. \\n        at org.apache.derby.client.am.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:46) \\n        at org.apache.derby.client.am.SqlException.getSQLException(SqlException.java:362) \\n        at org.apache.derby.client.am.PreparedStatement.executeUpdate(PreparedStatement.java:391) \\n        at error.fill_db(error.java:147) \\n        at error.main(error.java:171) \\nCaused by: org.apache.derby.client.am.DisconnectException: Insufficient data while reading from the network - expected \\n minimum of 6 bytes and received only -1 bytes.  The connection has been terminated. \\n        at org.apache.derby.client.net.Reply.fill(Reply.java:195) \\n        at org.apache.derby.client.net.Reply.ensureALayerDataInBuffer(Reply.java:215) \\n        at org.apache.derby.client.net.Reply.readDssHeader(Reply.java:317) \\n        at org.apache.derby.client.net.Reply.startSameIdChainParse(Reply.java:1147) \\n        at org.apache.derby.client.net.NetStatementReply.readExecute(NetStatementReply.java:69) \\n        at org.apache.derby.client.net.StatementReply.readExecute(StatementReply.java:55) \\n        at org.apache.derby.client.net.NetPreparedStatement.readExecute_(NetPreparedStatement.java:183) \\n        at org.apache.derby.client.am.PreparedStatement.readExecute(PreparedStatement.java:1796) \\n        at org.apache.derby.client.am.PreparedStatement.flowExecute(PreparedStatement.java:2116) \\n        at org.apache.derby.client.am.PreparedStatement.executeUpdateX(PreparedStatement.java:396) \\n        at org.apache.derby.client.am.PreparedStatement.executeUpdate(PreparedStatement.java:382) \\n        ... 2 more \\n\\n\\n\\n With 10.2.2.0 the program runs cleanly.  Marking as a regression. \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12562255\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12562255&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12562255\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562255_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562255_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Jan\\/08 22:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-24T22:19:55+0000\'\u003e24\\/Jan\\/08 22:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ehmmm.. using the error.java attached to the original email thread I get the IndexOutOfBoundsException.\u003cbr\\/\u003e\\nperforming dump.\u003cbr\\/\u003e\\njava.lang.IndexOutOfBoundsException: Index: 0, Size: 0\u003cbr\\/\u003e\\n        at java.util.ArrayList.RangeCheck(ArrayList.java:572)\u003cbr\\/\u003e\\n        at java.util.ArrayList.get(ArrayList.java:347)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.NetCursor.findExtdtaData(NetCursor.java:1049)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.NetCursor.getClobColumn_(NetCursor.java:1122)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.Cursor.getClob(Cursor.java:1187)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.ResultSet.getClob(ResultSet.java:1259)\u003cbr\\/\u003e\\n        at error.getLob(error.java:97)\u003cbr\\/\u003e\\n        at error.dump_db(error.java:161)\u003cbr\\/\u003e\\n        at error.main(error.java:172)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562255_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562255_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Jan\\/08 22:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-24T22:19:55+0000\'\u003e24\\/Jan\\/08 22:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    hmmm.. using the error.java attached to the original email thread I get the IndexOutOfBoundsException. \\nperforming dump. \\njava.lang.IndexOutOfBoundsException: Index: 0, Size: 0 \\n        at java.util.ArrayList.RangeCheck(ArrayList.java:572) \\n        at java.util.ArrayList.get(ArrayList.java:347) \\n        at org.apache.derby.client.net.NetCursor.findExtdtaData(NetCursor.java:1049) \\n        at org.apache.derby.client.net.NetCursor.getClobColumn_(NetCursor.java:1122) \\n        at org.apache.derby.client.am.Cursor.getClob(Cursor.java:1187) \\n        at org.apache.derby.client.am.ResultSet.getClob(ResultSet.java:1259) \\n        at error.getLob(error.java:97) \\n        at error.dump_db(error.java:161) \\n        at error.main(error.java:172)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12562325\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12562325&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12562325\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562325_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562325_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jan\\/08 01:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-25T01:17:08+0000\'\u003e25\\/Jan\\/08 01:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Kathey Marsden - 25\\/Jan\\/08 01:23\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis regression was caused by the following change:\u003cbr\\/\u003e\\n\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-2702\\\" title=\\\"Enable Clob locator support between NetworkServer and NetworkClient and modify tests that experience changed behaviour due to this(enabling Clob Locators).\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-2702\\\"\u003e\u003cdel\u003eDERBY-2702\u003c\\/del\u003e\u003c\\/a\u003e Enable Clob locator support between NetworkServer and NetworkClient and modify tests that experience changed behaviour due to this(enabling Clob Locators).\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"http:\\/\\/svn.apache.org\\/viewvc?view=rev&amp;revision=544481\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/svn.apache.org\\/viewvc?view=rev&amp;revision=544481\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eContributed by V.Narayanan\u003c\\/p\u003e\\n\\n\u003cp\u003eIt was a small patch but enabled code from other Jira issues I think.\u003c\\/p\u003e\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562325_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562325_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jan\\/08 01:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-25T01:17:08+0000\'\u003e25\\/Jan\\/08 01:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Kathey Marsden - 25\\/Jan\\/08 01:23\\\"\u003eedited\u003c\\/span\u003e                   This regression was caused by the following change: \\n  DERBY-2702   Enable Clob locator support between NetworkServer and NetworkClient and modify tests that experience changed behaviour due to this(enabling Clob Locators). \\n\\n  http:\\/\\/svn.apache.org\\/viewvc?view=rev&amp;revision=544481  \\n\\n Contributed by V.Narayanan \\n\\n It was a small patch but enabled code from other Jira issues I think. \\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12562702\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12562702&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12562702\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562702_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562702_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jan\\/08 21:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-25T21:54:25+0000\'\u003e25\\/Jan\\/08 21:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAt the root of this issue is this function in EmbedConnection.  We seem to increment this value for every lob value on the connection and then send it as a signed int which overflows at 32768, causing the high bit to be set and the client to think that it is getting a lob value instead of locator.\u003cbr\\/\u003e\\n\\t\\/**\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eReturn the current locator value\u003c\\/li\u003e\\n\\t\u003cli\u003e@return an integer that represents the most recent locator value.\u003cbr\\/\u003e\\n\\t*\\/\u003cbr\\/\u003e\\n\\tprivate int getIncLOBKey() \\n{\\n\\t\\treturn ++rootConnection.lobHMKey ;\\n\\t}\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\\n\u003cp\u003eI\'d appreciate input from the lob locator folks on what is the best course of action at this point.  Should we switch to sending by value when we reach this limit? As an aside, one thing I noticed is that lobHMKey actually never gets reset, even with EmbedConnection.clearLOBMapping() .  That would not help in this case however as we don\'t get a commit.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562702_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562702_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jan\\/08 21:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-25T21:54:25+0000\'\u003e25\\/Jan\\/08 21:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    At the root of this issue is this function in EmbedConnection.  We seem to increment this value for every lob value on the connection and then send it as a signed int which overflows at 32768, causing the high bit to be set and the client to think that it is getting a lob value instead of locator. \\n\\t\\/** \\n \\n\\t Return the current locator value \\n\\t @return an integer that represents the most recent locator value. \\n\\t*\\/ \\n\\tprivate int getIncLOBKey() \\n{\\n\\t\\treturn ++rootConnection.lobHMKey ;\\n\\t} \\n \\n\\n\\n\\n I\'d appreciate input from the lob locator folks on what is the best course of action at this point.  Should we switch to sending by value when we reach this limit? As an aside, one thing I noticed is that lobHMKey actually never gets reset, even with EmbedConnection.clearLOBMapping() .  That would not help in this case however as we don\'t get a commit. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12562868\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12562868&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12562868\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562868_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562868_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Jan\\/08 14:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-26T14:59:13+0000\'\u003e26\\/Jan\\/08 14:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAnother thing I noticed when looking at this bug is that each lob is added to the HashMap twice. Once as a side effect of getObject and then again with a call to:\u003cbr\\/\u003e\\n int locator = database.getConnection().addLOBMapping(val);\u003c\\/p\u003e\\n\\n\u003cp\u003eso the repro fails on row 16384 instead of 32768.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562868_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562868_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Jan\\/08 14:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-26T14:59:13+0000\'\u003e26\\/Jan\\/08 14:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Another thing I noticed when looking at this bug is that each lob is added to the HashMap twice. Once as a side effect of getObject and then again with a call to: \\n int locator = database.getConnection().addLOBMapping(val); \\n\\n so the repro fails on row 16384 instead of 32768.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12562915\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12562915&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12562915\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562915_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562915_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Jan\\/08 20:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-26T20:40:38+0000\'\u003e26\\/Jan\\/08 20:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached is a patch to fix the double entry of lobs in the lob hashmap for network server.  We now store the locator in the lob so network server can retrieve it instead of doing a second store of the lob.  \u003c\\/p\u003e\\n\\n\u003cp\u003eThe test case still fails but retrieves double the number of rows before failing, so it does not fix the core bug.  I just thought I would fix this while it was in front of me.  I didn\'t add a functional test. I wasn\'t sure how appropriate it was to add a test with a table with 32K rows to the functional tests.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe patch also resets the lob key on commit\\/rollback which will help prevent this bug from hitting upon retrieving 32K lobs even across transaction boundaries.\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562915_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562915_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Jan\\/08 20:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-26T20:40:38+0000\'\u003e26\\/Jan\\/08 20:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attached is a patch to fix the double entry of lobs in the lob hashmap for network server.  We now store the locator in the lob so network server can retrieve it instead of doing a second store of the lob.   \\n\\n The test case still fails but retrieves double the number of rows before failing, so it does not fix the core bug.  I just thought I would fix this while it was in front of me.  I didn\'t add a functional test. I wasn\'t sure how appropriate it was to add a test with a table with 32K rows to the functional tests. \\n\\n The patch also resets the lob key on commit\\/rollback which will help prevent this bug from hitting upon retrieving 32K lobs even across transaction boundaries. \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12562924\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12562924&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12562924\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562924_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562924_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Jan\\/08 22:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-26T22:04:13+0000\'\u003e26\\/Jan\\/08 22:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003epartial patch available.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12562924_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562924_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Jan\\/08 22:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-26T22:04:13+0000\'\u003e26\\/Jan\\/08 22:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    partial patch available.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12563132\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12563132&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12563132\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12563132_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563132_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jan\\/08 12:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-28T12:48:27+0000\'\u003e28\\/Jan\\/08 12:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eDoes the DRDA spec require that locators are two-byte integers, or could we use four bytes? Seems like we at least should make EmbedConnection.lobHMKey wrap around on the max value we are able to send over DRDA, and ensure that it doesn\'t go negative.\u003c\\/p\u003e\\n\\n\u003cp\u003eI don\'t think resetting the lob key on commit\\/rollback works, as the client does not expect the keys to be reused. Old Clob\\/Blob objects on the client will then start returning data for the queries performed in the new transaction. I ran the code below to test it.\u003c\\/p\u003e\\n\\n\u003cp\u003e----\u003cdel\u003e8&lt;\u003c\\/del\u003e----\u003cbr\\/\u003e\\nimport java.sql.*;\u003c\\/p\u003e\\n\\n\u003cp\u003epublic class ResetCounter {\u003cbr\\/\u003e\\n    public static void main(String[] args) throws Exception \u003c\\/p\u003e\\n{\\n        Class.forName(\\\"org.apache.derby.jdbc.ClientDriver\\\");\\n        Connection c = DriverManager.getConnection(\\n            \\\"jdbc:derby:\\/\\/localhost\\/db;create=true\\\");\\n\\n        Statement s1 = c.createStatement();\\n        ResultSet rs1 = s1.executeQuery(\\\"values cast(\'first\' as clob)\\\");\\n        rs1.next();\\n        Clob first = rs1.getClob(1);\\n        rs1.close(); \\/\\/ auto-commit happens here\\n\\n        Statement s2 = c.createStatement();\\n        ResultSet rs2 = s2.executeQuery(\\\"values cast(\'second\' as clob)\\\");\\n        rs2.next();\\n        Clob second = rs2.getClob(1);\\n\\n        System.out.println(\\\"1: \\\" + first.getSubString(1, 100)); \\/\\/ should fail\\n        System.out.println(\\\"2: \\\" + second.getSubString(1, 100));\\n\\n        rs2.close();\\n    }\\n\u003cp\u003e}\u003cbr\\/\u003e\\n----\u003cdel\u003e&gt;8\u003c\\/del\u003e----\u003c\\/p\u003e\\n\\n\u003cp\u003eWithout the patch, first.getSubString(1, 100) failed (correctly) because the transaction in which the Clob was created, had been committed. With the patch applied, it instead returned the data that the second transaction had retrieved.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12563132_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563132_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jan\\/08 12:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-28T12:48:27+0000\'\u003e28\\/Jan\\/08 12:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Does the DRDA spec require that locators are two-byte integers, or could we use four bytes? Seems like we at least should make EmbedConnection.lobHMKey wrap around on the max value we are able to send over DRDA, and ensure that it doesn\'t go negative. \\n\\n I don\'t think resetting the lob key on commit\\/rollback works, as the client does not expect the keys to be reused. Old Clob\\/Blob objects on the client will then start returning data for the queries performed in the new transaction. I ran the code below to test it. \\n\\n ---- 8&lt; ---- \\nimport java.sql.*; \\n\\n public class ResetCounter { \\n    public static void main(String[] args) throws Exception  \\n{\\n        Class.forName(\\\"org.apache.derby.jdbc.ClientDriver\\\");\\n        Connection c = DriverManager.getConnection(\\n            \\\"jdbc:derby:\\/\\/localhost\\/db;create=true\\\");\\n\\n        Statement s1 = c.createStatement();\\n        ResultSet rs1 = s1.executeQuery(\\\"values cast(\'first\' as clob)\\\");\\n        rs1.next();\\n        Clob first = rs1.getClob(1);\\n        rs1.close(); \\/\\/ auto-commit happens here\\n\\n        Statement s2 = c.createStatement();\\n        ResultSet rs2 = s2.executeQuery(\\\"values cast(\'second\' as clob)\\\");\\n        rs2.next();\\n        Clob second = rs2.getClob(1);\\n\\n        System.out.println(\\\"1: \\\" + first.getSubString(1, 100)); \\/\\/ should fail\\n        System.out.println(\\\"2: \\\" + second.getSubString(1, 100));\\n\\n        rs2.close();\\n    }\\n } \\n---- &gt;8 ---- \\n\\n Without the patch, first.getSubString(1, 100) failed (correctly) because the transaction in which the Clob was created, had been committed. With the patch applied, it instead returned the data that the second transaction had retrieved.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12563204\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12563204&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12563204\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12563204_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563204_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jan\\/08 17:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-28T17:06:38+0000\'\u003e28\\/Jan\\/08 17:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Knut for looking at the patch and catching that resetting the lob key on commit\\/rollback doesn\'t work.  I will add your test to the regression test so we have a test for that.  It seems to me that we would have the same problem (albeit further removed) if we roll over the lob key at 32K.   I will look at the DRDA spec and see if there is an opportunity to send a larger value.\u003c\\/p\u003e\\n\\n\u003cp\u003eI wonder if you had a chance to look at the rest of the patch to avoid storing the locator twice for each lob. Does that change look ok?\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12563204_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563204_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jan\\/08 17:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-28T17:06:38+0000\'\u003e28\\/Jan\\/08 17:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Knut for looking at the patch and catching that resetting the lob key on commit\\/rollback doesn\'t work.  I will add your test to the regression test so we have a test for that.  It seems to me that we would have the same problem (albeit further removed) if we roll over the lob key at 32K.   I will look at the DRDA spec and see if there is an opportunity to send a larger value. \\n\\n I wonder if you had a chance to look at the rest of the patch to avoid storing the locator twice for each lob. Does that change look ok? \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12563496\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12563496&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12563496\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12563496_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563496_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 12:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T12:41:10+0000\'\u003e29\\/Jan\\/08 12:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; It seems to me that we would have the same problem (albeit further removed) if we roll over the lob key at 32K. I will look at the DRDA spec and see if there is an opportunity to send a larger value.\u003c\\/p\u003e\\n\\n\u003cp\u003eYes, we would have the same problem. If we find a way to use e.g. 4-byte integers it would only manifest itself if someone retrieves a lob, keeps it while retrieving billions of other lobs in the same connection, and then tries to access the first lob. In that case, I think it\'s highly unlikely that someone will be bitten by it.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think the rest of the patch looks OK (except there\'s a typo in the javadoc for EmbedClob.getLocator(): loctor -&gt; locator, and in EngineBlob\\/EngineClob: getLobLobMapping() -&gt; getLOBMapping()).\u003c\\/p\u003e\\n\\n\u003cp\u003eDo you think we should use getLocator() instead of addLOBMapping() in LobStoredProcedure.BLOBCREATELOCATOR() and CLOBCREATELOCATOR() as well? Seems like the Blobs\\/Clobs they create already have called addLOBMapping() in their constructors.\u003c\\/p\u003e\\n\\n\u003cp\u003eAnother thing I came to think about: Would it be better to remove addLOBMapping() from the constructors in EmbedBlob\\/EmbedClob and instead call it lazily from getLocator()? Something like:\u003c\\/p\u003e\\n\\n\u003cp\u003e  public int getLocator() {\u003cbr\\/\u003e\\n      if (locator == -1) \u003c\\/p\u003e\\n{\\n          locator = getEmbedConnection().addLOBMapping(this);\\n      }\\n\u003cp\u003e      return locator;\u003cbr\\/\u003e\\n  }\u003c\\/p\u003e\\n\\n\u003cp\u003eThen we\'d also remove the overhead of maintaining the lob mapping in embedded mode.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12563496_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563496_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 12:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T12:41:10+0000\'\u003e29\\/Jan\\/08 12:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; It seems to me that we would have the same problem (albeit further removed) if we roll over the lob key at 32K. I will look at the DRDA spec and see if there is an opportunity to send a larger value. \\n\\n Yes, we would have the same problem. If we find a way to use e.g. 4-byte integers it would only manifest itself if someone retrieves a lob, keeps it while retrieving billions of other lobs in the same connection, and then tries to access the first lob. In that case, I think it\'s highly unlikely that someone will be bitten by it. \\n\\n I think the rest of the patch looks OK (except there\'s a typo in the javadoc for EmbedClob.getLocator(): loctor -&gt; locator, and in EngineBlob\\/EngineClob: getLobLobMapping() -&gt; getLOBMapping()). \\n\\n Do you think we should use getLocator() instead of addLOBMapping() in LobStoredProcedure.BLOBCREATELOCATOR() and CLOBCREATELOCATOR() as well? Seems like the Blobs\\/Clobs they create already have called addLOBMapping() in their constructors. \\n\\n Another thing I came to think about: Would it be better to remove addLOBMapping() from the constructors in EmbedBlob\\/EmbedClob and instead call it lazily from getLocator()? Something like: \\n\\n   public int getLocator() { \\n      if (locator == -1)  \\n{\\n          locator = getEmbedConnection().addLOBMapping(this);\\n      }\\n       return locator; \\n  } \\n\\n Then we\'d also remove the overhead of maintaining the lob mapping in embedded mode.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12563546\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12563546&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12563546\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"oysteing\\\" id=\\\"commentauthor_12563546_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=oysteing\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"oysteing\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e \\u00D8ystein Gr\\u00F8vlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563546_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 15:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T15:13:31+0000\'\u003e29\\/Jan\\/08 15:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"\\u00D8ystein Gr\\u00F8vlen - 29\\/Jan\\/08 15:18\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have not time to look at the details of this problem today, but I\u003cbr\\/\u003e\\nthought I would write up a few things based on what I remember from\u003cbr\\/\u003e\\nreviewing this work.\u003c\\/p\u003e\\n\\n\u003cp\u003eI am not sure if it is a good idea, but the locator mapping table is\u003cbr\\/\u003e\\nused for two separate issues:\u003c\\/p\u003e\\n\\n\u003cp\u003e  1. It used by the network server to store the mapping from locator\u003cbr\\/\u003e\\n     by client to EmbedBlob\\/EmbedClob.  This is used by stored\u003cbr\\/\u003e\\n     procedures that is called by the client for LOB operations.\u003c\\/p\u003e\\n\\n\u003cp\u003e  2. It is used by the embedded driver to store references to LOB\u003cbr\\/\u003e\\n     objects that due to their size temporarily spills to disk.  This\u003cbr\\/\u003e\\n     is done so that the temporary files can be cleaned up on\u003cbr\\/\u003e\\n     commit\\/rollback.\u003c\\/p\u003e\\n\\n\u003cp\u003eTo me it sounds like the item 2. is implemented so that all LOB\u003cbr\\/\u003e\\nobjects are stored in the mapping table, not just those that need\u003cbr\\/\u003e\\nclean-up.  (I am guessing, I have not checked the code).  That would\u003cbr\\/\u003e\\nmake two entries for every client LOB.\u003c\\/p\u003e\\n\\n\u003cp\u003eWith respect to the wrapping locator generator, I think it should be\u003cbr\\/\u003e\\npossible to reuse locators that have been released.  Hence, one way to\u003cbr\\/\u003e\\nsolve this is to start at 0 when it wraps, and iterate until an unused\u003cbr\\/\u003e\\nlocator is found.\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"oysteing\\\" id=\\\"commentauthor_12563546_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=oysteing\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"oysteing\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e \\u00D8ystein Gr\\u00F8vlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563546_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 15:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T15:13:31+0000\'\u003e29\\/Jan\\/08 15:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"\\u00D8ystein Gr\\u00F8vlen - 29\\/Jan\\/08 15:18\\\"\u003eedited\u003c\\/span\u003e                   I have not time to look at the details of this problem today, but I \\nthought I would write up a few things based on what I remember from \\nreviewing this work. \\n\\n I am not sure if it is a good idea, but the locator mapping table is \\nused for two separate issues: \\n\\n   1. It used by the network server to store the mapping from locator \\n     by client to EmbedBlob\\/EmbedClob.  This is used by stored \\n     procedures that is called by the client for LOB operations. \\n\\n   2. It is used by the embedded driver to store references to LOB \\n     objects that due to their size temporarily spills to disk.  This \\n     is done so that the temporary files can be cleaned up on \\n     commit\\/rollback. \\n\\n To me it sounds like the item 2. is implemented so that all LOB \\nobjects are stored in the mapping table, not just those that need \\nclean-up.  (I am guessing, I have not checked the code).  That would \\nmake two entries for every client LOB. \\n\\n With respect to the wrapping locator generator, I think it should be \\npossible to reuse locators that have been released.  Hence, one way to \\nsolve this is to start at 0 when it wraps, and iterate until an unused \\nlocator is found. \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12563552\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12563552&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12563552\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12563552_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563552_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 15:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T15:34:50+0000\'\u003e29\\/Jan\\/08 15:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOystein\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt;With respect to the wrapping locator generator, I think it should be\u003cbr\\/\u003e\\n&gt;possible to reuse locators that have been released. Hence, one way to\u003cbr\\/\u003e\\n&gt;solve this is to start at 0 when it wraps, and iterate until an unused\u003cbr\\/\u003e\\n&gt;locator is found.\u003c\\/p\u003e\\n\\n\u003cp\u003eStill the test case attached to this issue would fail as there are no calls to Clob.free() since it appears to be written against jdk1.5. The core problem is that we are limitted to 32K entries. I was looking at the spec at section 5.6.5.13 and if I read that correctly (which  perhaps I am not) we are limitted to 4 bytes for the locator.  I am not sure how to get around this hard limit.\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12563552_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563552_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 15:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T15:34:50+0000\'\u003e29\\/Jan\\/08 15:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Oystein \\n\\n &gt;With respect to the wrapping locator generator, I think it should be \\n&gt;possible to reuse locators that have been released. Hence, one way to \\n&gt;solve this is to start at 0 when it wraps, and iterate until an unused \\n&gt;locator is found. \\n\\n Still the test case attached to this issue would fail as there are no calls to Clob.free() since it appears to be written against jdk1.5. The core problem is that we are limitted to 32K entries. I was looking at the spec at section 5.6.5.13 and if I read that correctly (which  perhaps I am not) we are limitted to 4 bytes for the locator.  I am not sure how to get around this hard limit. \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12563563\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12563563&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12563563\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12563563_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563563_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 16:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T16:11:47+0000\'\u003e29\\/Jan\\/08 16:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; I was looking at the spec at section 5.6.5.13 and if I read that correctly (which perhaps I am not) we are limitted to 4 bytes for the locator. I am not sure how to get around this hard limit.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think you read it correctly (section 5.6.5 says bits 10-11 in lower box represent maximum length in bytes, not including length field or null indicator, and section 5.6.5.13 has the value 4 in bits 10-11). Note that with 4 bytes we are limited to ~4 billion entries (or ~2 billion if the sign bit is stripped off), not 32K. It\'s just that the current implementation only uses two bytes, hence the 32K limit.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12563563_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563563_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 16:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T16:11:47+0000\'\u003e29\\/Jan\\/08 16:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; I was looking at the spec at section 5.6.5.13 and if I read that correctly (which perhaps I am not) we are limitted to 4 bytes for the locator. I am not sure how to get around this hard limit. \\n\\n I think you read it correctly (section 5.6.5 says bits 10-11 in lower box represent maximum length in bytes, not including length field or null indicator, and section 5.6.5.13 has the value 4 in bits 10-11). Note that with 4 bytes we are limited to ~4 billion entries (or ~2 billion if the sign bit is stripped off), not 32K. It\'s just that the current implementation only uses two bytes, hence the 32K limit.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12563668\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12563668&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12563668\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12563668_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563668_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 21:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T21:06:16+0000\'\u003e29\\/Jan\\/08 21:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere is the patch to fix the double hashmap entries without resetting the lob key.  I plan to commit this tomorrow if I don\'t hear back.\u003c\\/p\u003e\\n\\n\u003cp\u003eKathey\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12563668_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563668_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 21:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T21:06:16+0000\'\u003e29\\/Jan\\/08 21:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here is the patch to fix the double hashmap entries without resetting the lob key.  I plan to commit this tomorrow if I don\'t hear back. \\n\\n Kathey \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12563767\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12563767&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12563767\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12563767_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563767_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jan\\/08 00:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-30T00:59:46+0000\'\u003e30\\/Jan\\/08 00:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSo we do send and receive a 4 byte int, but we have this check in the locator(int column) method of NetCursor which says the highest bit will be set if it is not a locator, but it is not the highest bit that we are checking, so we end up using only two bytes for our locator.\u003c\\/p\u003e\\n\\n\u003cp\u003ePerhaps in the case of lob value we are reading the extended length indicator which will be 0x800x.  I\'m not sure if that\'s what\'s going on though.  I did try  against a 10.2 server to see if the check is necessary for sending lobs by value and found that indeed it is.\u003c\\/p\u003e\\n\\n\u003cp\u003eRemoving the check in 10.4 and just returning the locator gets us through the repro.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt seems like maybe instead of this check we should be able to tell by the drda type whether we have a locator or a value.\u003c\\/p\u003e\\n\\n\u003cp\u003e private int locator(int column)\u003cbr\\/\u003e\\n    {\u003cbr\\/\u003e\\n        int locator = get_INTEGER(column);\u003cbr\\/\u003e\\n        \\/\\/ If Lob value was sent instead of locator, highest bit will be set\u003cbr\\/\u003e\\n        \\/\\/ Zero is not a valid locator, it indicates a zero length value\u003cbr\\/\u003e\\n        if (((locator &amp; 0x8000) == 0x8000) || (locator == 0)) \u003c\\/p\u003e\\n{\\n            return Lob.INVALID_LOCATOR;\\n        }\\n\u003cp\u003e else \u003c\\/p\u003e\\n{\\n            return locator;\\n        }\\n\u003cp\u003e    }\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12563767_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563767_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jan\\/08 00:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-30T00:59:46+0000\'\u003e30\\/Jan\\/08 00:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    So we do send and receive a 4 byte int, but we have this check in the locator(int column) method of NetCursor which says the highest bit will be set if it is not a locator, but it is not the highest bit that we are checking, so we end up using only two bytes for our locator. \\n\\n Perhaps in the case of lob value we are reading the extended length indicator which will be 0x800x.  I\'m not sure if that\'s what\'s going on though.  I did try  against a 10.2 server to see if the check is necessary for sending lobs by value and found that indeed it is. \\n\\n Removing the check in 10.4 and just returning the locator gets us through the repro. \\n\\n It seems like maybe instead of this check we should be able to tell by the drda type whether we have a locator or a value. \\n\\n  private int locator(int column) \\n    { \\n        int locator = get_INTEGER(column); \\n        \\/\\/ If Lob value was sent instead of locator, highest bit will be set \\n        \\/\\/ Zero is not a valid locator, it indicates a zero length value \\n        if (((locator &amp; 0x8000) == 0x8000) || (locator == 0))  \\n{\\n            return Lob.INVALID_LOCATOR;\\n        }\\n  else  \\n{\\n            return locator;\\n        }\\n     }              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12563922\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12563922&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12563922\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12563922_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563922_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jan\\/08 09:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-30T09:32:20+0000\'\u003e30\\/Jan\\/08 09:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe new patch looks fine, but it still has the typos I mentioned in an earlier comment. It should also change LOBStoredProcedure.BLOBCREATELOCATOR and LOBStoredProcedure.CLOBCREATELOCATOR so that they use getLocator() instead of addLOBMapping().\u003c\\/p\u003e\\n\\n\u003cp\u003eI think this change also means that addLOBMapping() should be removed from EngineConnection and BrokeredConnection, and made package private in the EmbedConnection class.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt would also be good to make the locator field in EmbedBlob\\/EmbedClob final, so that we check on compile-time that it hasn\'t been forgotten in one of the constructors.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12563922_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563922_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jan\\/08 09:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-30T09:32:20+0000\'\u003e30\\/Jan\\/08 09:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The new patch looks fine, but it still has the typos I mentioned in an earlier comment. It should also change LOBStoredProcedure.BLOBCREATELOCATOR and LOBStoredProcedure.CLOBCREATELOCATOR so that they use getLocator() instead of addLOBMapping(). \\n\\n I think this change also means that addLOBMapping() should be removed from EngineConnection and BrokeredConnection, and made package private in the EmbedConnection class. \\n\\n It would also be good to make the locator field in EmbedBlob\\/EmbedClob final, so that we check on compile-time that it hasn\'t been forgotten in one of the constructors.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564031\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12564031&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564031\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"oysteing\\\" id=\\\"commentauthor_12564031_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=oysteing\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"oysteing\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e \\u00D8ystein Gr\\u00F8vlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564031_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jan\\/08 14:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-30T14:30:50+0000\'\u003e30\\/Jan\\/08 14:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think part of the confusion here is that EmbedConnection#lobHashMap\u003cbr\\/\u003e\\nis used for two separate purposes.  It was first added as a mechanism\u003cbr\\/\u003e\\nfor the NetworkServer to add locators mapping for locators that were\u003cbr\\/\u003e\\nsent to the client.  This mechanism was intented to by driven by the\u003cbr\\/\u003e\\nNetworkServer, but EmbedConnection is used for storage since it is\u003cbr\\/\u003e\\npersistent across client requests.\u003c\\/p\u003e\\n\\n\u003cp\u003eLater, the same hash map was used to store references to all internal\u003cbr\\/\u003e\\nLobs in order to be able to do clean-up at end of transaction.  (I was\u003cbr\\/\u003e\\nwrong when I earlier wrote that this was really only needed for LOB\u003cbr\\/\u003e\\nobjects that had associated temporary files.  This mechanism is used\u003cbr\\/\u003e\\nin order to invalidate any active LOB object at the end of\u003cbr\\/\u003e\\ntransaction.)\u003c\\/p\u003e\\n\\n\u003cp\u003eThere are other ways to achieve invalidation at end of transaction,\u003cbr\\/\u003e\\nbut as long as we are using the current mechanism, it will be\u003cbr\\/\u003e\\nnecessary to keep track of all active LOB objects of a connection.\u003cbr\\/\u003e\\nGiven that, it is not necessary for the network server to do its own\u003cbr\\/\u003e\\nbook-keeping.  Instead, it could rely on the embedded driver for this.\u003cbr\\/\u003e\\nI think Kathey\'s patch is a step in the right direction here, but as\u003cbr\\/\u003e\\nKnut Anders suggest I think we should go a step further and remove all\u003cbr\\/\u003e\\ntraces of how this is currently done by the network server.\u003c\\/p\u003e\\n\\n\u003cp\u003eI also think that it would be better if this clean-up was tied to\u003cbr\\/\u003e\\n\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3354\\\" title=\\\"Select from large lob table with embedded gives OutOfMemoryError\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3354\\\"\u003e\u003cdel\u003eDERBY-3354\u003c\\/del\u003e\u003c\\/a\u003e which I feel is more related.  Then this JIRA could focus\u003cbr\\/\u003e\\non the DRDA problems that causes the reported bug. (I will discuss\u003cbr\\/\u003e\\nthat issue in a separate comment.)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"oysteing\\\" id=\\\"commentauthor_12564031_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=oysteing\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"oysteing\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e \\u00D8ystein Gr\\u00F8vlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564031_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jan\\/08 14:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-30T14:30:50+0000\'\u003e30\\/Jan\\/08 14:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I think part of the confusion here is that EmbedConnection#lobHashMap \\nis used for two separate purposes.  It was first added as a mechanism \\nfor the NetworkServer to add locators mapping for locators that were \\nsent to the client.  This mechanism was intented to by driven by the \\nNetworkServer, but EmbedConnection is used for storage since it is \\npersistent across client requests. \\n\\n Later, the same hash map was used to store references to all internal \\nLobs in order to be able to do clean-up at end of transaction.  (I was \\nwrong when I earlier wrote that this was really only needed for LOB \\nobjects that had associated temporary files.  This mechanism is used \\nin order to invalidate any active LOB object at the end of \\ntransaction.) \\n\\n There are other ways to achieve invalidation at end of transaction, \\nbut as long as we are using the current mechanism, it will be \\nnecessary to keep track of all active LOB objects of a connection. \\nGiven that, it is not necessary for the network server to do its own \\nbook-keeping.  Instead, it could rely on the embedded driver for this. \\nI think Kathey\'s patch is a step in the right direction here, but as \\nKnut Anders suggest I think we should go a step further and remove all \\ntraces of how this is currently done by the network server. \\n\\n I also think that it would be better if this clean-up was tied to \\n  DERBY-3354   which I feel is more related.  Then this JIRA could focus \\non the DRDA problems that causes the reported bug. (I will discuss \\nthat issue in a separate comment.)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564040\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12564040&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564040\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"oysteing\\\" id=\\\"commentauthor_12564040_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=oysteing\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"oysteing\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e \\u00D8ystein Gr\\u00F8vlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564040_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jan\\/08 15:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-30T15:08:39+0000\'\u003e30\\/Jan\\/08 15:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe reasoning for the check in NetCursor#locator was to be able to\u003cbr\\/\u003e\\nboth handle pre-10.3 servers, and 10.3 servers running in soft-upgrade\u003cbr\\/\u003e\\nmode, both which ignore requests for use of locators.  I guess the\u003cbr\\/\u003e\\nfirst group could be handled by recognizing that the server is\u003cbr\\/\u003e\\npre-10.3, and it should also be possible to come up with a separate\u003cbr\\/\u003e\\nmechanism to handle soft upgrade.  However, It would be even better if\u003cbr\\/\u003e\\none where able to communicate the type of each value dynamically, but\u003cbr\\/\u003e\\nI were not able to determine how to do this with DRDA.  Does anybody\u003cbr\\/\u003e\\nknow? \u003c\\/p\u003e\\n\\n\u003cp\u003eI think that when I added the code that checked whether a locator or\u003cbr\\/\u003e\\nLOB had been sent, I thought that the when a LOB was sent, its column\u003cbr\\/\u003e\\nposition would contain the length of the LOB with the high-order bit\u003cbr\\/\u003e\\nset.  However, it seems that what has originally been sent is not the\u003cbr\\/\u003e\\nlength of the LOB, but the length of the length field for the LOB, and\u003cbr\\/\u003e\\nit is not the high-order bit that is set, but the high-order bit of\u003cbr\\/\u003e\\nbyte 3.  When Layer B streaming was added, it seems the length of the\u003cbr\\/\u003e\\nlength field was fixed at 4 bytes so that now the client will always\u003cbr\\/\u003e\\nreceive 0x8004 for non-zero length LOBs.\u003c\\/p\u003e\\n\\n\u003cp\u003eI do not know whether the above is in accordance with the DRDA spec,\u003cbr\\/\u003e\\nand it also seems that the client expect the high-order bit to be set when\u003cbr\\/\u003e\\nthe length is unknown.  From NetCursor#isNonTrivialDataLob:\u003c\\/p\u003e\\n\\n\u003cp\u003e    \\/\\/ if the high-order bit is set, length is unknown -&gt; set value to x\'FF..FF\'\u003cbr\\/\u003e\\n    if (((dataBuffer_\u003cspan class=\\\"error\\\"\u003e&#91;position&#93;\u003c\\/span\u003e) &amp; 0x80) == 0x80) \u003c\\/p\u003e\\n{\\n        length = -1;\\n    }\\n\u003cp\u003e else {\u003c\\/p\u003e\\n\\n\u003cp\u003eA quick, but dirty, way to fix the reported bug would be to make the\u003cbr\\/\u003e\\nserver skip 0x8004 when allocating locators, and make the client\u003cbr\\/\u003e\\ncheck for this exact value when determining whether it has received a\u003cbr\\/\u003e\\nlocator or not.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"oysteing\\\" id=\\\"commentauthor_12564040_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=oysteing\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"oysteing\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e \\u00D8ystein Gr\\u00F8vlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564040_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jan\\/08 15:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-30T15:08:39+0000\'\u003e30\\/Jan\\/08 15:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The reasoning for the check in NetCursor#locator was to be able to \\nboth handle pre-10.3 servers, and 10.3 servers running in soft-upgrade \\nmode, both which ignore requests for use of locators.  I guess the \\nfirst group could be handled by recognizing that the server is \\npre-10.3, and it should also be possible to come up with a separate \\nmechanism to handle soft upgrade.  However, It would be even better if \\none where able to communicate the type of each value dynamically, but \\nI were not able to determine how to do this with DRDA.  Does anybody \\nknow?  \\n\\n I think that when I added the code that checked whether a locator or \\nLOB had been sent, I thought that the when a LOB was sent, its column \\nposition would contain the length of the LOB with the high-order bit \\nset.  However, it seems that what has originally been sent is not the \\nlength of the LOB, but the length of the length field for the LOB, and \\nit is not the high-order bit that is set, but the high-order bit of \\nbyte 3.  When Layer B streaming was added, it seems the length of the \\nlength field was fixed at 4 bytes so that now the client will always \\nreceive 0x8004 for non-zero length LOBs. \\n\\n I do not know whether the above is in accordance with the DRDA spec, \\nand it also seems that the client expect the high-order bit to be set when \\nthe length is unknown.  From NetCursor#isNonTrivialDataLob: \\n\\n     \\/\\/ if the high-order bit is set, length is unknown -&gt; set value to x\'FF..FF\' \\n    if (((dataBuffer_ &#91;position&#93; ) &amp; 0x80) == 0x80)  \\n{\\n        length = -1;\\n    }\\n  else { \\n\\n A quick, but dirty, way to fix the reported bug would be to make the \\nserver skip 0x8004 when allocating locators, and make the client \\ncheck for this exact value when determining whether it has received a \\nlocator or not.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564181\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12564181&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564181\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12564181_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564181_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jan\\/08 21:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-30T21:39:16+0000\'\u003e30\\/Jan\\/08 21:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOystein asked:\u003cbr\\/\u003e\\n&gt;However, It would be even better if\u003cbr\\/\u003e\\n&gt;one where able to communicate the type of each value dynamically, but\u003cbr\\/\u003e\\n&gt;I were not able to determine how to do this with DRDA. Does anybody\u003cbr\\/\u003e\\nknow? \u003c\\/p\u003e\\n\\n\u003cp\u003eI think that the sqlType that we send with the SQLDAGRP should be set to one of the following when we send by locator.\u003cbr\\/\u003e\\npublic\\tstatic final  int DB2_SQLTYPE_BLOB_LOCATOR = 960;    \\/\\/ BLOB locator\u003cbr\\/\u003e\\n\\tpublic\\tstatic final  int DB2_SQLTYPE_NBLOB_LOCATOR = 961;\u003cbr\\/\u003e\\n\\tpublic\\tstatic final  int DB2_SQLTYPE_CLOB_LOCATOR = 964;    \\/\\/ CLOB locator\u003cbr\\/\u003e\\n\\tpublic\\tstatic final  int DB2_SQLTYPE_NCLOB_LOCATOR = 965;\u003c\\/p\u003e\\n\\n\u003cp\u003eRight now we always send one of these whether it is by locator or value.\u003cbr\\/\u003e\\n\\tpublic\\tstatic final  int DB2_SQLTYPE_BLOB = 404;        \\/\\/ BLOB\u003cbr\\/\u003e\\n\\tpublic\\tstatic final  int DB2_SQLTYPE_NBLOB = 405;\u003cbr\\/\u003e\\n\\tpublic\\tstatic final  int DB2_SQLTYPE_CLOB = 408;        \\/\\/ CLOB\u003cbr\\/\u003e\\n\\tpublic\\tstatic final  int DB2_SQLTYPE_NCLOB = 409;\u003c\\/p\u003e\\n\\n\u003cp\u003eIf we send the specific SQL Type then the client should be able to branch its logic based on that.  There are issues of backward compatibility which would have to be dealt with, but it seems a better way for the client to figure out whether it is dealing with a locator or a value.\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12564181_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564181_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jan\\/08 21:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-30T21:39:16+0000\'\u003e30\\/Jan\\/08 21:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Oystein asked: \\n&gt;However, It would be even better if \\n&gt;one where able to communicate the type of each value dynamically, but \\n&gt;I were not able to determine how to do this with DRDA. Does anybody \\nknow?  \\n\\n I think that the sqlType that we send with the SQLDAGRP should be set to one of the following when we send by locator. \\npublic\\tstatic final  int DB2_SQLTYPE_BLOB_LOCATOR = 960;    \\/\\/ BLOB locator \\n\\tpublic\\tstatic final  int DB2_SQLTYPE_NBLOB_LOCATOR = 961; \\n\\tpublic\\tstatic final  int DB2_SQLTYPE_CLOB_LOCATOR = 964;    \\/\\/ CLOB locator \\n\\tpublic\\tstatic final  int DB2_SQLTYPE_NCLOB_LOCATOR = 965; \\n\\n Right now we always send one of these whether it is by locator or value. \\n\\tpublic\\tstatic final  int DB2_SQLTYPE_BLOB = 404;        \\/\\/ BLOB \\n\\tpublic\\tstatic final  int DB2_SQLTYPE_NBLOB = 405; \\n\\tpublic\\tstatic final  int DB2_SQLTYPE_CLOB = 408;        \\/\\/ CLOB \\n\\tpublic\\tstatic final  int DB2_SQLTYPE_NCLOB = 409; \\n\\n If we send the specific SQL Type then the client should be able to branch its logic based on that.  There are issues of backward compatibility which would have to be dealt with, but it seems a better way for the client to figure out whether it is dealing with a locator or a value. \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564452\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12564452&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564452\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12564452_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564452_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 18:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T18:40:33+0000\'\u003e31\\/Jan\\/08 18:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAnother long term drda solution might be Dynamic data format, described in section 7.8 of the drda manual.\u003cbr\\/\u003e\\n\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3353\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3353\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eEither this solution or branching based on the sqlType would mean version specific drda handling.  So I think I might pursue Oystein\'s suggestion for a quick fix and then more long term solutions can be pursued on the trunk.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12564452_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564452_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 18:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T18:40:33+0000\'\u003e31\\/Jan\\/08 18:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Another long term drda solution might be Dynamic data format, described in section 7.8 of the drda manual. \\n https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3353  \\n\\n Either this solution or branching based on the sqlType would mean version specific drda handling.  So I think I might pursue Oystein\'s suggestion for a quick fix and then more long term solutions can be pursued on the trunk.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564517\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12564517&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564517\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12564517_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564517_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 21:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T21:50:20+0000\'\u003e31\\/Jan\\/08 21:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached is a patch which implements Oystein\'s suggestion to exclude the extended length value from being a valid locator value.  I had to exclude 0x8000, 0x8002, 0x8004, and 0x8008 as these are all possible valid values with 10.1.\u003c\\/p\u003e\\n\\n\u003cp\u003eI tried the repro with the patch with various version combinations of 10.1, 10.2 and  trunk with the patch.\u003cbr\\/\u003e\\nI am running tests now.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12564517_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564517_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 21:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T21:50:20+0000\'\u003e31\\/Jan\\/08 21:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attached is a patch which implements Oystein\'s suggestion to exclude the extended length value from being a valid locator value.  I had to exclude 0x8000, 0x8002, 0x8004, and 0x8008 as these are all possible valid values with 10.1. \\n\\n I tried the repro with the patch with various version combinations of 10.1, 10.2 and  trunk with the patch. \\nI am running tests now.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564539\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12564539&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564539\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12564539_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564539_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 23:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T23:05:48+0000\'\u003e31\\/Jan\\/08 23:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFor completeness, you may also want to skip all negative values and zero (the client only accepts positive locators). This only happens if you wrap around at ~2 billion, but with long-lived connections (for instance in a connection pool) it\'s possible. We\'re only talking about 68 lobs a second continuously for one year... \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/wink.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12564539_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564539_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 23:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T23:05:48+0000\'\u003e31\\/Jan\\/08 23:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    For completeness, you may also want to skip all negative values and zero (the client only accepts positive locators). This only happens if you wrap around at ~2 billion, but with long-lived connections (for instance in a connection pool) it\'s possible. We\'re only talking about 68 lobs a second continuously for one year...                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564545\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12564545&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564545\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12564545_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564545_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 23:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T23:20:01+0000\'\u003e31\\/Jan\\/08 23:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIt would be good to expand the comment in getIncLOBKey() since this is quite ugly hack, and it won\'t be obvious to a reader why we skip those values. I propose something along these lines:\u003c\\/p\u003e\\n\\n\u003cp\u003e\\/\\/ Skip 0x8000, 0x8002, 0x8004, 0x8006, for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3243\\\" title=\\\"(jdbc net client) exception during normal iteration through &quot;ResultSet&quot; of &quot;select * from t&quot;\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3243\\\"\u003e\u003cdel\u003eDERBY-3243\u003c\\/del\u003e\u003c\\/a\u003e\u003cbr\\/\u003e\\n\\/\\/ Earlier versions of the Derby Network Server (&lt;10.3) didn\'t\u003cbr\\/\u003e\\n\\/\\/ support locators and would send an extended length field\u003cbr\\/\u003e\\n\\/\\/ with one of the above mentioned values instead of a\u003cbr\\/\u003e\\n\\/\\/ locator, even when locators were requested. To enable the\u003cbr\\/\u003e\\n\\/\\/ client driver to detect that locators aren\'t supported,\u003cbr\\/\u003e\\n\\/\\/ we don\'t use any of them as locator values.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12564545_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564545_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 23:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T23:20:01+0000\'\u003e31\\/Jan\\/08 23:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    It would be good to expand the comment in getIncLOBKey() since this is quite ugly hack, and it won\'t be obvious to a reader why we skip those values. I propose something along these lines: \\n\\n \\/\\/ Skip 0x8000, 0x8002, 0x8004, 0x8006, for   DERBY-3243   \\n\\/\\/ Earlier versions of the Derby Network Server (&lt;10.3) didn\'t \\n\\/\\/ support locators and would send an extended length field \\n\\/\\/ with one of the above mentioned values instead of a \\n\\/\\/ locator, even when locators were requested. To enable the \\n\\/\\/ client driver to detect that locators aren\'t supported, \\n\\/\\/ we don\'t use any of them as locator values.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564843\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12564843&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564843\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12564843_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564843_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 17:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T17:48:37+0000\'\u003e01\\/Feb\\/08 17:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached is derby-3243_diff.txt addressing Knut\'s comments to skip negative and 0 locators.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12564843_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564843_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 17:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T17:48:37+0000\'\u003e01\\/Feb\\/08 17:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attached is derby-3243_diff.txt addressing Knut\'s comments to skip negative and 0 locators.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12565825\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12565825&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12565825\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"djd\\\" id=\\\"commentauthor_12565825_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=djd\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"djd\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Daniel John Debrunner\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12565825_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/08 17:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-05T17:26:58+0000\'\u003e05\\/Feb\\/08 17:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis is marked \'existing application impact\' but I don\'t see any reason why. Does the solution require some change to existing applications?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"djd\\\" id=\\\"commentauthor_12565825_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=djd\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"djd\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Daniel John Debrunner\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12565825_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/08 17:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-05T17:26:58+0000\'\u003e05\\/Feb\\/08 17:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This is marked \'existing application impact\' but I don\'t see any reason why. Does the solution require some change to existing applications?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12565840\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12565840&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12565840\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12565840_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12565840_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/08 18:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-05T18:13:12+0000\'\u003e05\\/Feb\\/08 18:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUnchecking Existing Application Impact. This fix does not require any action or have impact on existing applications.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12565840_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12565840_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Feb\\/08 18:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-05T18:13:12+0000\'\u003e05\\/Feb\\/08 18:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Unchecking Existing Application Impact. This fix does not require any action or have impact on existing applications.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12566062\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3243?focusedCommentId=12566062&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12566062\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"os10000\\\" id=\\\"commentauthor_12566062_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=os10000\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"os10000\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Oliver Seidel\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12566062_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Feb\\/08 09:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-06T09:55:18+0000\'\u003e06\\/Feb\\/08 09:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHello Daniel,\u003c\\/p\u003e\\n\\n\u003cp\u003ethank you for all the effort.  I have opened the request when my\u003cbr\\/\u003e\\napplication \\\"outseeker\\\" (copies emails from MS Outlook into Derby)\u003cbr\\/\u003e\\nstopped working beyond a certain message volume.  I was able to \\\"fix\\\"\u003cbr\\/\u003e\\nthe problem by moving to the embedded version, thereby reducing the\u003cbr\\/\u003e\\nfunctionality (location independence) of my application.\u003c\\/p\u003e\\n\\n\u003cp\u003eSimilarly, I found \\\"critical\\\" to be a strong attribute, but reading\u003cbr\\/\u003e\\nthrough the definitions convinced me that it fit the problem.\u003c\\/p\u003e\\n\\n\u003cp\u003eI apologise if I did make a classification mistake.\u003c\\/p\u003e\\n\\n\u003cp\u003eBest regards,\u003c\\/p\u003e\\n\\n\u003cp\u003eOliver Seidel\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;focusedCommentId=12565825#action_12565825\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;focusedCommentId=12565825#action_12565825\u003c\\/a\u003e\u003cbr\\/\u003e\\nreason why.\u003cbr\\/\u003e\\n\\\"ResultSet\\\" of\u003cbr\\/\u003e\\n--------------------------------------------------------------------------------------------\u003cbr\\/\u003e\\n\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3243\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3243\u003c\\/a\u003e\u003cbr\\/\u003e\\n------------------\u003cbr\\/\u003e\\n10.3.1.4 -\u003cbr\\/\u003e\\nis where\u003cbr\\/\u003e\\ncase by\u003cbr\\/\u003e\\nmessages\u003cbr\\/\u003e\\nclob).\u003cbr\\/\u003e\\nThis is a\u003cbr\\/\u003e\\ndemonstration\u003cbr\\/\u003e\\nException\\\", but a\u003cbr\\/\u003e\\ndiagnosis that\u003cbr\\/\u003e\\ndata.\u003cbr\\/\u003e\\n--------------------------------------------------------------------------------\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\njava.io.StringWriter();\u003cbr\\/\u003e\\njava.io.PrintWriter(sw);\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\norg.apache.derby.drda.NetworkServerControl(java.net.InetAddress.getByName(host),port);\u003cbr\\/\u003e\\n\\\"\u003cins\u003eInteger.toString(port)\u003c\\/ins\u003e\\\".\\\");\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\n----------------------------------------------------------------------\u003cbr\\/\u003e\\n};\u003cbr\\/\u003e\\n----------------------------------------------------------------------\u003cbr\\/\u003e\\n0; };\u003cbr\\/\u003e\\n0; };\u003cbr\\/\u003e\\nreturn null;\u003cbr\\/\u003e\\nreturn\u003cbr\\/\u003e\\n-1; };\u003cbr\\/\u003e\\n-1; };\u003cbr\\/\u003e\\nmyclob\u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/error.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e; };\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\nString\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\nx.replaceAll(\\\"[\\\\0\\\\r\\\\\\\\\\\\\\\\]\\\",\\\"\\\").replaceAll(\\\"\'\\\",\\\"\\\\\\\\\\\\\\\"\\\").replaceAll(\\\",+\\\",\\\",\\\");\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\n(Math.pow(10.0,digits*Math.random()));\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\nvarchar(100),\u003cbr\\/\u003e\\n?, ?\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\nfrom\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003cbr\\/\u003e\\n------------------------------------------------------------------------\u003c\\/p\u003e\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"os10000\\\" id=\\\"commentauthor_12566062_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=os10000\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"os10000\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Oliver Seidel\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12566062_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Feb\\/08 09:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-06T09:55:18+0000\'\u003e06\\/Feb\\/08 09:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hello Daniel, \\n\\n thank you for all the effort.  I have opened the request when my \\napplication \\\"outseeker\\\" (copies emails from MS Outlook into Derby) \\nstopped working beyond a certain message volume.  I was able to \\\"fix\\\" \\nthe problem by moving to the embedded version, thereby reducing the \\nfunctionality (location independence) of my application. \\n\\n Similarly, I found \\\"critical\\\" to be a strong attribute, but reading \\nthrough the definitions convinced me that it fit the problem. \\n\\n I apologise if I did make a classification mistake. \\n\\n Best regards, \\n\\n Oliver Seidel \\n\\n\\n  https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3243?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;focusedCommentId=12565825#action_12565825  \\nreason why. \\n\\\"ResultSet\\\" of \\n-------------------------------------------------------------------------------------------- \\n https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3243  \\n------------------ \\n10.3.1.4 - \\nis where \\ncase by \\nmessages \\nclob). \\nThis is a \\ndemonstration \\nException\\\", but a \\ndiagnosis that \\ndata. \\n-------------------------------------------------------------------------------- \\n------------------------------------------------------------------------ \\n------------------------------------------------------------------------ \\n------------------------------------------------------------------------ \\njava.io.StringWriter(); \\njava.io.PrintWriter(sw); \\n------------------------------------------------------------------------ \\norg.apache.derby.drda.NetworkServerControl(java.net.InetAddress.getByName(host),port); \\n\\\" Integer.toString(port) \\\".\\\"); \\n------------------------------------------------------------------------ \\n---------------------------------------------------------------------- \\n}; \\n---------------------------------------------------------------------- \\n0; }; \\n0; }; \\nreturn null; \\nreturn \\n-1; }; \\n-1; }; \\nmyclob ; }; \\n------------------------------------------------------------------------ \\nString \\n------------------------------------------------------------------------ \\nx.replaceAll(\\\"[\\\\0\\\\r\\\\\\\\\\\\\\\\]\\\",\\\"\\\").replaceAll(\\\"\'\\\",\\\"\\\\\\\\\\\\\\\"\\\").replaceAll(\\\",+\\\",\\\",\\\"); \\n------------------------------------------------------------------------ \\n(Math.pow(10.0,digits*Math.random())); \\n------------------------------------------------------------------------ \\n------------------------------------------------------------------------ \\nvarchar(100), \\n?, ? \\n------------------------------------------------------------------------ \\nfrom \\n------------------------------------------------------------------------ \\n------------------------------------------------------------------------ \\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="10594";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=10594&amp;avatarId=10122\\\" alt=\\\"Derby\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\"\u003eDerby\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1520239237613"> 
    <input type="hidden" title="jira.request.server.time" value="248"> 
    <input type="hidden" title="jira.request.id" value="520x94383455x2"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="2"> 
    <input type="hidden" title="db.reads.time.in.ms" value="42"> 
    <input type="hidden" title="db.conns.time.in.ms" value="48"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 520x94383455x2
	          REQUEST TIMESTAMP : [05/Mar/2018:08:40:37 +0000]
	               REQUEST TIME : 0.2480
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 2

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=26, elapsedTotal=42537253, elapsedMin=565373, elapsedMax=12200074, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=30, elapsedTotal=48632367, elapsedMin=620053, elapsedMax=12240136, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
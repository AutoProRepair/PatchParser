<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|ac1577f781c587335c06270e3657ce76b0974379|lout"> 
  <link rel="shortcut icon" href="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"jira.instrumentation.laas\":false,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"com.atlassian.jira.issuetable.draggable\":true,\"jira.create.linked.issue\":true,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"jira.jql.suggestrecentfields\":false,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"jira.jql.smartautoselectfirst\":false,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.priorities.per.project\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"jira.renderer.consider.variable.format\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/vnd.wap.wbmp,image/png,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"a007f138357043\"";
WRM._unparsedData["project-id"]="12310230";
WRM._unparsedData["project-key"]="\"SOLR\"";
WRM._unparsedData["project-name"]="\"Solr\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310230";
WRM._unparsedData["projectKey"]="\"SOLR\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/74ac580603ca910fff0cfdf319e54add-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/98ceb006e504d7924d5ffc411626c6bc-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/c1e4d26ea276469807c3dc0918df482c-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/6bf9253c8d533109c3b02e26794be24e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/ccd2e67b523185973473e8bd5735c8f9-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/33e5e0166867c8c9228d44506f60b2e8/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/6579b6b8ba67abaa496e39b9242a18a4-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="SOLR-7191"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[SOLR-7191] Improve stability and startup performance of SolrCloud with thousands of collections - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[SOLR-7191] Improve stability and startup performance of SolrCloud with thousands of collections - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/SOLR" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FSOLR-7191">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310230" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Solr'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310230&amp;avatarId=22151"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/SOLR">Solr</a></li>
                 <li><a class="issue-link" data-issue-key="SOLR-7191" href="/jira/browse/SOLR-7191" id="key-val" rel="12779613">SOLR-7191</a></li>
                </ol>
                <h1 id="summary-val">Improve stability and startup performance of SolrCloud with thousands of collections</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FSOLR-7191"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/SOLR-7191/SOLR-7191.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/SOLR-7191/SOLR-7191.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/SOLR-7191/SOLR-7191.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/SOLR-7191/SOLR-7191.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" title="Bug - A problem which impairs or prevents the functions of the product." width="16"> Bug </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Resolved</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.</span>">Resolved</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="5.0 First 5.x release, Major release after 4.10">5.0</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+SOLR+AND+fixVersion+%3D+6.3" title="6.3 Minor release after 6.2">6.3</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+SOLR+AND+component+%3D+SolrCloud" title="SolrCloud ">SolrCloud</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <ul class="labels" id="labels-12779613-value"> 
                     <li><a class="lozenge" href="/jira/issues/?jql=labels+%3D+performance" title="performance"><span>performance</span></a></li> 
                     <li><a class="lozenge" href="/jira/issues/?jql=labels+%3D+scalability" title="scalability"><span>scalability</span></a></li> 
                    </ul> 
                   </div> 
                  </div> </li> 
                </ul> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>A user on the mailing list with thousands of collections (5000 on 4.10.3, 4000 on 5.0) is having severe problems with getting Solr to restart.</p> 
                  <p>I tried as hard as I could to duplicate the user setup, but I ran into many problems myself even before I was able to get 4000 collections created on a 5.0 example cloud setup. Restarting Solr takes a very long time, and it is not very stable once it's up and running.</p> 
                  <p>This kind of setup is very much pushing the envelope on SolrCloud performance and scalability. It doesn't help that I'm running both Solr nodes on one machine (I started with 'bin/solr -e cloud') and that ZK is embedded.</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/SOLR-7191?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/SOLR-7191?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/SOLR-7191?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/SOLR-7191?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12702929" data-issue-id="12779613" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12702929/lots-of-zkstatereader-updates-branch_5x.log" draggable="true" data-downloadurl="text/plain:lots-of-zkstatereader-updates-branch_5x.log:https://issues.apache.org/jira/secure/attachment/12702929/lots-of-zkstatereader-updates-branch_5x.log"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12702929/lots-of-zkstatereader-updates-branch_5x.log" title="Latest  05/Mar/15 23:23 - Shawn Heisey" draggable="true" data-downloadurl="text/plain:lots-of-zkstatereader-updates-branch_5x.log:https://issues.apache.org/jira/secure/attachment/12702929/lots-of-zkstatereader-updates-branch_5x.log">lots-of-zkstatereader-updates-branch_5x.log</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-03-05T23:23:57.751Z">05/Mar/15 23:23</time>
                   </dd>
                   <dd class="attachment-size">
                    384 kB
                   </dd>
                   <dd class="attachment-author">
                    Shawn Heisey
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12814024" data-issue-id="12779613" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12814024/SOLR-7191.patch" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12814024/SOLR-7191.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12814024/SOLR-7191.patch" title="Latest  28/Jun/16 05:46 - Noble Paul" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12814024/SOLR-7191.patch">SOLR-7191.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2016-06-28T05:46:24.034Z">28/Jun/16 05:46</time>
                   </dd>
                   <dd class="attachment-size">
                    7 kB
                   </dd>
                   <dd class="attachment-author">
                    Noble Paul
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12813797" data-issue-id="12779613" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12813797/SOLR-7191.patch" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12813797/SOLR-7191.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12813797/SOLR-7191.patch" title=" 27/Jun/16 17:05 - Noble Paul" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12813797/SOLR-7191.patch">SOLR-7191.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2016-06-27T17:05:10.780Z">27/Jun/16 17:05</time>
                   </dd>
                   <dd class="attachment-size">
                    10 kB
                   </dd>
                   <dd class="attachment-author">
                    Noble Paul
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12812460" data-issue-id="12779613" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12812460/SOLR-7191.patch" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12812460/SOLR-7191.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12812460/SOLR-7191.patch" title=" 22/Jun/16 11:59 - Noble Paul" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12812460/SOLR-7191.patch">SOLR-7191.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2016-06-22T11:59:33.264Z">22/Jun/16 11:59</time>
                   </dd>
                   <dd class="attachment-size">
                    12 kB
                   </dd>
                   <dd class="attachment-author">
                    Noble Paul
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12767699" data-issue-id="12779613" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12767699/SOLR-7191.patch" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12767699/SOLR-7191.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12767699/SOLR-7191.patch" title=" 21/Oct/15 00:23 - Damien Kamerman" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12767699/SOLR-7191.patch">SOLR-7191.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-10-21T00:23:30.821Z">21/Oct/15 00:23</time>
                   </dd>
                   <dd class="attachment-size">
                    11 kB
                   </dd>
                   <dd class="attachment-author">
                    Damien Kamerman
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12704635" data-issue-id="12779613" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12704635/SOLR-7191.patch" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12704635/SOLR-7191.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12704635/SOLR-7191.patch" title=" 15/Mar/15 03:24 - Damien Kamerman" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12704635/SOLR-7191.patch">SOLR-7191.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-03-15T03:24:59.142Z">15/Mar/15 03:24</time>
                   </dd>
                   <dd class="attachment-size">
                    3 kB
                   </dd>
                   <dd class="attachment-author">
                    Damien Kamerman
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12704584" data-issue-id="12779613" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12704584/SOLR-7191.patch" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12704584/SOLR-7191.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12704584/SOLR-7191.patch" title=" 14/Mar/15 11:39 - Damien Kamerman" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12704584/SOLR-7191.patch">SOLR-7191.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-03-14T11:39:26.416Z">14/Mar/15 11:39</time>
                   </dd>
                   <dd class="attachment-size">
                    8 kB
                   </dd>
                   <dd class="attachment-author">
                    Damien Kamerman
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12704102" data-issue-id="12779613" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12704102/SOLR-7191.patch" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12704102/SOLR-7191.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12704102/SOLR-7191.patch" title=" 12/Mar/15 06:17 - Damien Kamerman" draggable="true" data-downloadurl="text/plain:SOLR-7191.patch:https://issues.apache.org/jira/secure/attachment/12704102/SOLR-7191.patch">SOLR-7191.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-03-12T06:17:16.484Z">12/Mar/15 06:17</time>
                   </dd>
                   <dd class="attachment-size">
                    3 kB
                   </dd>
                   <dd class="attachment-author">
                    Damien Kamerman
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="is related to">
                   is related to
                  </dt> 
                  <dd id="internal-12756426_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" width="16" height="16" title="Improvement - An improvement or enhancement to an existing feature or task." alt="Improvement - An improvement or enhancement to an existing feature or task."> <span title="SOLR-6760: New optimized DistributedQueue implementation for overseer"> <a href="/jira/browse/SOLR-6760" data-issue-key="SOLR-6760" class="issue-link link-title resolution">SOLR-6760</a> <span class="link-summary">New optimized DistributedQueue implementation for overseer</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="view-subtasks" class="module toggle-wrap">
               <div id="view-subtasks_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="subtask-view-options" class="aui-list-section aui-first aui-last">
                     <li class="aui-list-item"><a id="subtasks-show-all" href="/jira/browse/SOLR-7191?subTaskView=all#issuetable" class="aui-list-checked aui-checked aui-list-item-link" title="Show All"><span>Show All</span></a></li>
                     <li class="aui-list-item"><a id="subtasks-show-open" href="/jira/browse/SOLR-7191?subTaskView=unresolved#issuetable" class="aui-list-checked aui-list-item-link" title="Show Open"><span>Show Open</span></a></li>
                     <li class="aui-list-item"><a id="subtasks-bulk-operation" href="/jira/issue/bulkedit/BulkEdit1!default.jspa?reset=true&amp;searchParent=SOLR-7191" class="aui-list-checked aui-list-item-link" title="Bulk operation"><span>Bulk operation</span></a></li>
                     <li class="aui-list-item"><a id="subtasks-open-issue-navigator" href="/jira/issues/?jql=parent%3DSOLR-7191" class="aui-list-checked aui-list-item-link" title="Open issue navigator"><span>Open issue navigator</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Sub-Tasks</h2>
               </div>
               <div class="mod-content">
                <div class="mod-content intform subtask-table-container"> 
                 <issuetable-web-component> 
                  <table id="issuetable"> 
                   <tbody>
                    <tr id="issuerow12783759" rel="12783759" data-issuekey="SOLR-7281" class="issuerow"> 
                     <td class="stsequence">
                      <div rel="0" class="subtask-done">
                       1.
                      </div> </td> 
                     <td class="stsummary"><a class="issue-link" data-issue-key="SOLR-7281" href="/jira/browse/SOLR-7281">Add an overseer action to publish an entire node as 'down'</a></td> 
                     <td class="issuetype"> <a class="issue-link" data-issue-key="SOLR-7281" href="/jira/browse/SOLR-7281"> <img src="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype" height="16" width="16" border="0" align="absmiddle" alt="Sub-task" title="Sub-task - The sub-task of the issue"> </a> </td> 
                     <td class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </td> 
                     <td class="assignee"> <span class="tinylink"><a class="user-hover" rel="markrmiller@gmail.com" id="assignee_markrmiller@gmail.com" href="/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com">Mark Miller</a></span> </td> 
                    </tr> 
                    <tr id="issuerow12783761" rel="12783761" data-issuekey="SOLR-7282" class="issuerow"> 
                     <td class="stsequence">
                      <div rel="1">
                       2.
                      </div> </td> 
                     <td class="stsummary"><a class="issue-link" data-issue-key="SOLR-7282" href="/jira/browse/SOLR-7282">Cache config or index schema objects by configset and share them across cores</a></td> 
                     <td class="issuetype"> <a class="issue-link" data-issue-key="SOLR-7282" href="/jira/browse/SOLR-7282"> <img src="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype" height="16" width="16" border="0" align="absmiddle" alt="Sub-task" title="Sub-task - The sub-task of the issue"> </a> </td> 
                     <td class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-blue-gray jira-issue-status-lozenge-new aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Open</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is open and ready for the assignee to start work on it.</span>">Open</span> </td> 
                     <td class="assignee"> <span class="tinylink"><a class="user-hover" rel="noble.paul" id="assignee_noble.paul" href="/jira/secure/ViewProfile.jspa?name=noble.paul">Noble Paul</a></span> </td> 
                    </tr> 
                   </tbody> 
                  </table> 
                 </issuetable-web-component> 
                 <div class="end-of-stable-message"></div> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_noble.paul" rel="noble.paul" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Noble Paul&quot;,&quot;emailAddress&quot;:&quot;noble.paul@gmail.com&quot;,&quot;username&quot;:&quot;noble.paul&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="noble.paul"></span></span> Noble Paul </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_elyograg" rel="elyograg" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Shawn Heisey&quot;,&quot;emailAddress&quot;:&quot;apache@elyograg.org&quot;,&quot;username&quot;:&quot;elyograg&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="elyograg"></span></span> Shawn Heisey </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">7</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">20</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="04/Mar/15 22:24"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2015-03-04T22:24:31+0000">04/Mar/15 22:24</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="15/Mar/17 19:29"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2017-03-15T19:29:08+0000">15/Mar/17 19:29</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="28/Nov/16 16:56"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2016-11-28T16:56:14+0000">28/Nov/16 16:56</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-7191?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-7191?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-7191?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-7191?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-7191?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-7191?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-7191?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-7191?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/SOLR-7191?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-7191?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-7191?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/SOLR-7191?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-14347689\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14347689&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14347689\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14347689_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14347689_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/15 22:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-04T22:27:22+0000\'\u003e04\\/Mar\\/15 22:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAt this time I do not know what the actual issues are.  I\'m in the middle of another round of restarts right now because it became too unstable to add the last few hundred collections.  Once I have a complete log from that startup, I can attach it here.\u003c\\/p\u003e\\n\\n\u003cp\u003eI will add some information about how I have my test machine set up, and I can answer questions as needed.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14347689_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14347689_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/15 22:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-04T22:27:22+0000\'\u003e04\\/Mar\\/15 22:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    At this time I do not know what the actual issues are.  I\'m in the middle of another round of restarts right now because it became too unstable to add the last few hundred collections.  Once I have a complete log from that startup, I can attach it here. \\n\\n I will add some information about how I have my test machine set up, and I can answer questions as needed.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14347746\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14347746&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14347746\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_14347746_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14347746_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/15 23:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-04T23:10:34+0000\'\u003e04\\/Mar\\/15 23:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eJust throwing this out there, but tangentially related is the whole \\\"Lots of cores\\\" thing. It\'s really an open question to me how much effort into supporting either a zillion collections (or even a zillion cores).\u003c\\/p\u003e\\n\\n\u003cp\u003eThe LotsOfCores code was written without considering how to support it in SolrCloud. I\'m quite sure it\'d be \\\"interesting\\\" to support. I\'m explicitly \u003cem\u003enot\u003c\\/em\u003e advocating whether it be supported in SolrCloud, it\'d have to be thought out pretty carefully and my instinct is that it wouldn\'t be worth the effort.\u003c\\/p\u003e\\n\\n\u003cp\u003eFWIW\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_14347746_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14347746_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/15 23:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-04T23:10:34+0000\'\u003e04\\/Mar\\/15 23:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Just throwing this out there, but tangentially related is the whole \\\"Lots of cores\\\" thing. It\'s really an open question to me how much effort into supporting either a zillion collections (or even a zillion cores). \\n\\n The LotsOfCores code was written without considering how to support it in SolrCloud. I\'m quite sure it\'d be \\\"interesting\\\" to support. I\'m explicitly  not  advocating whether it be supported in SolrCloud, it\'d have to be thought out pretty carefully and my instinct is that it wouldn\'t be worth the effort. \\n\\n FWIW              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14347813\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14347813&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14347813\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14347813_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14347813_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 00:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T00:10:41+0000\'\u003e05\\/Mar\\/15 00:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have thought about this in terms of deciding whether we should even bother with it at all... but I figured it wouldn\'t hurt to open the issue so we can think about it, figure out whether any performance bottlenecks can be fixed, and at the very least come up with some best practice information for the docs.\u003c\\/p\u003e\\n\\n\u003cp\u003eOne of the big problems that I had was that the overseer queue was getting REALLY filled up.  I gave up and started over when I realized (from looking at the logs) that there were over eight hundred thousand entries in the queue, all from attempts to restart Solr repeatedly.  That huge queue is what finally pushed the znode size too high for jute.maxbuffer.\u003c\\/p\u003e\\n\\n\u003cp\u003eZookeeper seems to be the real bottleneck here, which is not all that surprising.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14347813_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14347813_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 00:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T00:10:41+0000\'\u003e05\\/Mar\\/15 00:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have thought about this in terms of deciding whether we should even bother with it at all... but I figured it wouldn\'t hurt to open the issue so we can think about it, figure out whether any performance bottlenecks can be fixed, and at the very least come up with some best practice information for the docs. \\n\\n One of the big problems that I had was that the overseer queue was getting REALLY filled up.  I gave up and started over when I realized (from looking at the logs) that there were over eight hundred thousand entries in the queue, all from attempts to restart Solr repeatedly.  That huge queue is what finally pushed the znode size too high for jute.maxbuffer. \\n\\n Zookeeper seems to be the real bottleneck here, which is not all that surprising.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14347834\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14347834&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14347834\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14347834_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14347834_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 00:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T00:32:56+0000\'\u003e05\\/Mar\\/15 00:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRegarding jute.maxbuffer:  The new stateFormat ensures that the clusterstate won\'t break the default 1MB limit.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe giant queue I encountered was about 850000 entries, and resulted in a packet length of a little over 14 megabytes.  If I divide 850000 by 14, I know that I can have about 60000 overseer queue entries in one znode before jute.maxbuffer needs to be increased.\u003c\\/p\u003e\\n\\n\u003cp\u003eThere are a couple of possibilities for managing really large overseer queues within the default buffer size.  One is to throttle the creation of new overseer entries when the number of existing entries exceeds a certain threshold ... I\'m thinking 32768 ... so that hopefully the overseer can catch up.  Another is to change the structure of the queue so that it creates new nodes under \\/overseer\\/queue and then puts actual entries inside those nodes, limiting the number of queue entries in each one to 32768.  With 32768 nodes that each have 32768 entries, the queue could easily reach one billion entries without breaking the buffer... although a queue that size might take days or weeks to process.\u003c\\/p\u003e\\n\\n\u003cp\u003eA similar problem would exist with the \\/collections node ... so a limit of 32768 collections would also be prudent.  I expect that users will run into other problems (number of processes being the one that comes to mind) long before they reach 32768 collections, though.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14347834_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14347834_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 00:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T00:32:56+0000\'\u003e05\\/Mar\\/15 00:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Regarding jute.maxbuffer:  The new stateFormat ensures that the clusterstate won\'t break the default 1MB limit. \\n\\n The giant queue I encountered was about 850000 entries, and resulted in a packet length of a little over 14 megabytes.  If I divide 850000 by 14, I know that I can have about 60000 overseer queue entries in one znode before jute.maxbuffer needs to be increased. \\n\\n There are a couple of possibilities for managing really large overseer queues within the default buffer size.  One is to throttle the creation of new overseer entries when the number of existing entries exceeds a certain threshold ... I\'m thinking 32768 ... so that hopefully the overseer can catch up.  Another is to change the structure of the queue so that it creates new nodes under \\/overseer\\/queue and then puts actual entries inside those nodes, limiting the number of queue entries in each one to 32768.  With 32768 nodes that each have 32768 entries, the queue could easily reach one billion entries without breaking the buffer... although a queue that size might take days or weeks to process. \\n\\n A similar problem would exist with the \\/collections node ... so a limit of 32768 collections would also be prudent.  I expect that users will run into other problems (number of processes being the one that comes to mind) long before they reach 32768 collections, though.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14348132\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14348132&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14348132\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14348132_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14348132_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 04:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T04:55:28+0000\'\u003e05\\/Mar\\/15 04:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m more concerned with stability than performance. I\'ve created up to 10,000 cores and the cloud is fine and well within memory limits. However, the cloud will never restart. Lots of warnings \'org.apache.solr.cloud.ZkController; Still seeing conflicting information about the leader of shard\'\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14348132_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14348132_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 04:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T04:55:28+0000\'\u003e05\\/Mar\\/15 04:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m more concerned with stability than performance. I\'ve created up to 10,000 cores and the cloud is fine and well within memory limits. However, the cloud will never restart. Lots of warnings \'org.apache.solr.cloud.ZkController; Still seeing conflicting information about the leader of shard\'              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14348235\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14348235&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14348235\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14348235_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14348235_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 06:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T06:21:08+0000\'\u003e05\\/Mar\\/15 06:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eShawn, can you try with branch_5x instead? In particular, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-6956\\\" title=\\\"OverseerCollectionProcessor and replicas on the overseer node can operate on stale cluster state\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-6956\\\"\u003e\u003cdel\u003eSOLR-6956\u003c\\/del\u003e\u003c\\/a\u003e should help. There was unnecessary synchronization on the overseer node which caused OverseerCollectionProcessor and replicas on the overseer node to not see updated cluster state. Considering that you\'re running only 3\u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/help_16.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e nodes, 1 of the nodes involved could be slowing down the entire cluster.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14348235_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14348235_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 06:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T06:21:08+0000\'\u003e05\\/Mar\\/15 06:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Shawn, can you try with branch_5x instead? In particular,   SOLR-6956   should help. There was unnecessary synchronization on the overseer node which caused OverseerCollectionProcessor and replicas on the overseer node to not see updated cluster state. Considering that you\'re running only 3  nodes, 1 of the nodes involved could be slowing down the entire cluster.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14348240\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14348240&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14348240\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14348240_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14348240_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 06:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T06:28:30+0000\'\u003e05\\/Mar\\/15 06:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWe can optimize the node shutdown case. Instead of each core publishing a \'down\' state individually, Solr can publish a \'down\' state for the entire node and overseer can do the rest.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14348240_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14348240_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 06:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T06:28:30+0000\'\u003e05\\/Mar\\/15 06:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    We can optimize the node shutdown case. Instead of each core publishing a \'down\' state individually, Solr can publish a \'down\' state for the entire node and overseer can do the rest.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14348836\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14348836&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14348836\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14348836_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14348836_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 15:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T15:02:14+0000\'\u003e05\\/Mar\\/15 15:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAs I said above, I started over with a fresh cloud example because of the problems I was having.  Late last night, the creation of 4000 collections completed.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis morning, I went to the admin UI page which I still had open, and did a shift-refresh on the main page.  Somehow, pulling the list of cores for the dropdown (there are 4001 of them) sent Solr into a tailspin where all the shards were marked down (orange) on the cloud graph, then they started coming back up.  Half an hour after this event started, only about 150 out of the 4000 collections had fully recovered.  That projects full recovery to take half the day ... and this is just from basically opening the admin UI to the dashboard!\u003c\\/p\u003e\\n\\n\u003cp\u003eFor situations where large numbers of cluster bits must change state, could there be an improvement made in the overseer queue messages to change the state of multiple bits?  If we could have a single message change the state of up to 1000 at once (and perhaps have a special code to indicate all of the replicas on a node), that would go a long way towards keeping the queue tidy when there are major events.  (I wrote this paragraph before seeing Shalin\'s note about optimizing the node shutdown case)\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\" class=\\\"user-hover\\\" rel=\\\"shalinmangar\\\"\u003eShalin Shekhar Mangar\u003c\\/a\u003e, I will try again with branch_5x.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14348836_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14348836_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 15:02\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T15:02:14+0000\'\u003e05\\/Mar\\/15 15:02\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    As I said above, I started over with a fresh cloud example because of the problems I was having.  Late last night, the creation of 4000 collections completed. \\n\\n This morning, I went to the admin UI page which I still had open, and did a shift-refresh on the main page.  Somehow, pulling the list of cores for the dropdown (there are 4001 of them) sent Solr into a tailspin where all the shards were marked down (orange) on the cloud graph, then they started coming back up.  Half an hour after this event started, only about 150 out of the 4000 collections had fully recovered.  That projects full recovery to take half the day ... and this is just from basically opening the admin UI to the dashboard! \\n\\n For situations where large numbers of cluster bits must change state, could there be an improvement made in the overseer queue messages to change the state of multiple bits?  If we could have a single message change the state of up to 1000 at once (and perhaps have a special code to indicate all of the replicas on a node), that would go a long way towards keeping the queue tidy when there are major events.  (I wrote this paragraph before seeing Shalin\'s note about optimizing the node shutdown case) \\n\\n  Shalin Shekhar Mangar , I will try again with branch_5x.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14349163\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14349163&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14349163\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14349163_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14349163_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 17:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T17:49:15+0000\'\u003e05\\/Mar\\/15 17:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAnother issue that will help us achieve this is \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-6760\\\" title=\\\"New optimized DistributedQueue implementation for overseer\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-6760\\\"\u003e\u003cdel\u003eSOLR-6760\u003c\\/del\u003e\u003c\\/a\u003e but that isn\'t implemented yet.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14349163_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14349163_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 17:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T17:49:15+0000\'\u003e05\\/Mar\\/15 17:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Another issue that will help us achieve this is   SOLR-6760   but that isn\'t implemented yet.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14349610\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14349610&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14349610\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14349610_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14349610_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 23:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T23:23:57+0000\'\u003e05\\/Mar\\/15 23:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAbove I mentioned a full recovery that I expected to take half a day, testing with the 5.0.0 release.  I killed that and started over AGAIN, this time with branch_5x.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m attaching a log excerpt from branch_5x (during the creation of 4000 collections) showing what happens between the receipt of two CREATE calls to the collections admin.\u003c\\/p\u003e\\n\\n\u003cp\u003eAfter the first create call, all the stuff for the create happens, and then a massive number of ZkStateReader lines are logged, indicating that an update is happening.  The collection (mycoll3221) that was created would be the 3223rd collection on the system, and the log shows 3198 update lines from zkStateReader, then the CREATE call for the next collection.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis is happening on EVERY collection create.  Why would every existing collection need to be touched when a new collection is created?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14349610_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14349610_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 23:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T23:23:57+0000\'\u003e05\\/Mar\\/15 23:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Above I mentioned a full recovery that I expected to take half a day, testing with the 5.0.0 release.  I killed that and started over AGAIN, this time with branch_5x. \\n\\n I\'m attaching a log excerpt from branch_5x (during the creation of 4000 collections) showing what happens between the receipt of two CREATE calls to the collections admin. \\n\\n After the first create call, all the stuff for the create happens, and then a massive number of ZkStateReader lines are logged, indicating that an update is happening.  The collection (mycoll3221) that was created would be the 3223rd collection on the system, and the log shows 3198 update lines from zkStateReader, then the CREATE call for the next collection. \\n\\n This is happening on EVERY collection create.  Why would every existing collection need to be touched when a new collection is created?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14349622\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14349622&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14349622\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14349622_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14349622_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 23:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T23:35:02+0000\'\u003e05\\/Mar\\/15 23:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOn the plus side ... in branch_5x, drawing the cloud graph is very fast, even if you increase the number of items per page to the point where it shows all 4001 collections at once.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14349622_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14349622_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/15 23:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-05T23:35:02+0000\'\u003e05\\/Mar\\/15 23:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    On the plus side ... in branch_5x, drawing the cloud graph is very fast, even if you increase the number of items per page to the point where it shows all 4001 collections at once.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14349849\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14349849&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14349849\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14349849_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14349849_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/15 02:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-06T02:42:37+0000\'\u003e06\\/Mar\\/15 02:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFollowup on the attached log, because I realized that I didn\'t quite understand what I was looking at.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe first line of the log is where the request for a collection create is logged ... but all the activity for that CREATE call is \u003cb\u003ebefore\u003c\\/b\u003e that line, so you can\'t see it.\u003c\\/p\u003e\\n\\n\u003cp\u003eAll of the rest of the log covers activity for the request that is logged as the last line.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14349849_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14349849_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/15 02:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-06T02:42:37+0000\'\u003e06\\/Mar\\/15 02:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Followup on the attached log, because I realized that I didn\'t quite understand what I was looking at. \\n\\n The first line of the log is where the request for a collection create is logged ... but all the activity for that CREATE call is  before  that line, so you can\'t see it. \\n\\n All of the rest of the log covers activity for the request that is logged as the last line.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14354379\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14354379&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14354379\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14354379_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14354379_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/15 05:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-10T05:46:25+0000\'\u003e10\\/Mar\\/15 05:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI tested 4,000 cores on branch_5x and found better results. My setup:\u003cbr\\/\u003e\\n3 nodes (32GB RAM each ; jdk1.8.0_40) running on a single server (256GB RAM).\u003cbr\\/\u003e\\n2,000 collections (1 x shard ; 2 x replica)\u003cbr\\/\u003e\\n1 x Zookeeper 3.4.6\u003c\\/p\u003e\\n\\n\u003cp\u003eFull restart (stop all nodes; start all nodes 1min staggered). Many cores on node1 are active, other cores are recovering. Lots of warnings \'org.apache.solr.update.PeerSync; no frame of reference to tell if we\'ve missed updates\' on node2 and node3. But it is slowly recovering.\u003c\\/p\u003e\\n\\n\u003cp\u003eBTW: collection creation slows down the more collections you have in the cloud. Starts with qtimes of ~3s; ending with ~6s. Solr 4.x was always steady at ~3s.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14354379_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14354379_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/15 05:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-10T05:46:25+0000\'\u003e10\\/Mar\\/15 05:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I tested 4,000 cores on branch_5x and found better results. My setup: \\n3 nodes (32GB RAM each ; jdk1.8.0_40) running on a single server (256GB RAM). \\n2,000 collections (1 x shard ; 2 x replica) \\n1 x Zookeeper 3.4.6 \\n\\n Full restart (stop all nodes; start all nodes 1min staggered). Many cores on node1 are active, other cores are recovering. Lots of warnings \'org.apache.solr.update.PeerSync; no frame of reference to tell if we\'ve missed updates\' on node2 and node3. But it is slowly recovering. \\n\\n BTW: collection creation slows down the more collections you have in the cloud. Starts with qtimes of ~3s; ending with ~6s. Solr 4.x was always steady at ~3s.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14354868\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14354868&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14354868\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14354868_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14354868_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/15 13:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-10T13:24:08+0000\'\u003e10\\/Mar\\/15 13:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe branch_5x code is a lot more stable than 5.0, but full recovery after a cluster restart is very slow, and as Damien noted, creation of new collections is also very slow.  On my dev server, by the time it had reached 4000 collections, each new collection was taking about 20 seconds to create.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe biggest problem I noticed is that any little change on the cluster (even creating a new collection) seems to cause a flood of ZkStateReader \\\"Updating data for XXXXX to ver NN\\\" messages.  Each time it must update every single collection it has ... when that happens, it doesn\'t take an extreme amount of time, but I\'ve noticed that it does it repeatedly, especially on node startup.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have some logs from a cluster restart on a 2 node cluster, but they are far too large to attach here, even compressed.  I have loaded the zip onto my dropbox account.\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/www.dropbox.com\\/s\\/28mu7asdvbgwkqt\\/logs-restart1-branch_5x.zip?dl=0\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/www.dropbox.com\\/s\\/28mu7asdvbgwkqt\\/logs-restart1-branch_5x.zip?dl=0\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eThese logs are also far too large to load into Notepad or Notepad++ on Windows, but gnu\'s \\\"less\\\" program can deal with them just fine.\u003c\\/p\u003e\\n\\n\u003cp\u003eTo create these logs, I shut down the cluster, deleted all logfiles, and then restarted each node.\u003c\\/p\u003e\\n\\n\u003cp\u003eLooking only at the log for node1, node startup began at 06:54 UTC.  At the following point, half an hour later, it appears that the node was fully operational - every collection shard had become active:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003eINFO  - 2015-03-06 07:27:21.586; org.apache.solr.cloud.overseer.ReplicaMutator; Update state numShards=2 message={\\n  \\\"operation\\\":\\\"state\\\",\\n  \\\"core_node_name\\\":\\\"core_node2\\\",\\n  \\\"numShards\\\":\\\"2\\\",\\n  \\\"shard\\\":\\\"shard2\\\",\\n  \\\"roles\\\":null,\\n  \\\"state\\\":\\\"active\\\",\\n  \\\"core\\\":\\\"mycoll3892_shard2_replica1\\\",\\n  \\\"collection\\\":\\\"mycoll3892\\\",\\n  \\\"node_name\\\":\\\"10.100.1.39:7574_solr\\\",\\n  \\\"base_url\\\":\\\"http:\\/\\/10.100.1.39:7574\\/solr\\\"}\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eAt 08:38 UTC, just before I went to bed, I sent a request to create a new collection, named \\\"lotsashards\\\".  The http request for collection creation timed out three minutes later, at 08:41, but the request was in the overseer queue, so eventually it did happen.  It took until 15:29 for that collection creation to begin - nearly seven hours after I started it - because Solr was busy handling a very large number of those ZkStateReader updates.  It appears that it took another ten minutes for the create to finish, and there are other messages related to lotsashards right up through the end of the log at 16:54 UTC.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14354868_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14354868_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/15 13:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-10T13:24:08+0000\'\u003e10\\/Mar\\/15 13:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The branch_5x code is a lot more stable than 5.0, but full recovery after a cluster restart is very slow, and as Damien noted, creation of new collections is also very slow.  On my dev server, by the time it had reached 4000 collections, each new collection was taking about 20 seconds to create. \\n\\n The biggest problem I noticed is that any little change on the cluster (even creating a new collection) seems to cause a flood of ZkStateReader \\\"Updating data for XXXXX to ver NN\\\" messages.  Each time it must update every single collection it has ... when that happens, it doesn\'t take an extreme amount of time, but I\'ve noticed that it does it repeatedly, especially on node startup. \\n\\n I have some logs from a cluster restart on a 2 node cluster, but they are far too large to attach here, even compressed.  I have loaded the zip onto my dropbox account. \\n\\n  https:\\/\\/www.dropbox.com\\/s\\/28mu7asdvbgwkqt\\/logs-restart1-branch_5x.zip?dl=0  \\n\\n These logs are also far too large to load into Notepad or Notepad++ on Windows, but gnu\'s \\\"less\\\" program can deal with them just fine. \\n\\n To create these logs, I shut down the cluster, deleted all logfiles, and then restarted each node. \\n\\n Looking only at the log for node1, node startup began at 06:54 UTC.  At the following point, half an hour later, it appears that the node was fully operational - every collection shard had become active: \\n\\n  \\n INFO  - 2015-03-06 07:27:21.586; org.apache.solr.cloud.overseer.ReplicaMutator; Update state numShards=2 message={\\n  \\\"operation\\\":\\\"state\\\",\\n  \\\"core_node_name\\\":\\\"core_node2\\\",\\n  \\\"numShards\\\":\\\"2\\\",\\n  \\\"shard\\\":\\\"shard2\\\",\\n  \\\"roles\\\":null,\\n  \\\"state\\\":\\\"active\\\",\\n  \\\"core\\\":\\\"mycoll3892_shard2_replica1\\\",\\n  \\\"collection\\\":\\\"mycoll3892\\\",\\n  \\\"node_name\\\":\\\"10.100.1.39:7574_solr\\\",\\n  \\\"base_url\\\":\\\"http:\\/\\/10.100.1.39:7574\\/solr\\\"}\\n \\n  \\n\\n At 08:38 UTC, just before I went to bed, I sent a request to create a new collection, named \\\"lotsashards\\\".  The http request for collection creation timed out three minutes later, at 08:41, but the request was in the overseer queue, so eventually it did happen.  It took until 15:29 for that collection creation to begin - nearly seven hours after I started it - because Solr was busy handling a very large number of those ZkStateReader updates.  It appears that it took another ten minutes for the create to finish, and there are other messages related to lotsashards right up through the end of the log at 16:54 UTC.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14354875\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14354875&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14354875\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14354875_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14354875_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/15 13:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-10T13:30:18+0000\'\u003e10\\/Mar\\/15 13:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNow that I look closer at that log snippet, it appears that was a state update for node2, so I\'m not sure exactly how long it took for node1 to become stable ... but since I started ndoe2 at 07:01 UTC, it appears that it was nearly half an hour for full cluster stability, which is unacceptable in a production situation.\u003c\\/p\u003e\\n\\n\u003cp\u003eThere are no docs in any of the indexes, and I did not think to try a query or an update to see whether Solr was actually functional.  That will be included on any test repeat.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14354875_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14354875_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/15 13:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-10T13:30:18+0000\'\u003e10\\/Mar\\/15 13:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Now that I look closer at that log snippet, it appears that was a state update for node2, so I\'m not sure exactly how long it took for node1 to become stable ... but since I started ndoe2 at 07:01 UTC, it appears that it was nearly half an hour for full cluster stability, which is unacceptable in a production situation. \\n\\n There are no docs in any of the indexes, and I did not think to try a query or an update to see whether Solr was actually functional.  That will be included on any test repeat.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14354965\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14354965&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14354965\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14354965_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14354965_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/15 14:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-10T14:33:12+0000\'\u003e10\\/Mar\\/15 14:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eI tested 4,000 cores on branch_5x and found better results.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThanks, that is good to know.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eBTW: collection creation slows down the more collections you have in the cloud. Starts with qtimes of ~3s; ending with ~6s. Solr 4.x was always steady at ~3s.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eYes, that is expected with the current implementation. Each new collection touches the \\/clusterstate.json as a way to inform all nodes about the existence of a new collection (this is required for routing requests; this also happens on collection deletion). This invokes a reload of state information for all collections that have a core on that solr node. As the number of collections increase (and because you have a lot of cores on the same node), the state refresh takes longer. The Collection Create API waits for the new collection to be visible in the cluster state and therefore takes a longer time as number of collections increase.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe current implementation was made under the assumption that the system will have a large number of collections but a node will only have a few replicas. This isn\'t true in this case and therefore we\'re running into these bottlenecks.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14354965_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14354965_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Mar\\/15 14:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-10T14:33:12+0000\'\u003e10\\/Mar\\/15 14:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     I tested 4,000 cores on branch_5x and found better results.  \\n\\n Thanks, that is good to know. \\n\\n  BTW: collection creation slows down the more collections you have in the cloud. Starts with qtimes of ~3s; ending with ~6s. Solr 4.x was always steady at ~3s.  \\n\\n Yes, that is expected with the current implementation. Each new collection touches the \\/clusterstate.json as a way to inform all nodes about the existence of a new collection (this is required for routing requests; this also happens on collection deletion). This invokes a reload of state information for all collections that have a core on that solr node. As the number of collections increase (and because you have a lot of cores on the same node), the state refresh takes longer. The Collection Create API waits for the new collection to be visible in the cluster state and therefore takes a longer time as number of collections increase. \\n\\n The current implementation was made under the assumption that the system will have a large number of collections but a node will only have a few replicas. This isn\'t true in this case and therefore we\'re running into these bottlenecks.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14358149\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14358149&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14358149\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14358149_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14358149_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/15 06:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-12T06:15:37+0000\'\u003e12\\/Mar\\/15 06:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWith 10K cores I was still seeing many cores stuck in recovery.\u003c\\/p\u003e\\n\\n\u003cp\u003eI reduced CoreContainer.load() coreLoadExector to be 24 (cfg.coreLoadThreads) threads (from max int); I guess I\'m now assuming replicas to be on other nodes.\u003cbr\\/\u003e\\nI reduced ZkContainer.coreZkRegister to be 24 threads (from max int) and added a sort to SolrCore.getCores(). The sort ensures replicas are available.\u003cbr\\/\u003e\\nI tested with solr 4.10.4; 2 x nodes; 5K collections; 10K cores. All green in 19min.\u003c\\/p\u003e\\n\\n\u003cp\u003ePlease review patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eWould still like to see \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-6399\\\" title=\\\"Implement unloadCollection in the Collections API\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-6399\\\"\u003eSOLR-6399\u003c\\/a\u003e and a SolrCloud LotsOfCores as per Erick.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14358149_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14358149_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/15 06:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-12T06:15:37+0000\'\u003e12\\/Mar\\/15 06:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    With 10K cores I was still seeing many cores stuck in recovery. \\n\\n I reduced CoreContainer.load() coreLoadExector to be 24 (cfg.coreLoadThreads) threads (from max int); I guess I\'m now assuming replicas to be on other nodes. \\nI reduced ZkContainer.coreZkRegister to be 24 threads (from max int) and added a sort to SolrCore.getCores(). The sort ensures replicas are available. \\nI tested with solr 4.10.4; 2 x nodes; 5K collections; 10K cores. All green in 19min. \\n\\n Please review patch. \\n\\n Would still like to see  SOLR-6399  and a SolrCloud LotsOfCores as per Erick.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14358151\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14358151&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14358151\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14358151_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14358151_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/15 06:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-12T06:17:16+0000\'\u003e12\\/Mar\\/15 06:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch against lucene_solr_4_10_4.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14358151_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14358151_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/15 06:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-12T06:17:16+0000\'\u003e12\\/Mar\\/15 06:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch against lucene_solr_4_10_4.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14358685\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14358685&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14358685\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14358685_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14358685_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/15 13:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-12T13:50:07+0000\'\u003e12\\/Mar\\/15 13:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\" class=\\\"user-hover\\\" rel=\\\"dk\\\"\u003eDamien Kamerman\u003c\\/a\u003e:\u003c\\/p\u003e\\n\\n\u003cp\u003eThe first thing I thought when I saw that you were trying 10K cores was that you would run out of threads unless you change the servlet container config.  There is another limit looming after that ... the number of processes that you can create.  A Linux\\/Unix system uses a 16-bit identifier for process IDs, so the absolute upper limit of processes (including all OS-related processes) is 65535.  On Linux (and likely other Unix\\/Unix-like systems), threads take up a PID, although they are not visible to programs like \\\"top\\\" or \\\"ps\\\" without specific options.  I have no idea what the situation is on Windows.\u003c\\/p\u003e\\n\\n\u003cp\u003eOn your patch:\u003c\\/p\u003e\\n\\n\u003cp\u003eThe first patch section removes a null check.  This is never a good idea, because the fact that a null check exists tends to mean that the object identifier has the potential to be null, and presumably the first result on the trinary operator will fail (NullPointerException) somehow if the checked object actually is null.\u003c\\/p\u003e\\n\\n\u003cp\u003eOn the last patch section: Imposing a limit in the code without giving the user the option of configuring that limit will eventually cause problems for somebody.  Also, someone who is really familiar with how the ZkContainer code works will need to let us know if reducing the number of threads might have unintended consequences.\u003c\\/p\u003e\\n\\n\u003cp\u003eOn LotsOfCores: SolrCloud brings a lot of complications to the situation, and when Erick did his work on that, he told all of us that trying to use transient cores in conjunction with SolrCloud would likely not work correctly.  I think that the goal is to eventually make the two features coexist, but a lot of thought and work needs to happen.\u003c\\/p\u003e\\n\\n\u003cp\u003eGeneral observation:  A patch like this is not likely to be backported to the 4.10 branch.  That branch is in maintenance mode, so only trivial fixes or patches for major bugs will be committed, and new releases from the maintenance mode branch are not common.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14358685_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14358685_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Mar\\/15 13:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-12T13:50:07+0000\'\u003e12\\/Mar\\/15 13:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Damien Kamerman : \\n\\n The first thing I thought when I saw that you were trying 10K cores was that you would run out of threads unless you change the servlet container config.  There is another limit looming after that ... the number of processes that you can create.  A Linux\\/Unix system uses a 16-bit identifier for process IDs, so the absolute upper limit of processes (including all OS-related processes) is 65535.  On Linux (and likely other Unix\\/Unix-like systems), threads take up a PID, although they are not visible to programs like \\\"top\\\" or \\\"ps\\\" without specific options.  I have no idea what the situation is on Windows. \\n\\n On your patch: \\n\\n The first patch section removes a null check.  This is never a good idea, because the fact that a null check exists tends to mean that the object identifier has the potential to be null, and presumably the first result on the trinary operator will fail (NullPointerException) somehow if the checked object actually is null. \\n\\n On the last patch section: Imposing a limit in the code without giving the user the option of configuring that limit will eventually cause problems for somebody.  Also, someone who is really familiar with how the ZkContainer code works will need to let us know if reducing the number of threads might have unintended consequences. \\n\\n On LotsOfCores: SolrCloud brings a lot of complications to the situation, and when Erick did his work on that, he told all of us that trying to use transient cores in conjunction with SolrCloud would likely not work correctly.  I think that the goal is to eventually make the two features coexist, but a lot of thought and work needs to happen. \\n\\n General observation:  A patch like this is not likely to be backported to the 4.10 branch.  That branch is in maintenance mode, so only trivial fixes or patches for major bugs will be committed, and new releases from the maintenance mode branch are not common.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14361731\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14361731&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14361731\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14361731_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14361731_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/15 11:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-14T11:39:26+0000\'\u003e14\\/Mar\\/15 11:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis fix takes some load off the DistributedQueue.\u003cbr\\/\u003e\\nOn shutdown the node will publish a \'down\' state for the entire node and overseer will do the rest.\u003cbr\\/\u003e\\nRegistration is done in a fixed size (128) threadPool in corename order.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14361731_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14361731_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Mar\\/15 11:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-14T11:39:26+0000\'\u003e14\\/Mar\\/15 11:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This fix takes some load off the DistributedQueue. \\nOn shutdown the node will publish a \'down\' state for the entire node and overseer will do the rest. \\nRegistration is done in a fixed size (128) threadPool in corename order.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14362169\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14362169&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14362169\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14362169_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14362169_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/15 03:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-15T03:24:59+0000\'\u003e15\\/Mar\\/15 03:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Shawn,\u003cbr\\/\u003e\\nHere\'s a patch for branch_5x that does the following:\u003cbr\\/\u003e\\n1. Load cores in fixed threadPool. Cores are registered in background threads, so no reason to load all cores at once!\u003cbr\\/\u003e\\n2. Register cores in corename order with a fixed 128 threadPool. This is to not flood the DistributedQueue.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14362169_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14362169_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/15 03:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-15T03:24:59+0000\'\u003e15\\/Mar\\/15 03:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Shawn, \\nHere\'s a patch for branch_5x that does the following: \\n1. Load cores in fixed threadPool. Cores are registered in background threads, so no reason to load all cores at once! \\n2. Register cores in corename order with a fixed 128 threadPool. This is to not flood the DistributedQueue.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14362511\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14362511&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14362511\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14362511_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14362511_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/15 19:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-15T19:16:06+0000\'\u003e15\\/Mar\\/15 19:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis is a very broad issue so there are likely to be multiple problems and their solutions. It\'s probably best to start splitting out individual changes into their own sub-tasks so that each can be reviewed and committed individually.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14362511_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14362511_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/15 19:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-15T19:16:06+0000\'\u003e15\\/Mar\\/15 19:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This is a very broad issue so there are likely to be multiple problems and their solutions. It\'s probably best to start splitting out individual changes into their own sub-tasks so that each can be reviewed and committed individually.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14368557\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14368557&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14368557\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14368557_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14368557_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Mar\\/15 05:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-19T05:56:39+0000\'\u003e19\\/Mar\\/15 05:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eShalin, Another change I made was to cache ConfigSetService.createIndexSchema() in cloud mode. BTW, have tested OK up to 24K cores.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14368557_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14368557_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Mar\\/15 05:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-19T05:56:39+0000\'\u003e19\\/Mar\\/15 05:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Shalin, Another change I made was to cache ConfigSetService.createIndexSchema() in cloud mode. BTW, have tested OK up to 24K cores.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14372155\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14372155&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14372155\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14372155_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14372155_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Mar\\/15 21:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-20T21:29:34+0000\'\u003e20\\/Mar\\/15 21:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThat\'s awesome, Damien. I\'ll start next week on getting these improvements into Solr. I\'m going to create some sub-tasks for individual changes. You can help by providing patches which applies on trunk.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14372155_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14372155_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Mar\\/15 21:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-20T21:29:34+0000\'\u003e20\\/Mar\\/15 21:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    That\'s awesome, Damien. I\'ll start next week on getting these improvements into Solr. I\'m going to create some sub-tasks for individual changes. You can help by providing patches which applies on trunk.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14372212\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14372212&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14372212\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14372212_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14372212_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Mar\\/15 22:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-20T22:06:14+0000\'\u003e20\\/Mar\\/15 22:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eThe biggest problem I noticed is that any little change on the cluster (even creating a new collection) seems to cause a flood of ZkStateReader \\\"Updating data for XXXXX to ver NN\\\" messages. Each time it must update every single collection it has ... when that happens, it doesn\'t take an extreme amount of time, but I\'ve noticed that it does it repeatedly, especially on node startup.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\" class=\\\"user-hover\\\" rel=\\\"elyograg\\\"\u003eShawn Heisey\u003c\\/a\u003e &#8211; Sorry for not responding earlier. Yes, that is how it works right now. We didn\'t optimize this case because collections are created\\/deleted infrequently. However, this might be a problem when users has collections with statetFormat=1 and 2.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14372212_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14372212_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Mar\\/15 22:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-03-20T22:06:14+0000\'\u003e20\\/Mar\\/15 22:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     The biggest problem I noticed is that any little change on the cluster (even creating a new collection) seems to cause a flood of ZkStateReader \\\"Updating data for XXXXX to ver NN\\\" messages. Each time it must update every single collection it has ... when that happens, it doesn\'t take an extreme amount of time, but I\'ve noticed that it does it repeatedly, especially on node startup.  \\n\\n  Shawn Heisey  &#8211; Sorry for not responding earlier. Yes, that is how it works right now. We didn\'t optimize this case because collections are created\\/deleted infrequently. However, this might be a problem when users has collections with statetFormat=1 and 2.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14642896\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14642896&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14642896\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14642896_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14642896_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jul\\/15 15:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-07-27T15:48:31+0000\'\u003e27\\/Jul\\/15 15:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAnother user on the mailing list brought up another scaling problem &#8211; large numbers of collections using a large configuration.  A 6MB config across 1000 collections requires several gigabytes of RAM.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14642896_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14642896_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jul\\/15 15:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-07-27T15:48:31+0000\'\u003e27\\/Jul\\/15 15:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Another user on the mailing list brought up another scaling problem &#8211; large numbers of collections using a large configuration.  A 6MB config across 1000 collections requires several gigabytes of RAM.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14642990\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14642990&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14642990\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14642990_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14642990_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jul\\/15 16:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-07-27T16:40:39+0000\'\u003e27\\/Jul\\/15 16:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eAnother user on the mailing list brought up another scaling problem \\u2013 large numbers of collections using a large configuration. A 6MB config across 1000 collections requires several gigabytes of RAM.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eYup, that\'s why I opened \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-7282\\\" title=\\\"Cache config or index schema objects by configset and share them across cores\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-7282\\\"\u003eSOLR-7282\u003c\\/a\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14642990_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14642990_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jul\\/15 16:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-07-27T16:40:39+0000\'\u003e27\\/Jul\\/15 16:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Another user on the mailing list brought up another scaling problem \\u2013 large numbers of collections using a large configuration. A 6MB config across 1000 collections requires several gigabytes of RAM.  \\n\\n Yup, that\'s why I opened  SOLR-7282               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14966024\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14966024&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14966024\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14966024_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14966024_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Oct\\/15 00:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-21T00:23:30+0000\'\u003e21\\/Oct\\/15 00:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'ve had a first look at porting the patch I did for Solr 4.10 to the Solr trunk (1708905). I created 6,000 collections (3 nodes; 2 x replicas) and re-started the 3 nodes, and all green in 24min.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe bottleneck was ZkController.register() calling zkStateReader.updateClusterState() for each collection. I moved this call up to the end of CoreContainer.load(). Comments appreciated.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14966024_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14966024_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Oct\\/15 00:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-21T00:23:30+0000\'\u003e21\\/Oct\\/15 00:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'ve had a first look at porting the patch I did for Solr 4.10 to the Solr trunk (1708905). I created 6,000 collections (3 nodes; 2 x replicas) and re-started the 3 nodes, and all green in 24min. \\n\\n The bottleneck was ZkController.register() calling zkStateReader.updateClusterState() for each collection. I moved this call up to the end of CoreContainer.load(). Comments appreciated.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14966893\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14966893&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14966893\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14966893_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14966893_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Oct\\/15 14:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-21T14:29:44+0000\'\u003e21\\/Oct\\/15 14:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eI created 6,000 collections (3 nodes; 2 x replicas) and re-started the 3 nodes, and all green in 24min.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eVery nice! That\'s an improvement, though still fairly slow.  How quickly did the cluster reach full usability &#8211; at least one replica active on all collections?  That\'s more important than all-green.\u003c\\/p\u003e\\n\\n\u003cp\u003eI would hope for full stability in a timeframe well under ten minutes, and under five minutes would be even better.  I don\'t want to discourage your efforts.\u003c\\/p\u003e\\n\\n\u003cp\u003eWas this with a single ZK node, or did you have a 3-node ensemble?  It\'s my understanding that as nodes are added to the ensemble, database updates get slower, because the write must be coordinated on more hosts. A redundant ensemble cannot update the database as fast as a single node, so verification of progress should be done with an ensemble.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_14966893_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14966893_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Oct\\/15 14:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-21T14:29:44+0000\'\u003e21\\/Oct\\/15 14:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     I created 6,000 collections (3 nodes; 2 x replicas) and re-started the 3 nodes, and all green in 24min.  \\n\\n Very nice! That\'s an improvement, though still fairly slow.  How quickly did the cluster reach full usability &#8211; at least one replica active on all collections?  That\'s more important than all-green. \\n\\n I would hope for full stability in a timeframe well under ten minutes, and under five minutes would be even better.  I don\'t want to discourage your efforts. \\n\\n Was this with a single ZK node, or did you have a 3-node ensemble?  It\'s my understanding that as nodes are added to the ensemble, database updates get slower, because the write must be coordinated on more hosts. A redundant ensemble cannot update the database as fast as a single node, so verification of progress should be done with an ensemble.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14968920\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14968920&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14968920\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14968920_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14968920_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Oct\\/15 10:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-22T10:24:45+0000\'\u003e22\\/Oct\\/15 10:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Damien.\u003c\\/p\u003e\\n\\n\u003col\u003e\\n\\t\u003cli\u003eWhat is the purpose of the fastClose in SolrCore.close(). It only disables clearing the jmx registry. Have you found that to be very slow in practice?\u003c\\/li\u003e\\n\\t\u003cli\u003eYour schema cache will cache schema indefinitely and won\'t reload on changes made by schema API or manually. You need to use znode version of the schema file as part of the key name to ensure that you can reload schemas.\u003c\\/li\u003e\\n\u003c\\/ol\u003e\\n\\n\\n\u003cp\u003eI\'ll have to test your change of moving the updateClusterState to CoreContainer.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"shalinmangar\\\" id=\\\"commentauthor_14968920_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=shalinmangar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"shalinmangar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shalin Shekhar Mangar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14968920_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Oct\\/15 10:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-22T10:24:45+0000\'\u003e22\\/Oct\\/15 10:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Damien. \\n\\n \\n\\t What is the purpose of the fastClose in SolrCore.close(). It only disables clearing the jmx registry. Have you found that to be very slow in practice? \\n\\t Your schema cache will cache schema indefinitely and won\'t reload on changes made by schema API or manually. You need to use znode version of the schema file as part of the key name to ensure that you can reload schemas. \\n \\n\\n\\n I\'ll have to test your change of moving the updateClusterState to CoreContainer.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14970253\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14970253&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14970253\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14970253_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14970253_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Oct\\/15 01:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-23T01:26:13+0000\'\u003e23\\/Oct\\/15 01:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e1. hmmm cancel that. Initially I noticed very slow (around 60min total) shutdown in JmxMonitoredMap.clear(). I went back to test it and was unable to reproduce!? I did update the trunk. A partial stack is all I\'ve saved:\u003cbr\\/\u003e\\nat org.apache.solr.core.JmxMonitoredMap.clear(JmxMonitoredMap.java:144)\u003cbr\\/\u003e\\nat org.apache.solr.core.SolrCore.close(SolrCore.java:1263)\u003cbr\\/\u003e\\nat org.apache.solr.core.SolrCores.close(SolrCores.java:124)\u003cbr\\/\u003e\\nat org.apache.solr.core.CoreContainer.shutdown(CoreContainer.java:564)\u003cbr\\/\u003e\\nat org.apache.solr.servlet.SolrDispatchFilter.destroy(SolrDispatchFilter.java:172)\u003c\\/p\u003e\\n\\n\u003cp\u003e2. OK, will look into that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14970253_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14970253_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Oct\\/15 01:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-23T01:26:13+0000\'\u003e23\\/Oct\\/15 01:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    1. hmmm cancel that. Initially I noticed very slow (around 60min total) shutdown in JmxMonitoredMap.clear(). I went back to test it and was unable to reproduce!? I did update the trunk. A partial stack is all I\'ve saved: \\nat org.apache.solr.core.JmxMonitoredMap.clear(JmxMonitoredMap.java:144) \\nat org.apache.solr.core.SolrCore.close(SolrCore.java:1263) \\nat org.apache.solr.core.SolrCores.close(SolrCores.java:124) \\nat org.apache.solr.core.CoreContainer.shutdown(CoreContainer.java:564) \\nat org.apache.solr.servlet.SolrDispatchFilter.destroy(SolrDispatchFilter.java:172) \\n\\n 2. OK, will look into that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14970255\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=14970255&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14970255\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14970255_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14970255_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Oct\\/15 01:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-23T01:28:31+0000\'\u003e23\\/Oct\\/15 01:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAfter 2min around 100 collections all-green. This is with a 3-node ensemble. Ten minutes would be great, and I guess with 3K collections I would be close to that mark.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_14970255_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14970255_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Oct\\/15 01:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-23T01:28:31+0000\'\u003e23\\/Oct\\/15 01:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    After 2min around 100 collections all-green. This is with a 3-node ensemble. Ten minutes would be great, and I guess with 3K collections I would be close to that mark.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15325575\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15325575&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15325575\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15325575_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15325575_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jun\\/16 00:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-11T00:54:38+0000\'\u003e11\\/Jun\\/16 00:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI had to chase after this for a while, so I\'m recording results \u003cbr\\/\u003e\\nof some testing for posterity.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; Setup: 4 Solr JVMs, 8G each (64G total RAM on the machine).\u003cbr\\/\u003e\\n&gt; Create 100 4x4 collections (i.e. 4 replicas, 4 shards each). 1,600 total shards\u003cbr\\/\u003e\\n  &gt; Note that the cluster is fine at this point, everything\'s green.\u003cbr\\/\u003e\\n&gt; No data indexed at all.\u003cbr\\/\u003e\\n&gt; Shut all Solr instances down.\u003cbr\\/\u003e\\n&gt; Bring up a Solr on a different box. I did this to eliminate the chance\u003cbr\\/\u003e\\n  that the Overseer was somehow involved since it is now on the machine\u003cbr\\/\u003e\\n  with no replicas. I don\'t think this matters much though.\u003cbr\\/\u003e\\n&gt; Bring up one JVM.\u003cbr\\/\u003e\\n&gt; Wait for all the nodes on that JVM to come up. Now every shard has a leader,\u003cbr\\/\u003e\\n  and the collections are all green, 3 of 4 replicas for each shard are\u003cbr\\/\u003e\\n  \\\"gone\\\" of course, but it\'s a functioning cluster.\u003cbr\\/\u003e\\n&gt; Bring up the next JVM: Kabloooey. Very shortly you\'ll start to see OOM\u003cbr\\/\u003e\\n  errors on the \u003cem\u003esecond\u003c\\/em\u003e JVM but not the first.\u003cbr\\/\u003e\\n  &gt; The numbers of threads on the first JVM are about 1,200. On the second,\u003cbr\\/\u003e\\n    they go over 2,000. Whether this would drop back down or not\u003cbr\\/\u003e\\n    is an open question.\u003cbr\\/\u003e\\n  &gt; So I tried playing with -Xss to drop the size of the stack on the threads\u003cbr\\/\u003e\\n    and even dropping by half didn\'t help.\u003cbr\\/\u003e\\n  &gt; Expanding the memory on the second JVM to 32G didn\'t help\u003cbr\\/\u003e\\n  &gt; I tried increasing the processes to no avail (ulimit -u) on a hint\u003cbr\\/\u003e\\n    that there was a wonky effect there somehow.\u003cbr\\/\u003e\\n  &gt; Especially disconcerting is the fact that this node was running fine\u003cbr\\/\u003e\\n    when the collections were \u003cem\u003ecreated\u003c\\/em\u003e, it just can\'t get past restart.\u003cbr\\/\u003e\\n  &gt; Changing coreLoadThreads even down to 2 did not seem to help.\u003cbr\\/\u003e\\n  &gt; At no point does the reported memory consumption via jConsole or top\u003cbr\\/\u003e\\n    show even getting close to the allocated JVM limits.\u003cbr\\/\u003e\\n&gt; I\'d like to be able to just start all 4 JVMs at once, but didn\'t get\u003cbr\\/\u003e\\n  that far.\u003cbr\\/\u003e\\n&gt; If one tries to start additional JVMs anyway, there\'s a lot of thrashing\u003cbr\\/\u003e\\n  around, replicas go into recovery, go out of recovery, are permanently down etc.\u003cbr\\/\u003e\\n  Of course with OOMs it\'s unclear what \u003cem\u003eshould\u003c\\/em\u003e happen.\u003cbr\\/\u003e\\n&gt; The OOM killer script apparently does NOT get triggered, I think the OOM\u003cbr\\/\u003e\\n  is swallowed, perhaps in Zookeeper client code. Note that if the OOM\u003cbr\\/\u003e\\n  killer script \u003cem\u003edid\u003c\\/em\u003e get fired there\'d the second &amp; greater JVMs would\u003cbr\\/\u003e\\n  ust die.\u003cbr\\/\u003e\\n&gt; Error is OOM: Unable to create new native thread.\u003cbr\\/\u003e\\n&gt; Here\'s a stack trace, there are a \u003cem\u003elot\u003c\\/em\u003e of these...\u003c\\/p\u003e\\n\\n\u003cp\u003eERROR - 2016-06-11 00:05:36.806; [   ] org.apache.zookeeper.ClientCnxn$EventThread; Error while calling watcher \u003cbr\\/\u003e\\njava.lang.OutOfMemoryError: unable to create new native thread\u003cbr\\/\u003e\\n\\tat java.lang.Thread.start0(Native Method)\u003cbr\\/\u003e\\n\\tat java.lang.Thread.start(Thread.java:714)\u003cbr\\/\u003e\\n\\tat java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:950)\u003cbr\\/\u003e\\n\\tat java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1368)\u003cbr\\/\u003e\\n\\tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.execute(ExecutorUtil.java:214)\u003cbr\\/\u003e\\n\\tat java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:112)\u003cbr\\/\u003e\\n\\tat org.apache.solr.common.cloud.SolrZkClient$3.process(SolrZkClient.java:266)\u003cbr\\/\u003e\\n\\tat org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:522)\u003cbr\\/\u003e\\n\\tat org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:498)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15325575_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15325575_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jun\\/16 00:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-11T00:54:38+0000\'\u003e11\\/Jun\\/16 00:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I had to chase after this for a while, so I\'m recording results  \\nof some testing for posterity. \\n\\n &gt; Setup: 4 Solr JVMs, 8G each (64G total RAM on the machine). \\n&gt; Create 100 4x4 collections (i.e. 4 replicas, 4 shards each). 1,600 total shards \\n  &gt; Note that the cluster is fine at this point, everything\'s green. \\n&gt; No data indexed at all. \\n&gt; Shut all Solr instances down. \\n&gt; Bring up a Solr on a different box. I did this to eliminate the chance \\n  that the Overseer was somehow involved since it is now on the machine \\n  with no replicas. I don\'t think this matters much though. \\n&gt; Bring up one JVM. \\n&gt; Wait for all the nodes on that JVM to come up. Now every shard has a leader, \\n  and the collections are all green, 3 of 4 replicas for each shard are \\n  \\\"gone\\\" of course, but it\'s a functioning cluster. \\n&gt; Bring up the next JVM: Kabloooey. Very shortly you\'ll start to see OOM \\n  errors on the  second  JVM but not the first. \\n  &gt; The numbers of threads on the first JVM are about 1,200. On the second, \\n    they go over 2,000. Whether this would drop back down or not \\n    is an open question. \\n  &gt; So I tried playing with -Xss to drop the size of the stack on the threads \\n    and even dropping by half didn\'t help. \\n  &gt; Expanding the memory on the second JVM to 32G didn\'t help \\n  &gt; I tried increasing the processes to no avail (ulimit -u) on a hint \\n    that there was a wonky effect there somehow. \\n  &gt; Especially disconcerting is the fact that this node was running fine \\n    when the collections were  created , it just can\'t get past restart. \\n  &gt; Changing coreLoadThreads even down to 2 did not seem to help. \\n  &gt; At no point does the reported memory consumption via jConsole or top \\n    show even getting close to the allocated JVM limits. \\n&gt; I\'d like to be able to just start all 4 JVMs at once, but didn\'t get \\n  that far. \\n&gt; If one tries to start additional JVMs anyway, there\'s a lot of thrashing \\n  around, replicas go into recovery, go out of recovery, are permanently down etc. \\n  Of course with OOMs it\'s unclear what  should  happen. \\n&gt; The OOM killer script apparently does NOT get triggered, I think the OOM \\n  is swallowed, perhaps in Zookeeper client code. Note that if the OOM \\n  killer script  did  get fired there\'d the second &amp; greater JVMs would \\n  ust die. \\n&gt; Error is OOM: Unable to create new native thread. \\n&gt; Here\'s a stack trace, there are a  lot  of these... \\n\\n ERROR - 2016-06-11 00:05:36.806; [   ] org.apache.zookeeper.ClientCnxn$EventThread; Error while calling watcher  \\njava.lang.OutOfMemoryError: unable to create new native thread \\n\\tat java.lang.Thread.start0(Native Method) \\n\\tat java.lang.Thread.start(Thread.java:714) \\n\\tat java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:950) \\n\\tat java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1368) \\n\\tat org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.execute(ExecutorUtil.java:214) \\n\\tat java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:112) \\n\\tat org.apache.solr.common.cloud.SolrZkClient$3.process(SolrZkClient.java:266) \\n\\tat org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:522) \\n\\tat org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:498)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15325626\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15325626&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15325626\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"damienka\\\" id=\\\"commentauthor_15325626_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=damienka\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"damienka\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e damien kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15325626_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jun\\/16 01:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-11T01:41:40+0000\'\u003e11\\/Jun\\/16 01:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis fits with what I\'ve seen on solr 4\\/5. The cores register on an\u003cbr\\/\u003e\\nunlimited thread pool. The patch I did was to limit the thread pool and\u003cbr\\/\u003e\\nregister in order.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"damienka\\\" id=\\\"commentauthor_15325626_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=damienka\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"damienka\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e damien kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15325626_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Jun\\/16 01:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-11T01:41:40+0000\'\u003e11\\/Jun\\/16 01:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This fits with what I\'ve seen on solr 4\\/5. The cores register on an \\nunlimited thread pool. The patch I did was to limit the thread pool and \\nregister in order. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15340106\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15340106&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15340106\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15340106_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15340106_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Jun\\/16 18:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-20T18:22:30+0000\'\u003e20\\/Jun\\/16 18:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ewhich version is the patch built on?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15340106_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15340106_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Jun\\/16 18:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-20T18:22:30+0000\'\u003e20\\/Jun\\/16 18:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    which version is the patch built on?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15340685\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15340685&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15340685\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15340685_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15340685_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Jun\\/16 23:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-20T23:39:11+0000\'\u003e20\\/Jun\\/16 23:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\" class=\\\"user-hover\\\" rel=\\\"noble.paul\\\"\u003eNoble Paul\u003c\\/a\u003e Not sure what version this patch was against. My testing and most recent notes were on stock Solr...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15340685_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15340685_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Jun\\/16 23:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-20T23:39:11+0000\'\u003e20\\/Jun\\/16 23:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Noble Paul  Not sure what version this patch was against. My testing and most recent notes were on stock Solr...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15340698\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15340698&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15340698\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"damienka\\\" id=\\\"commentauthor_15340698_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=damienka\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"damienka\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e damien kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15340698_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Jun\\/16 23:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-20T23:46:40+0000\'\u003e20\\/Jun\\/16 23:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe patch from March 2015 was against Solr 4.10.\u003cbr\\/\u003e\\nThe patch from Oct 2015 was against Solr trunk (1708905)\u003c\\/p\u003e\\n\\n\\n\\n\\n\\n\u003cp\u003e&#8211; \u003cbr\\/\u003e\\nDamien Kamerman\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"damienka\\\" id=\\\"commentauthor_15340698_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=damienka\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"damienka\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e damien kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15340698_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'20\\/Jun\\/16 23:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-20T23:46:40+0000\'\u003e20\\/Jun\\/16 23:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The patch from March 2015 was against Solr 4.10. \\nThe patch from Oct 2015 was against Solr trunk (1708905) \\n\\n\\n\\n\\n\\n &#8211;  \\nDamien Kamerman              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15344180\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15344180&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15344180\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15344180_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15344180_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Jun\\/16 11:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-22T11:59:33+0000\'\u003e22\\/Jun\\/16 11:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003epatch updated to trunk\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15344180_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15344180_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Jun\\/16 11:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-22T11:59:33+0000\'\u003e22\\/Jun\\/16 11:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    patch updated to trunk              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15352216\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15352216&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15352216\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15352216_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352216_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 02:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T02:05:25+0000\'\u003e28\\/Jun\\/16 02:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNoble:\u003c\\/p\u003e\\n\\n\u003cp\u003eA few comments:\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; the stress setup I have is sailing right through the parts that were dying last week, so this is looking good.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; I also tried back-porting this to 5x and it seems to be working equally well there\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; There\'s a comment in CoreContainer:\u003cbr\\/\u003e\\n   \\/\\/ OK to limit the size of the executor in zk mode as cores are loaded in order.\u003cbr\\/\u003e\\n   \\/\\/ This assumes replicaCount is less than coreLoadThreadCount?\u003cbr\\/\u003e\\nI didn\'t read it before I started testing, so I didn\'t know enough to be scared... I\'m starting 400 cores in each JVM with 10 coreLoadThreads so does the fact that the loading is in order preclude fewer threads than cores being a problem? I also experimented with 3 threads (4 shards, 4 replicas each) and saw no problems.\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15352216_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352216_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 02:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T02:05:25+0000\'\u003e28\\/Jun\\/16 02:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Noble: \\n\\n A few comments: \\n\\n &gt; the stress setup I have is sailing right through the parts that were dying last week, so this is looking good. \\n\\n &gt; I also tried back-porting this to 5x and it seems to be working equally well there \\n\\n &gt; There\'s a comment in CoreContainer: \\n   \\/\\/ OK to limit the size of the executor in zk mode as cores are loaded in order. \\n   \\/\\/ This assumes replicaCount is less than coreLoadThreadCount? \\nI didn\'t read it before I started testing, so I didn\'t know enough to be scared... I\'m starting 400 cores in each JVM with 10 coreLoadThreads so does the fact that the loading is in order preclude fewer threads than cores being a problem? I also experimented with 3 threads (4 shards, 4 replicas each) and saw no problems. \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15352228\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15352228&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15352228\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"damienka\\\" id=\\\"commentauthor_15352228_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=damienka\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"damienka\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e damien kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352228_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 02:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T02:29:40+0000\'\u003e28\\/Jun\\/16 02:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOnly coreLoadThreadCount cores are registering at a time on each JVM, so\u003cbr\\/\u003e\\nthe concern is if there is a collection that has more than\u003cbr\\/\u003e\\ncoreLoadThreadCount replicas on a JVM then registration could fail.\u003c\\/p\u003e\\n\\n\\n\\n\\n\\n\u003cp\u003e&#8211; \u003cbr\\/\u003e\\nDamien Kamerman\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"damienka\\\" id=\\\"commentauthor_15352228_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=damienka\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"damienka\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e damien kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352228_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 02:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T02:29:40+0000\'\u003e28\\/Jun\\/16 02:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Only coreLoadThreadCount cores are registering at a time on each JVM, so \\nthe concern is if there is a collection that has more than \\ncoreLoadThreadCount replicas on a JVM then registration could fail. \\n\\n\\n\\n\\n\\n &#8211;  \\nDamien Kamerman              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15352349\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15352349&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15352349\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15352349_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352349_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 04:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T04:44:18+0000\'\u003e28\\/Jun\\/16 04:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\\n\u003cp\u003eHmmm, is this a concern based on general principles or on a code path that is expected to fail?\u003c\\/p\u003e\\n\\n\u003cp\u003eI tested a couple of scenarios. All there are 4 JVM, 3 load threads. The \\\"smoke test\\\" was starting all the JVMs at once.\u003c\\/p\u003e\\n\\n\u003cp\u003e1&gt; 100 collections, 4 shards x 4 replicas each\u003cbr\\/\u003e\\n2&gt; 10 collections, 4 shards x 40 replicas each.\u003c\\/p\u003e\\n\\n\u003cp\u003eOf course my testing could easily have missed the corner cases that trip this as it was pretty bare-bones.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15352349_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352349_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 04:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T04:44:18+0000\'\u003e28\\/Jun\\/16 04:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                   \\n Hmmm, is this a concern based on general principles or on a code path that is expected to fail? \\n\\n I tested a couple of scenarios. All there are 4 JVM, 3 load threads. The \\\"smoke test\\\" was starting all the JVMs at once. \\n\\n 1&gt; 100 collections, 4 shards x 4 replicas each \\n2&gt; 10 collections, 4 shards x 40 replicas each. \\n\\n Of course my testing could easily have missed the corner cases that trip this as it was pretty bare-bones. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15352397\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15352397&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15352397\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15352397_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352397_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 05:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T05:46:24+0000\'\u003e28\\/Jun\\/16 05:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eremoved some unnecessary changes\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15352397_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352397_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 05:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T05:46:24+0000\'\u003e28\\/Jun\\/16 05:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    removed some unnecessary changes              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15352399\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15352399&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15352399\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15352399_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352399_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 05:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T05:48:10+0000\'\u003e28\\/Jun\\/16 05:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Noble Paul - 28\\/Jun\\/16 05:48\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eif there is a collection that has more than coreLoadThreadCount\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eor a \'shard\' has more replicas? \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15352399_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352399_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 05:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T05:48:10+0000\'\u003e28\\/Jun\\/16 05:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Noble Paul - 28\\/Jun\\/16 05:48\\\"\u003eedited\u003c\\/span\u003e                    if there is a collection that has more than coreLoadThreadCount  \\n\\n or a \'shard\' has more replicas?               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15352431\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15352431&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15352431\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"damienka\\\" id=\\\"commentauthor_15352431_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=damienka\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"damienka\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e damien kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352431_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 06:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T06:17:07+0000\'\u003e28\\/Jun\\/16 06:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eConcern based on general principles. e.g. if a shard has all 4 replicas on the one JVM and 3 load threads. Then registration will be based on the first three cores only.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"damienka\\\" id=\\\"commentauthor_15352431_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=damienka\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"damienka\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e damien kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15352431_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 06:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T06:17:07+0000\'\u003e28\\/Jun\\/16 06:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Concern based on general principles. e.g. if a shard has all 4 replicas on the one JVM and 3 load threads. Then registration will be based on the first three cores only.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15353247\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15353247&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15353247\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dragonsinth\\\" id=\\\"commentauthor_15353247_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dragonsinth\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dragonsinth\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Scott Blum\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353247_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 15:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T15:41:13+0000\'\u003e28\\/Jun\\/16 15:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis may be unrelated to the current patch work, but seems relevant to the uber ticket.:\u003c\\/p\u003e\\n\\n\u003cp\u003eI rebooted our solr cluster the other night to pick up an update, and I ran into what seemed to be pathological behavior around state updates.  My first attempt to bring up everything at once resulted in utter deadlock, so I shut everything down, manually nuked all the overseer queues\\/maps in ZK, and started bringing them up one at a time.  What I saw was kind of astounding.\u003c\\/p\u003e\\n\\n\u003cp\u003eI was monitoring OVERSEERSTATUS and tracking the number of outstanding overseer ops + the total number of update_state ops, and I noticed that every VM I brought up needed ~4000 update_state ops to stabilize, despite the fact that each VM only manages ~128 cores.  We have 32 vms with ~128 cores each, or ~4096 cores in our entire cluster... it took over 100,000 update_state operations to bring the whole cluster up.  That seems... insane.  3 or 4 update_state ops per core would seem reasonable to me, but I saw over 30 ops per core loaded as I went.  This number was extremely consistent for every node I brought up.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dragonsinth\\\" id=\\\"commentauthor_15353247_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dragonsinth\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dragonsinth\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Scott Blum\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353247_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 15:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T15:41:13+0000\'\u003e28\\/Jun\\/16 15:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This may be unrelated to the current patch work, but seems relevant to the uber ticket.: \\n\\n I rebooted our solr cluster the other night to pick up an update, and I ran into what seemed to be pathological behavior around state updates.  My first attempt to bring up everything at once resulted in utter deadlock, so I shut everything down, manually nuked all the overseer queues\\/maps in ZK, and started bringing them up one at a time.  What I saw was kind of astounding. \\n\\n I was monitoring OVERSEERSTATUS and tracking the number of outstanding overseer ops + the total number of update_state ops, and I noticed that every VM I brought up needed ~4000 update_state ops to stabilize, despite the fact that each VM only manages ~128 cores.  We have 32 vms with ~128 cores each, or ~4096 cores in our entire cluster... it took over 100,000 update_state operations to bring the whole cluster up.  That seems... insane.  3 or 4 update_state ops per core would seem reasonable to me, but I saw over 30 ops per core loaded as I went.  This number was extremely consistent for every node I brought up.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15353258\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15353258&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15353258\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_15353258_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353258_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 15:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T15:47:07+0000\'\u003e28\\/Jun\\/16 15:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eThat seems... insane.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI am glad that I am not the only one to think the number of updates in the overseer queue for node startup is insane.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhen you get that many updates in the queue and haven\'t make a big change to jute.maxbuffer, zookeeper starts failing because the size of the znode will become too large.  I think it\'s crazy that zookeeper allows \u003cb\u003ewrites\u003c\\/b\u003e to a znode when the write will make the node too big.  See \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/ZOOKEEPER-1162\\\" title=\\\"consistent handling of jute.maxbuffer when attempting to read large zk &quot;directories&quot;\\\" class=\\\"issue-link\\\" data-issue-key=\\\"ZOOKEEPER-1162\\\"\u003eZOOKEEPER-1162\u003c\\/a\u003e.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_15353258_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353258_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 15:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T15:47:07+0000\'\u003e28\\/Jun\\/16 15:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     That seems... insane.  \\n\\n I am glad that I am not the only one to think the number of updates in the overseer queue for node startup is insane. \\n\\n When you get that many updates in the queue and haven\'t make a big change to jute.maxbuffer, zookeeper starts failing because the size of the znode will become too large.  I think it\'s crazy that zookeeper allows  writes  to a znode when the write will make the node too big.  See  ZOOKEEPER-1162 .              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15353261\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15353261&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15353261\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dragonsinth\\\" id=\\\"commentauthor_15353261_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dragonsinth\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dragonsinth\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Scott Blum\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353261_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 15:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T15:49:50+0000\'\u003e28\\/Jun\\/16 15:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePaginated getChildren().. always wondered why that wasn\'t a thing.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dragonsinth\\\" id=\\\"commentauthor_15353261_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dragonsinth\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dragonsinth\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Scott Blum\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353261_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 15:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T15:49:50+0000\'\u003e28\\/Jun\\/16 15:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Paginated getChildren().. always wondered why that wasn\'t a thing.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15353262\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15353262&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15353262\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dragonsinth\\\" id=\\\"commentauthor_15353262_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dragonsinth\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dragonsinth\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Scott Blum\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353262_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 15:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T15:50:10+0000\'\u003e28\\/Jun\\/16 15:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e(for the record, this was on a 5.5.1 based build)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dragonsinth\\\" id=\\\"commentauthor_15353262_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dragonsinth\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dragonsinth\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Scott Blum\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353262_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 15:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T15:50:10+0000\'\u003e28\\/Jun\\/16 15:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    (for the record, this was on a 5.5.1 based build)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15353278\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15353278&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15353278\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15353278_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353278_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 16:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T16:01:24+0000\'\u003e28\\/Jun\\/16 16:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eEmpirically it was fine, but that was on very few runs. I had 10 replicas in each JVM and 3 load threads in one variant. Of course I might just have gotten lucky.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15353278_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353278_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 16:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T16:01:24+0000\'\u003e28\\/Jun\\/16 16:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Empirically it was fine, but that was on very few runs. I had 10 replicas in each JVM and 3 load threads in one variant. Of course I might just have gotten lucky.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15353293\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15353293&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15353293\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15353293_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353293_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 16:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T16:13:56+0000\'\u003e28\\/Jun\\/16 16:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe cluster was very stable when I used dedicated overseer using the \u003ctt\u003eADDROLE\u003c\\/tt\u003e command. I used the replica placement strategy to ensure that the overseer nodes did not have any replicas created. For any reasonably large cluster, I recommend using dedicated overseer nodes. Another observation was that the overseer nodes use very little memory. It never went beyond 200MB heap. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15353293_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353293_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 16:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T16:13:56+0000\'\u003e28\\/Jun\\/16 16:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The cluster was very stable when I used dedicated overseer using the  ADDROLE  command. I used the replica placement strategy to ensure that the overseer nodes did not have any replicas created. For any reasonably large cluster, I recommend using dedicated overseer nodes. Another observation was that the overseer nodes use very little memory. It never went beyond 200MB heap.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15353362\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15353362&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15353362\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15353362_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353362_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 16:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T16:50:13+0000\'\u003e28\\/Jun\\/16 16:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIIUC, the whole watcher thing is replica based. So N replicas for the same collection in the same JVM register N watchers.\u003c\\/p\u003e\\n\\n\u003cp\u003eIf that\'s true, does it make sense to think about watchers being set per \u003cem\u003ecollection\u003c\\/em\u003e in a JVM rather than per \u003cem\u003ereplica\u003c\\/em\u003e? I admit I\'m completely ignorant of the nuances here. It also wouldn\'t make any difference in a collection where each instance hosted exactly one replica per collection, but practically I\'m not sure there\'s anything we can do about that anyway.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlthough it seems that each replica could be an Observer for a given collection (watcher at the JVM level?) without doing much violence to the current architecture. Or maybe it\'d just be simpler to have the replicas get their state information from some kind of cache maintained at the JVM level where the cache was updated via watcher. I admit I\'m talking through my hat here. Maybe there should be a JIRA to discuss this?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15353362_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353362_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 16:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T16:50:13+0000\'\u003e28\\/Jun\\/16 16:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    IIUC, the whole watcher thing is replica based. So N replicas for the same collection in the same JVM register N watchers. \\n\\n If that\'s true, does it make sense to think about watchers being set per  collection  in a JVM rather than per  replica ? I admit I\'m completely ignorant of the nuances here. It also wouldn\'t make any difference in a collection where each instance hosted exactly one replica per collection, but practically I\'m not sure there\'s anything we can do about that anyway. \\n\\n Although it seems that each replica could be an Observer for a given collection (watcher at the JVM level?) without doing much violence to the current architecture. Or maybe it\'d just be simpler to have the replicas get their state information from some kind of cache maintained at the JVM level where the cache was updated via watcher. I admit I\'m talking through my hat here. Maybe there should be a JIRA to discuss this?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15353437\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15353437&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15353437\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15353437_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353437_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 17:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T17:47:00+0000\'\u003e28\\/Jun\\/16 17:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFWIW, I tried both and had no trouble even when overseer was on one of the replicas with lots of cores. That said, I agree it\'s wise to put the overseer somewhere else in these cases. Certainly can\'t hurt!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15353437_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353437_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 17:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T17:47:00+0000\'\u003e28\\/Jun\\/16 17:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    FWIW, I tried both and had no trouble even when overseer was on one of the replicas with lots of cores. That said, I agree it\'s wise to put the overseer somewhere else in these cases. Certainly can\'t hurt!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15353502\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15353502&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15353502\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dragonsinth\\\" id=\\\"commentauthor_15353502_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dragonsinth\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dragonsinth\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Scott Blum\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353502_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 18:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T18:34:45+0000\'\u003e28\\/Jun\\/16 18:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\" class=\\\"user-hover\\\" rel=\\\"erickerickson\\\"\u003eErick Erickson\u003c\\/a\u003e we may be talking about 2 different things?  I\'m referring to the total number of Overseer state update operations that happen.  Is there a relationship between that and the watcher side that I\'m unaware of?\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso, in my case, we only have 1 replica per shard, period, so leadership contention shouldn\'t be an issue at all.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dragonsinth\\\" id=\\\"commentauthor_15353502_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dragonsinth\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dragonsinth\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Scott Blum\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353502_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 18:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T18:34:45+0000\'\u003e28\\/Jun\\/16 18:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Erick Erickson  we may be talking about 2 different things?  I\'m referring to the total number of Overseer state update operations that happen.  Is there a relationship between that and the watcher side that I\'m unaware of? \\n\\n Also, in my case, we only have 1 replica per shard, period, so leadership contention shouldn\'t be an issue at all.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15353556\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15353556&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15353556\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15353556_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353556_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 19:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T19:14:27+0000\'\u003e28\\/Jun\\/16 19:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eyeah, probably as I\'m out of my depth here. Since each replica goes through at least three state changes (down-&gt;recovering-&gt;active), not to mention leadership election and such and each state change needs to bet to ZK, I\'m really not at all sure now to cut that number down.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15353556_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15353556_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jun\\/16 19:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-28T19:14:27+0000\'\u003e28\\/Jun\\/16 19:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    yeah, probably as I\'m out of my depth here. Since each replica goes through at least three state changes (down-&gt;recovering-&gt;active), not to mention leadership election and such and each state change needs to bet to ZK, I\'m really not at all sure now to cut that number down. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15357146\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15357146&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15357146\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15357146_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15357146_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jun\\/16 14:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-30T14:15:48+0000\'\u003e30\\/Jun\\/16 14:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eyeah, normally you are fine. If there is a GC pause in the overseer node,  a lot of messages can get stuck in the queue and this will lead to even more threads waiting indefinitely (consuming more memory ) and aggravating the situation.   \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15357146_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15357146_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jun\\/16 14:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-30T14:15:48+0000\'\u003e30\\/Jun\\/16 14:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    yeah, normally you are fine. If there is a GC pause in the overseer node,  a lot of messages can get stuck in the queue and this will lead to even more threads waiting indefinitely (consuming more memory ) and aggravating the situation.                 \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15357167\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15357167&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15357167\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15357167_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15357167_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jun\\/16 14:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-30T14:31:48+0000\'\u003e30\\/Jun\\/16 14:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have simplified this patch and moved it over to \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-7280\\\" title=\\\"Load cores in sorted order and tweak coreLoadThread counts to improve cluster stability on restarts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-7280\\\"\u003e\u003cdel\u003eSOLR-7280\u003c\\/del\u003e\u003c\\/a\u003e . I plan to commit that soon\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"noble.paul\\\" id=\\\"commentauthor_15357167_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"noble.paul\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Noble Paul\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15357167_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Jun\\/16 14:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-06-30T14:31:48+0000\'\u003e30\\/Jun\\/16 14:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have simplified this patch and moved it over to   SOLR-7280   . I plan to commit that soon              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15702278\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15702278&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15702278\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15702278_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15702278_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/16 15:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-28T15:50:50+0000\'\u003e28\\/Nov\\/16 15:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=noble.paul\\\" class=\\\"user-hover\\\" rel=\\\"noble.paul\\\"\u003eNoble Paul\u003c\\/a\u003e Can we close this since \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-7280\\\" title=\\\"Load cores in sorted order and tweak coreLoadThread counts to improve cluster stability on restarts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-7280\\\"\u003e\u003cdel\u003eSOLR-7280\u003c\\/del\u003e\u003c\\/a\u003e has been committed?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"erickerickson\\\" id=\\\"commentauthor_15702278_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=erickerickson\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"erickerickson\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Erick Erickson\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15702278_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Nov\\/16 15:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2016-11-28T15:50:50+0000\'\u003e28\\/Nov\\/16 15:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Noble Paul  Can we close this since   SOLR-7280   has been committed?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15832664\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15832664&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15832664\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_15832664_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15832664_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/17 00:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-21T00:25:04+0000\'\u003e21\\/Jan\\/17 00:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI figured I would try the test setup again on Solr 6.4, see whether the situation has improved with newer versions.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe system requirements of thousands of collections has NOT gotten better.  It seems to have gotten considerably worse.  The time from node restart to stable operation MIGHT have improved, but since I haven\'t yet been able to create all 4000 collections, I cannot be sure about that.\u003c\\/p\u003e\\n\\n\u003cp\u003eI ran into serious trouble before I had even created 1000 collections.  Bumped the heap and proceeded to create more ... but ran into more trouble.  With a 12g heap for the instance running zookeeper, I noticed that I was getting an OOME about not being able to create threads when I had gotten a little more than 1800 collections created  I have changed nproc in \\/etc\\/security\\/limits.conf (was a soft limit of 4096 and a hard limit of 6144) and bumped maxThreads in the Jetty config, and once the cluster is stable after restart, I will try to make more collections.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_15832664_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15832664_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/17 00:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-21T00:25:04+0000\'\u003e21\\/Jan\\/17 00:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I figured I would try the test setup again on Solr 6.4, see whether the situation has improved with newer versions. \\n\\n The system requirements of thousands of collections has NOT gotten better.  It seems to have gotten considerably worse.  The time from node restart to stable operation MIGHT have improved, but since I haven\'t yet been able to create all 4000 collections, I cannot be sure about that. \\n\\n I ran into serious trouble before I had even created 1000 collections.  Bumped the heap and proceeded to create more ... but ran into more trouble.  With a 12g heap for the instance running zookeeper, I noticed that I was getting an OOME about not being able to create threads when I had gotten a little more than 1800 collections created  I have changed nproc in \\/etc\\/security\\/limits.conf (was a soft limit of 4096 and a hard limit of 6144) and bumped maxThreads in the Jetty config, and once the cluster is stable after restart, I will try to make more collections.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15832668\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15832668&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15832668\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_15832668_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15832668_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/17 00:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-21T00:31:20+0000\'\u003e21\\/Jan\\/17 00:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Shawn Heisey - 21\\/Jan\\/17 00:32\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWith hard nproc at 61440, soft nproc at 40960, and maxThreads for each jetty at 20000, I am still not able to create enough threads to start both Solr instances with just under 1900 collections in the cloud.  The user in question is running a few other things on the system, but the number of threads involved there is less than 300.  This is definitely not an improvement over 5.x.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_15832668_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15832668_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/17 00:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-21T00:31:20+0000\'\u003e21\\/Jan\\/17 00:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Shawn Heisey - 21\\/Jan\\/17 00:32\\\"\u003eedited\u003c\\/span\u003e                   With hard nproc at 61440, soft nproc at 40960, and maxThreads for each jetty at 20000, I am still not able to create enough threads to start both Solr instances with just under 1900 collections in the cloud.  The user in question is running a few other things on the system, but the number of threads involved there is less than 300.  This is definitely not an improvement over 5.x.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15832705\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15832705&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15832705\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_15832705_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15832705_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/17 01:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-21T01:16:05+0000\'\u003e21\\/Jan\\/17 01:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI know we have gotten pretty good at labeling and grouping threads, so hopefully a comparison between versions is not too difficult.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"markrmiller@gmail.com\\\" id=\\\"commentauthor_15832705_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=markrmiller%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"markrmiller@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mark Miller\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15832705_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/17 01:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-21T01:16:05+0000\'\u003e21\\/Jan\\/17 01:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I know we have gotten pretty good at labeling and grouping threads, so hopefully a comparison between versions is not too difficult.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15832908\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15832908&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15832908\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yriveiro\\\" id=\\\"commentauthor_15832908_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yriveiro\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yriveiro\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yago Riveiro\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15832908_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/17 09:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-21T09:49:11+0000\'\u003e21\\/Jan\\/17 09:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRestarting a node in 6.3 now takes forever ... I bumped coreLoadThreads from 4 to 512 and restarting a node with 1500 collections takes 20 - 25 minutes. If I bump coreLoadThreads to 1024 or 2048 is faster, but some times replicas stay in a wrong state and never go up.\u003c\\/p\u003e\\n\\n\u003cp\u003eOther thing that I see happen now is collections created without replicas.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eShawn where can I raise maxThreads of jetty?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yriveiro\\\" id=\\\"commentauthor_15832908_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yriveiro\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yriveiro\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yago Riveiro\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15832908_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/17 09:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-21T09:49:11+0000\'\u003e21\\/Jan\\/17 09:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Restarting a node in 6.3 now takes forever ... I bumped coreLoadThreads from 4 to 512 and restarting a node with 1500 collections takes 20 - 25 minutes. If I bump coreLoadThreads to 1024 or 2048 is faster, but some times replicas stay in a wrong state and never go up. \\n\\n Other thing that I see happen now is collections created without replicas. \\n\\n\\n Shawn where can I raise maxThreads of jetty?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15833172\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15833172&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15833172\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_15833172_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15833172_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/17 22:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-21T22:19:29+0000\'\u003e21\\/Jan\\/17 22:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eShawn where can I raise maxThreads of jetty?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eserver\\/etc\\/jetty.xml\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_15833172_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15833172_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/17 22:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-21T22:19:29+0000\'\u003e21\\/Jan\\/17 22:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Shawn where can I raise maxThreads of jetty?  \\n\\n server\\/etc\\/jetty.xml              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15833804\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15833804&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15833804\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_15833804_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15833804_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jan\\/17 02:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-23T02:04:57+0000\'\u003e23\\/Jan\\/17 02:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRegarding the extra threads, I\'m thinking the issue is that CoreContainer.load() now calls ZkContainer.registerInZk() with background \'true\'. Check how many \'coreZkRegister\' threads there are.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dk\\\" id=\\\"commentauthor_15833804_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dk\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dk\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Damien Kamerman\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15833804_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jan\\/17 02:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-01-23T02:04:57+0000\'\u003e23\\/Jan\\/17 02:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Regarding the extra threads, I\'m thinking the issue is that CoreContainer.load() now calls ZkContainer.registerInZk() with background \'true\'. Check how many \'coreZkRegister\' threads there are.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15893410\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15893410&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15893410\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_15893410_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15893410_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Mar\\/17 00:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-03T00:42:39+0000\'\u003e03\\/Mar\\/17 00:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNow that \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-10130\\\" title=\\\"Serious performance degradation in Solr 6.4.1 due to the new metrics collection\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-10130\\\"\u003e\u003cdel\u003eSOLR-10130\u003c\\/del\u003e\u003c\\/a\u003e has been discovered, there\'s a possibility that the bigger problems I ran into with a repeat test on 6.4 might have been related to that.  When I find some time, I will need to repeat with 6.4.2 or branch_6x.\u003c\\/p\u003e\\n\\n\u003cp\u003eI disagree with the status of this issue as FIXED.  No changes have been committed in relation to this issue.  At best, the problems I encountered with 5.0 are the same, and may have gotten worse.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"elyograg\\\" id=\\\"commentauthor_15893410_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=elyograg\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"elyograg\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Shawn Heisey\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15893410_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Mar\\/17 00:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-03T00:42:39+0000\'\u003e03\\/Mar\\/17 00:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Now that   SOLR-10130   has been discovered, there\'s a possibility that the bigger problems I ran into with a repeat test on 6.4 might have been related to that.  When I find some time, I will need to repeat with 6.4.2 or branch_6x. \\n\\n I disagree with the status of this issue as FIXED.  No changes have been committed in relation to this issue.  At best, the problems I encountered with 5.0 are the same, and may have gotten worse.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15925790\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15925790&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15925790\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yjfeng001\\\" id=\\\"commentauthor_15925790_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yjfeng001\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yjfeng001\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Jerome Yang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15925790_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/17 09:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-15T09:23:34+0000\'\u003e15\\/Mar\\/17 09:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAfter I test on solr6.4.2 in cloud mode.\u003cbr\\/\u003e\\n32 nodes, on 3 centos6.7 host.\u003cbr\\/\u003e\\nCreate 100 collections with replica_factor 3, 1800 cores in total.\u003cbr\\/\u003e\\nAfter restart the whole cluster(I write a script to start all nodes at same time). Only parts of collections are green.\u003cbr\\/\u003e\\nAnd sometimes all collections are marked as down.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt seems this still not fixed on solr6.4.2. Please re-open this.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yjfeng001\\\" id=\\\"commentauthor_15925790_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yjfeng001\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yjfeng001\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Jerome Yang\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15925790_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/17 09:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-15T09:23:34+0000\'\u003e15\\/Mar\\/17 09:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    After I test on solr6.4.2 in cloud mode. \\n32 nodes, on 3 centos6.7 host. \\nCreate 100 collections with replica_factor 3, 1800 cores in total. \\nAfter restart the whole cluster(I write a script to start all nodes at same time). Only parts of collections are green. \\nAnd sometimes all collections are marked as down. \\n\\n It seems this still not fixed on solr6.4.2. Please re-open this.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15925821\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15925821&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15925821\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"TimOwen\\\" id=\\\"commentauthor_15925821_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=TimOwen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"TimOwen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tim Owen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15925821_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/17 09:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-15T09:54:11+0000\'\u003e15\\/Mar\\/17 09:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAdmittedly not thousands of collections, but another anecdote. Each of our clusters are 12 hosts running 6 nodes each, with 165 collections of 16 shards each, 3x replication. So around 7900 cores spread over 72 nodes (roughly 100 each).\u003c\\/p\u003e\\n\\n\u003cp\u003eTo get stable restarts we throttle the recovery thread pool size, see ticket I raised with our patch, \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-9936\\\" title=\\\"Allow configuration for recoveryExecutor thread pool size\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-9936\\\"\u003e\u003cdel\u003eSOLR-9936\u003c\\/del\u003e\u003c\\/a\u003e - without that, the amount of recovery just kills the network and disks and the cluster status never settles.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso we avoid restarting all nodes at once, we bring up a few at a time and wait for their recovery to finish before starting more. We need to automate this, e.g. using a Zookeeper lock pool so that nodes will wait to startup.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"TimOwen\\\" id=\\\"commentauthor_15925821_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=TimOwen\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"TimOwen\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Tim Owen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15925821_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/17 09:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-15T09:54:11+0000\'\u003e15\\/Mar\\/17 09:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Admittedly not thousands of collections, but another anecdote. Each of our clusters are 12 hosts running 6 nodes each, with 165 collections of 16 shards each, 3x replication. So around 7900 cores spread over 72 nodes (roughly 100 each). \\n\\n To get stable restarts we throttle the recovery thread pool size, see ticket I raised with our patch,   SOLR-9936   - without that, the amount of recovery just kills the network and disks and the cluster status never settles. \\n\\n Also we avoid restarting all nodes at once, we bring up a few at a time and wait for their recovery to finish before starting more. We need to automate this, e.g. using a Zookeeper lock pool so that nodes will wait to startup.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15926204\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15926204&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15926204\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jhump\\\" id=\\\"commentauthor_15926204_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jhump\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jhump\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Joshua Humphries\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15926204_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/17 13:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-15T13:51:32+0000\'\u003e15\\/Mar\\/17 13:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Joshua Humphries - 15\\/Mar\\/17 13:51\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOur cluster has many thousands of collections, most of which have only a single shard and single replica. Restarting a single node takes over two minutes in good circumstances (expected restart, like during upgrades of solr or deployment of new\\/updated plugins). In bad circumstances, like if machines appear wedged and leader election issues have already caused the overseer queue to grow large, restarting a server can take over 10 minutes!\u003c\\/p\u003e\\n\\n\u003cp\u003eWhile watching the overseer queue size in our latest observation of this slowness, I saw that the down node messages take \u003cb\u003eway\u003c\\/b\u003e too long to process. I ended up tracking that to an issue where it results in a ZK write for \u003cb\u003eevery\u003c\\/b\u003e collection, not just the collections that had shard-replicas on that node. In our case, it was processing about 40 times too many collections, making a rolling restart of the whole cluster effectively O(n^2) instead of O( n) in terms of the writes to ZK.\u003c\\/p\u003e\\n\\n\u003cp\u003eSee \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-10277\\\" title=\\\"On &#39;downnode&#39;, lots of wasteful mutations are done to ZK\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-10277\\\"\u003e\u003cdel\u003eSOLR-10277\u003c\\/del\u003e\u003c\\/a\u003e.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jhump\\\" id=\\\"commentauthor_15926204_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jhump\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jhump\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Joshua Humphries\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15926204_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/17 13:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-15T13:51:32+0000\'\u003e15\\/Mar\\/17 13:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Joshua Humphries - 15\\/Mar\\/17 13:51\\\"\u003eedited\u003c\\/span\u003e                   Our cluster has many thousands of collections, most of which have only a single shard and single replica. Restarting a single node takes over two minutes in good circumstances (expected restart, like during upgrades of solr or deployment of new\\/updated plugins). In bad circumstances, like if machines appear wedged and leader election issues have already caused the overseer queue to grow large, restarting a server can take over 10 minutes! \\n\\n While watching the overseer queue size in our latest observation of this slowness, I saw that the down node messages take  way  too long to process. I ended up tracking that to an issue where it results in a ZK write for  every  collection, not just the collections that had shard-replicas on that node. In our case, it was processing about 40 times too many collections, making a rolling restart of the whole cluster effectively O(n^2) instead of O( n) in terms of the writes to ZK. \\n\\n See   SOLR-10277  .              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15926810\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-7191?focusedCommentId=15926810&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15926810\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"varunthacker\\\" id=\\\"commentauthor_15926810_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=varunthacker\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"varunthacker\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Varun Thacker\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15926810_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/17 19:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-15T19:29:08+0000\'\u003e15\\/Mar\\/17 19:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; Restarting a single node takes over two minutes in good circumstance\u003c\\/p\u003e\\n\\n\u003cp\u003eI posted some numbers on \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-10265\\\" title=\\\"Overseer can become the bottleneck in very large clusters\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-10265\\\"\u003eSOLR-10265\u003c\\/a\u003e which you might find helpful. You can run that test on your cluster to see the speed of the overseer. \u003c\\/p\u003e\\n\\n\u003cp\u003eA dedicated overseer node can help you in the meanwhile as well : \u003ca href=\\\"https:\\/\\/cwiki.apache.org\\/confluence\\/display\\/solr\\/Collections+API#CollectionsAPI-ADDROLE:AddaRole\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/cwiki.apache.org\\/confluence\\/display\\/solr\\/Collections+API#CollectionsAPI-ADDROLE:AddaRole\u003c\\/a\u003e\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"varunthacker\\\" id=\\\"commentauthor_15926810_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=varunthacker\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"varunthacker\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Varun Thacker\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15926810_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Mar\\/17 19:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2017-03-15T19:29:08+0000\'\u003e15\\/Mar\\/17 19:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; Restarting a single node takes over two minutes in good circumstance \\n\\n I posted some numbers on  SOLR-10265  which you might find helpful. You can run that test on your cluster to see the speed of the overseer.  \\n\\n A dedicated overseer node can help you in the meanwhile as well :  https:\\/\\/cwiki.apache.org\\/confluence\\/display\\/solr\\/Collections+API#CollectionsAPI-ADDROLE:AddaRole  \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310230";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/SOLR\\/summary\\\" title=\\\"Solr\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310230&amp;avatarId=22151\\\" alt=\\\"Solr\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/SOLR\\/summary\\\" title=\\\"Solr\\\"\u003eSolr\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1520341266183"> 
    <input type="hidden" title="jira.request.server.time" value="210"> 
    <input type="hidden" title="jira.request.id" value="781x97473813x5"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="3"> 
    <input type="hidden" title="db.reads.time.in.ms" value="42"> 
    <input type="hidden" title="db.conns.time.in.ms" value="47"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 781x97473813x5
	          REQUEST TIMESTAMP : [06/Mar/2018:13:01:06 +0000]
	               REQUEST TIME : 0.2100
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 3

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=43, elapsedTotal=42191294, elapsedMin=337596, elapsedMax=16306090, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=47, elapsedTotal=47018827, elapsedMin=308646, elapsedMax=16330463, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
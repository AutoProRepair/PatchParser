<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|9e7e6bd44f1380434117df7ec3a4a86b4b13eead|lout"> 
  <link rel="shortcut icon" href="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"sd.customer.profile.multi.languages\":true,\"sd.customer.portal.transitions\":true,\"sd.customer.portal.transitions.config\":true,\"sd.custom.email.stripping.rules\":false,\"sd.sla.lucene.issue.id.callback.performance\":true,\"sd.new.settings.sidebar.location\":true,\"sd.workload.report.paginator\":true,\"sd.experimental.portal.search.algorithm.default.1\":false,\"sd.customer.portal.help.center.agent.announcement\":true,\"sd.sla.improved.rendering\":false,\"sd.experimental.portal.search.algorithm.default.2\":false,\"sd.customer.feedback.validate.reporter.on.token\":true,\"sd.custom.email.notifications.utf8.csat.star\":true,\"sd.who.create.customers.by.email.setting\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.renderer.consider.variable.format\":true,\"sd.stats.event.tracking\":true,\"sd.password.helper.dialog\":true,\"sd.canned.responses\":false,\"sd.portal.help.center.customer.signup.secondary.email\":true,\"sd.custom.email.notifications.manage.language\":true,\"sd.use.search.by.permissions\":true,\"sd.slavalue.record.updated.date\":false,\"sd.report.custom.date.range\":false,\"sd.kb.article.helpfulness.report\":false,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"sd.custom.email.notifications.styling\":true,\"sd.workinghours.new.page.bulldog.1\":false,\"sd.customer.portal.two.step.login\":false,\"sd.automation.psmq.async.executor\":true,\"sd.customer.org.list.page.lazy.search\":true,\"sd.approval.requested.when.handler\":true,\"sd.request.type.field.rest.api.filtering.bugfix\":true,\"sd.automation.then.action.auto.answer.approval\":true,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"sla.will.only.be.paused.if.they.are.already.started\":true,\"sd.kb.comment.share.stats.collection\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"sd.customer.orgs.group.participants\":true,\"sd.portal.help.center.customer.signup\":true,\"sd.sla.agent.jql.security.restricted\":true,\"sd.test.feature.flag.x\":true,\"sd.test.feature.flag.y\":false,\"sd.cluster.safe.mail.channel.shutdown\":true,\"sd.email.channel.folders\":false,\"sd.email.analytics.open\":false,\"sd.kb.project.creation.create.link.space\":true,\"sd.workinghours.new.page\":false,\"sd.confluence.anonymous.permission.fix\":true,\"com.atlassian.jira.issuetable.draggable\":true,\"sd.customer.portal.project.agent.announcement\":true,\"sd.automation.audit.log\":true,\"jira.jql.suggestrecentfields\":false,\"sd.canned.responses.check.index.startup\":false,\"sd.new.project.templates\":true,\"sd.custom.email.notifications.custom.rules.simple.ui\":false,\"sd.custom.email.notifications.cut.over\":true,\"sd.dismiss.all.misconfiguration.warnings.setting\":true,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"sd.sla.configurations.export\":true,\"sd.canned.responses.variable.substitution\":true,\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"sd.customer.portal.prioties.per.project.fix\":true,\"jira.instrumentation.laas\":false,\"sd.kb.self.service.report\":false,\"sla.improved.request.handling\":true,\"sd.no.schedule.async.upgrade.tasks\":true,\"sd.kb.primary.nav\":true,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"sd.kb.issueview.panel.phase2\":true,\"sd.email.outsider.comments\":true,\"jira.create.linked.issue\":true,\"sd.kb.issueview.panel\":true,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"sd.approvals.light.weight\":false,\"sd.automation.then.webhook\":true,\"sd.respect.inline.edit.issue.off\":true,\"jira.jql.smartautoselectfirst\":false,\"sd.global.portal.search.atlassian.only.tracking\":false,\"sd.automation.if.condition.comment.primary.action\":true,\"jira.priorities.per.project\":true,\"sd.inline.noformat.renderer\":true,\"sd.customer.request.type.create.edit.screens\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/png,image/vnd.wap.wbmp,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data"]="{\"substitutionVariables\":{\"issue.summary\":\"Issue summary\",\"issue.description\":\"Issue description\",\"issue.key\":\"Issue key\",\"issue.reporter.name\":\"Issue reporter\",\"issue.resolution\":\"Issue resolution\",\"request.url\":\"Request URL\",\"request.status\":\"Request status\"}}";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-help-links.help-links"]="{\"help\":{\"email.settings\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"managing.queues\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+queues+for+your+team\",\"email.setup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"request.settings.help.bubble\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\",\"email.settings.suitablerequest\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email#Receivingrequestsbyemail-suitablerequest\",\"sla.import.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Importing+SLAs\",\"documentation.home\":\"https://docs.atlassian.com/jira/jsd-docs-039/JIRA+Service+Desk+Documentation\",\"default\":\"https://docs.atlassian.com/jira/jsd-docs-039/\",\"create.space.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base#serving-customers-with-a-knowledge-base-createpermission\",\"email.settings.troubleshooting\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+the+email+channel\",\"admin.notifications.config\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+service+desk+notifications\",\"troubleshoot.requesttype\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+request+types\",\"approvals.configuration\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+JIRA+Service+Desk+approvals\",\"setting.up.reports\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+service+desk+reports\",\"public.signup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+public+signup\",\"knowledge.base\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base\",\"resolve.permission.scheme.errors\":\"https://docs.atlassian.com/jira/jsd-docs-039/Resolving+permission+scheme+errors\",\"getting.started\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+with+JIRA+Service+Desk\",\"getting.started.agent\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+for+service+desk+agents\",\"invite.customers\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\"},\"kb\":{\"default\":\"https://confluence.atlassian.com/display/SDKB/\",\"troubleshooting.user.management.issues\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\",\"legacytransition\":\"https://confluence.atlassian.com/display/SDKB/Replacing+legacy+automatic+transitions+with+automation+rules\",\"umtroubleshoot\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\"}}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-base-url.base-url"]="\"https://issues.apache.org/jira\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"f19af2ba5740bb\"";
WRM._unparsedData["project-id"]="10594";
WRM._unparsedData["project-key"]="\"DERBY\"";
WRM._unparsedData["project-name"]="\"Derby\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="10594";
WRM._unparsedData["projectKey"]="\"DERBY\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/1a6b21131945f6f49ff48336b49ca3fe-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/d8484c9183f546511a8e336a8779bcd9-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d3b35d835f8f46fc3b53bb4db7f85158-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/71d42e74136d842a3ef4d5d136484843-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/95a4826c265852f4904f1e0e7300df68-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/944bb39eced1b35cfc7194aa02eb5a5a/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/5a8f0f8b8aa8f96a4f0f7e9e248d62f3-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="DERBY-3330"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[DERBY-3330] provide support for unique constraint over keys that include one or more nullable columns. - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[DERBY-3330] provide support for unique constraint over keys that include one or more nullable columns. - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/DERBY" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-3330">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="10594" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Derby'" src="https://issues.apache.org/jira/secure/projectavatar?pid=10594&amp;avatarId=10122"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/DERBY">Derby</a></li>
                 <li><a class="issue-link" data-issue-key="DERBY-3330" href="/jira/browse/DERBY-3330" id="key-val" rel="12386534">DERBY-3330</a></li>
                </ol>
                <h1 id="summary-val">provide support for unique constraint over keys that include one or more nullable columns.</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-3330"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/DERBY-3330/DERBY-3330.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/DERBY-3330/DERBY-3330.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/DERBY-3330/DERBY-3330.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/DERBY-3330/DERBY-3330.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" title="Improvement - An improvement or enhancement to an existing feature or task." width="16"> Improvement </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="10.4.1.3 ">10.4.1.3</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+fixVersion+%3D+10.4.1.3" title="10.4.1.3 ">10.4.1.3</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+component+%3D+SQL" title="SQL ">SQL</a>, <a href="/jira/issues/?jql=project+%3D+DERBY+AND+component+%3D+Store" title="Store ">Store</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12386534-value">None</span> 
                   </div> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap"> 
                   <strong class="name">Environment:</strong> 
                   <div id="environment-val" class="value">
                     all 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310090" class="item"> 
                     <div class="wrap"> 
                      <strong title="Issue &amp; fix info" class="name">Issue &amp; fix info:</strong> 
                      <div id="customfield_12310090-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310090-field"> 
                        <span>Release Note Needed</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>Allow unique constraint over keys which include one or more nullable fields. Prior to this change Derby only supported unique constraints on keys that included no nullable columns. The new constraint will allow unlimited inserts of any key with one more null columns, but will limit insert of keys with no null columns to 1 unique value per table.</p> 
                  <p>There is no change to existing or newly created unique indexes on null columns (as opposed to unique constraints on null columns). Also there is no change to existing or newly created constraints on keys with no nullable columns.</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/DERBY-3330?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/DERBY-3330?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/DERBY-3330?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/DERBY-3330?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374485" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374485/BTreeController.diff" draggable="true" data-downloadurl="text/x-patch:BTreeController.diff:https://issues.apache.org/jira/secure/attachment/12374485/BTreeController.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374485/BTreeController.diff" title="Latest  31/Jan/08 18:05 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:BTreeController.diff:https://issues.apache.org/jira/secure/attachment/12374485/BTreeController.diff">BTreeController.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-31T18:05:39.407Z">31/Jan/08 18:05</time>
                   </dd>
                   <dd class="attachment-size">
                    10 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376712" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376712/db2Compatibility.diff" draggable="true" data-downloadurl="text/x-patch:db2Compatibility.diff:https://issues.apache.org/jira/secure/attachment/12376712/db2Compatibility.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376712/db2Compatibility.diff" title="Latest  28/Feb/08 12:18 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:db2Compatibility.diff:https://issues.apache.org/jira/secure/attachment/12376712/db2Compatibility.diff">db2Compatibility.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-28T12:18:22.596Z">28/Feb/08 12:18</time>
                   </dd>
                   <dd class="attachment-size">
                    2 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376862" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376862/db2Compatibility-v2.diff" draggable="true" data-downloadurl="text/x-patch:db2Compatibility-v2.diff:https://issues.apache.org/jira/secure/attachment/12376862/db2Compatibility-v2.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376862/db2Compatibility-v2.diff" title="Latest  29/Feb/08 19:32 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:db2Compatibility-v2.diff:https://issues.apache.org/jira/secure/attachment/12376862/db2Compatibility-v2.diff">db2Compatibility-v2.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-29T19:32:11.214Z">29/Feb/08 19:32</time>
                   </dd>
                   <dd class="attachment-size">
                    3 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12377281" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12377281/derby-3330_followup_1_modified.diff" draggable="true" data-downloadurl="application/octet-stream:derby-3330_followup_1_modified.diff:https://issues.apache.org/jira/secure/attachment/12377281/derby-3330_followup_1_modified.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12377281/derby-3330_followup_1_modified.diff" title="Latest  06/Mar/08 20:34 - Mike Matrigali" draggable="true" data-downloadurl="application/octet-stream:derby-3330_followup_1_modified.diff:https://issues.apache.org/jira/secure/attachment/12377281/derby-3330_followup_1_modified.diff">derby-3330_followup_1_modified.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-03-06T20:34:15.917Z">06/Mar/08 20:34</time>
                   </dd>
                   <dd class="attachment-size">
                    6 kB
                   </dd>
                   <dd class="attachment-author">
                    Mike Matrigali
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12377257" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12377257/derby-3330_followup_1.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330_followup_1.diff:https://issues.apache.org/jira/secure/attachment/12377257/derby-3330_followup_1.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12377257/derby-3330_followup_1.diff" title="Latest  06/Mar/08 13:51 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330_followup_1.diff:https://issues.apache.org/jira/secure/attachment/12377257/derby-3330_followup_1.diff">derby-3330_followup_1.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-03-06T13:51:30.966Z">06/Mar/08 13:51</time>
                   </dd>
                   <dd class="attachment-size">
                    5 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12373494" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12373494/derby-3330.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330.diff:https://issues.apache.org/jira/secure/attachment/12373494/derby-3330.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12373494/derby-3330.diff" title="Latest  18/Jan/08 10:03 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330.diff:https://issues.apache.org/jira/secure/attachment/12373494/derby-3330.diff">derby-3330.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-18T10:03:33.996Z">18/Jan/08 10:03</time>
                   </dd>
                   <dd class="attachment-size">
                    29 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12373910" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12373910/derby-3330-testcase.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330-testcase.diff:https://issues.apache.org/jira/secure/attachment/12373910/derby-3330-testcase.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12373910/derby-3330-testcase.diff" title="Latest  24/Jan/08 08:51 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330-testcase.diff:https://issues.apache.org/jira/secure/attachment/12373910/derby-3330-testcase.diff">derby-3330-testcase.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-24T08:51:04.502Z">24/Jan/08 08:51</time>
                   </dd>
                   <dd class="attachment-size">
                    19 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12377142" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12377142/derby-3330-UpgradeTests.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330-UpgradeTests.diff:https://issues.apache.org/jira/secure/attachment/12377142/derby-3330-UpgradeTests.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12377142/derby-3330-UpgradeTests.diff" title="Latest  05/Mar/08 07:55 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330-UpgradeTests.diff:https://issues.apache.org/jira/secure/attachment/12377142/derby-3330-UpgradeTests.diff">derby-3330-UpgradeTests.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-03-05T07:55:01.043Z">05/Mar/08 07:55</time>
                   </dd>
                   <dd class="attachment-size">
                    10 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376674" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376674/derby-3330v10.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v10.diff:https://issues.apache.org/jira/secure/attachment/12376674/derby-3330v10.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376674/derby-3330v10.diff" title="Latest  27/Feb/08 22:13 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v10.diff:https://issues.apache.org/jira/secure/attachment/12376674/derby-3330v10.diff">derby-3330v10.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-27T22:13:25.568Z">27/Feb/08 22:13</time>
                   </dd>
                   <dd class="attachment-size">
                    86 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376711" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376711/derby-3330v11.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v11.diff:https://issues.apache.org/jira/secure/attachment/12376711/derby-3330v11.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376711/derby-3330v11.diff" title="Latest  28/Feb/08 12:06 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v11.diff:https://issues.apache.org/jira/secure/attachment/12376711/derby-3330v11.diff">derby-3330v11.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-28T12:06:21.480Z">28/Feb/08 12:06</time>
                   </dd>
                   <dd class="attachment-size">
                    82 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376736" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376736/derby-3330v12.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v12.diff:https://issues.apache.org/jira/secure/attachment/12376736/derby-3330v12.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376736/derby-3330v12.diff" title="Latest  28/Feb/08 15:40 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v12.diff:https://issues.apache.org/jira/secure/attachment/12376736/derby-3330v12.diff">derby-3330v12.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-28T15:40:51.092Z">28/Feb/08 15:40</time>
                   </dd>
                   <dd class="attachment-size">
                    82 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376773" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376773/derby-3330v13.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v13.diff:https://issues.apache.org/jira/secure/attachment/12376773/derby-3330v13.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376773/derby-3330v13.diff" title="Latest  28/Feb/08 22:14 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v13.diff:https://issues.apache.org/jira/secure/attachment/12376773/derby-3330v13.diff">derby-3330v13.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-28T22:14:37.931Z">28/Feb/08 22:14</time>
                   </dd>
                   <dd class="attachment-size">
                    88 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12373736" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12373736/derby-3330v2.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v2.diff:https://issues.apache.org/jira/secure/attachment/12373736/derby-3330v2.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12373736/derby-3330v2.diff" title="Latest  22/Jan/08 09:26 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v2.diff:https://issues.apache.org/jira/secure/attachment/12373736/derby-3330v2.diff">derby-3330v2.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-22T09:26:35.413Z">22/Jan/08 09:26</time>
                   </dd>
                   <dd class="attachment-size">
                    38 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12373854" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12373854/derby-3330v3.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v3.diff:https://issues.apache.org/jira/secure/attachment/12373854/derby-3330v3.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12373854/derby-3330v3.diff" title="Latest  23/Jan/08 18:26 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v3.diff:https://issues.apache.org/jira/secure/attachment/12373854/derby-3330v3.diff">derby-3330v3.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-23T18:26:11.072Z">23/Jan/08 18:26</time>
                   </dd>
                   <dd class="attachment-size">
                    39 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12373909" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12373909/derby-3330v4.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v4.diff:https://issues.apache.org/jira/secure/attachment/12373909/derby-3330v4.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12373909/derby-3330v4.diff" title="Latest  24/Jan/08 08:51 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v4.diff:https://issues.apache.org/jira/secure/attachment/12373909/derby-3330v4.diff">derby-3330v4.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-24T08:51:04.241Z">24/Jan/08 08:51</time>
                   </dd>
                   <dd class="attachment-size">
                    39 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12375565" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12375565/derby-3330v5.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v5.diff:https://issues.apache.org/jira/secure/attachment/12375565/derby-3330v5.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12375565/derby-3330v5.diff" title="Latest  14/Feb/08 09:47 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v5.diff:https://issues.apache.org/jira/secure/attachment/12375565/derby-3330v5.diff">derby-3330v5.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-14T09:47:04.509Z">14/Feb/08 09:47</time>
                   </dd>
                   <dd class="attachment-size">
                    84 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376120" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376120/derby-3330v6.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v6.diff:https://issues.apache.org/jira/secure/attachment/12376120/derby-3330v6.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376120/derby-3330v6.diff" title="Latest  21/Feb/08 11:51 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v6.diff:https://issues.apache.org/jira/secure/attachment/12376120/derby-3330v6.diff">derby-3330v6.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-21T11:51:47.784Z">21/Feb/08 11:51</time>
                   </dd>
                   <dd class="attachment-size">
                    102 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376205" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376205/derby-3330v7.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v7.diff:https://issues.apache.org/jira/secure/attachment/12376205/derby-3330v7.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376205/derby-3330v7.diff" title="Latest  22/Feb/08 08:06 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v7.diff:https://issues.apache.org/jira/secure/attachment/12376205/derby-3330v7.diff">derby-3330v7.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-22T08:06:29.315Z">22/Feb/08 08:06</time>
                   </dd>
                   <dd class="attachment-size">
                    103 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376240" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376240/derby-3330v8.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v8.diff:https://issues.apache.org/jira/secure/attachment/12376240/derby-3330v8.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376240/derby-3330v8.diff" title="Latest  22/Feb/08 17:07 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v8.diff:https://issues.apache.org/jira/secure/attachment/12376240/derby-3330v8.diff">derby-3330v8.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-22T17:07:37.460Z">22/Feb/08 17:07</time>
                   </dd>
                   <dd class="attachment-size">
                    101 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376302" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376302/derby-3330v9.diff" draggable="true" data-downloadurl="text/x-patch:derby-3330v9.diff:https://issues.apache.org/jira/secure/attachment/12376302/derby-3330v9.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376302/derby-3330v9.diff" title="Latest  23/Feb/08 12:52 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:derby-3330v9.diff:https://issues.apache.org/jira/secure/attachment/12376302/derby-3330v9.diff">derby-3330v9.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-23T12:52:31.732Z">23/Feb/08 12:52</time>
                   </dd>
                   <dd class="attachment-size">
                    86 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376682" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376682/derbyall_report.txt" draggable="true" data-downloadurl="text/plain:derbyall_report.txt:https://issues.apache.org/jira/secure/attachment/12376682/derbyall_report.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376682/derbyall_report.txt" title="Latest  28/Feb/08 00:56 - Mike Matrigali" draggable="true" data-downloadurl="text/plain:derbyall_report.txt:https://issues.apache.org/jira/secure/attachment/12376682/derbyall_report.txt">derbyall_report.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-28T00:56:30.020Z">28/Feb/08 00:56</time>
                   </dd>
                   <dd class="attachment-size">
                    19 kB
                   </dd>
                   <dd class="attachment-author">
                    Mike Matrigali
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12373919" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12373919/FunctionalSpec_DERBY-3330.html" draggable="true" data-downloadurl="text/html:FunctionalSpec_DERBY-3330.html:https://issues.apache.org/jira/secure/attachment/12373919/FunctionalSpec_DERBY-3330.html"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="HTML File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12373919/FunctionalSpec_DERBY-3330.html" title="Latest  24/Jan/08 12:01 - Anurag Shekhar" draggable="true" data-downloadurl="text/html:FunctionalSpec_DERBY-3330.html:https://issues.apache.org/jira/secure/attachment/12373919/FunctionalSpec_DERBY-3330.html">FunctionalSpec_DERBY-3330.html</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-24T12:01:33.697Z">24/Jan/08 12:01</time>
                   </dd>
                   <dd class="attachment-size">
                    7 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374153" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374153/FunctionalSpec_DERBY-3330-V2.html" draggable="true" data-downloadurl="text/html:FunctionalSpec_DERBY-3330-V2.html:https://issues.apache.org/jira/secure/attachment/12374153/FunctionalSpec_DERBY-3330-V2.html"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="HTML File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374153/FunctionalSpec_DERBY-3330-V2.html" title="Latest  27/Jan/08 15:29 - Anurag Shekhar" draggable="true" data-downloadurl="text/html:FunctionalSpec_DERBY-3330-V2.html:https://issues.apache.org/jira/secure/attachment/12374153/FunctionalSpec_DERBY-3330-V2.html">FunctionalSpec_DERBY-3330-V2.html</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-01-27T15:29:24.076Z">27/Jan/08 15:29</time>
                   </dd>
                   <dd class="attachment-size">
                    7 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12377283" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12377283/sortercomments.diff" draggable="true" data-downloadurl="text/x-patch:sortercomments.diff:https://issues.apache.org/jira/secure/attachment/12377283/sortercomments.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12377283/sortercomments.diff" title="Latest  06/Mar/08 20:57 - Anurag Shekhar" draggable="true" data-downloadurl="text/x-patch:sortercomments.diff:https://issues.apache.org/jira/secure/attachment/12377283/sortercomments.diff">sortercomments.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-03-06T20:57:01.255Z">06/Mar/08 20:57</time>
                   </dd>
                   <dd class="attachment-size">
                    1 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376251" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376251/UniqueConstraint_Implementation_V2.html" draggable="true" data-downloadurl="text/html:UniqueConstraint_Implementation_V2.html:https://issues.apache.org/jira/secure/attachment/12376251/UniqueConstraint_Implementation_V2.html"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="HTML File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376251/UniqueConstraint_Implementation_V2.html" title="Latest  22/Feb/08 18:55 - Anurag Shekhar" draggable="true" data-downloadurl="text/html:UniqueConstraint_Implementation_V2.html:https://issues.apache.org/jira/secure/attachment/12376251/UniqueConstraint_Implementation_V2.html">UniqueConstraint_Implementation_V2.html</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-22T18:55:32.150Z">22/Feb/08 18:55</time>
                   </dd>
                   <dd class="attachment-size">
                    12 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12376309" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12376309/UniqueConstraint_Implementation_V3.html" draggable="true" data-downloadurl="text/html:UniqueConstraint_Implementation_V3.html:https://issues.apache.org/jira/secure/attachment/12376309/UniqueConstraint_Implementation_V3.html"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="HTML File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12376309/UniqueConstraint_Implementation_V3.html" title="Latest  23/Feb/08 13:09 - Anurag Shekhar" draggable="true" data-downloadurl="text/html:UniqueConstraint_Implementation_V3.html:https://issues.apache.org/jira/secure/attachment/12376309/UniqueConstraint_Implementation_V3.html">UniqueConstraint_Implementation_V3.html</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-23T13:09:13.783Z">23/Feb/08 13:09</time>
                   </dd>
                   <dd class="attachment-size">
                    10 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12377272" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12377272/UniqueConstraint_Implementation_V4.html" draggable="true" data-downloadurl="text/html:UniqueConstraint_Implementation_V4.html:https://issues.apache.org/jira/secure/attachment/12377272/UniqueConstraint_Implementation_V4.html"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="HTML File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12377272/UniqueConstraint_Implementation_V4.html" title="Latest  06/Mar/08 18:46 - Anurag Shekhar" draggable="true" data-downloadurl="text/html:UniqueConstraint_Implementation_V4.html:https://issues.apache.org/jira/secure/attachment/12377272/UniqueConstraint_Implementation_V4.html">UniqueConstraint_Implementation_V4.html</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-03-06T18:46:01.485Z">06/Mar/08 18:46</time>
                   </dd>
                   <dd class="attachment-size">
                    13 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12374544" data-issue-id="12386534" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12374544/UniqueConstraint_Implementation.html" draggable="true" data-downloadurl="text/html:UniqueConstraint_Implementation.html:https://issues.apache.org/jira/secure/attachment/12374544/UniqueConstraint_Implementation.html"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-code" title="HTML File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12374544/UniqueConstraint_Implementation.html" title="Latest  01/Feb/08 12:44 - Anurag Shekhar" draggable="true" data-downloadurl="text/html:UniqueConstraint_Implementation.html:https://issues.apache.org/jira/secure/attachment/12374544/UniqueConstraint_Implementation.html">UniqueConstraint_Implementation.html</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-02-01T12:44:06.700Z">01/Feb/08 12:44</time>
                   </dd>
                   <dd class="attachment-size">
                    15 kB
                   </dd>
                   <dd class="attachment-author">
                    Anurag Shekhar
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="is related to">
                   is related to
                  </dt> 
                  <dd id="internal-12390770_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" width="16" height="16" title="Bug - A problem which impairs or prevents the functions of the product." alt="Bug - A problem which impairs or prevents the functions of the product."> <span title="DERBY-3523: sql states (X0Y63, X0Y63, X0Y63.S) related to nulls in unique constraints are associated with wrong message texts "> <a href="/jira/browse/DERBY-3523" data-issue-key="DERBY-3523" class="issue-link link-title">DERBY-3523</a> <span class="link-summary">sql states (X0Y63, X0Y63, X0Y63.S) related to nulls in unique constraints are associated with wrong message texts </span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-blue-gray jira-issue-status-lozenge-new aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Open</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is open and ready for the assignee to start work on it.</span>">Open</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                  <dd id="internal-12359789_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" width="16" height="16" title="Improvement - An improvement or enhancement to an existing feature or task." alt="Improvement - An improvement or enhancement to an existing feature or task."> <span title="DERBY-2212: Add &quot;Unique where not null&quot; to create index"> <a href="/jira/browse/DERBY-2212" data-issue-key="DERBY-2212" class="issue-link link-title">DERBY-2212</a> <span class="link-summary">Add "Unique where not null" to create index</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-blue-gray jira-issue-status-lozenge-new aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Open</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is open and ready for the assignee to start work on it.</span>">Open</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                 <dl class="links-list "> 
                  <dt title="relates to">
                   relates to
                  </dt> 
                  <dd id="internal-12390350_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" width="16" height="16" title="Bug - A problem which impairs or prevents the functions of the product." alt="Bug - A problem which impairs or prevents the functions of the product."> <span title="DERBY-3502: Unique Constraint's backing index when shared with existing indexes doesn't behave as expected"> <a href="/jira/browse/DERBY-3502" data-issue-key="DERBY-3502" class="issue-link link-title resolution">DERBY-3502</a> <span class="link-summary">Unique Constraint's backing index when shared with existing indexes doesn't behave as expected</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/critical.svg" width="16" height="16" title="Critical - Crashes, loss of data, severe memory leak." alt="Critical - Crashes, loss of data, severe memory leak."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="view-subtasks" class="module toggle-wrap">
               <div id="view-subtasks_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="subtask-view-options" class="aui-list-section aui-first aui-last">
                     <li class="aui-list-item"><a id="subtasks-show-all" href="/jira/browse/DERBY-3330?subTaskView=all#issuetable" class="aui-list-checked aui-checked aui-list-item-link" title="Show All"><span>Show All</span></a></li>
                     <li class="aui-list-item"><a id="subtasks-show-open" href="/jira/browse/DERBY-3330?subTaskView=unresolved#issuetable" class="aui-list-checked aui-list-item-link" title="Show Open"><span>Show Open</span></a></li>
                     <li class="aui-list-item"><a id="subtasks-bulk-operation" href="/jira/issue/bulkedit/BulkEdit1!default.jspa?reset=true&amp;searchParent=DERBY-3330" class="aui-list-checked aui-list-item-link" title="Bulk operation"><span>Bulk operation</span></a></li>
                     <li class="aui-list-item"><a id="subtasks-open-issue-navigator" href="/jira/issues/?jql=parent%3DDERBY-3330" class="aui-list-checked aui-list-item-link" title="Open issue navigator"><span>Open issue navigator</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Sub-Tasks</h2>
               </div>
               <div class="mod-content">
                <div class="mod-content intform subtask-table-container"> 
                 <issuetable-web-component> 
                  <table id="issuetable"> 
                   <tbody>
                    <tr id="issuerow12389384" rel="12389384" data-issuekey="DERBY-3456" class="issuerow"> 
                     <td class="stsequence">
                      <div rel="0" class="subtask-done">
                       1.
                      </div> </td> 
                     <td class="stsummary"><a class="issue-link" data-issue-key="DERBY-3456" href="/jira/browse/DERBY-3456">Allow removing not null from collumns particpating in unique constraint.</a></td> 
                     <td class="issuetype"> <a class="issue-link" data-issue-key="DERBY-3456" href="/jira/browse/DERBY-3456"> <img src="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype" height="16" width="16" border="0" align="absmiddle" alt="Sub-task" title="Sub-task - The sub-task of the issue"> </a> </td> 
                     <td class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </td> 
                     <td class="assignee"> <span class="tinylink"><a class="user-hover" rel="anurag" id="assignee_anurag" href="/jira/secure/ViewProfile.jspa?name=anurag">Anurag Shekhar</a></span> </td> 
                    </tr> 
                    <tr id="issuerow12389676" rel="12389676" data-issuekey="DERBY-3473" class="issuerow"> 
                     <td class="stsequence">
                      <div rel="1" class="subtask-done">
                       2.
                      </div> </td> 
                     <td class="stsummary"><a class="issue-link" data-issue-key="DERBY-3473" href="/jira/browse/DERBY-3473">write test cases to test locking during tree operation</a></td> 
                     <td class="issuetype"> <a class="issue-link" data-issue-key="DERBY-3473" href="/jira/browse/DERBY-3473"> <img src="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype" height="16" width="16" border="0" align="absmiddle" alt="Sub-task" title="Sub-task - The sub-task of the issue"> </a> </td> 
                     <td class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </td> 
                     <td class="assignee"> <span class="tinylink"><a class="user-hover" rel="anurag" id="assignee_anurag" href="/jira/secure/ViewProfile.jspa?name=anurag">Anurag Shekhar</a></span> </td> 
                    </tr> 
                    <tr id="issuerow12389678" rel="12389678" data-issuekey="DERBY-3474" class="issuerow"> 
                     <td class="stsequence">
                      <div rel="2" class="subtask-done">
                       3.
                      </div> </td> 
                     <td class="stsummary"><a class="issue-link" data-issue-key="DERBY-3474" href="/jira/browse/DERBY-3474">update unique constraint sections of refrence manual</a></td> 
                     <td class="issuetype"> <a class="issue-link" data-issue-key="DERBY-3474" href="/jira/browse/DERBY-3474"> <img src="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype" height="16" width="16" border="0" align="absmiddle" alt="Sub-task" title="Sub-task - The sub-task of the issue"> </a> </td> 
                     <td class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </td> 
                     <td class="assignee"> <span class="tinylink"><a class="user-hover" rel="chaase3" id="assignee_chaase3" href="/jira/secure/ViewProfile.jspa?name=chaase3">Kim Haase</a></span> </td> 
                    </tr> 
                   </tbody> 
                  </table> 
                 </issuetable-web-component> 
                 <div class="end-of-stable-message"></div> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_anurag" rel="anurag" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Anurag Shekhar&quot;,&quot;emailAddress&quot;:&quot;anurag.shekhar@gmail.com&quot;,&quot;username&quot;:&quot;anurag&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="anurag"></span></span> Anurag Shekhar </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_anurag" rel="anurag" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Anurag Shekhar&quot;,&quot;emailAddress&quot;:&quot;anurag.shekhar@gmail.com&quot;,&quot;username&quot;:&quot;anurag&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="anurag"></span></span> Anurag Shekhar </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">1</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">1</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="17/Jan/08 19:41"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2008-01-17T19:41:16+0000">17/Jan/08 19:41</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="25/Nov/13 20:30"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2013-11-25T20:30:48+0000">25/Nov/13 20:30</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="10/Oct/08 17:31"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2008-10-10T17:31:14+0000">10/Oct/08 17:31</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for n/a, Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3330?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3330?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3330?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3330?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3330?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3330?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3330?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3330?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/DERBY-3330?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3330?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3330?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/DERBY-3330?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-12560055\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12560055&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12560055\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12560055_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12560055_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Jan\\/08 19:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-17T19:47:57+0000\'\u003e17\\/Jan\\/08 19:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis issue started as a part of Derby-2212 but latter it was discussed that its safer to provide this functionality just by having unique constraint over null able columns and behavior of index is left unchanged.\u003c\\/p\u003e\\n\\n\u003cp\u003ePlease read comments in Derby-2212 for the background information about this issue.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12560055_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12560055_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Jan\\/08 19:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-17T19:47:57+0000\'\u003e17\\/Jan\\/08 19:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This issue started as a part of Derby-2212 but latter it was discussed that its safer to provide this functionality just by having unique constraint over null able columns and behavior of index is left unchanged. \\n\\n Please read comments in Derby-2212 for the background information about this issue.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12560070\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12560070&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12560070\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12560070_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12560070_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Jan\\/08 20:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-17T20:22:03+0000\'\u003e17\\/Jan\\/08 20:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI am following Mike\'s approach ie internally unique constraint will \u003cbr\\/\u003e\\nbe backed by no unique index but during insert, checking the \u003cbr\\/\u003e\\nimmediate left and right slot to find duplicate (if there is no null \u003cbr\\/\u003e\\nin the new key). If a duplicate key is found it the insert will be rejected. \u003c\\/p\u003e\\n\\n\u003cp\u003eI will be introducing a new attribute in BTree to tell the insert routine \u003cbr\\/\u003e\\nthat its not a non unique index but almost unique index. New \u003cbr\\/\u003e\\nattribute in BTree will be a persistant attribute so the file system will \u003cbr\\/\u003e\\nnot be compatible with the older versions and will require a hard upgrade \u003cbr\\/\u003e\\nroutine to migrate the old indexes to new version.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhile creating the constraint on a table with existing records \u003cbr\\/\u003e\\nmerge short is perform to sort the keys before creating index. A \u003cbr\\/\u003e\\nnew merge short class will be required to sort this almost unique \u003cbr\\/\u003e\\nindex (allowing duplicates only if there is null in it).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12560070_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12560070_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Jan\\/08 20:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-17T20:22:03+0000\'\u003e17\\/Jan\\/08 20:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I am following Mike\'s approach ie internally unique constraint will  \\nbe backed by no unique index but during insert, checking the  \\nimmediate left and right slot to find duplicate (if there is no null  \\nin the new key). If a duplicate key is found it the insert will be rejected.  \\n\\n I will be introducing a new attribute in BTree to tell the insert routine  \\nthat its not a non unique index but almost unique index. New  \\nattribute in BTree will be a persistant attribute so the file system will  \\nnot be compatible with the older versions and will require a hard upgrade  \\nroutine to migrate the old indexes to new version. \\n\\n While creating the constraint on a table with existing records  \\nmerge short is perform to sort the keys before creating index. A  \\nnew merge short class will be required to sort this almost unique  \\nindex (allowing duplicates only if there is null in it).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12560322\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12560322&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12560322\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12560322_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12560322_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Jan\\/08 10:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-18T10:03:34+0000\'\u003e18\\/Jan\\/08 10:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI am running the tests and will be updating the patch based on the test results.\u003c\\/p\u003e\\n\\n\u003cp\u003eDescription of patch\u003cbr\\/\u003e\\nmodified files \u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/compile\\/CreateIndexNode.java\u003cbr\\/\u003e\\njava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/compile\\/TableElementList.java\u003cbr\\/\u003e\\njava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/GenericConstantActionFactory.java\u003cbr\\/\u003e\\nAdded new methods to support almost unique index for unique constraint\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/CreateIndexConstantAction.java\u003cbr\\/\u003e\\nAdded new CreateIndexConstantAction method to support a new parameter (almost unique) for indexes. This property is stored and used while executing this action.\u003cbr\\/\u003e\\nexecute method of this class uses this property to use AlmostUniqueIndexSortObserver and AlmostUniqueMergeSort. This two classes provide special sorting routine which considers two row as duplicate only if all the key parts are non null.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/sort\\/MergeSort.java\u003cbr\\/\u003e\\nchanged the scope of few attributes to protected so that AlmostUniqueMergeSort can  access them.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/sort\\/ExternalSortFactory.java\u003cbr\\/\u003e\\nremoved final to allow AlmostUniqueExternalSortFactory to extend from it.\u003cbr\\/\u003e\\nmoved creation of MergeSort to a protected method so that extending class \u003cbr\\/\u003e\\ncan return a different class.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/BTree.java\u003cbr\\/\u003e\\nadded a new property almostUnique and getter and setters for the same.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/BTreeController.java\u003cbr\\/\u003e\\nadded a new private method to compare the record with immediate left and right records to check for duplicate.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/index\\/B2I.java\u003cbr\\/\u003e\\nadded code to store and retrieve new attribute \\\"almostUnique\\\" to the file system.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/iapi\\/store\\/access\\/AccessFactoryGlobals.java\u003cbr\\/\u003e\\nadded property string for AlmostUniqueExternalSortFactory.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/modules.properties\u003cbr\\/\u003e\\nAdded entry for AlmostUniqueExternalSortFactory.\u003c\\/p\u003e\\n\\n\\n\\n\u003cp\u003eNew files\u003cbr\\/\u003e\\njava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/AlmostUniqueIndexSortObserver.java\u003cbr\\/\u003e\\nThis class implements duplicate checking routine to reject non null duplicate keys.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/sort\\/AlmostUniqueExternalSortFactory.java\u003cbr\\/\u003e\\nThis class extends from ExternalSortFactory and overrides getMergeSort methods to return AlmostUniqueMergeSort.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/sort\\/AlmostUniqueMergeSort.java\u003cbr\\/\u003e\\nThis class extends MergeSort and overrides compare methods to ignore last keypart (location) while checking for duplicate keys.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12560322_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12560322_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Jan\\/08 10:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-18T10:03:34+0000\'\u003e18\\/Jan\\/08 10:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I am running the tests and will be updating the patch based on the test results. \\n\\n Description of patch \\nmodified files  \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/compile\\/CreateIndexNode.java \\njava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/compile\\/TableElementList.java \\njava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/GenericConstantActionFactory.java \\nAdded new methods to support almost unique index for unique constraint \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/CreateIndexConstantAction.java \\nAdded new CreateIndexConstantAction method to support a new parameter (almost unique) for indexes. This property is stored and used while executing this action. \\nexecute method of this class uses this property to use AlmostUniqueIndexSortObserver and AlmostUniqueMergeSort. This two classes provide special sorting routine which considers two row as duplicate only if all the key parts are non null. \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/sort\\/MergeSort.java \\nchanged the scope of few attributes to protected so that AlmostUniqueMergeSort can  access them. \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/sort\\/ExternalSortFactory.java \\nremoved final to allow AlmostUniqueExternalSortFactory to extend from it. \\nmoved creation of MergeSort to a protected method so that extending class  \\ncan return a different class. \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/BTree.java \\nadded a new property almostUnique and getter and setters for the same. \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/BTreeController.java \\nadded a new private method to compare the record with immediate left and right records to check for duplicate. \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/index\\/B2I.java \\nadded code to store and retrieve new attribute \\\"almostUnique\\\" to the file system. \\n\\n java\\/engine\\/org\\/apache\\/derby\\/iapi\\/store\\/access\\/AccessFactoryGlobals.java \\nadded property string for AlmostUniqueExternalSortFactory. \\n\\n java\\/engine\\/org\\/apache\\/derby\\/modules.properties \\nAdded entry for AlmostUniqueExternalSortFactory. \\n\\n\\n\\n New files \\njava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/AlmostUniqueIndexSortObserver.java \\nThis class implements duplicate checking routine to reject non null duplicate keys. \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/sort\\/AlmostUniqueExternalSortFactory.java \\nThis class extends from ExternalSortFactory and overrides getMergeSort methods to return AlmostUniqueMergeSort. \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/sort\\/AlmostUniqueMergeSort.java \\nThis class extends MergeSort and overrides compare methods to ignore last keypart (location) while checking for duplicate keys. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12561275\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12561275&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12561275\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12561275_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12561275_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Jan\\/08 09:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-22T09:26:35+0000\'\u003e22\\/Jan\\/08 09:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have done some cleanup in this patch. This patch also includes fixes based on the failures in regression tests. I still have failures in regression tests. I will posting another patch after fixing them.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis patch has following changes since the last time.\u003c\\/p\u003e\\n\\n\u003cp\u003e1. Modified IndexRowGenerator to keep the information if this represents an almost unique index. This information is used by IndexChanger to deffer the inserts for update in case of almost unique index (in addition to unique index).\u003c\\/p\u003e\\n\\n\u003cp\u003e2. Modified BTreeControler.compareLeftAndRightSiblings to use newly introduced methods to get the record at left and right. These two methods check for deleted record and continue to move to previous (in case of right next) record till it finds a valid record.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have also identified the code changed required for soft upgrade (marked with comments)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12561275_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12561275_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Jan\\/08 09:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-22T09:26:35+0000\'\u003e22\\/Jan\\/08 09:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have done some cleanup in this patch. This patch also includes fixes based on the failures in regression tests. I still have failures in regression tests. I will posting another patch after fixing them. \\n\\n This patch has following changes since the last time. \\n\\n 1. Modified IndexRowGenerator to keep the information if this represents an almost unique index. This information is used by IndexChanger to deffer the inserts for update in case of almost unique index (in addition to unique index). \\n\\n 2. Modified BTreeControler.compareLeftAndRightSiblings to use newly introduced methods to get the record at left and right. These two methods check for deleted record and continue to move to previous (in case of right next) record till it finds a valid record. \\n\\n I have also identified the code changed required for soft upgrade (marked with comments)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12561757\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12561757&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12561757\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12561757_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12561757_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jan\\/08 18:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-23T18:26:11+0000\'\u003e23\\/Jan\\/08 18:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis patches fixes all the failures in test suite cased by this \u003cbr\\/\u003e\\nwork except for upgrades tests. I am still having failures and \u003cbr\\/\u003e\\nerrors in upgrade tests because this patch introduces extra \u003cbr\\/\u003e\\nattribute in BTree and IndexRowGenerator.\u003c\\/p\u003e\\n\\n\u003cp\u003eII am also seeing one failure in \u003cbr\\/\u003e\\norg.apache.derbyTesting.functionTests.tests.lang.PrimaryKeyTest.testKeyConstraintsImpliesNotNull but I am getting this error in fresh checkout too.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have made changes nist.dml019.out in group by tests.\u003cbr\\/\u003e\\nCurrently Unique constraint is backed by unique index \u003cbr\\/\u003e\\nand group by clause on unique index internally uses distinct \u003cbr\\/\u003e\\nscan resulting in sorted results. After changing backing \u003cbr\\/\u003e\\nindex from unique index to almost unique index distinct \u003cbr\\/\u003e\\nindex wasn\'t used and results appear in random order (similar\u003cbr\\/\u003e\\n to group by clause on non unique indexes). I have modified the\u003cbr\\/\u003e\\n out file to match the output of select with group by clause.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis results in deviation from current behavior but group by \u003cbr\\/\u003e\\nwithout order by clause need not be sorted so portable \u003cbr\\/\u003e\\napplication will not be using this behavior or derby. Derby \u003cbr\\/\u003e\\nmanuals also don\'t promise this behavior.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis change in behavior doesn\'t mean that nist test is failing \u003cbr\\/\u003e\\nas the test iis supposed to be checking only for the number \u003cbr\\/\u003e\\nof rows and not their order.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12561757_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12561757_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Jan\\/08 18:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-23T18:26:11+0000\'\u003e23\\/Jan\\/08 18:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This patches fixes all the failures in test suite cased by this  \\nwork except for upgrades tests. I am still having failures and  \\nerrors in upgrade tests because this patch introduces extra  \\nattribute in BTree and IndexRowGenerator. \\n\\n II am also seeing one failure in  \\norg.apache.derbyTesting.functionTests.tests.lang.PrimaryKeyTest.testKeyConstraintsImpliesNotNull but I am getting this error in fresh checkout too. \\n\\n I have made changes nist.dml019.out in group by tests. \\nCurrently Unique constraint is backed by unique index  \\nand group by clause on unique index internally uses distinct  \\nscan resulting in sorted results. After changing backing  \\nindex from unique index to almost unique index distinct  \\nindex wasn\'t used and results appear in random order (similar \\n to group by clause on non unique indexes). I have modified the \\n out file to match the output of select with group by clause. \\n\\n This results in deviation from current behavior but group by  \\nwithout order by clause need not be sorted so portable  \\napplication will not be using this behavior or derby. Derby  \\nmanuals also don\'t promise this behavior. \\n\\n This change in behavior doesn\'t mean that nist test is failing  \\nas the test iis supposed to be checking only for the number  \\nof rows and not their order.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12561976\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12561976&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12561976\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12561976_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12561976_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Jan\\/08 08:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-24T08:51:04+0000\'\u003e24\\/Jan\\/08 08:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ederby-3330-testcase.diff has a test case to test unique constraint on nullable column. \u003c\\/p\u003e\\n\\n\u003cp\u003echange between derby-3330v3.diff derby-3330v4.diff \u003cbr\\/\u003e\\nFixed one bug related to deleted keys exposed by the above test case.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12561976_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12561976_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Jan\\/08 08:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-24T08:51:04+0000\'\u003e24\\/Jan\\/08 08:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    derby-3330-testcase.diff has a test case to test unique constraint on nullable column.  \\n\\n change between derby-3330v3.diff derby-3330v4.diff  \\nFixed one bug related to deleted keys exposed by the above test case.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12562025\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12562025&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12562025\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12562025_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562025_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Jan\\/08 12:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-24T12:01:38+0000\'\u003e24\\/Jan\\/08 12:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRevised functional spec from derby-2212\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12562025_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562025_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'24\\/Jan\\/08 12:01\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-24T12:01:38+0000\'\u003e24\\/Jan\\/08 12:01\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Revised functional spec from derby-2212              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12562638\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12562638&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12562638\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12562638_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562638_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jan\\/08 19:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-25T19:55:19+0000\'\u003e25\\/Jan\\/08 19:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ehere are some initial comments on the derby-3330v4.diff patch\u003c\\/p\u003e\\n\\n\u003cp\u003eoverall:\u003cbr\\/\u003e\\no almost unique, doesn\'t seem like a good name for this.  And I didn\'t see\u003cbr\\/\u003e\\n  good documentation in the code explaining what this means.  Unfortunately\u003cbr\\/\u003e\\n  could not think of something less wordy than AllowMulipleNullsInUnique.\u003c\\/p\u003e\\n\\n\u003cp\u003eo not sure what you are using for tab\\/spaces, see derby web site for following\u003cbr\\/\u003e\\n  existing conventions in the code.  may seem minor but inconsistent tab\\/indent\u003cbr\\/\u003e\\n  makes stuff unreadable.  Derby code that has tab indentation expects 4 spaces\u003cbr\\/\u003e\\n  for those tabs.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/compile\\/CreateIndexNode.java\u003cbr\\/\u003e\\no no comments explaining new parameter and what false means.  \u003cbr\\/\u003e\\n  CreateindexConstantAction also has no comments about the parameter either.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/CreateIndexConstantAction.java\u003cbr\\/\u003e\\no inconsistent formatting with rest of file for new CreateIndexConstantAction\u003cbr\\/\u003e\\n  routine, so does not indent same as rest.\u003c\\/p\u003e\\n\\n\u003cp\u003eo Why did you add whole new routine rather than add single parameter to \u003cbr\\/\u003e\\n  existing routine and update other references.  I think it is really error\u003cbr\\/\u003e\\n  prone to have 2 routines with same name and just differ by 12 or 13 \u003cbr\\/\u003e\\n  params.  \u003c\\/p\u003e\\n\\n\u003cp\u003eo no comments about almostUnique, some doc in the CreateIndexConstantAction \u003cbr\\/\u003e\\n  call and some comment following the existing code when property is set up\u003cbr\\/\u003e\\n  would be appropriate.\u003c\\/p\u003e\\n\\n\u003cp\u003eo This line looks unused:\u003cbr\\/\u003e\\n  Properties sortProperty = null; \u003cbr\\/\u003e\\n  it looks later like you use \\\"properties\\\" but other code seems to think that\u003cbr\\/\u003e\\n  this may be null sometimes.\u003c\\/p\u003e\\n\\n\u003cp\u003eo the tabbing\\/indentation inconsistency makes the sort part almost unreadable.\u003cbr\\/\u003e\\n  no comments for added sort logic.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/compile\\/TableElementList.java\u003cbr\\/\u003e\\no bad indentation\u003cbr\\/\u003e\\no looks like you removed check for null but left comments that we would check\u003cbr\\/\u003e\\n  for null.  \u003cbr\\/\u003e\\no again no added comments for all changes to this file.\u003c\\/p\u003e\\n\\n\u003cp\u003eo need some explanation of what the added code is doing here.  What is the\u003cbr\\/\u003e\\n  purpose of the else part of if (constraintDN.constraintType ==\u003cbr\\/\u003e\\n          DataDictionary.UNIQUE_CONSTRAINT)?\u003c\\/p\u003e\\n\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/IndexChanger.java\u003cbr\\/\u003e\\no no comments in changed code\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/GenericConstantActionFactory.java\u003cbr\\/\u003e\\no bad indentation\u003cbr\\/\u003e\\no no comments\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/catalog\\/DataDictionaryImpl.java\u003cbr\\/\u003e\\no bad indentation\u003cbr\\/\u003e\\no todo left in code, looks like needs to be resolved before checkin\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/sort\\/ExternalSortFactory.java\u003cbr\\/\u003e\\no bad indentation\u003cbr\\/\u003e\\no need some documentation on what changes to mergesort are doing.  \u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/BTree.java\u003cbr\\/\u003e\\no bad indentation\u003cbr\\/\u003e\\no no comments for any change to file\u003c\\/p\u003e\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/BTreeController.java\u003cbr\\/\u003e\\no a bunch of imports added that look unnecessary, ie. Time, TimeStampe, Calendar, ...\u003cbr\\/\u003e\\no brace style inconsistent with rest of routine.\u003c\\/p\u003e\\n\\n\u003cp\u003eo getPreviousRecord()\u003cbr\\/\u003e\\n  o what is the expected behavior on latch waits?\u003cbr\\/\u003e\\n  o Does not follow latch\\/latch deadlock avoidance protocol - must not wait on\u003cbr\\/\u003e\\n    latch while holding latch while traveling left in tree.  \u003cbr\\/\u003e\\n  o no handling of getting and releasing latches during search.\u003cbr\\/\u003e\\n  o see B2IRowLocking3.java!searchLeftAndLockPreviousKey for example of code\u003cbr\\/\u003e\\n    that searches left in btree.  \u003cbr\\/\u003e\\n  o What kind of locking will the various isolation levels need for your checking\u003cbr\\/\u003e\\n    of left and right keys?  Is holding the latch while checking good enough?  I\u003cbr\\/\u003e\\n    don\'t know right now.\u003cbr\\/\u003e\\n  o note the trickiest part of this is if you have to give up the latch while\u003cbr\\/\u003e\\n    waiting then you have to restart entire search of the tree to find where to\u003cbr\\/\u003e\\n    do the insert because you don\'t have latch.\u003cbr\\/\u003e\\n  o remember that you may have to search left many pages to find a data row.\u003c\\/p\u003e\\n\\n\u003cp\u003e  o i don\'t think you should be searching for \\\"undeleted\\\", deleted records \u003cbr\\/\u003e\\n    still count toward the integrity of the tree.  Without getting locks it\u003cbr\\/\u003e\\n    is impossible to know if the records marked deleted are committed deleted\u003cbr\\/\u003e\\n    or not.  Imagine if you skip a marked deleted record that would have caused\u003cbr\\/\u003e\\n    a constraint violation, and then that xact backs out it would then mark\u003cbr\\/\u003e\\n    the row as valid and now you would have 2 records that fail the constraint.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003egetNextRecord()\u003cbr\\/\u003e\\n  o what is expected behavior of latch waits?\u003cbr\\/\u003e\\n  o what is expected behavior if routine has to visit N right leaves (ie. will\u003cbr\\/\u003e\\n    routine hold all latches until end of transaction)?  \u003cbr\\/\u003e\\n  o as in getPreviousRecord() i think it should not special case deleted rows\u003cbr\\/\u003e\\n  o remember you may have to search right many pages to find row in edge case.\u003c\\/p\u003e\\n\\n\u003cp\u003ecompareLeftAndRightSiblings()\u003cbr\\/\u003e\\n  o likely code to deal with lost latches would go into this routine and callers.\u003cbr\\/\u003e\\n  o no need to call runtime_mem.get_template(getRawTran()) twice.  Once you \u003cbr\\/\u003e\\n    call it you have a template.  Just reuse the template.\u003c\\/p\u003e\\n\\n\u003cp\u003e  o there should be some comments somewhere explaining why just checking left\u003cbr\\/\u003e\\n    and right siblings works for what you are trying to achieve.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eo i have to think about it some more but the places you added the\u003cbr\\/\u003e\\nif (compareLeftAndRightSiblings(rowToInsert,\u003cbr\\/\u003e\\n            insert_slot, targetleaf))\u003cbr\\/\u003e\\n        return ConglomerateController.ROWISDUPLICATE;\u003cbr\\/\u003e\\n  don\'t seem optimal.  I would like to see the code only called in the \u003cbr\\/\u003e\\n  almost unique case, so we don\'t affect the behavior of existing indexes at\u003cbr\\/\u003e\\n  all.\u003c\\/p\u003e\\n\\n\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/index\\/B2I.java\u003cbr\\/\u003e\\no it is critical to properly document changes to ondisk format of store objects,\u003cbr\\/\u003e\\n  doesn\'t look like any work here done.  I know from existing comments that\u003cbr\\/\u003e\\n  upgrade still does not work so maybe you are planning more here.\u003c\\/p\u003e\\n\\n\u003cp\u003eo The model has been to add new stuff at the end rather than in the middle.  \u003c\\/p\u003e\\n\\n\u003cp\u003eo so far I haven\'t seen what is going to stop this from being created in soft\u003cbr\\/\u003e\\n  upgrade.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/modules.properties\u003cbr\\/\u003e\\no did you consider just altering the existing sort to take an additional\u003cbr\\/\u003e\\n  startup parameter rather than extending and creating a new module to sort?\u003cbr\\/\u003e\\n  just would be interested to know why one approach vs. the other.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/catalog\\/types\\/IndexDescriptorImpl.java\u003cbr\\/\u003e\\no bad indent in places\u003cbr\\/\u003e\\no as todo\'s point out, need soft upgrade support\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12562638_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562638_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jan\\/08 19:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-25T19:55:19+0000\'\u003e25\\/Jan\\/08 19:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    here are some initial comments on the derby-3330v4.diff patch \\n\\n overall: \\no almost unique, doesn\'t seem like a good name for this.  And I didn\'t see \\n  good documentation in the code explaining what this means.  Unfortunately \\n  could not think of something less wordy than AllowMulipleNullsInUnique. \\n\\n o not sure what you are using for tab\\/spaces, see derby web site for following \\n  existing conventions in the code.  may seem minor but inconsistent tab\\/indent \\n  makes stuff unreadable.  Derby code that has tab indentation expects 4 spaces \\n  for those tabs. \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/compile\\/CreateIndexNode.java \\no no comments explaining new parameter and what false means.   \\n  CreateindexConstantAction also has no comments about the parameter either. \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/CreateIndexConstantAction.java \\no inconsistent formatting with rest of file for new CreateIndexConstantAction \\n  routine, so does not indent same as rest. \\n\\n o Why did you add whole new routine rather than add single parameter to  \\n  existing routine and update other references.  I think it is really error \\n  prone to have 2 routines with same name and just differ by 12 or 13  \\n  params.   \\n\\n o no comments about almostUnique, some doc in the CreateIndexConstantAction  \\n  call and some comment following the existing code when property is set up \\n  would be appropriate. \\n\\n o This line looks unused: \\n  Properties sortProperty = null;  \\n  it looks later like you use \\\"properties\\\" but other code seems to think that \\n  this may be null sometimes. \\n\\n o the tabbing\\/indentation inconsistency makes the sort part almost unreadable. \\n  no comments for added sort logic. \\n\\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/compile\\/TableElementList.java \\no bad indentation \\no looks like you removed check for null but left comments that we would check \\n  for null.   \\no again no added comments for all changes to this file. \\n\\n o need some explanation of what the added code is doing here.  What is the \\n  purpose of the else part of if (constraintDN.constraintType == \\n          DataDictionary.UNIQUE_CONSTRAINT)? \\n\\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/IndexChanger.java \\no no comments in changed code \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/execute\\/GenericConstantActionFactory.java \\no bad indentation \\no no comments \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/catalog\\/DataDictionaryImpl.java \\no bad indentation \\no todo left in code, looks like needs to be resolved before checkin \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/sort\\/ExternalSortFactory.java \\no bad indentation \\no need some documentation on what changes to mergesort are doing.   \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/BTree.java \\no bad indentation \\no no comments for any change to file \\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/BTreeController.java \\no a bunch of imports added that look unnecessary, ie. Time, TimeStampe, Calendar, ... \\no brace style inconsistent with rest of routine. \\n\\n o getPreviousRecord() \\n  o what is the expected behavior on latch waits? \\n  o Does not follow latch\\/latch deadlock avoidance protocol - must not wait on \\n    latch while holding latch while traveling left in tree.   \\n  o no handling of getting and releasing latches during search. \\n  o see B2IRowLocking3.java!searchLeftAndLockPreviousKey for example of code \\n    that searches left in btree.   \\n  o What kind of locking will the various isolation levels need for your checking \\n    of left and right keys?  Is holding the latch while checking good enough?  I \\n    don\'t know right now. \\n  o note the trickiest part of this is if you have to give up the latch while \\n    waiting then you have to restart entire search of the tree to find where to \\n    do the insert because you don\'t have latch. \\n  o remember that you may have to search left many pages to find a data row. \\n\\n   o i don\'t think you should be searching for \\\"undeleted\\\", deleted records  \\n    still count toward the integrity of the tree.  Without getting locks it \\n    is impossible to know if the records marked deleted are committed deleted \\n    or not.  Imagine if you skip a marked deleted record that would have caused \\n    a constraint violation, and then that xact backs out it would then mark \\n    the row as valid and now you would have 2 records that fail the constraint. \\n\\n\\n getNextRecord() \\n  o what is expected behavior of latch waits? \\n  o what is expected behavior if routine has to visit N right leaves (ie. will \\n    routine hold all latches until end of transaction)?   \\n  o as in getPreviousRecord() i think it should not special case deleted rows \\n  o remember you may have to search right many pages to find row in edge case. \\n\\n compareLeftAndRightSiblings() \\n  o likely code to deal with lost latches would go into this routine and callers. \\n  o no need to call runtime_mem.get_template(getRawTran()) twice.  Once you  \\n    call it you have a template.  Just reuse the template. \\n\\n   o there should be some comments somewhere explaining why just checking left \\n    and right siblings works for what you are trying to achieve. \\n\\n\\n o i have to think about it some more but the places you added the \\nif (compareLeftAndRightSiblings(rowToInsert, \\n            insert_slot, targetleaf)) \\n        return ConglomerateController.ROWISDUPLICATE; \\n  don\'t seem optimal.  I would like to see the code only called in the  \\n  almost unique case, so we don\'t affect the behavior of existing indexes at \\n  all. \\n\\n\\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/index\\/B2I.java \\no it is critical to properly document changes to ondisk format of store objects, \\n  doesn\'t look like any work here done.  I know from existing comments that \\n  upgrade still does not work so maybe you are planning more here. \\n\\n o The model has been to add new stuff at the end rather than in the middle.   \\n\\n o so far I haven\'t seen what is going to stop this from being created in soft \\n  upgrade. \\n\\n\\n java\\/engine\\/org\\/apache\\/derby\\/modules.properties \\no did you consider just altering the existing sort to take an additional \\n  startup parameter rather than extending and creating a new module to sort? \\n  just would be interested to know why one approach vs. the other. \\n\\n\\n java\\/engine\\/org\\/apache\\/derby\\/catalog\\/types\\/IndexDescriptorImpl.java \\no bad indent in places \\no as todo\'s point out, need soft upgrade support \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12562643\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12562643&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12562643\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12562643_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562643_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jan\\/08 20:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-25T20:03:33+0000\'\u003e25\\/Jan\\/08 20:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ecomments of functional spec\\/hard upgrade section:\u003cbr\\/\u003e\\nIt says:\u003cbr\\/\u003e\\nDuring had upgrade existing backing indexes will be dropped and recreated as almost unique indexes. It will be possible to create unique constraint over nullable column in upgraded data base. After hard upgrade user will able to create unique constraint over nullable columns and will also be able to drop not null constraints even if the column is part of a unique constraint.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis is not what I expected and I believe is unnecessary and not a good idea.  Because the feature only affects constraints on\u003cbr\\/\u003e\\nnullable columns which could never exist before the upgrade there should be nothing necessary to drop\\/recreate.  Once a hard\u003cbr\\/\u003e\\nupgrade has happenned then the new backing index for unique constraint over null columns will be enabled.   Nothing should \u003cbr\\/\u003e\\n\\\"automatically\\\" get dropped and recreated as an almost unique index.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso there are still a number of gramatical and spelling errors in the functional spec.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12562643_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562643_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Jan\\/08 20:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-25T20:03:33+0000\'\u003e25\\/Jan\\/08 20:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    comments of functional spec\\/hard upgrade section: \\nIt says: \\nDuring had upgrade existing backing indexes will be dropped and recreated as almost unique indexes. It will be possible to create unique constraint over nullable column in upgraded data base. After hard upgrade user will able to create unique constraint over nullable columns and will also be able to drop not null constraints even if the column is part of a unique constraint. \\n\\n This is not what I expected and I believe is unnecessary and not a good idea.  Because the feature only affects constraints on \\nnullable columns which could never exist before the upgrade there should be nothing necessary to drop\\/recreate.  Once a hard \\nupgrade has happenned then the new backing index for unique constraint over null columns will be enabled.   Nothing should  \\n\\\"automatically\\\" get dropped and recreated as an almost unique index. \\n\\n Also there are still a number of gramatical and spelling errors in the functional spec.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12562999\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12562999&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12562999\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12562999_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562999_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jan\\/08 15:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-27T15:29:24+0000\'\u003e27\\/Jan\\/08 15:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFixed typos in functional specs.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12562999_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12562999_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Jan\\/08 15:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-27T15:29:24+0000\'\u003e27\\/Jan\\/08 15:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Fixed typos in functional specs.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12563119\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12563119&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12563119\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12563119_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563119_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jan\\/08 11:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-28T11:23:56+0000\'\u003e28\\/Jan\\/08 11:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ethanks Mike for looking at the patch and detailed comments\u003cbr\\/\u003e\\nI am explaining few points in this comment and will get back \u003cbr\\/\u003e\\nabout rest of the comments\u003c\\/p\u003e\\n\\n\u003cp\u003eoverall:\u003cbr\\/\u003e\\no almost unique, doesn\'t seem like a good name for this.  And I didn\'t see\u003cbr\\/\u003e\\n  good documentation in the code explaining what this means.  Unfortunately\u003cbr\\/\u003e\\n  could not think of something less wordy than AllowMulipleNullsInUnique.\u003c\\/p\u003e\\n\\n\u003cp\u003eShall I change it to UniqueWhenNotNull ?\u003c\\/p\u003e\\n\\n\u003cp\u003eo not sure what you are using for tab\\/spaces, see derby web site for following\u003cbr\\/\u003e\\n  existing conventions in the code.  may seem minor but inconsistent tab\\/indent\u003cbr\\/\u003e\\n  makes stuff unreadable.  Derby code that has tab indentation expects 4 spaces\u003cbr\\/\u003e\\n  for those tabs.\u003c\\/p\u003e\\n\\n\u003cp\u003eI will check the indentations and fix them.\u003c\\/p\u003e\\n\\n\\n\\n\u003cp\u003eo i have to think about it some more but the places you added the\u003cbr\\/\u003e\\nif (compareLeftAndRightSiblings(rowToInsert,\u003cbr\\/\u003e\\n            insert_slot, targetleaf))\u003cbr\\/\u003e\\n        return ConglomerateController.ROWISDUPLICATE;\u003cbr\\/\u003e\\n  don\'t seem optimal.  I would like to see the code only called in the \u003cbr\\/\u003e\\n  almost unique case, so we don\'t affect the behavior of existing indexes at\u003cbr\\/\u003e\\n  all.\u003c\\/p\u003e\\n\\n\u003cp\u003eI will change it to check for new index before calling compareLeftAndRightSiblings.\u003c\\/p\u003e\\n\\n\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/index\\/B2I.java\u003cbr\\/\u003e\\no it is critical to properly document changes to ondisk format of store objects,\u003cbr\\/\u003e\\n  doesn\'t look like any work here done.  I know from existing comments that\u003cbr\\/\u003e\\n  upgrade still does not work so maybe you are planning more here.\u003c\\/p\u003e\\n\\n\u003cp\u003eo The model has been to add new stuff at the end rather than in the middle.  \u003c\\/p\u003e\\n\\n\u003cp\u003eI will be fixing it in my new patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eo so far I haven\'t seen what is going to stop this from being created in soft\u003cbr\\/\u003e\\n  upgrade.\u003c\\/p\u003e\\n\\n\u003cp\u003eI am adding a new class B2I_10_3 which will be used in case of soft upgrades.\u003cbr\\/\u003e\\n I will add comments about disk format. \u003c\\/p\u003e\\n\\n\\n\u003cp\u003ejava\\/engine\\/org\\/apache\\/derby\\/modules.properties\u003cbr\\/\u003e\\no did you consider just altering the existing sort to take an additional\u003cbr\\/\u003e\\n  startup parameter rather than extending and creating a new module to sort?\u003cbr\\/\u003e\\n  just would be interested to know why one approach vs. the other.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe sorting will be required while creating the constraint only. For rest of the \u003cbr\\/\u003e\\nexecution it acts like a non unique index. By adding a new module I felt I won\'t \u003cbr\\/\u003e\\nbe touching the execution path of other functionality (like select) and they will \u003cbr\\/\u003e\\nretain the their performance. \u003cbr\\/\u003e\\nBut I can merge this code with exiting sorting routine if you feel that will be better\u003cbr\\/\u003e\\nway of handing it. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12563119_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563119_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Jan\\/08 11:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-28T11:23:56+0000\'\u003e28\\/Jan\\/08 11:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    thanks Mike for looking at the patch and detailed comments \\nI am explaining few points in this comment and will get back  \\nabout rest of the comments \\n\\n overall: \\no almost unique, doesn\'t seem like a good name for this.  And I didn\'t see \\n  good documentation in the code explaining what this means.  Unfortunately \\n  could not think of something less wordy than AllowMulipleNullsInUnique. \\n\\n Shall I change it to UniqueWhenNotNull ? \\n\\n o not sure what you are using for tab\\/spaces, see derby web site for following \\n  existing conventions in the code.  may seem minor but inconsistent tab\\/indent \\n  makes stuff unreadable.  Derby code that has tab indentation expects 4 spaces \\n  for those tabs. \\n\\n I will check the indentations and fix them. \\n\\n\\n\\n o i have to think about it some more but the places you added the \\nif (compareLeftAndRightSiblings(rowToInsert, \\n            insert_slot, targetleaf)) \\n        return ConglomerateController.ROWISDUPLICATE; \\n  don\'t seem optimal.  I would like to see the code only called in the  \\n  almost unique case, so we don\'t affect the behavior of existing indexes at \\n  all. \\n\\n I will change it to check for new index before calling compareLeftAndRightSiblings. \\n\\n\\n\\n java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/index\\/B2I.java \\no it is critical to properly document changes to ondisk format of store objects, \\n  doesn\'t look like any work here done.  I know from existing comments that \\n  upgrade still does not work so maybe you are planning more here. \\n\\n o The model has been to add new stuff at the end rather than in the middle.   \\n\\n I will be fixing it in my new patch. \\n\\n o so far I haven\'t seen what is going to stop this from being created in soft \\n  upgrade. \\n\\n I am adding a new class B2I_10_3 which will be used in case of soft upgrades. \\n I will add comments about disk format.  \\n\\n\\n java\\/engine\\/org\\/apache\\/derby\\/modules.properties \\no did you consider just altering the existing sort to take an additional \\n  startup parameter rather than extending and creating a new module to sort? \\n  just would be interested to know why one approach vs. the other. \\n\\n The sorting will be required while creating the constraint only. For rest of the  \\nexecution it acts like a non unique index. By adding a new module I felt I won\'t  \\nbe touching the execution path of other functionality (like select) and they will  \\nretain the their performance.  \\nBut I can merge this code with exiting sorting routine if you feel that will be better \\nway of handing it.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12563473\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12563473&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12563473\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12563473_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563473_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 11:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T11:19:29+0000\'\u003e29\\/Jan\\/08 11:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Mike for pointing out issues related to locking and also about the way \u003cbr\\/\u003e\\nI have handled deleted row.\u003c\\/p\u003e\\n\\n\u003cp\u003eI went through the code you have have asked me to look for reference and also the doIns code. This is what I think I should be doing.\u003c\\/p\u003e\\n\\n\u003cp\u003eStep 1. Find the slot where new row can be inserted.\u003cbr\\/\u003e\\nStep 2. Get the left row (without checking for deleted row) if there is a match try to \u003cbr\\/\u003e\\nhold a lock. If lock is obtained without releasing the latch no other transaction is \u003cbr\\/\u003e\\nworking on it and it should be a deleted row. return error if its not. \u003cbr\\/\u003e\\nIf latch was released tree has under gone some changes and start with step 1.\u003c\\/p\u003e\\n\\n\u003cp\u003eStep3. Repeat step 2 for right row.\u003c\\/p\u003e\\n\\n\u003cp\u003eI am checking out B2IRowLocking3.searchLeftAndLockPreviousKey and will be\u003cbr\\/\u003e\\n posting about locking scheme and effect of isolation level shortly.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12563473_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12563473_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Jan\\/08 11:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-29T11:19:29+0000\'\u003e29\\/Jan\\/08 11:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Mike for pointing out issues related to locking and also about the way  \\nI have handled deleted row. \\n\\n I went through the code you have have asked me to look for reference and also the doIns code. This is what I think I should be doing. \\n\\n Step 1. Find the slot where new row can be inserted. \\nStep 2. Get the left row (without checking for deleted row) if there is a match try to  \\nhold a lock. If lock is obtained without releasing the latch no other transaction is  \\nworking on it and it should be a deleted row. return error if its not.  \\nIf latch was released tree has under gone some changes and start with step 1. \\n\\n Step3. Repeat step 2 for right row. \\n\\n I am checking out B2IRowLocking3.searchLeftAndLockPreviousKey and will be \\n posting about locking scheme and effect of isolation level shortly.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564253\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12564253&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564253\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12564253_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564253_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 01:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T01:11:58+0000\'\u003e31\\/Jan\\/08 01:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAt this point you should somehow document the implementation that you are\u003cbr\\/\u003e\\nplanning to support the functional spec.  That way I can comment on whether\u003cbr\\/\u003e\\nor not I think it should work.  It is hard just going from your patch with\u003cbr\\/\u003e\\nalmost no comments.  I suggested the approach, and am having a hard time\u003cbr\\/\u003e\\nremembering at this point - imagine what other reviewers are going through.\u003c\\/p\u003e\\n\\n\u003cp\u003eWith regard to this specific question, it depends on what rows you are\u003cbr\\/\u003e\\ngoing to support in the new tree.  To make it easier to talk about let\'s\u003cbr\\/\u003e\\njust consider the simplest case of a single key index.  Then with respect\u003cbr\\/\u003e\\nto \\\"deleted\\\" rows will you ever support duplicate entries in the tree,\u003cbr\\/\u003e\\nas below:\u003c\\/p\u003e\\n\\n\u003cp\u003edeleted bit key     rowlocation\u003cbr\\/\u003e\\n----------- &#8212;     -----------\u003cbr\\/\u003e\\nfalse       null    1,7\u003cbr\\/\u003e\\nfalse       null    1,8\u003cbr\\/\u003e\\ntrue        a       1,9\u003cbr\\/\u003e\\nfalse       a       1,10\u003c\\/p\u003e\\n\\n\u003cp\u003eI think the algorithms and edge cases are probably easier if you keep the\u003cbr\\/\u003e\\nrule that disregarding the deleted bit, there can never be a duplicate non-null\u003cbr\\/\u003e\\nkey in the tree.  This makes it easier to deal with uncommitted transactions and\u003cbr\\/\u003e\\nduplicates and deleted rows.  If you pick this rule then you should read and\u003cbr\\/\u003e\\nunderstand the code in BTreeController that deals with this case in the\u003cbr\\/\u003e\\nold indexes.  This code starts with the comment:\u003cbr\\/\u003e\\n\\/\\/ If the row is there already, simply undelete it.\u003cbr\\/\u003e\\n\\/\\/ The rationale for this is, since the index does\u003cbr\\/\u003e\\n\\/\\/ not support duplicates, the only way we could ...\u003c\\/p\u003e\\n\\n\u003cp\u003eRemember that getting a lock on a deleted row does not mean it is a committed\u003cbr\\/\u003e\\ndeleted row, it may have been deleted by the current transaction.\u003c\\/p\u003e\\n\\n\u003cp\u003eProbably the most straightforward is to follow what we do currently for\u003cbr\\/\u003e\\nunique indexes, but apply it to this new index which allows duplicate null\'s\u003cbr\\/\u003e\\nbut non duplicate non-null.\u003c\\/p\u003e\\n\\n\u003cp\u003eI don\'t know the exact answer on locking, it is complicated as we have never locked\u003cbr\\/\u003e\\nrows to the right of a row during an insert before.  This can have some negative concurrency\u003cbr\\/\u003e\\naspects.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12564253_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564253_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 01:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T01:11:58+0000\'\u003e31\\/Jan\\/08 01:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    At this point you should somehow document the implementation that you are \\nplanning to support the functional spec.  That way I can comment on whether \\nor not I think it should work.  It is hard just going from your patch with \\nalmost no comments.  I suggested the approach, and am having a hard time \\nremembering at this point - imagine what other reviewers are going through. \\n\\n With regard to this specific question, it depends on what rows you are \\ngoing to support in the new tree.  To make it easier to talk about let\'s \\njust consider the simplest case of a single key index.  Then with respect \\nto \\\"deleted\\\" rows will you ever support duplicate entries in the tree, \\nas below: \\n\\n deleted bit key     rowlocation \\n----------- &#8212;     ----------- \\nfalse       null    1,7 \\nfalse       null    1,8 \\ntrue        a       1,9 \\nfalse       a       1,10 \\n\\n I think the algorithms and edge cases are probably easier if you keep the \\nrule that disregarding the deleted bit, there can never be a duplicate non-null \\nkey in the tree.  This makes it easier to deal with uncommitted transactions and \\nduplicates and deleted rows.  If you pick this rule then you should read and \\nunderstand the code in BTreeController that deals with this case in the \\nold indexes.  This code starts with the comment: \\n\\/\\/ If the row is there already, simply undelete it. \\n\\/\\/ The rationale for this is, since the index does \\n\\/\\/ not support duplicates, the only way we could ... \\n\\n Remember that getting a lock on a deleted row does not mean it is a committed \\ndeleted row, it may have been deleted by the current transaction. \\n\\n Probably the most straightforward is to follow what we do currently for \\nunique indexes, but apply it to this new index which allows duplicate null\'s \\nbut non duplicate non-null. \\n\\n I don\'t know the exact answer on locking, it is complicated as we have never locked \\nrows to the right of a row during an insert before.  This can have some negative concurrency \\naspects.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564437\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12564437&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564437\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12564437_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564437_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 18:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T18:05:39+0000\'\u003e31\\/Jan\\/08 18:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Mike in taking time to explain the nuances of locking in such a clear and detailed manner. I will shortly post a document explaining the following issues related to my patch\u003cbr\\/\u003e\\n1.How insert is handled.\u003cbr\\/\u003e\\n2.How sorting is performed (while creating the unique constraint).\u003cbr\\/\u003e\\n3.How soft upgrade will work.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have written the routine to perform comparison while inserting.  this routine is called only if all the parts of the new key are non null. This routine is called for both keys (left and right of the position identified to insert)\u003c\\/p\u003e\\n\\n\u003cp\u003e1.If no match return\u003cbr\\/\u003e\\n2.if there is match check if its already deleted \u003cbr\\/\u003e\\n3.if not deleted there return a match (will result in exception)\u003cbr\\/\u003e\\n4.if deleted try getting a lock on it\u003cbr\\/\u003e\\n5.if lock is obtained without releasing the latch (means without waiting) the key was deleted withing current transaction.\u003cbr\\/\u003e\\n6.if lock is obtained and latch is released the lock was held by some other transaction and might have caused change in tree. Insert process will be restarted again to locate the position for new key.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhile fetching the left and right records I am not checking for deleted bit any more but checking for it only after finding a match. The fetched record is locked only if a match is found and its a deleted record and in that case also the lock will be held only if the key was deleted within same transaction. In case its deleted from another transaction page latch will be released and it will ultimately result in rescanning the tree for insert position.\u003c\\/p\u003e\\n\\n\u003cp\u003eI am attaching a diff for BtreeController.java (I haven\'t yet implemented the left locking protocol) Please let me know If I am doing it right.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12564437_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564437_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Jan\\/08 18:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-01-31T18:05:39+0000\'\u003e31\\/Jan\\/08 18:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Mike in taking time to explain the nuances of locking in such a clear and detailed manner. I will shortly post a document explaining the following issues related to my patch \\n1.How insert is handled. \\n2.How sorting is performed (while creating the unique constraint). \\n3.How soft upgrade will work. \\n\\n I have written the routine to perform comparison while inserting.  this routine is called only if all the parts of the new key are non null. This routine is called for both keys (left and right of the position identified to insert) \\n\\n 1.If no match return \\n2.if there is match check if its already deleted  \\n3.if not deleted there return a match (will result in exception) \\n4.if deleted try getting a lock on it \\n5.if lock is obtained without releasing the latch (means without waiting) the key was deleted withing current transaction. \\n6.if lock is obtained and latch is released the lock was held by some other transaction and might have caused change in tree. Insert process will be restarted again to locate the position for new key. \\n\\n While fetching the left and right records I am not checking for deleted bit any more but checking for it only after finding a match. The fetched record is locked only if a match is found and its a deleted record and in that case also the lock will be held only if the key was deleted within same transaction. In case its deleted from another transaction page latch will be released and it will ultimately result in rescanning the tree for insert position. \\n\\n I am attaching a diff for BtreeController.java (I haven\'t yet implemented the left locking protocol) Please let me know If I am doing it right. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12564740\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12564740&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12564740\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12564740_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564740_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 12:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T12:44:06+0000\'\u003e01\\/Feb\\/08 12:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttaching the implementation documents. I will merge it with the functional spec after reviews.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12564740_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12564740_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Feb\\/08 12:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-01T12:44:06+0000\'\u003e01\\/Feb\\/08 12:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attaching the implementation documents. I will merge it with the functional spec after reviews.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12568844\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12568844&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12568844\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12568844_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12568844_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/08 09:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-14T09:47:06+0000\'\u003e14\\/Feb\\/08 09:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis patch includes following changes since v4 \u003cbr\\/\u003e\\n1. Fixed Indentation issues\u003cbr\\/\u003e\\n2. Added comments for new methods attributes and some code changes\u003cbr\\/\u003e\\n3. Added code for soft upgrade\u003cbr\\/\u003e\\n4.Removed unnecessary imports.\u003cbr\\/\u003e\\n5. Modified left and right sibling comparison (details to follow).\u003cbr\\/\u003e\\n6. Moved new attribute to end of the BTree file format.\u003cbr\\/\u003e\\n7. Added comments about  new file format.\u003cbr\\/\u003e\\n8. Added new classes to support soft upgrade (as described in implementation spec).\u003c\\/p\u003e\\n\\n\u003cp\u003ePending task\u003cbr\\/\u003e\\nHard upgrade\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12568844_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12568844_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/08 09:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-14T09:47:06+0000\'\u003e14\\/Feb\\/08 09:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This patch includes following changes since v4  \\n1. Fixed Indentation issues \\n2. Added comments for new methods attributes and some code changes \\n3. Added code for soft upgrade \\n4.Removed unnecessary imports. \\n5. Modified left and right sibling comparison (details to follow). \\n6. Moved new attribute to end of the BTree file format. \\n7. Added comments about  new file format. \\n8. Added new classes to support soft upgrade (as described in implementation spec). \\n\\n Pending task \\nHard upgrade              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12568850\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12568850&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12568850\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12568850_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12568850_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/08 09:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-14T09:58:07+0000\'\u003e14\\/Feb\\/08 09:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eDetails about changes in java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/BTreeController.java \u003c\\/p\u003e\\n\\n\u003cp\u003eThe new code doesn\'t checks for deleted records. So while looking for left and right sibling there won\'t be any need to traverse multiple pages (at the most one pages to left if the new slot is 1st slot of the page or one page of the right if the new slot is the last slot of the page will be latched). \u003cbr\\/\u003e\\nSteps for duplicate detection is as follows\u003c\\/p\u003e\\n\\n\u003cp\u003e1. Get the previous record (may or may not be from same page)\u003cbr\\/\u003e\\n2. if there the two record are different unlatch page and return NO_MATCH\u003cbr\\/\u003e\\n3. if these to match obtain the lock on exiting record\u003cbr\\/\u003e\\n4. if lock is obtained after wait (latch lost) tree might have been modified start with locating he slot of new record\u003cbr\\/\u003e\\n5. If the locked record is deleted return no match else return match\u003c\\/p\u003e\\n\\n\u003cp\u003edo the above for record at right again.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12568850_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12568850_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/08 09:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-14T09:58:07+0000\'\u003e14\\/Feb\\/08 09:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Details about changes in java\\/engine\\/org\\/apache\\/derby\\/impl\\/store\\/access\\/btree\\/BTreeController.java  \\n\\n The new code doesn\'t checks for deleted records. So while looking for left and right sibling there won\'t be any need to traverse multiple pages (at the most one pages to left if the new slot is 1st slot of the page or one page of the right if the new slot is the last slot of the page will be latched).  \\nSteps for duplicate detection is as follows \\n\\n 1. Get the previous record (may or may not be from same page) \\n2. if there the two record are different unlatch page and return NO_MATCH \\n3. if these to match obtain the lock on exiting record \\n4. if lock is obtained after wait (latch lost) tree might have been modified start with locating he slot of new record \\n5. If the locked record is deleted return no match else return match \\n\\n do the above for record at right again.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12568879\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12568879&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12568879\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12568879_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12568879_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/08 11:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-14T11:16:07+0000\'\u003e14\\/Feb\\/08 11:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eImpact of isolation level\u003c\\/p\u003e\\n\\n\u003cp\u003eThe records involved (new record and duplicate ) are always locked for update\u003cbr\\/\u003e\\nwhich insures that there is exclusive lock on the record , irrespective of the isolation.\u003cbr\\/\u003e\\nSo nothing special need to be done with respect to isolation level.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12568879_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12568879_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/08 11:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-14T11:16:07+0000\'\u003e14\\/Feb\\/08 11:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Impact of isolation level \\n\\n The records involved (new record and duplicate ) are always locked for update \\nwhich insures that there is exclusive lock on the record , irrespective of the isolation. \\nSo nothing special need to be done with respect to isolation level.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12569949\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12569949&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12569949\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12569949_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12569949_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Feb\\/08 17:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-18T17:03:38+0000\'\u003e18\\/Feb\\/08 17:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eo although unlikely a legal state for a leaf page is to have a control row, but no other rows.  It can\u003cbr\\/\u003e\\nget this way if the deleted space background thread is able to reclaim the committed deleted rows, but can\'t get table level lock to merge the empty leaf page.  Thus to handle this one must be ready when scanning left and\\/or right to the next page looking for a row to need to visit multiple\u003cbr\\/\u003e\\npages.\u003c\\/p\u003e\\n\\n\u003cp\u003eo with respect to isolation level.  What kind of locking will you be doing on the rows that you are\u003cbr\\/\u003e\\nchecking left and right?  If you are locking those rows, how long will you hold those locks?  The\u003cbr\\/\u003e\\nsearch to the right is especially interesting as previously we would never have locked any row\u003cbr\\/\u003e\\nto the right of an insert.  With previous key locking used for isolation level implementation the code\u003cbr\\/\u003e\\ncurrently may or may not lock the left key, depending on isolation level.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12569949_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12569949_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Feb\\/08 17:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-18T17:03:38+0000\'\u003e18\\/Feb\\/08 17:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    o although unlikely a legal state for a leaf page is to have a control row, but no other rows.  It can \\nget this way if the deleted space background thread is able to reclaim the committed deleted rows, but can\'t get table level lock to merge the empty leaf page.  Thus to handle this one must be ready when scanning left and\\/or right to the next page looking for a row to need to visit multiple \\npages. \\n\\n o with respect to isolation level.  What kind of locking will you be doing on the rows that you are \\nchecking left and right?  If you are locking those rows, how long will you hold those locks?  The \\nsearch to the right is especially interesting as previously we would never have locked any row \\nto the right of an insert.  With previous key locking used for isolation level implementation the code \\ncurrently may or may not lock the left key, depending on isolation level.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12569987\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12569987&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12569987\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12569987_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12569987_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Feb\\/08 19:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-18T19:15:36+0000\'\u003e18\\/Feb\\/08 19:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Mike for pointing out the possibility of having empty page and hence need to scan multiple page. \u003cbr\\/\u003e\\nI will reintroduce the code for the same. I will add code to keep moving left (or right) till a row is found or no more leaf is available. \u003c\\/p\u003e\\n\\n\u003cp\u003eLocking of left or right row is attempted only if there is a duplicate is found. In that case \u003cbr\\/\u003e\\na. The transaction was deleted in same transaction &#8211; So its already locked within same transaction\u003cbr\\/\u003e\\nb. Is deleted in some other transaction - It will result in losing the latch and a rescan will performed to identify the slot (no lock)\u003c\\/p\u003e\\n\\n\u003cp\u003ec. Is an valid row - an exception will be thrown and lock will be released immediately.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eIrrespective of the isolation level only update lock is requested. But the actual locking is performed only in case c and that too for a very short time, I think it won\'t have much impact on performance. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12569987_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12569987_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Feb\\/08 19:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-18T19:15:36+0000\'\u003e18\\/Feb\\/08 19:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Mike for pointing out the possibility of having empty page and hence need to scan multiple page.  \\nI will reintroduce the code for the same. I will add code to keep moving left (or right) till a row is found or no more leaf is available.  \\n\\n Locking of left or right row is attempted only if there is a duplicate is found. In that case  \\na. The transaction was deleted in same transaction &#8211; So its already locked within same transaction \\nb. Is deleted in some other transaction - It will result in losing the latch and a rescan will performed to identify the slot (no lock) \\n\\n c. Is an valid row - an exception will be thrown and lock will be released immediately. \\n\\n\\n Irrespective of the isolation level only update lock is requested. But the actual locking is performed only in case c and that too for a very short time, I think it won\'t have much impact on performance.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12571023\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12571023&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12571023\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571023_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571023_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Feb\\/08 11:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-21T11:51:47+0000\'\u003e21\\/Feb\\/08 11:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis patch includes hard upgrade (Upgrade test from 10.3.1.4 and  10.1.3.1runs without fails).\u003c\\/p\u003e\\n\\n\u003cp\u003eDescription of Hard upgrade\u003c\\/p\u003e\\n\\n\u003cp\u003eHard upgrade makes following changes \u003cbr\\/\u003e\\n1. Updates B2I class by adding extra attribute (uniquewhenNotNull)\u003cbr\\/\u003e\\n2. Updates format id.\u003cbr\\/\u003e\\n3. Updates ConglomerateDescriptor of all updated Conglomerates to \u003cbr\\/\u003e\\nuser new version of IndexDescriptorImpl\u003c\\/p\u003e\\n\\n\u003cp\u003eUnique index meant to be backing index of UniqueConstraint is updated to \u003cbr\\/\u003e\\nbecome UniqueWhenNotNull index (nUniqueColumn is set to nKeyFields - 1\u003cbr\\/\u003e\\n and uniquewhen not null is set to true). For other indexes uniqueWhenNotNull\u003cbr\\/\u003e\\n attribute is set to false.\u003c\\/p\u003e\\n\\n\u003cp\u003eHard upgrade is initiated from DataDictionaryImpl.upgradeConglomerate \u003cbr\\/\u003e\\n(new method). This method calles another newly intoroduced method \u003cbr\\/\u003e\\ngetAllConglomerates to get the list of conglomerate and updates them \u003cbr\\/\u003e\\nby calling TransaCtioncontroller.updateUniquenessOfConglomerate \u003cbr\\/\u003e\\nwhich internally calls Conglomerate.updateUniqueness to \u003cbr\\/\u003e\\nconglomerate attributes.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eI will be posting one more patch after introducing multipage page \u003cbr\\/\u003e\\nscan while checking for duplicates.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571023_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571023_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Feb\\/08 11:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-21T11:51:47+0000\'\u003e21\\/Feb\\/08 11:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This patch includes hard upgrade (Upgrade test from 10.3.1.4 and  10.1.3.1runs without fails). \\n\\n Description of Hard upgrade \\n\\n Hard upgrade makes following changes  \\n1. Updates B2I class by adding extra attribute (uniquewhenNotNull) \\n2. Updates format id. \\n3. Updates ConglomerateDescriptor of all updated Conglomerates to  \\nuser new version of IndexDescriptorImpl \\n\\n Unique index meant to be backing index of UniqueConstraint is updated to  \\nbecome UniqueWhenNotNull index (nUniqueColumn is set to nKeyFields - 1 \\n and uniquewhen not null is set to true). For other indexes uniqueWhenNotNull \\n attribute is set to false. \\n\\n Hard upgrade is initiated from DataDictionaryImpl.upgradeConglomerate  \\n(new method). This method calles another newly intoroduced method  \\ngetAllConglomerates to get the list of conglomerate and updates them  \\nby calling TransaCtioncontroller.updateUniquenessOfConglomerate  \\nwhich internally calls Conglomerate.updateUniqueness to  \\nconglomerate attributes. \\n\\n\\n I will be posting one more patch after introducing multipage page  \\nscan while checking for duplicates.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12571300\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12571300&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12571300\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571300_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571300_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/08 08:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-22T08:06:29+0000\'\u003e22\\/Feb\\/08 08:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis page include the code to scan multiple slot\\/page if the slot identified immediate left and right returns null. It continues to scan (lef in case privious and right in case of next record) unless a valid record is found in a slot or no more pages are left to check.\u003c\\/p\u003e\\n\\n\u003cp\u003eEvery time the scan moves to a new page the latch on the privious page is released (unless the previous page has the slot  identified to insert the new record). \u003c\\/p\u003e\\n\\n\u003cp\u003eAll junit test suites are running without any failure.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571300_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571300_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/08 08:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-22T08:06:29+0000\'\u003e22\\/Feb\\/08 08:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This page include the code to scan multiple slot\\/page if the slot identified immediate left and right returns null. It continues to scan (lef in case privious and right in case of next record) unless a valid record is found in a slot or no more pages are left to check. \\n\\n Every time the scan moves to a new page the latch on the privious page is released (unless the previous page has the slot  identified to insert the new record).  \\n\\n All junit test suites are running without any failure.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12571466\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12571466&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12571466\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571466_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571466_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/08 17:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-22T17:07:37+0000\'\u003e22\\/Feb\\/08 17:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIn this patch (derby-3330v8.diff) I have modified upgrade routine to \u003cbr\\/\u003e\\nupgrade only the backing indexes of unique constraint. Other \u003cbr\\/\u003e\\nindexes are left unchanged.\u003c\\/p\u003e\\n\\n\u003cp\u003eDataDictionaryImpl.getAllConglomerates (introduced in derby-3330v6.dif) is \u003cbr\\/\u003e\\nno more required so I have taken it off.\u003c\\/p\u003e\\n\\n\u003cp\u003eTests are running without any error or failures. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571466_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571466_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/08 17:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-22T17:07:37+0000\'\u003e22\\/Feb\\/08 17:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    In this patch (derby-3330v8.diff) I have modified upgrade routine to  \\nupgrade only the backing indexes of unique constraint. Other  \\nindexes are left unchanged. \\n\\n DataDictionaryImpl.getAllConglomerates (introduced in derby-3330v6.dif) is  \\nno more required so I have taken it off. \\n\\n Tests are running without any error or failures.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12571506\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12571506&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12571506\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12571506_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571506_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/08 18:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-22T18:16:08+0000\'\u003e22\\/Feb\\/08 18:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eplease update your implementation spec to include your plan for hard upgrade.  Once this is done it should be easier to \u003cbr\\/\u003e\\nboth review the plan and whether the code does what you have said is the plan.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12571506_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571506_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/08 18:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-22T18:16:08+0000\'\u003e22\\/Feb\\/08 18:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    please update your implementation spec to include your plan for hard upgrade.  Once this is done it should be easier to  \\nboth review the plan and whether the code does what you have said is the plan.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12571510\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12571510&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12571510\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12571510_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571510_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/08 18:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-22T18:23:03+0000\'\u003e22\\/Feb\\/08 18:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ecomment on implementation details:\u003cbr\\/\u003e\\nWhile creating the unique constraint null checking is now conditional (only for the older version of Data Dictionary). In case of older version Data Dictionary the backing index created is an unique index. \u003c\\/p\u003e\\n\\n\u003cp\u003eIn order to not cause performance degredation for existing unique constraints I would have expected the constraint creation code to use the old unique index for non-null columns and use the new index for null columns.   The unique\u003cbr\\/\u003e\\nindex is going to perform somewhat better as it will have less checking to do (for instance on insert it will not have to\u003cbr\\/\u003e\\ncheck if nulls are in the key and do extra searching).  Also it will make it likely that only new applications that use the new\u003cbr\\/\u003e\\nfeature will see any new problems introduced by the new index.  Existing applications will continue to use the old\u003cbr\\/\u003e\\ncode.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12571510_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571510_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/08 18:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-22T18:23:03+0000\'\u003e22\\/Feb\\/08 18:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    comment on implementation details: \\nWhile creating the unique constraint null checking is now conditional (only for the older version of Data Dictionary). In case of older version Data Dictionary the backing index created is an unique index.  \\n\\n In order to not cause performance degredation for existing unique constraints I would have expected the constraint creation code to use the old unique index for non-null columns and use the new index for null columns.   The unique \\nindex is going to perform somewhat better as it will have less checking to do (for instance on insert it will not have to \\ncheck if nulls are in the key and do extra searching).  Also it will make it likely that only new applications that use the new \\nfeature will see any new problems introduced by the new index.  Existing applications will continue to use the old \\ncode.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12571524\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12571524&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12571524\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571524_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571524_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/08 18:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-22T18:55:32+0000\'\u003e22\\/Feb\\/08 18:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated version Implementation Details.\u003c\\/p\u003e\\n\\n\u003cp\u003eAdded Hard Upgrade Section\u003cbr\\/\u003e\\nUpdated to indicate that comparing with left and right record while inserting might result in traversing multiple pages.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571524_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571524_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'22\\/Feb\\/08 18:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-22T18:55:32+0000\'\u003e22\\/Feb\\/08 18:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated version Implementation Details. \\n\\n Added Hard Upgrade Section \\nUpdated to indicate that comparing with left and right record while inserting might result in traversing multiple pages.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12571729\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12571729&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12571729\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571729_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571729_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Feb\\/08 12:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-23T12:52:31+0000\'\u003e23\\/Feb\\/08 12:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have removed hard upgrade code from derby-3330v9.diff. Now the hard upgrade. For now it won;t be possible to make columns null able if they were set as not null while creating the constraint. I will be submitting another patch to allow that.\u003cbr\\/\u003e\\nThis patch (derby-3330v9.diff) contains code do create unique constraint over null able columns, soft upgrade, and test case for unique constraint. \u003c\\/p\u003e\\n\\n\u003cp\u003eDescription of the patch can be found in the UniqueConstraint_Implementation_V2.html. \u003c\\/p\u003e\\n\\n\u003cp\u003eTests are running without any failures or error.\u003c\\/p\u003e\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571729_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571729_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Feb\\/08 12:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-23T12:52:31+0000\'\u003e23\\/Feb\\/08 12:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have removed hard upgrade code from derby-3330v9.diff. Now the hard upgrade. For now it won;t be possible to make columns null able if they were set as not null while creating the constraint. I will be submitting another patch to allow that. \\nThis patch (derby-3330v9.diff) contains code do create unique constraint over null able columns, soft upgrade, and test case for unique constraint.  \\n\\n Description of the patch can be found in the UniqueConstraint_Implementation_V2.html.  \\n\\n Tests are running without any failures or error. \\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12571734\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12571734&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12571734\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571734_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571734_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Feb\\/08 13:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-23T13:09:13+0000\'\u003e23\\/Feb\\/08 13:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eupdated hard upgrade section.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12571734_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12571734_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'23\\/Feb\\/08 13:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-23T13:09:13+0000\'\u003e23\\/Feb\\/08 13:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    updated hard upgrade section.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573028\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573028&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573028\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12573028_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573028_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/08 19:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-27T19:09:44+0000\'\u003e27\\/Feb\\/08 19:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003edo you know why the master for dml019 changed?  \u003cbr\\/\u003e\\nIndex: java\\/testing\\/org\\/apache\\/derbyTesting\\/functionTests\\/master\\/dml019.out\u003cbr\\/\u003e\\n===================================================================\u003cbr\\/\u003e\\n&#8212; java\\/testing\\/org\\/apache\\/derbyTesting\\/functionTests\\/master\\/dml019.out\u003cbr\\/\u003e\\n(revision 630309)\u003cbr\\/\u003e\\n+++ java\\/testing\\/org\\/apache\\/derbyTesting\\/functionTests\\/master\\/dml019.out\u003cbr\\/\u003e\\n(working copy)\u003cbr\\/\u003e\\n@@ -82,18 +82,18 @@\u003cbr\\/\u003e\\n           GROUP BY PNUM,EMPNUM,HOURS;\u003cbr\\/\u003e\\n EM&amp;|PN&amp;|HOURS\u003cbr\\/\u003e\\n --------------\u003cbr\\/\u003e\\n-E1 |P1 |40\u003cbr\\/\u003e\\n-E1 |P2 |20\u003cbr\\/\u003e\\n-E1 |P3 |80\u003cbr\\/\u003e\\n-E1 |P4 |20\u003cbr\\/\u003e\\n+E2 |P1 |40\u003cbr\\/\u003e\\n+E4 |P4 |40\u003cbr\\/\u003e\\n E1 |P5 |12\u003cbr\\/\u003e\\n+E4 |P5 |80\u003cbr\\/\u003e\\n E1 |P6 |12\u003cbr\\/\u003e\\n-E2 |P1 |40\u003cbr\\/\u003e\\n-E2 |P2 |80\u003cbr\\/\u003e\\n E3 |P2 |20\u003cbr\\/\u003e\\n+E1 |P4 |20\u003cbr\\/\u003e\\n+E1 |P1 |40\u003cbr\\/\u003e\\n E4 |P2 |20\u003cbr\\/\u003e\\n-E4 |P4 |40\u003cbr\\/\u003e\\n-E4 |P5 |80\u003cbr\\/\u003e\\n+E1 |P2 |20\u003cbr\\/\u003e\\n+E2 |P2 |80\u003cbr\\/\u003e\\n+E1 |P3 |80\u003cbr\\/\u003e\\n ij&gt; &#8211; PASS:0077 If 12 rows are selected ?\u003c\\/p\u003e\\n\\n\u003cp\u003e &#8211; END TEST &gt;&gt;&gt; 0077 &lt;&lt;&lt; END TEST\u003cbr\\/\u003e\\n@@ -105,18 +105,18 @@\u003cbr\\/\u003e\\n           GROUP BY EMPNUM,PNUM,HOURS;\u003cbr\\/\u003e\\n PN&amp;|EM&amp;\u003cbr\\/\u003e\\n -------\u003cbr\\/\u003e\\n-P1 |E1\u003cbr\\/\u003e\\n-P2 |E1\u003cbr\\/\u003e\\n-P3 |E1\u003cbr\\/\u003e\\n-P4 |E1\u003cbr\\/\u003e\\n+P1 |E2\u003cbr\\/\u003e\\n+P4 |E4\u003cbr\\/\u003e\\n P5 |E1\u003cbr\\/\u003e\\n+P5 |E4\u003cbr\\/\u003e\\n P6 |E1\u003cbr\\/\u003e\\n-P1 |E2\u003cbr\\/\u003e\\n-P2 |E2\u003cbr\\/\u003e\\n P2 |E3\u003cbr\\/\u003e\\n+P4 |E1\u003cbr\\/\u003e\\n+P1 |E1\u003cbr\\/\u003e\\n P2 |E4\u003cbr\\/\u003e\\n-P4 |E4\u003cbr\\/\u003e\\n-P5 |E4\u003cbr\\/\u003e\\n+P2 |E1\u003cbr\\/\u003e\\n+P2 |E2\u003cbr\\/\u003e\\n+P3 |E1\u003cbr\\/\u003e\\n ij&gt; &#8211; PASS:0078 If 12 rows are selected  ?\u003c\\/p\u003e\\n\\n\u003cp\u003e &#8211; END TEST &gt;&gt;&gt; 0078 &lt;&lt;&lt; END TEST\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12573028_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573028_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/08 19:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-27T19:09:44+0000\'\u003e27\\/Feb\\/08 19:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    do you know why the master for dml019 changed?   \\nIndex: java\\/testing\\/org\\/apache\\/derbyTesting\\/functionTests\\/master\\/dml019.out \\n=================================================================== \\n&#8212; java\\/testing\\/org\\/apache\\/derbyTesting\\/functionTests\\/master\\/dml019.out \\n(revision 630309) \\n+++ java\\/testing\\/org\\/apache\\/derbyTesting\\/functionTests\\/master\\/dml019.out \\n(working copy) \\n@@ -82,18 +82,18 @@ \\n           GROUP BY PNUM,EMPNUM,HOURS; \\n EM&amp;|PN&amp;|HOURS \\n -------------- \\n-E1 |P1 |40 \\n-E1 |P2 |20 \\n-E1 |P3 |80 \\n-E1 |P4 |20 \\n+E2 |P1 |40 \\n+E4 |P4 |40 \\n E1 |P5 |12 \\n+E4 |P5 |80 \\n E1 |P6 |12 \\n-E2 |P1 |40 \\n-E2 |P2 |80 \\n E3 |P2 |20 \\n+E1 |P4 |20 \\n+E1 |P1 |40 \\n E4 |P2 |20 \\n-E4 |P4 |40 \\n-E4 |P5 |80 \\n+E1 |P2 |20 \\n+E2 |P2 |80 \\n+E1 |P3 |80 \\n ij&gt; &#8211; PASS:0077 If 12 rows are selected ? \\n\\n  &#8211; END TEST &gt;&gt;&gt; 0077 &lt;&lt;&lt; END TEST \\n@@ -105,18 +105,18 @@ \\n           GROUP BY EMPNUM,PNUM,HOURS; \\n PN&amp;|EM&amp; \\n ------- \\n-P1 |E1 \\n-P2 |E1 \\n-P3 |E1 \\n-P4 |E1 \\n+P1 |E2 \\n+P4 |E4 \\n P5 |E1 \\n+P5 |E4 \\n P6 |E1 \\n-P1 |E2 \\n-P2 |E2 \\n P2 |E3 \\n+P4 |E1 \\n+P1 |E1 \\n P2 |E4 \\n-P4 |E4 \\n-P5 |E4 \\n+P2 |E1 \\n+P2 |E2 \\n+P3 |E1 \\n ij&gt; &#8211; PASS:0078 If 12 rows are selected  ? \\n\\n  &#8211; END TEST &gt;&gt;&gt; 0078 &lt;&lt;&lt; END TEST              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573032\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573032&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573032\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573032_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573032_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/08 19:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-27T19:15:21+0000\'\u003e27\\/Feb\\/08 19:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003edml019 test group by clause of unique constraint. When unique constraint \u003cbr\\/\u003e\\nwas backed by unique index, distinct scan  was used but after making it non \u003cbr\\/\u003e\\nunique constraint this was not the case so the results are not ordered. \u003c\\/p\u003e\\n\\n\u003cp\u003eI have checked the test suite from nist web site and it mandates only \u003cbr\\/\u003e\\nnumber of rows and not their sequence. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573032_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573032_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/08 19:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-27T19:15:21+0000\'\u003e27\\/Feb\\/08 19:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    dml019 test group by clause of unique constraint. When unique constraint  \\nwas backed by unique index, distinct scan  was used but after making it non  \\nunique constraint this was not the case so the results are not ordered.  \\n\\n I have checked the test suite from nist web site and it mandates only  \\nnumber of rows and not their sequence.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573077\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573077&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573077\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12573077_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573077_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/08 21:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-27T21:43:12+0000\'\u003e27\\/Feb\\/08 21:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI am running a set of tests on the v9 patch and will post results when they are done.  I am reviewing the v9 patch currently, but will likely concentrate on the store level changes.  If there is anyone with time to review the language level code that would be good.   Especially would like help verifying that the language catalog upgrade code looks right - I have not done that before.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12573077_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573077_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/08 21:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-27T21:43:12+0000\'\u003e27\\/Feb\\/08 21:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I am running a set of tests on the v9 patch and will post results when they are done.  I am reviewing the v9 patch currently, but will likely concentrate on the store level changes.  If there is anyone with time to review the language level code that would be good.   Especially would like help verifying that the language catalog upgrade code looks right - I have not done that before.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573084\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573084&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573084\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"djd\\\" id=\\\"commentauthor_12573084_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=djd\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"djd\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Daniel John Debrunner\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573084_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/08 22:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-27T22:12:37+0000\'\u003e27\\/Feb\\/08 22:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think the upgrade handling of IndexDescriptorImpl is too complex.\u003c\\/p\u003e\\n\\n\u003cp\u003eIndexDescriptorImpl uses a FormatableHashtable to store some of its state, the format of this can handle additional or missing keys. Thus the additional boolean required by this change can simply be added to the hash table, so the writeExternal has an additional:\u003c\\/p\u003e\\n\\n\u003cp\u003e     fh.putBoolean (\\\"isUniqueWhenNotNull\\\", isUniqueWhenNotNull);\u003c\\/p\u003e\\n\\n\u003cp\u003eand the readExternal can have:\u003c\\/p\u003e\\n\\n\u003cp\u003e   if (fh.containsKey(\\\"isUniqueWhenNotNull\\\")\u003cbr\\/\u003e\\n       isUniqueWhenNotNull = fh.getBoolean(\\\"isUniqueWhenNotNull\\\");\u003cbr\\/\u003e\\n   else\u003cbr\\/\u003e\\n       isUniqueWhenNotNull = ?? ; \\/\\/ what ever is the correct value for old indexes.\u003c\\/p\u003e\\n\\n\u003cp\u003eOf course good to comment the real code with when &amp; why these changes were made.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"djd\\\" id=\\\"commentauthor_12573084_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=djd\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"djd\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Daniel John Debrunner\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573084_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/08 22:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-27T22:12:37+0000\'\u003e27\\/Feb\\/08 22:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I think the upgrade handling of IndexDescriptorImpl is too complex. \\n\\n IndexDescriptorImpl uses a FormatableHashtable to store some of its state, the format of this can handle additional or missing keys. Thus the additional boolean required by this change can simply be added to the hash table, so the writeExternal has an additional: \\n\\n      fh.putBoolean (\\\"isUniqueWhenNotNull\\\", isUniqueWhenNotNull); \\n\\n and the readExternal can have: \\n\\n    if (fh.containsKey(\\\"isUniqueWhenNotNull\\\") \\n       isUniqueWhenNotNull = fh.getBoolean(\\\"isUniqueWhenNotNull\\\"); \\n   else \\n       isUniqueWhenNotNull = ?? ; \\/\\/ what ever is the correct value for old indexes. \\n\\n Of course good to comment the real code with when &amp; why these changes were made.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573085\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573085&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573085\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573085_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573085_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/08 22:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-27T22:13:25+0000\'\u003e27\\/Feb\\/08 22:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eChanges in this  (derby-3330v10.diff) patch since (derby-3330v9.diff)\u003c\\/p\u003e\\n\\n\u003cp\u003eModified java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/compile\\/TableElementList.java to introduce a new method to check if any of the column in the constraint definition can have null value. This method is used while creating backing index for unique constraint and if all columns are non null able a backing unique index is created. If any of the column are null able a non unique index with uniqueWhenNotNull set to true.\u003c\\/p\u003e\\n\\n\u003cp\u003enist script dml019.out doesn\'t requires any change now.\u003c\\/p\u003e\\n\\n\u003cp\u003eI haven\'t finished running tests on this patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573085_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573085_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/08 22:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-27T22:13:25+0000\'\u003e27\\/Feb\\/08 22:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Changes in this  (derby-3330v10.diff) patch since (derby-3330v9.diff) \\n\\n Modified java\\/engine\\/org\\/apache\\/derby\\/impl\\/sql\\/compile\\/TableElementList.java to introduce a new method to check if any of the column in the constraint definition can have null value. This method is used while creating backing index for unique constraint and if all columns are non null able a backing unique index is created. If any of the column are null able a non unique index with uniqueWhenNotNull set to true. \\n\\n nist script dml019.out doesn\'t requires any change now. \\n\\n I haven\'t finished running tests on this patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573108\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573108&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573108\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dibyendumajumdar\\\" id=\\\"commentauthor_12573108_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dibyendumajumdar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dibyendumajumdar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dibyendu Majumdar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573108_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 00:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T00:17:27+0000\'\u003e28\\/Feb\\/08 00:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHi,\u003c\\/p\u003e\\n\\n\u003cp\u003eI could be talking nonsense here so please tell me to shut up if I have got the wrong end of the issue. \u003c\\/p\u003e\\n\\n\u003cp\u003eIf I understand correctly, one of the requirements is to allow multiple rows to be inserted where the index is unique and all columns are null. This doesn\'t work currently because such rows will be considered duplicates.\u003c\\/p\u003e\\n\\n\u003cp\u003eThinking very naively, I would implement this as follows:\u003c\\/p\u003e\\n\\n\u003cp\u003eI am assuming that when index rows are stored, Derby always stores an additional column containing the row location, regardless of the type of index.\u003cbr\\/\u003e\\nAlso that the search algorithm is uniform for both unique and non-unique indexes, with the only difference being that the unique index searches do not consider the extra row location column.\u003cbr\\/\u003e\\nFollowing is invalid if above assumptions are not true.\u003c\\/p\u003e\\n\\n\u003cp\u003eTo get the desired behaviour, I would simply change the comparison logic as follows:\u003c\\/p\u003e\\n\\n\u003cp\u003ea) If non-unique index, no change.\u003cbr\\/\u003e\\nb) If unique index, and all indexable columns are null, then compare the extra (last)  (row location) column.\u003cbr\\/\u003e\\nc) The else case for unique index will remain the same as now.\u003c\\/p\u003e\\n\\n\u003cp\u003eIf the key comparison routine always used above logic, would it not give desired behaviour without requiring any significant changes to the existing implementation?\u003c\\/p\u003e\\n\\n\u003cp\u003eAs I said, I may totally off track here, so please feel free to tell me to shut up.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dibyendumajumdar\\\" id=\\\"commentauthor_12573108_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dibyendumajumdar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dibyendumajumdar\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dibyendu Majumdar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573108_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 00:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T00:17:27+0000\'\u003e28\\/Feb\\/08 00:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hi, \\n\\n I could be talking nonsense here so please tell me to shut up if I have got the wrong end of the issue.  \\n\\n If I understand correctly, one of the requirements is to allow multiple rows to be inserted where the index is unique and all columns are null. This doesn\'t work currently because such rows will be considered duplicates. \\n\\n Thinking very naively, I would implement this as follows: \\n\\n I am assuming that when index rows are stored, Derby always stores an additional column containing the row location, regardless of the type of index. \\nAlso that the search algorithm is uniform for both unique and non-unique indexes, with the only difference being that the unique index searches do not consider the extra row location column. \\nFollowing is invalid if above assumptions are not true. \\n\\n To get the desired behaviour, I would simply change the comparison logic as follows: \\n\\n a) If non-unique index, no change. \\nb) If unique index, and all indexable columns are null, then compare the extra (last)  (row location) column. \\nc) The else case for unique index will remain the same as now. \\n\\n If the key comparison routine always used above logic, would it not give desired behaviour without requiring any significant changes to the existing implementation? \\n\\n As I said, I may totally off track here, so please feel free to tell me to shut up.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573113\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573113&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573113\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12573113_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573113_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 00:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T00:54:56+0000\'\u003e28\\/Feb\\/08 00:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFrom running the v9 patch on ibm15 jvm against a windows XP laptop I got 1 failure in the junit tests and 6 failures in the old style tests - i will attach a copy of the results for the old style test failures.  Are all tests passing in your environment with this patch?   I will try to run another set of tests over night with your latest patch - but do post what environment you are running the tests on and if they all pass or not with the v10 patch.\u003c\\/p\u003e\\n\\n\u003cp\u003ejunit failure:\u003cbr\\/\u003e\\nThere was 1 failure:\u003cbr\\/\u003e\\n1) dml019(org.apache.derbyTesting.functionTests.tests.nist.NistScripts)junit.fra\u003cbr\\/\u003e\\nmework.ComparisonFailure: Output at line 85 expected:&lt;...1 |4...&gt; but was:&lt;...2\u003c\\/p\u003e\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003ctd class=\'confluenceTd\'\u003e8...&gt;\u003cbr\\/\u003e\\n    at org.apache.derbyTesting.functionTests.util.CanonTestCase.compareCanon(Can\u003cbr\\/\u003e\\nonTestCase.java:100)\u003cbr\\/\u003e\\n    at org.apache.derbyTesting.functionTests.util.ScriptTestCase.runTest(ScriptT\u003cbr\\/\u003e\\nestCase.java:124)\u003cbr\\/\u003e\\n    at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:101)\u003cbr\\/\u003e\\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup.run(TestSetup.java:23)\u003cbr\\/\u003e\\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup.run(TestSetup.java:23)\u003cbr\\/\u003e\\n    at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\u003cbr\\/\u003e\\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup.run(TestSetup.java:23)\u003cbr\\/\u003e\\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup.run(TestSetup.java:23)\u003cbr\\/\u003e\\n    at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\u003cbr\\/\u003e\\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup.run(TestSetup.java:23)\u003cbr\\/\u003e\\n    at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\u003cbr\\/\u003e\\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19)\u003cbr\\/\u003e\\n    at junit.extensions.TestSetup.run(TestSetup.java:23)\u003cbr\\/\u003e\\n    at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\u003c\\/td\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\\n\u003cp\u003eThe following tests failed, will attach complete diff:\u003cbr\\/\u003e\\nderbyall\\/derbyall.fail:lang\\/altertable.sql\u003cbr\\/\u003e\\nderbyall\\/derbyall.fail:lang\\/db2Compatibility.sql\u003cbr\\/\u003e\\nderbyall\\/derbyall.fail:lang\\/subqueryFlattening.sql\u003cbr\\/\u003e\\nderbyall\\/derbyall.fail:tools\\/dblook_test.java\u003cbr\\/\u003e\\nderbyall\\/derbynetclientmats\\/derbynetmats.fail:derbynet\\/dblook_test_net.java\u003cbr\\/\u003e\\nderbyall\\/storeall\\/storeall.fail:store\\/rollForwardRecovery.sql\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12573113_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573113_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 00:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T00:54:56+0000\'\u003e28\\/Feb\\/08 00:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    From running the v9 patch on ibm15 jvm against a windows XP laptop I got 1 failure in the junit tests and 6 failures in the old style tests - i will attach a copy of the results for the old style test failures.  Are all tests passing in your environment with this patch?   I will try to run another set of tests over night with your latest patch - but do post what environment you are running the tests on and if they all pass or not with the v10 patch. \\n\\n junit failure: \\nThere was 1 failure: \\n1) dml019(org.apache.derbyTesting.functionTests.tests.nist.NistScripts)junit.fra \\nmework.ComparisonFailure: Output at line 85 expected:&lt;...1 |4...&gt; but was:&lt;...2 \\n \\n  \\n \\n 8...&gt; \\n    at org.apache.derbyTesting.functionTests.util.CanonTestCase.compareCanon(Can \\nonTestCase.java:100) \\n    at org.apache.derbyTesting.functionTests.util.ScriptTestCase.runTest(ScriptT \\nestCase.java:124) \\n    at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:101) \\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) \\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19) \\n    at junit.extensions.TestSetup.run(TestSetup.java:23) \\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) \\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19) \\n    at junit.extensions.TestSetup.run(TestSetup.java:23) \\n    at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) \\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) \\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19) \\n    at junit.extensions.TestSetup.run(TestSetup.java:23) \\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) \\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19) \\n    at junit.extensions.TestSetup.run(TestSetup.java:23) \\n    at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) \\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) \\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19) \\n    at junit.extensions.TestSetup.run(TestSetup.java:23) \\n    at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) \\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) \\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:19) \\n    at junit.extensions.TestSetup.run(TestSetup.java:23) \\n    at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) \\n \\n  \\n \\n\\n\\n The following tests failed, will attach complete diff: \\nderbyall\\/derbyall.fail:lang\\/altertable.sql \\nderbyall\\/derbyall.fail:lang\\/db2Compatibility.sql \\nderbyall\\/derbyall.fail:lang\\/subqueryFlattening.sql \\nderbyall\\/derbyall.fail:tools\\/dblook_test.java \\nderbyall\\/derbynetclientmats\\/derbynetmats.fail:derbynet\\/dblook_test_net.java \\nderbyall\\/storeall\\/storeall.fail:store\\/rollForwardRecovery.sql              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573114\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573114&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573114\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12573114_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573114_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 00:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T00:56:30+0000\'\u003e28\\/Feb\\/08 00:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ereport of diffs on ibm15 jvm running on xp laptop using version 9 patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12573114_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573114_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 00:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T00:56:30+0000\'\u003e28\\/Feb\\/08 00:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    report of diffs on ibm15 jvm running on xp laptop using version 9 patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573151\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573151&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573151\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"djd\\\" id=\\\"commentauthor_12573151_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=djd\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"djd\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Daniel John Debrunner\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573151_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 04:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T04:42:02+0000\'\u003e28\\/Feb\\/08 04:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eDibyendu wrote:\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; one of the requirements is to allow multiple rows to be inserted where the index is unique and all columns are null.\u003c\\/p\u003e\\n\\n\u003cp\u003ebut not the only requirement \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eIn a unique constraint these key columns are allowed:\u003c\\/p\u003e\\n\\n\u003cp\u003e   Smith, NULL\u003cbr\\/\u003e\\n   Smith, NULL\u003cbr\\/\u003e\\n   Smith, NULL\u003c\\/p\u003e\\n\\n\u003cp\u003eA unique index (from existing CREATE INDEX) would only allow one row with Smith,NULL\u003c\\/p\u003e\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"djd\\\" id=\\\"commentauthor_12573151_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=djd\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"djd\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Daniel John Debrunner\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573151_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 04:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T04:42:02+0000\'\u003e28\\/Feb\\/08 04:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Dibyendu wrote: \\n\\n &gt; one of the requirements is to allow multiple rows to be inserted where the index is unique and all columns are null. \\n\\n but not the only requirement   \\n\\n In a unique constraint these key columns are allowed: \\n\\n    Smith, NULL \\n   Smith, NULL \\n   Smith, NULL \\n\\n A unique index (from existing CREATE INDEX) would only allow one row with Smith,NULL \\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573241\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573241&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573241\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573241_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573241_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 12:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T12:06:21+0000\'\u003e28\\/Feb\\/08 12:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eDescription of patch (derby-3330v11.diff) \u003c\\/p\u003e\\n\\n\u003cp\u003eNow the backing index for unique constraint, if all \u003cbr\\/\u003e\\nparticipating columns are not null able, will be a unique index.\u003cbr\\/\u003e\\nFor now its not possible to set columns as null able after \u003cbr\\/\u003e\\ncreating unique constraint (\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3456\\\" title=\\\"Allow removing not null from collumns particpating in unique constraint.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3456\\\"\u003e\u003cdel\u003eDERBY-3456\u003c\\/del\u003e\u003c\\/a\u003e addresses this). \u003c\\/p\u003e\\n\\n\u003cp\u003eI have removed IndexDescriptorImpl_10_3 and handling \u003cbr\\/\u003e\\nadditional attribute the way Dan has recommend. \u003c\\/p\u003e\\n\\n\u003cp\u003eI am able to run junit tests without any failure.\u003c\\/p\u003e\\n\\n\u003cp\u003ederbyall harness tests has two failure\u003cbr\\/\u003e\\n1. lang\\/db2Compatibility.sql\u003cbr\\/\u003e\\nI have attached a separate diff (db2Compatibility.diff) to update the out files.\u003cbr\\/\u003e\\nI am not sure if we should continue to call this test as db2Compatibility as this \u003cbr\\/\u003e\\ntest is not ensuring compatibility anymore (able to create unique constraint \u003cbr\\/\u003e\\nover null able fields)\u003c\\/p\u003e\\n\\n\u003cp\u003e2.tools\\/derbyrunjartest.java\u003cbr\\/\u003e\\nThis failure was because of a missing class file in derbytools.jar \u003cbr\\/\u003e\\n(org.apache.derby.impl.tools.run). I am getting this problem in a \u003cbr\\/\u003e\\nfresh workspace too. So It might be something to do with my \u003cbr\\/\u003e\\nbuild environment and not the patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have modified following files in harness test\u003c\\/p\u003e\\n\\n\u003cp\u003e1. org\\/apache\\/derbyTesting\\/functionTests\\/tests\\/lang\\/subqueryFlattening.sql\u003cbr\\/\u003e\\n2. org\\/apache\\/derbyTesting\\/functionTests\\/master\\/subqueryFlattening.out\u003c\\/p\u003e\\n\\n\u003cp\u003eI have removed the additional test for unique constraint over null able field. \u003cbr\\/\u003e\\nThis creation was supposed to fail and the output query tree was based on no\u003cbr\\/\u003e\\nadditional constraint. After allowing unique constraint over null able field \u003cbr\\/\u003e\\nan additional index was introduced which changed the query tree. After removing\u003cbr\\/\u003e\\nthe statement to create unique constraint over null able field I am getting \u003cbr\\/\u003e\\nsame query tree as expected.\u003c\\/p\u003e\\n\\n\u003cp\u003e3. org\\/apache\\/derbyTesting\\/functionTests\\/master\\/altertable.out\u003c\\/p\u003e\\n\\n\u003cp\u003eOriginal out file was expecting the creation of unique constraint to \u003cbr\\/\u003e\\nfail over null able fields. Updated out file to expect it to succeed.\u003c\\/p\u003e\\n\\n\u003cp\u003eOther failures in harness test were because of change in backing index (from \u003cbr\\/\u003e\\nunique to non unique) for unique constraint over not null columns. They disappeared \u003cbr\\/\u003e\\nafter making changes related to backing index.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573241_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573241_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 12:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T12:06:21+0000\'\u003e28\\/Feb\\/08 12:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Description of patch (derby-3330v11.diff)  \\n\\n Now the backing index for unique constraint, if all  \\nparticipating columns are not null able, will be a unique index. \\nFor now its not possible to set columns as null able after  \\ncreating unique constraint (  DERBY-3456   addresses this).  \\n\\n I have removed IndexDescriptorImpl_10_3 and handling  \\nadditional attribute the way Dan has recommend.  \\n\\n I am able to run junit tests without any failure. \\n\\n derbyall harness tests has two failure \\n1. lang\\/db2Compatibility.sql \\nI have attached a separate diff (db2Compatibility.diff) to update the out files. \\nI am not sure if we should continue to call this test as db2Compatibility as this  \\ntest is not ensuring compatibility anymore (able to create unique constraint  \\nover null able fields) \\n\\n 2.tools\\/derbyrunjartest.java \\nThis failure was because of a missing class file in derbytools.jar  \\n(org.apache.derby.impl.tools.run). I am getting this problem in a  \\nfresh workspace too. So It might be something to do with my  \\nbuild environment and not the patch. \\n\\n I have modified following files in harness test \\n\\n 1. org\\/apache\\/derbyTesting\\/functionTests\\/tests\\/lang\\/subqueryFlattening.sql \\n2. org\\/apache\\/derbyTesting\\/functionTests\\/master\\/subqueryFlattening.out \\n\\n I have removed the additional test for unique constraint over null able field.  \\nThis creation was supposed to fail and the output query tree was based on no \\nadditional constraint. After allowing unique constraint over null able field  \\nan additional index was introduced which changed the query tree. After removing \\nthe statement to create unique constraint over null able field I am getting  \\nsame query tree as expected. \\n\\n 3. org\\/apache\\/derbyTesting\\/functionTests\\/master\\/altertable.out \\n\\n Original out file was expecting the creation of unique constraint to  \\nfail over null able fields. Updated out file to expect it to succeed. \\n\\n Other failures in harness test were because of change in backing index (from  \\nunique to non unique) for unique constraint over not null columns. They disappeared  \\nafter making changes related to backing index. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573245\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573245&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573245\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573245_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573245_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 12:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T12:18:22+0000\'\u003e28\\/Feb\\/08 12:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003edb2Compatibility.diff\u003cbr\\/\u003e\\ndiff file to update db2Compatibility.out. \u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573245_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573245_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 12:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T12:18:22+0000\'\u003e28\\/Feb\\/08 12:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    db2Compatibility.diff \\ndiff file to update db2Compatibility.out.  \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573324\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573324&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573324\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573324_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573324_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 15:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T15:40:51+0000\'\u003e28\\/Feb\\/08 15:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ederby-3330v12.diff\u003c\\/p\u003e\\n\\n\u003cp\u003efixed indentation issues and added comment in IndexDescriptorImpl.\u003cbr\\/\u003e\\nAs the changes are minor (only indentation and comments) I haven\'t run\u003cbr\\/\u003e\\nall the test just upgrade and lang junit suites.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573324_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573324_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 15:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T15:40:51+0000\'\u003e28\\/Feb\\/08 15:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    derby-3330v12.diff \\n\\n fixed indentation issues and added comment in IndexDescriptorImpl. \\nAs the changes are minor (only indentation and comments) I haven\'t run \\nall the test just upgrade and lang junit suites.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573347\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573347&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573347\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"djd\\\" id=\\\"commentauthor_12573347_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=djd\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"djd\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Daniel John Debrunner\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573347_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 16:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T16:41:30+0000\'\u003e28\\/Feb\\/08 16:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for cleaning up the IndexDescriptor upgrade related code, makes it look much cleaner.\u003c\\/p\u003e\\n\\n\u003cp\u003eA minor issue I have that if needed can be handled after any patch is applied is the naming in the code of the new style of unique index.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe common theme is \\\"uniqueWhenNotNull\\\", when I first looked at the code I thought this was the other way around since for index definitions I tend to think of the DDL, not the row values. Thus:\u003c\\/p\u003e\\n\\n\u003cp\u003e   isUnique() is true for indexes where the columns are defined NOT NULL\u003c\\/p\u003e\\n\\n\u003cp\u003e   isUniqueWhenNotNull() is true for indexes where the columns are nullable (but unique when the column values do not contain NULLs).\u003c\\/p\u003e\\n\\n\u003cp\u003eSee how that can be confusing to code readers who see the code without having been immersed in developing the code.\u003c\\/p\u003e\\n\\n\u003cp\u003eNot sure of a better name, re-writing to be a positive statement (always clearer) but still referring to the values would be:\u003cbr\\/\u003e\\n    isUniqueWithDuplicateNulls()\u003c\\/p\u003e\\n\\n\u003cp\u003eor a positive statement referring to the column types:\u003cbr\\/\u003e\\n   isUniqueWithNullableColumns()\u003c\\/p\u003e\\n\\n\u003cp\u003eI think a change in name would be good for the long term readability of the code, again it can be a follow on patch, fairly easy to do with IDE refactoring.\u003c\\/p\u003e\\n\\n\u003cp\u003eOne more aside, it would be good to expand the definition of isUnique() and the current isUniqueWhenNotNull() in IndexDescriptor to indicate any relationship between them, e.g. is isUnique() true if isUniqueWhenNotNull() is true?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"djd\\\" id=\\\"commentauthor_12573347_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=djd\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"djd\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Daniel John Debrunner\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573347_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 16:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T16:41:30+0000\'\u003e28\\/Feb\\/08 16:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for cleaning up the IndexDescriptor upgrade related code, makes it look much cleaner. \\n\\n A minor issue I have that if needed can be handled after any patch is applied is the naming in the code of the new style of unique index. \\n\\n The common theme is \\\"uniqueWhenNotNull\\\", when I first looked at the code I thought this was the other way around since for index definitions I tend to think of the DDL, not the row values. Thus: \\n\\n    isUnique() is true for indexes where the columns are defined NOT NULL \\n\\n    isUniqueWhenNotNull() is true for indexes where the columns are nullable (but unique when the column values do not contain NULLs). \\n\\n See how that can be confusing to code readers who see the code without having been immersed in developing the code. \\n\\n Not sure of a better name, re-writing to be a positive statement (always clearer) but still referring to the values would be: \\n    isUniqueWithDuplicateNulls() \\n\\n or a positive statement referring to the column types: \\n   isUniqueWithNullableColumns() \\n\\n I think a change in name would be good for the long term readability of the code, again it can be a follow on patch, fairly easy to do with IDE refactoring. \\n\\n One more aside, it would be good to expand the definition of isUnique() and the current isUniqueWhenNotNull() in IndexDescriptor to indicate any relationship between them, e.g. is isUnique() true if isUniqueWhenNotNull() is true?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573365\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573365&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573365\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573365_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573365_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 17:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T17:28:22+0000\'\u003e28\\/Feb\\/08 17:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUniqueWithDuplicateNulls explains the actual behavior than \u003cbr\\/\u003e\\nuniqueWhenNotNull. Thanks for  suggesting it.\u003cbr\\/\u003e\\nI will replace uniqueWhenNotNull by this. \u003cbr\\/\u003e\\nIn my next patch (or the follow up patch is there is no further issue in \u003cbr\\/\u003e\\nmy latest patch) i will replace the index name and will explain the the \u003cbr\\/\u003e\\nrelation between unique and UniqueWithDuplicateNulls.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573365_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573365_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 17:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T17:28:22+0000\'\u003e28\\/Feb\\/08 17:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    UniqueWithDuplicateNulls explains the actual behavior than  \\nuniqueWhenNotNull. Thanks for  suggesting it. \\nI will replace uniqueWhenNotNull by this.  \\nIn my next patch (or the follow up patch is there is no further issue in  \\nmy latest patch) i will replace the index name and will explain the the  \\nrelation between unique and UniqueWithDuplicateNulls. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573369\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573369&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573369\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573369_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573369_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 17:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T17:30:28+0000\'\u003e28\\/Feb\\/08 17:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003euniqueWhenNotNull attribute (in B2I and IndexDescritor) is ignored if isUnique is true. uniqueWhenNotNull is effective only if the the index is non unique type. \u003cbr\\/\u003e\\nI will add this explanation in comments.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573369_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573369_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 17:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T17:30:28+0000\'\u003e28\\/Feb\\/08 17:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    uniqueWhenNotNull attribute (in B2I and IndexDescritor) is ignored if isUnique is true. uniqueWhenNotNull is effective only if the the index is non unique type.  \\nI will add this explanation in comments.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573450\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573450&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573450\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573450_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573450_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 21:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T21:06:53+0000\'\u003e28\\/Feb\\/08 21:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eplease ignore  derby-3330v12.diff . It had a conflict with one of the recent patches and test suite didn\'t get updated. I will be uploading a new patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573450_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573450_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 21:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T21:06:53+0000\'\u003e28\\/Feb\\/08 21:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    please ignore  derby-3330v12.diff . It had a conflict with one of the recent patches and test suite didn\'t get updated. I will be uploading a new patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573488\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573488&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573488\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573488_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573488_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 22:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T22:14:37+0000\'\u003e28\\/Feb\\/08 22:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003echanges in derby-3330v13.diff \u003c\\/p\u003e\\n\\n\u003cp\u003e1. replaced uniqueWhenNotNull by uniqueWithDuplicateNulls. \u003cbr\\/\u003e\\n2. added description about relation ship between unique and uniqueWithDuplicateNulls.\u003cbr\\/\u003e\\n3. Added entry for NullableUniqueConstraintTest in lang._Suite (this was lost due to one of the conflicts)\u003c\\/p\u003e\\n\\n\u003cp\u003eUpgrade test (from 10.3.1.4) runs without failure.\u003cbr\\/\u003e\\nlang._Suite fails with 6 failures in LangScripts. I am getting these failures in fresh work space. (few hours back there was no failures in lang._Suite)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573488_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573488_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/08 22:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-28T22:14:37+0000\'\u003e28\\/Feb\\/08 22:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    changes in derby-3330v13.diff  \\n\\n 1. replaced uniqueWhenNotNull by uniqueWithDuplicateNulls.  \\n2. added description about relation ship between unique and uniqueWithDuplicateNulls. \\n3. Added entry for NullableUniqueConstraintTest in lang._Suite (this was lost due to one of the conflicts) \\n\\n Upgrade test (from 10.3.1.4) runs without failure. \\nlang._Suite fails with 6 failures in LangScripts. I am getting these failures in fresh work space. (few hours back there was no failures in lang._Suite)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573671\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573671&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573671\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573671_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573671_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Feb\\/08 10:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-29T10:47:07+0000\'\u003e29\\/Feb\\/08 10:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ejunit.all and derbyall tests are running fine with derby-3330v13.diff.\u003c\\/p\u003e\\n\\n\u003cp\u003ederbyall has some failures also visible in tinderbox. \u003cbr\\/\u003e\\nOne additional failure I am getting is  tools\\/derbyrunjartest.java which fails with \u003cbr\\/\u003e\\nsame error in my fresh work space too.\u003c\\/p\u003e\\n\\n\u003cp\u003edb2Compatibility.diff is not valid anymore it has conflicting failures with some changes.  I will \u003cbr\\/\u003e\\ncreate a new patch once lang\\/db2Compatibility.sql is clean in tinderbox.\u003c\\/p\u003e\\n\\n\u003cp\u003eAs of now there are no pending issues in derby-3330v13.diff\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573671_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573671_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Feb\\/08 10:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-29T10:47:07+0000\'\u003e29\\/Feb\\/08 10:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    junit.all and derbyall tests are running fine with derby-3330v13.diff. \\n\\n derbyall has some failures also visible in tinderbox.  \\nOne additional failure I am getting is  tools\\/derbyrunjartest.java which fails with  \\nsame error in my fresh work space too. \\n\\n db2Compatibility.diff is not valid anymore it has conflicting failures with some changes.  I will  \\ncreate a new patch once lang\\/db2Compatibility.sql is clean in tinderbox. \\n\\n As of now there are no pending issues in derby-3330v13.diff              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12573917\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12573917&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12573917\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573917_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573917_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Feb\\/08 19:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-29T19:32:11+0000\'\u003e29\\/Feb\\/08 19:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003edescription of db2Compatibility-v2.diff\u003c\\/p\u003e\\n\\n\u003cp\u003eremoved test case for unique constraint over null able columns and updated out files accordingly.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12573917_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12573917_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Feb\\/08 19:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-02-29T19:32:11+0000\'\u003e29\\/Feb\\/08 19:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    description of db2Compatibility-v2.diff \\n\\n removed test case for unique constraint over null able columns and updated out files accordingly.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12574816\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12574816&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12574816\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12574816_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12574816_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/08 01:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-04T01:42:07+0000\'\u003e04\\/Mar\\/08 01:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI am looking at committing a version of the latest changes, once they pass a set of tests for me and my final review.  If anyone has any reservations about this going in, let me know.  Overall I think the changes now only affect only the new \u003cbr\\/\u003e\\nfunctionality so even if I find some non-test related problems I am likely to commit to make it easier to address the remaining issues.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12574816_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12574816_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/08 01:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-04T01:42:07+0000\'\u003e04\\/Mar\\/08 01:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I am looking at committing a version of the latest changes, once they pass a set of tests for me and my final review.  If anyone has any reservations about this going in, let me know.  Overall I think the changes now only affect only the new  \\nfunctionality so even if I find some non-test related problems I am likely to commit to make it easier to address the remaining issues.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575074\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575074&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575074\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575074_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575074_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/08 17:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-04T17:48:53+0000\'\u003e04\\/Mar\\/08 17:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003erevision 633560 checked into trunk:\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3330\\\" title=\\\"provide support for unique constraint over keys that include one or more nullable columns.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3330\\\"\u003e\u003cdel\u003eDERBY-3330\u003c\\/del\u003e\u003c\\/a\u003e\u003cbr\\/\u003e\\ncommitted on behalf of Anurag Shekhar\u003c\\/p\u003e\\n\\n\u003cp\u003eCommitted modified versions of patch derby-3330v13.diff and\u003cbr\\/\u003e\\ndb2Compatibility-v2.diff.  The modifications are mostly changed and\\/or\u003cbr\\/\u003e\\nadded comments along with some code formatting changes to make the\u003cbr\\/\u003e\\nnew code match the surrounding code style.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis checkin adds the functionality to\u003cbr\\/\u003e\\ncreate unique constraints on a key that contains one or more nullable\u003cbr\\/\u003e\\ncolumns.  This constraint will all inserts of all keys that contain\u003cbr\\/\u003e\\none or more columns with the null value.  All keys that contain no columns\u003cbr\\/\u003e\\nwith null values are constrained to be unique in the table.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe underlying implementation for this new type of unique constraint uses\u003cbr\\/\u003e\\nthe existing btree non-unique index with a small modification to do\u003cbr\\/\u003e\\nchecking at insert time to provide the described unique behavior for null\u003cbr\\/\u003e\\nand non-null keys.  The sorter has also been modified to provide this\u003cbr\\/\u003e\\nsupport for creating the index.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575074_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575074_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/08 17:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-04T17:48:53+0000\'\u003e04\\/Mar\\/08 17:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    revision 633560 checked into trunk: \\n\\n   DERBY-3330   \\ncommitted on behalf of Anurag Shekhar \\n\\n Committed modified versions of patch derby-3330v13.diff and \\ndb2Compatibility-v2.diff.  The modifications are mostly changed and\\/or \\nadded comments along with some code formatting changes to make the \\nnew code match the surrounding code style. \\n\\n This checkin adds the functionality to \\ncreate unique constraints on a key that contains one or more nullable \\ncolumns.  This constraint will all inserts of all keys that contain \\none or more columns with the null value.  All keys that contain no columns \\nwith null values are constrained to be unique in the table. \\n\\n The underlying implementation for this new type of unique constraint uses \\nthe existing btree non-unique index with a small modification to do \\nchecking at insert time to provide the described unique behavior for null \\nand non-null keys.  The sorter has also been modified to provide this \\nsupport for creating the index.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575075\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575075&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575075\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575075_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575075_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/08 17:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-04T17:50:37+0000\'\u003e04\\/Mar\\/08 17:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere are some comments that were still unresolved in the submitted patch, but didn\'t seem big enough to hold up the patch and can be addressed with a subsequent patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eCreateIndexConstantAction.java -\u003cbr\\/\u003e\\n    use of properties?  Some of the existing code seems to sometimes expect\u003cbr\\/\u003e\\n    a properties passed in.  Your new code will overwrite the saved copy of\u003cbr\\/\u003e\\n    the properties to pass needed info to the new sort routine.  I don\'t\u003cbr\\/\u003e\\n    know when a property may be passed in and lost.  I think you just want\u003cbr\\/\u003e\\n    to create a new variable for sort_properties.\u003c\\/p\u003e\\n\\n\u003cp\u003esort changes\u003cbr\\/\u003e\\n    I don\'t like that the implementation of unique merge sort knows about\u003cbr\\/\u003e\\n    row location last column.  The intent of the sorted is to be somewhat\u003cbr\\/\u003e\\n    general purpose so it would be better to somehow encode that info into\u003cbr\\/\u003e\\n    the startup parameters.  I think the null special handling is located\u003cbr\\/\u003e\\n    in the right place, ie. in the new sort impl.\u003c\\/p\u003e\\n\\n\u003cp\u003e    A comment explaining the why of these 2 lines would be nice in\u003cbr\\/\u003e\\n    UniqueWithDuplicateNullMergeSort.java would be nice.\u003c\\/p\u003e\\n\\n\u003cp\u003e    if (i == colsToCompare - 1 &amp;&amp; nonull)\u003cbr\\/\u003e\\n            return 0;\u003c\\/p\u003e\\n\\n\u003cp\u003eBTreeController.java\u003cbr\\/\u003e\\n    Can the second call to the following code be optimized, is it necessary?\u003cbr\\/\u003e\\n    maybe a comment here would help.\u003c\\/p\u003e\\n\\n\u003cp\u003e    if (getConglomerate().isUniqueWithDuplicateNulls()) \u003c\\/p\u003e\\n{\\n        int ret = compareLeftAndRightSiblings(rowToInsert,\\n                    insert_slot, targetleaf);\\n        if (ret == MATCH_FOUND)\\n                    return ConglomerateController.ROWISDUPLICATE;\\n        if (ret == RESCAN_REQUIRED)\\n                    continue;\\n    }\\n\\n\u003cp\u003eB2I.java\u003cbr\\/\u003e\\n    I updated the upgrade comments, especially for the change in behavior for\u003cbr\\/\u003e\\n    the 10.3 formats.  You should review these to make sure they are what\u003cbr\\/\u003e\\n    you expect.\u003c\\/p\u003e\\n\\n\u003cp\u003eIndexDescriptorImpl.java\u003cbr\\/\u003e\\n    Should change following to match new naming:\u003cbr\\/\u003e\\n    sb.append (\\\"ALMOST UNIQUE\\\");\u003c\\/p\u003e\\n\\n\u003cp\u003e    The following is a wrong (repeated same test), but I didn\'t change -\u003cbr\\/\u003e\\n    wanted to give you a chance to look at it.  Not sure what it affects, if\u003cbr\\/\u003e\\n    it is a bug would be nice to have a test case that shows the problem.\u003c\\/p\u003e\\n\\n\u003cp\u003e    Wasn\'t sure if it wanted another different term, probably wants to be a\u003cbr\\/\u003e\\n    test for the new attribute.\u003c\\/p\u003e\\n\\n\u003cp\u003e    if ((id.isUnique == this.isUnique) &amp;&amp;\u003cbr\\/\u003e\\n            (id.isUnique == this.isUnique) &amp;&amp;\u003c\\/p\u003e\\n\\n\u003cp\u003eBTreeController.java\u003cbr\\/\u003e\\n    I think there may be some edge case stuff missing from the searches, I\u003cbr\\/\u003e\\n    will look more later, but it looks like a good basis for the new\u003cbr\\/\u003e\\n    functionality so rather see it get checked in and more eyes on it.\u003cbr\\/\u003e\\n    Again now that new searches only happen on new nullable constraints there\u003cbr\\/\u003e\\n    is less risk to existing functionality.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eI don\'t see upgrade tests, are they in a different JIRA\\/patch?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575075_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575075_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/08 17:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-04T17:50:37+0000\'\u003e04\\/Mar\\/08 17:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here are some comments that were still unresolved in the submitted patch, but didn\'t seem big enough to hold up the patch and can be addressed with a subsequent patch. \\n\\n CreateIndexConstantAction.java - \\n    use of properties?  Some of the existing code seems to sometimes expect \\n    a properties passed in.  Your new code will overwrite the saved copy of \\n    the properties to pass needed info to the new sort routine.  I don\'t \\n    know when a property may be passed in and lost.  I think you just want \\n    to create a new variable for sort_properties. \\n\\n sort changes \\n    I don\'t like that the implementation of unique merge sort knows about \\n    row location last column.  The intent of the sorted is to be somewhat \\n    general purpose so it would be better to somehow encode that info into \\n    the startup parameters.  I think the null special handling is located \\n    in the right place, ie. in the new sort impl. \\n\\n     A comment explaining the why of these 2 lines would be nice in \\n    UniqueWithDuplicateNullMergeSort.java would be nice. \\n\\n     if (i == colsToCompare - 1 &amp;&amp; nonull) \\n            return 0; \\n\\n BTreeController.java \\n    Can the second call to the following code be optimized, is it necessary? \\n    maybe a comment here would help. \\n\\n     if (getConglomerate().isUniqueWithDuplicateNulls())  \\n{\\n        int ret = compareLeftAndRightSiblings(rowToInsert,\\n                    insert_slot, targetleaf);\\n        if (ret == MATCH_FOUND)\\n                    return ConglomerateController.ROWISDUPLICATE;\\n        if (ret == RESCAN_REQUIRED)\\n                    continue;\\n    }\\n\\n B2I.java \\n    I updated the upgrade comments, especially for the change in behavior for \\n    the 10.3 formats.  You should review these to make sure they are what \\n    you expect. \\n\\n IndexDescriptorImpl.java \\n    Should change following to match new naming: \\n    sb.append (\\\"ALMOST UNIQUE\\\"); \\n\\n     The following is a wrong (repeated same test), but I didn\'t change - \\n    wanted to give you a chance to look at it.  Not sure what it affects, if \\n    it is a bug would be nice to have a test case that shows the problem. \\n\\n     Wasn\'t sure if it wanted another different term, probably wants to be a \\n    test for the new attribute. \\n\\n     if ((id.isUnique == this.isUnique) &amp;&amp; \\n            (id.isUnique == this.isUnique) &amp;&amp; \\n\\n BTreeController.java \\n    I think there may be some edge case stuff missing from the searches, I \\n    will look more later, but it looks like a good basis for the new \\n    functionality so rather see it get checked in and more eyes on it. \\n    Again now that new searches only happen on new nullable constraints there \\n    is less risk to existing functionality. \\n\\n\\n I don\'t see upgrade tests, are they in a different JIRA\\/patch?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575079\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575079&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575079\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575079_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575079_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/08 17:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-04T17:56:46+0000\'\u003e04\\/Mar\\/08 17:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Mike for guiding me through this issue and for the commit.\u003cbr\\/\u003e\\nI will submit follow up patch to address your comments.\u003c\\/p\u003e\\n\\n\u003cp\u003eUpgrade tests and also the tests related to indexes you had suggested are part of \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3456\\\" title=\\\"Allow removing not null from collumns particpating in unique constraint.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3456\\\"\u003e\u003cdel\u003eDERBY-3456\u003c\\/del\u003e\u003c\\/a\u003e. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575079_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575079_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Mar\\/08 17:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-04T17:56:46+0000\'\u003e04\\/Mar\\/08 17:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Mike for guiding me through this issue and for the commit. \\nI will submit follow up patch to address your comments. \\n\\n Upgrade tests and also the tests related to indexes you had suggested are part of   DERBY-3456  .               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575261\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575261&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575261\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575261_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575261_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/08 07:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-05T07:55:01+0000\'\u003e05\\/Mar\\/08 07:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003edescription of derby-3330-UpgradeTests.diff \u003c\\/p\u003e\\n\\n\u003cp\u003eThis patch has following tests\u003c\\/p\u003e\\n\\n\u003cp\u003etests for unique constraint\u003cbr\\/\u003e\\n1. Create a unique constraint in lower version of derby\u003cbr\\/\u003e\\n2. Test the above constraint in soft upgrade mode.\u003cbr\\/\u003e\\n3. create a new unique constraint in soft upgrade mode.: Shouldn\'t able to create   \u003cbr\\/\u003e\\n    unique constraint over nullable columns.\u003cbr\\/\u003e\\n4. test the above constraint in post soft upgrade mode (running under lower version)\u003c\\/p\u003e\\n\\n\u003cp\u003etests for index\u003cbr\\/\u003e\\nThis test is for indexes in different modes. Different types are indexes are created \u003cbr\\/\u003e\\nduring\u003cbr\\/\u003e\\n1. Create (running under older version)\u003cbr\\/\u003e\\n2. Soft Upgrade mode\u003cbr\\/\u003e\\n3. Post soft upgrade mode \u003cbr\\/\u003e\\n4. Hard upgrade mode\u003c\\/p\u003e\\n\\n\u003cp\u003eIn all these phases the indexes created in previous phases are tested.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe types of indexes created in each phases are \u003cbr\\/\u003e\\n1. Unique index over not null field\u003cbr\\/\u003e\\n2. Unique Index over null able field\u003cbr\\/\u003e\\n3. Non Unique constraint over not null field\u003cbr\\/\u003e\\n4. Non Unique constraint over null able field.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575261_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575261_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/08 07:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-05T07:55:01+0000\'\u003e05\\/Mar\\/08 07:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    description of derby-3330-UpgradeTests.diff  \\n\\n This patch has following tests \\n\\n tests for unique constraint \\n1. Create a unique constraint in lower version of derby \\n2. Test the above constraint in soft upgrade mode. \\n3. create a new unique constraint in soft upgrade mode.: Shouldn\'t able to create    \\n    unique constraint over nullable columns. \\n4. test the above constraint in post soft upgrade mode (running under lower version) \\n\\n tests for index \\nThis test is for indexes in different modes. Different types are indexes are created  \\nduring \\n1. Create (running under older version) \\n2. Soft Upgrade mode \\n3. Post soft upgrade mode  \\n4. Hard upgrade mode \\n\\n In all these phases the indexes created in previous phases are tested. \\n\\n The types of indexes created in each phases are  \\n1. Unique index over not null field \\n2. Unique Index over null able field \\n3. Non Unique constraint over not null field \\n4. Non Unique constraint over null able field.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575436\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575436&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575436\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575436_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575436_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/08 17:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-05T17:58:37+0000\'\u003e05\\/Mar\\/08 17:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCreateIndexConstantAction.java -\u003cbr\\/\u003e\\n    use of properties? Some of the existing code seems to sometimes expect\u003cbr\\/\u003e\\n    a properties passed in. Your new code will overwrite the saved copy of\u003cbr\\/\u003e\\n    the properties to pass needed info to the new sort routine. I don\'t\u003cbr\\/\u003e\\n    know when a property may be passed in and lost. I think you just want\u003cbr\\/\u003e\\n    to create a new variable for sort_properties.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis piece of code is unnecessary. I had added it initially for some debugging\u003cbr\\/\u003e\\n purpose and forgot to remove.  Sorry about it. I will take it off.\u003c\\/p\u003e\\n\\n\u003cp\u003esort changes\u003cbr\\/\u003e\\n    I don\'t like that the implementation of unique merge sort knows about\u003cbr\\/\u003e\\n    row location last column. The intent of the sorted is to be somewhat\u003cbr\\/\u003e\\n    general purpose so it would be better to somehow encode that info into\u003cbr\\/\u003e\\n    the startup parameters. I think the null special handling is located\u003cbr\\/\u003e\\n    in the right place, ie. in the new sort impl.\u003c\\/p\u003e\\n\\n\u003cp\u003e    A comment explaining the why of these 2 lines would be nice in\u003cbr\\/\u003e\\n    UniqueWithDuplicateNullMergeSort.java would be nice.\u003c\\/p\u003e\\n\\n\u003cp\u003e    if (i == colsToCompare - 1 &amp;&amp; nonull)\u003cbr\\/\u003e\\n            return 0;\u003c\\/p\u003e\\n\\n\u003cp\u003eI will add comment in my follow up patch and will also check how can I make sort \u003cbr\\/\u003e\\nindependent of information about location.\u003c\\/p\u003e\\n\\n\u003cp\u003eBTreeController.java\u003cbr\\/\u003e\\n    Can the second call to the following code be optimized, is it necessary?\u003cbr\\/\u003e\\n    maybe a comment here would help.\u003c\\/p\u003e\\n\\n\u003cp\u003e    if (getConglomerate().isUniqueWithDuplicateNulls()) \u003c\\/p\u003e\\n{\\n        int ret = compareLeftAndRightSiblings(rowToInsert,\\n                    insert_slot, targetleaf);\\n        if (ret == MATCH_FOUND)\\n                    return ConglomerateController.ROWISDUPLICATE;\\n        if (ret == RESCAN_REQUIRED)\\n                    continue;\\n    }\\n\\n\u003cp\u003eIt shouldn\'t return from this code but should set \u003cbr\\/\u003e\\nreturn value to ConglomerateController.ROWISDUPLICATE, so that necessary cleanup of latch\u003cbr\\/\u003e\\n is performed. \u003c\\/p\u003e\\n\\n\u003cp\u003eB2I.java\u003cbr\\/\u003e\\n    I updated the upgrade comments, especially for the change in behavior for\u003cbr\\/\u003e\\n    the 10.3 formats. You should review these to make sure they are what\u003cbr\\/\u003e\\n    you expect.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt looks good. Its exact description of what will happen during soft \u003cbr\\/\u003e\\nand hard upgrade. Thanks a lot for adding this.\u003c\\/p\u003e\\n\\n\u003cp\u003eIndexDescriptorImpl.java\u003cbr\\/\u003e\\n    Should change following to match new naming:\u003cbr\\/\u003e\\n    sb.append (\\\"ALMOST UNIQUE\\\");\u003c\\/p\u003e\\n\\n\u003cp\u003eI will change this.\u003c\\/p\u003e\\n\\n\u003cp\u003e    The following is a wrong (repeated same test), but I didn\'t change -\u003cbr\\/\u003e\\n    wanted to give you a chance to look at it. Not sure what it affects, if\u003cbr\\/\u003e\\n    it is a bug would be nice to have a test case that shows the problem.\u003c\\/p\u003e\\n\\n\u003cp\u003e    Wasn\'t sure if it wanted another different term, probably wants to be a\u003cbr\\/\u003e\\n    test for the new attribute.\u003c\\/p\u003e\\n\\n\u003cp\u003e    if ((id.isUnique == this.isUnique) &amp;&amp;\u003cbr\\/\u003e\\n            (id.isUnique == this.isUnique) &amp;&amp;\u003c\\/p\u003e\\n\\n\u003cp\u003eThis should be checking for uniqueWithDuplicateNull. I will update it.\u003c\\/p\u003e\\n\\n\u003cp\u003eBTreeController.java\u003cbr\\/\u003e\\n    I think there may be some edge case stuff missing from the searches, I\u003cbr\\/\u003e\\n    will look more later, but it looks like a good basis for the new\u003cbr\\/\u003e\\n    functionality so rather see it get checked in and more eyes on it.\u003cbr\\/\u003e\\n    Again now that new searches only happen on new nullable constraints there\u003cbr\\/\u003e\\n    is less risk to existing functionality.\u003c\\/p\u003e\\n\\n\u003cp\u003eI will go though the code and try to identify the problem areas.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eI don\'t see upgrade tests, are they in a different JIRA\\/patch?\u003c\\/p\u003e\\n\\n\u003cp\u003eI have attached tests in derby-3330-UpgradeTests.diff\u003c\\/p\u003e\\n\\n\u003cp\u003eI am working on the followup patch and will upload it asap.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575436_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575436_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'05\\/Mar\\/08 17:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-05T17:58:37+0000\'\u003e05\\/Mar\\/08 17:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    CreateIndexConstantAction.java - \\n    use of properties? Some of the existing code seems to sometimes expect \\n    a properties passed in. Your new code will overwrite the saved copy of \\n    the properties to pass needed info to the new sort routine. I don\'t \\n    know when a property may be passed in and lost. I think you just want \\n    to create a new variable for sort_properties. \\n\\n This piece of code is unnecessary. I had added it initially for some debugging \\n purpose and forgot to remove.  Sorry about it. I will take it off. \\n\\n sort changes \\n    I don\'t like that the implementation of unique merge sort knows about \\n    row location last column. The intent of the sorted is to be somewhat \\n    general purpose so it would be better to somehow encode that info into \\n    the startup parameters. I think the null special handling is located \\n    in the right place, ie. in the new sort impl. \\n\\n     A comment explaining the why of these 2 lines would be nice in \\n    UniqueWithDuplicateNullMergeSort.java would be nice. \\n\\n     if (i == colsToCompare - 1 &amp;&amp; nonull) \\n            return 0; \\n\\n I will add comment in my follow up patch and will also check how can I make sort  \\nindependent of information about location. \\n\\n BTreeController.java \\n    Can the second call to the following code be optimized, is it necessary? \\n    maybe a comment here would help. \\n\\n     if (getConglomerate().isUniqueWithDuplicateNulls())  \\n{\\n        int ret = compareLeftAndRightSiblings(rowToInsert,\\n                    insert_slot, targetleaf);\\n        if (ret == MATCH_FOUND)\\n                    return ConglomerateController.ROWISDUPLICATE;\\n        if (ret == RESCAN_REQUIRED)\\n                    continue;\\n    }\\n\\n It shouldn\'t return from this code but should set  \\nreturn value to ConglomerateController.ROWISDUPLICATE, so that necessary cleanup of latch \\n is performed.  \\n\\n B2I.java \\n    I updated the upgrade comments, especially for the change in behavior for \\n    the 10.3 formats. You should review these to make sure they are what \\n    you expect. \\n\\n It looks good. Its exact description of what will happen during soft  \\nand hard upgrade. Thanks a lot for adding this. \\n\\n IndexDescriptorImpl.java \\n    Should change following to match new naming: \\n    sb.append (\\\"ALMOST UNIQUE\\\"); \\n\\n I will change this. \\n\\n     The following is a wrong (repeated same test), but I didn\'t change - \\n    wanted to give you a chance to look at it. Not sure what it affects, if \\n    it is a bug would be nice to have a test case that shows the problem. \\n\\n     Wasn\'t sure if it wanted another different term, probably wants to be a \\n    test for the new attribute. \\n\\n     if ((id.isUnique == this.isUnique) &amp;&amp; \\n            (id.isUnique == this.isUnique) &amp;&amp; \\n\\n This should be checking for uniqueWithDuplicateNull. I will update it. \\n\\n BTreeController.java \\n    I think there may be some edge case stuff missing from the searches, I \\n    will look more later, but it looks like a good basis for the new \\n    functionality so rather see it get checked in and more eyes on it. \\n    Again now that new searches only happen on new nullable constraints there \\n    is less risk to existing functionality. \\n\\n I will go though the code and try to identify the problem areas. \\n\\n\\n I don\'t see upgrade tests, are they in a different JIRA\\/patch? \\n\\n I have attached tests in derby-3330-UpgradeTests.diff \\n\\n I am working on the followup patch and will upload it asap.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575709\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575709&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575709\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575709_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575709_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 13:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T13:51:31+0000\'\u003e06\\/Mar\\/08 13:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIssues addressed in derby-3330_followup_1.diff\u003c\\/p\u003e\\n\\n\u003cp\u003eCreateIndexConstantAction.java \u003c\\/p\u003e\\n\\n\u003cp\u003eI have changed the name of the variable and added comment to explain what its meant for.\u003cbr\\/\u003e\\nI got confused while commenting last time. This property is required if \u003cbr\\/\u003e\\nTransactionCoordinator has to select the non default Sorter.\u003c\\/p\u003e\\n\\n\u003cp\u003esort changes\u003c\\/p\u003e\\n\\n\u003cp\u003eI have updated compare method and it doesn\'t need to assume location column. But it still\u003cbr\\/\u003e\\nhas information about nulls not being equal. \u003cbr\\/\u003e\\nI am checking how to remove this information from comparison. It appears to me that I can remove \u003cbr\\/\u003e\\nthis custom compare method and use the existing but that miy need some change which might effect \u003cbr\\/\u003e\\nother part of code.I will wait for 10.4 branching and will work for it in the trunk.\u003c\\/p\u003e\\n\\n\\n\\n\u003cp\u003eBTreeController.java\u003c\\/p\u003e\\n\\n\u003cp\u003eI haven\'t optimized it yet. But instead of returning error code setting the ret value so the latch \u003cbr\\/\u003e\\nis cleared before return.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eIndexDescriptorImpl.java\u003c\\/p\u003e\\n\\n\u003cp\u003eUpdated both the place (using new name in toString () and using the new attribute in equals methods).\u003c\\/p\u003e\\n\\n\u003cp\u003eBTreeController.java\u003cbr\\/\u003e\\nI am still checking it out and will submit new follow up if I find any problem areas.\u003c\\/p\u003e\\n\\n\u003cp\u003ejunit suites.All is running without any failure with this patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575709_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575709_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 13:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T13:51:31+0000\'\u003e06\\/Mar\\/08 13:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Issues addressed in derby-3330_followup_1.diff \\n\\n CreateIndexConstantAction.java  \\n\\n I have changed the name of the variable and added comment to explain what its meant for. \\nI got confused while commenting last time. This property is required if  \\nTransactionCoordinator has to select the non default Sorter. \\n\\n sort changes \\n\\n I have updated compare method and it doesn\'t need to assume location column. But it still \\nhas information about nulls not being equal.  \\nI am checking how to remove this information from comparison. It appears to me that I can remove  \\nthis custom compare method and use the existing but that miy need some change which might effect  \\nother part of code.I will wait for 10.4 branching and will work for it in the trunk. \\n\\n\\n\\n BTreeController.java \\n\\n I haven\'t optimized it yet. But instead of returning error code setting the ret value so the latch  \\nis cleared before return. \\n\\n\\n IndexDescriptorImpl.java \\n\\n Updated both the place (using new name in toString () and using the new attribute in equals methods). \\n\\n BTreeController.java \\nI am still checking it out and will submit new follow up if I find any problem areas. \\n\\n junit suites.All is running without any failure with this patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575824\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575824&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575824\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575824_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575824_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 18:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T18:46:01+0000\'\u003e06\\/Mar\\/08 18:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUpdated implementation doc\u003cbr\\/\u003e\\nAdded a section about shared backing index.\u003cbr\\/\u003e\\nAdded a section about making column nullable\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575824_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575824_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 18:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T18:46:01+0000\'\u003e06\\/Mar\\/08 18:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Updated implementation doc \\nAdded a section about shared backing index. \\nAdded a section about making column nullable              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575835\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575835&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575835\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575835_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575835_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 19:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T19:08:47+0000\'\u003e06\\/Mar\\/08 19:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI am currently looking at the new patches in this issue and will commit as appropriate after review and running tests.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575835_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575835_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 19:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T19:08:47+0000\'\u003e06\\/Mar\\/08 19:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I am currently looking at the new patches in this issue and will commit as appropriate after review and running tests.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575854\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575854&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575854\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575854_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575854_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 19:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T19:50:27+0000\'\u003e06\\/Mar\\/08 19:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIn the derby-3330_followup_1.diff I don\'t think the sort changes will work correctly.  In the \u003cbr\\/\u003e\\n uniqueWithDuplicateNulls we need the sorter to sort on the rowlocation column also in the \u003cbr\\/\u003e\\ncase where there are 2 rows that otherwise are duplicate by store null comparison standards.\u003cbr\\/\u003e\\nImagine the case of a table with a single column nullable index that has a million rows all\u003cbr\\/\u003e\\nwith null.  Order does not really matter for user, but when the base row is deleted the system\u003cbr\\/\u003e\\nwill want to exactly find the matching (null, (page 5, row7)) index entry and if the rows are not\u003cbr\\/\u003e\\nproperly sorted on the row location then the btree search for this row will probably fail.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo what we want from sorter if N is the number of columns including the row location column:\u003cbr\\/\u003e\\n1) sort on N columns\u003cbr\\/\u003e\\n2) if any column has a null don\'t do any duplicate checking\u003cbr\\/\u003e\\n3) if no column has a null then duplicate checking based on leading N-1 columns\u003c\\/p\u003e\\n\\n\u003cp\u003eIt would nice to have a test that verified the sorting is correct when there are many duplicate nulls.  It is a little \u003cbr\\/\u003e\\ntricky to get a good test case as the normal case is for rows scanned from a heap to build an index to have \u003cbr\\/\u003e\\nrowlocations in ascending order - but we should not be counting on that.   I will have to think about this.  I don\'t\u003cbr\\/\u003e\\nknow if once you get the sorter to go external with multiple merge runs I think it will shuffle the rows from input\u003cbr\\/\u003e\\norder based on what sort keys you told it to consider.   We should verify that the existing checked in code handles\u003cbr\\/\u003e\\nthis case correctly.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575854_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575854_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 19:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T19:50:27+0000\'\u003e06\\/Mar\\/08 19:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    In the derby-3330_followup_1.diff I don\'t think the sort changes will work correctly.  In the  \\n uniqueWithDuplicateNulls we need the sorter to sort on the rowlocation column also in the  \\ncase where there are 2 rows that otherwise are duplicate by store null comparison standards. \\nImagine the case of a table with a single column nullable index that has a million rows all \\nwith null.  Order does not really matter for user, but when the base row is deleted the system \\nwill want to exactly find the matching (null, (page 5, row7)) index entry and if the rows are not \\nproperly sorted on the row location then the btree search for this row will probably fail. \\n\\n So what we want from sorter if N is the number of columns including the row location column: \\n1) sort on N columns \\n2) if any column has a null don\'t do any duplicate checking \\n3) if no column has a null then duplicate checking based on leading N-1 columns \\n\\n It would nice to have a test that verified the sorting is correct when there are many duplicate nulls.  It is a little  \\ntricky to get a good test case as the normal case is for rows scanned from a heap to build an index to have  \\nrowlocations in ascending order - but we should not be counting on that.   I will have to think about this.  I don\'t \\nknow if once you get the sorter to go external with multiple merge runs I think it will shuffle the rows from input \\norder based on what sort keys you told it to consider.   We should verify that the existing checked in code handles \\nthis case correctly.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575860\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575860&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575860\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575860_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575860_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 20:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T20:11:15+0000\'\u003e06\\/Mar\\/08 20:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003elooking at it more carefully, would it be possible to not have any sorter changes and handle the required functionality in the\u003cbr\\/\u003e\\nnew UniqueWithDuplicateNullsIndexSortObserver ?  Basically use the existing sorter to sort on all columns and then in the observer look at each row and if it has a null let it through.  If it doesn\'t have a null compare it with the next row and throw an error if it has a duplicate violation?   I know there is some existing code for doing this kind of compare - see \u003cbr\\/\u003e\\nCardinalityCounter.java.  \u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575860_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575860_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 20:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T20:11:15+0000\'\u003e06\\/Mar\\/08 20:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    looking at it more carefully, would it be possible to not have any sorter changes and handle the required functionality in the \\nnew UniqueWithDuplicateNullsIndexSortObserver ?  Basically use the existing sorter to sort on all columns and then in the observer look at each row and if it has a null let it through.  If it doesn\'t have a null compare it with the next row and throw an error if it has a duplicate violation?   I know there is some existing code for doing this kind of compare - see  \\nCardinalityCounter.java.   \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575862\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575862&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575862\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575862_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575862_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 20:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T20:15:42+0000\'\u003e06\\/Mar\\/08 20:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Mike for the review.\u003c\\/p\u003e\\n\\n\u003cp\u003eLooks like the earlier (before the follow up changes) sorter routine was doing right thing. \u003cbr\\/\u003e\\nif had same compare routine from UniqueSort with additional entry for non nulls at the beginning of comparison loop \u003c\\/p\u003e\\n\\n\u003cp\u003e            if (i == colsToCompare - 1 &amp;&amp; nonull)\u003cbr\\/\u003e\\n                return 0;\u003c\\/p\u003e\\n\\n\u003cp\u003eSo if the comparison has reached till the last entry (location) and there is no null found so far it will consider the rows as duplicate. If one of the part was null (nonull will be false) the it will go ahead and compare the location too. \u003c\\/p\u003e\\n\\n\u003cp\u003eI will revert this change from the follow up patch and update sorting with comments in my new follow up patch. \u003c\\/p\u003e\\n\\n\u003cp\u003eI will also try to come up with a good tests for scenario you explained. \u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575862_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575862_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 20:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T20:15:42+0000\'\u003e06\\/Mar\\/08 20:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Mike for the review. \\n\\n Looks like the earlier (before the follow up changes) sorter routine was doing right thing.  \\nif had same compare routine from UniqueSort with additional entry for non nulls at the beginning of comparison loop  \\n\\n             if (i == colsToCompare - 1 &amp;&amp; nonull) \\n                return 0; \\n\\n So if the comparison has reached till the last entry (location) and there is no null found so far it will consider the rows as duplicate. If one of the part was null (nonull will be false) the it will go ahead and compare the location too.  \\n\\n I will revert this change from the follow up patch and update sorting with comments in my new follow up patch.  \\n\\n I will also try to come up with a good tests for scenario you explained.  \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575863\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575863&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575863\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575863_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575863_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 20:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T20:21:51+0000\'\u003e06\\/Mar\\/08 20:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003elooking at it more carefully, would it be possible to not have any sorter changes and handle the required functionality in the\u003cbr\\/\u003e\\nnew UniqueWithDuplicateNullsIndexSortObserver ?\u003c\\/p\u003e\\n\\n\u003cp\u003eI think it can be done. I started to do this initially but I was getting some assertion failures at a different location (while constructing the BTree). I am sure it would have been a small issue to fix but I felt little nervous about changing something which might effect some other functionality. I plan to work on it but after the 10.4 branch is separated from trunk. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575863_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575863_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 20:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T20:21:51+0000\'\u003e06\\/Mar\\/08 20:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    looking at it more carefully, would it be possible to not have any sorter changes and handle the required functionality in the \\nnew UniqueWithDuplicateNullsIndexSortObserver ? \\n\\n I think it can be done. I started to do this initially but I was getting some assertion failures at a different location (while constructing the BTree). I am sure it would have been a small issue to fix but I felt little nervous about changing something which might effect some other functionality. I plan to work on it but after the 10.4 branch is separated from trunk.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575872\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575872&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575872\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575872_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575872_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 20:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T20:34:15+0000\'\u003e06\\/Mar\\/08 20:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere is the modified followup patch that I am looking at committing if it passes tests - tests running now.  It has all your followup changes except the sorter changes.  It has some spelling\\/comment fixes also.  \u003cbr\\/\u003e\\nIf no other problems are found with existing sorter implementation I am ok leaving it for now the way it is, if there are new problems I think the sort observer solution is cleaner for the future.\u003c\\/p\u003e\\n\\n\u003cp\u003eIf you have some added comments for the sorter file just submit them as a separate patch, and I can commit those easily without worrying about test running.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575872_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575872_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 20:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T20:34:15+0000\'\u003e06\\/Mar\\/08 20:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here is the modified followup patch that I am looking at committing if it passes tests - tests running now.  It has all your followup changes except the sorter changes.  It has some spelling\\/comment fixes also.   \\nIf no other problems are found with existing sorter implementation I am ok leaving it for now the way it is, if there are new problems I think the sort observer solution is cleaner for the future. \\n\\n If you have some added comments for the sorter file just submit them as a separate patch, and I can commit those easily without worrying about test running.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575882\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575882&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575882\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575882_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575882_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T20:57:01+0000\'\u003e06\\/Mar\\/08 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAdded comments in UniqueWithDuplicateNullsMergeSort.java\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"anurag\\\" id=\\\"commentauthor_12575882_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=anurag\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"anurag\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Anurag Shekhar\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575882_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 20:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T20:57:01+0000\'\u003e06\\/Mar\\/08 20:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Added comments in UniqueWithDuplicateNullsMergeSort.java              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12575928\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12575928&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12575928\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575928_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575928_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 22:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T22:35:18+0000\'\u003e06\\/Mar\\/08 22:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ei have committed a modified version of the sortercomments.diff patch.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12575928_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12575928_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Mar\\/08 22:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-06T22:35:18+0000\'\u003e06\\/Mar\\/08 22:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    i have committed a modified version of the sortercomments.diff patch.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12576041\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12576041&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12576041\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12576041_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12576041_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Mar\\/08 05:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-07T05:21:36+0000\'\u003e07\\/Mar\\/08 05:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have committed the derby-3330_followup_1_modified.diff patch to the trunk.  I believe this is the last outstanding patch for this JIRA, so unchecking patch available.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12576041_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12576041_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Mar\\/08 05:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-07T05:21:36+0000\'\u003e07\\/Mar\\/08 05:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have committed the derby-3330_followup_1_modified.diff patch to the trunk.  I believe this is the last outstanding patch for this JIRA, so unchecking patch available.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12583451\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12583451&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12583451\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12583451_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12583451_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Mar\\/08 14:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-30T14:51:45+0000\'\u003e30\\/Mar\\/08 14:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI came across this interesting discussion of the behavior of NULLs and UNIQUE constraints\u003cbr\\/\u003e\\nin various database systems, and thought it might be interesting in the context of this\u003cbr\\/\u003e\\ndiscussion: \u003ca href=\\\"http:\\/\\/www.sqlite.org\\/nulls.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.sqlite.org\\/nulls.html\u003c\\/a\u003e\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12583451_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12583451_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Mar\\/08 14:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-03-30T14:51:45+0000\'\u003e30\\/Mar\\/08 14:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I came across this interesting discussion of the behavior of NULLs and UNIQUE constraints \\nin various database systems, and thought it might be interesting in the context of this \\ndiscussion:  http:\\/\\/www.sqlite.org\\/nulls.html  \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12626501\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12626501&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12626501\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_12626501_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12626501_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Aug\\/08 09:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-08-28T09:23:51+0000\'\u003e28\\/Aug\\/08 09:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eDoes anyone know the status of this issue and it sub issues?\u003cbr\\/\u003e\\nHas the work been completed, so that the Jiras can be resolved\\/closed? (update fix version as well)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_12626501_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12626501_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Aug\\/08 09:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-08-28T09:23:51+0000\'\u003e28\\/Aug\\/08 09:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Does anyone know the status of this issue and it sub issues? \\nHas the work been completed, so that the Jiras can be resolved\\/closed? (update fix version as well)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12638529\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12638529&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12638529\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"sola\\\" id=\\\"commentauthor_12638529_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=sola\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"sola\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Andras Soltesz\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12638529_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Oct\\/08 10:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-10-10T10:43:32+0000\'\u003e10\\/Oct\\/08 10:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eDoes anyone know when this and  \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-2212\\\" title=\\\"Add &quot;Unique where not null&quot; to create index\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-2212\\\"\u003eDERBY-2212\u003c\\/a\u003e make it to a release?\u003c\\/p\u003e\\n\\n\u003cp\u003eThis is a very important part of functionality and it is really bad that it is not Oracle\\/PostgreSQL compliant, since Derby is often used as a development database or single-user production database in applications which use Oracle\\/PostgreSQL for multi-user production databases. With a behavioral difference like this, Derby cannot be used in this scenario since those apps usually complex enough to use this db feature.\u003c\\/p\u003e\\n\\n\u003cp\u003eI just bumped into it when my application became complex enough to use unique indexes on NULLable columns. I have used the oracle-like unique index behavior since ages on Oracle and PG and now I don\'t know how to support it on Derby. Obviously, it can be replaced only with complex application logic.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"sola\\\" id=\\\"commentauthor_12638529_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=sola\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"sola\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Andras Soltesz\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12638529_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Oct\\/08 10:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-10-10T10:43:32+0000\'\u003e10\\/Oct\\/08 10:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Does anyone know when this and   DERBY-2212  make it to a release? \\n\\n This is a very important part of functionality and it is really bad that it is not Oracle\\/PostgreSQL compliant, since Derby is often used as a development database or single-user production database in applications which use Oracle\\/PostgreSQL for multi-user production databases. With a behavioral difference like this, Derby cannot be used in this scenario since those apps usually complex enough to use this db feature. \\n\\n I just bumped into it when my application became complex enough to use unique indexes on NULLable columns. I have used the oracle-like unique index behavior since ages on Oracle and PG and now I don\'t know how to support it on Derby. Obviously, it can be replaced only with complex application logic.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12638532\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12638532&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12638532\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_12638532_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12638532_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Oct\\/08 10:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-10-10T10:57:53+0000\'\u003e10\\/Oct\\/08 10:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHave you tried the 10.4.2.0 release?\u003cbr\\/\u003e\\nThe functionality made it into 10.4, see release notes \u003ca href=\\\"http:\\/\\/db.apache.org\\/derby\\/releases\\/release-10.4.1.3.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/db.apache.org\\/derby\\/releases\\/release-10.4.1.3.html\u003c\\/a\u003e - \\\"New Features\\\".\u003c\\/p\u003e\\n\\n\u003cp\u003eHowever, I think the relevant issues in Jira are a bit out of sync with the reality, which is why I raised the issue of updating them.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_12638532_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12638532_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Oct\\/08 10:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-10-10T10:57:53+0000\'\u003e10\\/Oct\\/08 10:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Have you tried the 10.4.2.0 release? \\nThe functionality made it into 10.4, see release notes  http:\\/\\/db.apache.org\\/derby\\/releases\\/release-10.4.1.3.html  - \\\"New Features\\\". \\n\\n However, I think the relevant issues in Jira are a bit out of sync with the reality, which is why I raised the issue of updating them.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12638597\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12638597&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12638597\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12638597_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12638597_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Oct\\/08 17:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-10-10T17:31:14+0000\'\u003e10\\/Oct\\/08 17:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI committed a bunch of this work.  I believe this can be resolved\\/closed with all the work checked into 10.4.  \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12638597_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12638597_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Oct\\/08 17:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-10-10T17:31:14+0000\'\u003e10\\/Oct\\/08 17:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I committed a bunch of this work.  I believe this can be resolved\\/closed with all the work checked into 10.4.                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12698634\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=12698634&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12698634\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"myrna\\\" id=\\\"commentauthor_12698634_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=myrna\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"myrna\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Myrna van Lunteren\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12698634_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/09 02:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2009-04-14T02:58:38+0000\'\u003e14\\/Apr\\/09 02:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAs the functionality made it into 10.4.1.3, marking as fixed in 10.4.1.3.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"myrna\\\" id=\\\"commentauthor_12698634_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=myrna\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"myrna\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Myrna van Lunteren\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12698634_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/09 02:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2009-04-14T02:58:38+0000\'\u003e14\\/Apr\\/09 02:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    As the functionality made it into 10.4.1.3, marking as fixed in 10.4.1.3.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13831879\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3330?focusedCommentId=13831879&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13831879\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13831879_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13831879_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Nov\\/13 20:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-11-25T20:30:48+0000\'\u003e25\\/Nov\\/13 20:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1545394 from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dagw\\\" class=\\\"user-hover\\\" rel=\\\"dagw\\\"\u003eDag H. Wanvik\u003c\\/a\u003e in branch \'code\\/trunk\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1545394\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1545394\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-532\\\" title=\\\"Support deferrable constraints\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-532\\\"\u003e\u003cdel\u003eDERBY-532\u003c\\/del\u003e\u003c\\/a\u003e Support deferrable constraints\u003c\\/p\u003e\\n\\n\u003cp\u003ePatch derby-532-post-scan-4 implements basic support for deferred\u003cbr\\/\u003e\\nconstraints for PRIMARY KEY and UNIQUE constraints. Deferrable\u003cbr\\/\u003e\\nconstraints are not enabled by default yet; one needs to set a\u003cbr\\/\u003e\\nproperty to try the feature: \\\"derby.constraintsTesting\\\".\u003c\\/p\u003e\\n\\n\u003cp\u003eThis patch enables deferred constraints for:\u003c\\/p\u003e\\n\\n\u003cp\u003e    a) primary key constraints\u003cbr\\/\u003e\\n    b) unique constraint with not nullable columns\u003cbr\\/\u003e\\n    c) unique constraint with nullable columns\u003c\\/p\u003e\\n\\n\u003cp\u003eby new logic in insertion and sorts.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe patch includes relaxing the constraint at insertion and update\u003cbr\\/\u003e\\ntime, as well as adding a constraint to an existing table. \u003c\\/p\u003e\\n\\n\u003cp\u003eDerby treats constraints a) and b) the same, and in the code these are\u003cbr\\/\u003e\\nmarked as \\\"unique\\\" when they are not deferrable (as in existing code).\u003c\\/p\u003e\\n\\n\u003cp\u003eConstraint type c) is currently marked as\u003cbr\\/\u003e\\n\\\"uniqueWithDuplicateNulls\\\". Insert\\/update of these is implemented in\u003cbr\\/\u003e\\nthe BTree by including the RowLocation of the base row in the set of\u003cbr\\/\u003e\\nkeys in the index row (\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3330\\\" title=\\\"provide support for unique constraint over keys that include one or more nullable columns.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3330\\\"\u003e\u003cdel\u003eDERBY-3330\u003c\\/del\u003e\u003c\\/a\u003e). This makes them trivially unique,\u003cbr\\/\u003e\\nbut there is an extra code path in BTreeController that checks\u003cbr\\/\u003e\\nneighbor rows for duplicates, and only allows insertion if the key\u003cbr\\/\u003e\\ncontains a null. When adding a constraint to an existing table, these\u003cbr\\/\u003e\\nare handled by a specially crafted sorter\u003cbr\\/\u003e\\n(UniqueWithDuplicateNullsMergeSort).\u003c\\/p\u003e\\n\\n\u003cp\u003eThe implementation of insert\\/update of deferrable indexes is based on\u003cbr\\/\u003e\\na similar approach, i.e. by backing with a non-unique index, and checking \u003cbr\\/\u003e\\nduplicates in the language layer, notably IndexChanger.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn IndexChanger, after inserting a row, we check if it is unique by\u003cbr\\/\u003e\\nperforming a scan of the BTree. A time-out here leads to a pessimistic\u003cbr\\/\u003e\\nassumption that there is a duplicate. Duplicate key values are saved\u003cbr\\/\u003e\\nuntil checking time (usually commit time), when a new scan is\u003cbr\\/\u003e\\nperformed to validate the uniqueness property.\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003cspan class=\\\"error\\\"\u003e&#91;This means a) and b) if deferrable are no longer marked &quot;unique&quot;&#93;\u003c\\/span\u003e.\u003c\\/p\u003e\\n\\n\u003cp\u003eDeferrable indexes are not shared.\u003c\\/p\u003e\\n\\n\u003cp\u003eIf there are duplicates and we have deferred constraint mode (a\u003cbr\\/\u003e\\ndynamic session property), we save the duplicate index row in a disk\u003cbr\\/\u003e\\nbased hash table (DeferredDuplicates#rememberDuplicate).\u003c\\/p\u003e\\n\\n\u003cp\u003eFor a) and b), constraints which are deferrable are marked as\u003cbr\\/\u003e\\n\\\"uniqueDeferrable\\\" and \\\"hasDeferrableChecking\\\". Constraints of type c)\u003cbr\\/\u003e\\nwhich are deferrable are marked \\\"uniqueWithDuplicateNulls\\\" and\u003cbr\\/\u003e\\n\\\"hasDeferrableChecking\\\". These marks determines the code paths\u003cbr\\/\u003e\\nused. Note that existing indexes and non-deferrable constraint do not\u003cbr\\/\u003e\\nget a new code path, which should preserve correctness and performance\u003cbr\\/\u003e\\nof those.\u003c\\/p\u003e\\n\\n\u003cp\u003eNow, with these markers in place, deferral of checks happens in three\u003cbr\\/\u003e\\nplaces:\u003c\\/p\u003e\\n\\n\u003cp\u003e    {{ IndexChanger#insertAndCheckDups}}\u003c\\/p\u003e\\n\\n\u003cp\u003e    {{CreateIndexConstantAction#executeConstantAction +\u003cbr\\/\u003e\\n     MergeSort#compare and UniqueWithDuplicateNullsMergeSort#compare }}\u003c\\/p\u003e\\n\\n\u003cp\u003e    \u003ctt\u003eInsertResultSet#setUpAllSorts\u003c\\/tt\u003e\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eThe former is active for deferral under INSERT and UPDATE. The middle\u003cbr\\/\u003e\\nwhen adding a deferrable constraint to an existing table, when we sort\u003cbr\\/\u003e\\nexisting rows detecting any duplicates. The last is used when importing\u003cbr\\/\u003e\\nrows.\u003c\\/p\u003e\\n\\n\u003cp\u003eAt transaction commit (1), or when the constraint mode for a deferred\u003cbr\\/\u003e\\nconstraint is changed back to immediate (2), we validate the\u003cbr\\/\u003e\\nconstraint (DeferredDuplicates#validate) by replaying the hash table\u003cbr\\/\u003e\\nand scanning the index for the duplicate index rows to ascertain there\u003cbr\\/\u003e\\nare none, or else we have an error: transaction or statement severity\u003cbr\\/\u003e\\nrespectively for (1) and (2).\u003c\\/p\u003e\\n\\n\u003cp\u003eThe constraint mode is a SQL session level variable, and inside\u003cbr\\/\u003e\\nroutines (nested connections), we push this on the stack. This means\u003cbr\\/\u003e\\nchange of the constraint mode inside nested connections will be popped\u003cbr\\/\u003e\\non routine exit. If, as part of this, a constraint changes from\u003cbr\\/\u003e\\ndeferred to immediate mode, we also validate it for correctness. If\u003cbr\\/\u003e\\nthis fail, the transaction rolls back\u003cbr\\/\u003e\\nWe needed to do this from a newly introduced method,\u003cbr\\/\u003e\\nGenericLanguageConnectionContext#popNestedSessionContext. This\u003cbr\\/\u003e\\npops the SQL session context.\u003cbr\\/\u003e\\nThat hook is called from GenericPreparedStatement#executeStmt. As a\u003cbr\\/\u003e\\npart of this effort, we also renamed #setupNestedSessionContext to\u003cbr\\/\u003e\\n#pushNestedSessionContext.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe patch also adds support for checking deferred constraints in\u003cbr\\/\u003e\\nxa_prepare and xa_commit (.., true), cf. specification attached to the\u003cbr\\/\u003e\\nJIRA issue.\u003c\\/p\u003e\\n\\n\u003cp\u003eConcurrency: if a transaction gets a lock time-out when trying to\u003cbr\\/\u003e\\nestablish if a row just inserted is a duplicate (another transaction\u003cbr\\/\u003e\\nmay have just inserted a row with a similar index key), we use a\u003cbr\\/\u003e\\npessimistics assumption and add that key to the set of keys to be\u003cbr\\/\u003e\\nchecked at commit time. If a key can\'t be grabbed then, a time-out is\u003cbr\\/\u003e\\nthrown. We plan to add an optimized scan to avoid waiting for the lock\u003cbr\\/\u003e\\nat insertion time, cf \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-6419\\\" title=\\\"Make BTree scan honor  OPENMODE_LOCK_NOWAIT for row locks.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-6419\\\"\u003e\u003cdel\u003eDERBY-6419\u003c\\/del\u003e\u003c\\/a\u003e.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe \\\"not enforced\\\" feature is not yet implemented in this patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eSeveral new test cases been added to ConstraintCharacteristicsTest to\u003cbr\\/\u003e\\ntest these basic behaviors.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13831879_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13831879_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'25\\/Nov\\/13 20:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-11-25T20:30:48+0000\'\u003e25\\/Nov\\/13 20:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1545394 from  Dag H. Wanvik  in branch \'code\\/trunk\' \\n[  https:\\/\\/svn.apache.org\\/r1545394  ] \\n\\n   DERBY-532   Support deferrable constraints \\n\\n Patch derby-532-post-scan-4 implements basic support for deferred \\nconstraints for PRIMARY KEY and UNIQUE constraints. Deferrable \\nconstraints are not enabled by default yet; one needs to set a \\nproperty to try the feature: \\\"derby.constraintsTesting\\\". \\n\\n This patch enables deferred constraints for: \\n\\n     a) primary key constraints \\n    b) unique constraint with not nullable columns \\n    c) unique constraint with nullable columns \\n\\n by new logic in insertion and sorts. \\n\\n The patch includes relaxing the constraint at insertion and update \\ntime, as well as adding a constraint to an existing table.  \\n\\n Derby treats constraints a) and b) the same, and in the code these are \\nmarked as \\\"unique\\\" when they are not deferrable (as in existing code). \\n\\n Constraint type c) is currently marked as \\n\\\"uniqueWithDuplicateNulls\\\". Insert\\/update of these is implemented in \\nthe BTree by including the RowLocation of the base row in the set of \\nkeys in the index row (  DERBY-3330  ). This makes them trivially unique, \\nbut there is an extra code path in BTreeController that checks \\nneighbor rows for duplicates, and only allows insertion if the key \\ncontains a null. When adding a constraint to an existing table, these \\nare handled by a specially crafted sorter \\n(UniqueWithDuplicateNullsMergeSort). \\n\\n The implementation of insert\\/update of deferrable indexes is based on \\na similar approach, i.e. by backing with a non-unique index, and checking  \\nduplicates in the language layer, notably IndexChanger. \\n\\n In IndexChanger, after inserting a row, we check if it is unique by \\nperforming a scan of the BTree. A time-out here leads to a pessimistic \\nassumption that there is a duplicate. Duplicate key values are saved \\nuntil checking time (usually commit time), when a new scan is \\nperformed to validate the uniqueness property. \\n\\n  &#91;This means a) and b) if deferrable are no longer marked &quot;unique&quot;&#93; . \\n\\n Deferrable indexes are not shared. \\n\\n If there are duplicates and we have deferred constraint mode (a \\ndynamic session property), we save the duplicate index row in a disk \\nbased hash table (DeferredDuplicates#rememberDuplicate). \\n\\n For a) and b), constraints which are deferrable are marked as \\n\\\"uniqueDeferrable\\\" and \\\"hasDeferrableChecking\\\". Constraints of type c) \\nwhich are deferrable are marked \\\"uniqueWithDuplicateNulls\\\" and \\n\\\"hasDeferrableChecking\\\". These marks determines the code paths \\nused. Note that existing indexes and non-deferrable constraint do not \\nget a new code path, which should preserve correctness and performance \\nof those. \\n\\n Now, with these markers in place, deferral of checks happens in three \\nplaces: \\n\\n     {{ IndexChanger#insertAndCheckDups}} \\n\\n     {{CreateIndexConstantAction#executeConstantAction + \\n     MergeSort#compare and UniqueWithDuplicateNullsMergeSort#compare }} \\n\\n      InsertResultSet#setUpAllSorts  \\n\\n\\n The former is active for deferral under INSERT and UPDATE. The middle \\nwhen adding a deferrable constraint to an existing table, when we sort \\nexisting rows detecting any duplicates. The last is used when importing \\nrows. \\n\\n At transaction commit (1), or when the constraint mode for a deferred \\nconstraint is changed back to immediate (2), we validate the \\nconstraint (DeferredDuplicates#validate) by replaying the hash table \\nand scanning the index for the duplicate index rows to ascertain there \\nare none, or else we have an error: transaction or statement severity \\nrespectively for (1) and (2). \\n\\n The constraint mode is a SQL session level variable, and inside \\nroutines (nested connections), we push this on the stack. This means \\nchange of the constraint mode inside nested connections will be popped \\non routine exit. If, as part of this, a constraint changes from \\ndeferred to immediate mode, we also validate it for correctness. If \\nthis fail, the transaction rolls back \\nWe needed to do this from a newly introduced method, \\nGenericLanguageConnectionContext#popNestedSessionContext. This \\npops the SQL session context. \\nThat hook is called from GenericPreparedStatement#executeStmt. As a \\npart of this effort, we also renamed #setupNestedSessionContext to \\n#pushNestedSessionContext. \\n\\n The patch also adds support for checking deferred constraints in \\nxa_prepare and xa_commit (.., true), cf. specification attached to the \\nJIRA issue. \\n\\n Concurrency: if a transaction gets a lock time-out when trying to \\nestablish if a row just inserted is a duplicate (another transaction \\nmay have just inserted a row with a similar index key), we use a \\npessimistics assumption and add that key to the set of keys to be \\nchecked at commit time. If a key can\'t be grabbed then, a time-out is \\nthrown. We plan to add an optimized scan to avoid waiting for the lock \\nat insertion time, cf   DERBY-6419  . \\n\\n The \\\"not enforced\\\" feature is not yet implemented in this patch. \\n\\n Several new test cases been added to ConstraintCharacteristicsTest to \\ntest these basic behaviors.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="10594";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=10594&amp;avatarId=10122\\\" alt=\\\"Derby\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\"\u003eDerby\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1516198575216"> 
    <input type="hidden" title="jira.request.server.time" value="1042"> 
    <input type="hidden" title="jira.request.id" value="856x7499839x2"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="5"> 
    <input type="hidden" title="db.reads.time.in.ms" value="108"> 
    <input type="hidden" title="db.conns.time.in.ms" value="120"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 856x7499839x2
	          REQUEST TIMESTAMP : [17/Jan/2018:14:16:15 +0000]
	               REQUEST TIME : 1.0420
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 5

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=31, elapsedTotal=108457095, elapsedMin=863189, elapsedMax=53152395, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=35, elapsedTotal=120976167, elapsedMin=919495, elapsedMax=53291321, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
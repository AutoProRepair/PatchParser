<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|3b0106fec9a4615c99156448c97519becdd6cf54|lout"> 
  <link rel="shortcut icon" href="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"sd.customer.profile.multi.languages\":true,\"sd.customer.portal.transitions\":true,\"sd.customer.portal.transitions.config\":true,\"sd.custom.email.stripping.rules\":false,\"sd.sla.lucene.issue.id.callback.performance\":true,\"sd.new.settings.sidebar.location\":true,\"sd.workload.report.paginator\":true,\"sd.experimental.portal.search.algorithm.default.1\":false,\"sd.customer.portal.help.center.agent.announcement\":true,\"sd.sla.improved.rendering\":false,\"sd.experimental.portal.search.algorithm.default.2\":false,\"sd.customer.feedback.validate.reporter.on.token\":true,\"sd.custom.email.notifications.utf8.csat.star\":true,\"sd.who.create.customers.by.email.setting\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.renderer.consider.variable.format\":true,\"sd.stats.event.tracking\":true,\"sd.password.helper.dialog\":true,\"sd.canned.responses\":false,\"sd.portal.help.center.customer.signup.secondary.email\":true,\"sd.custom.email.notifications.manage.language\":true,\"sd.use.search.by.permissions\":true,\"sd.slavalue.record.updated.date\":false,\"sd.report.custom.date.range\":false,\"sd.kb.article.helpfulness.report\":false,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"sd.custom.email.notifications.styling\":true,\"sd.workinghours.new.page.bulldog.1\":false,\"sd.customer.portal.two.step.login\":false,\"sd.automation.psmq.async.executor\":true,\"sd.customer.org.list.page.lazy.search\":true,\"sd.approval.requested.when.handler\":true,\"sd.request.type.field.rest.api.filtering.bugfix\":true,\"sd.automation.then.action.auto.answer.approval\":true,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"sla.will.only.be.paused.if.they.are.already.started\":true,\"sd.kb.comment.share.stats.collection\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"sd.customer.orgs.group.participants\":true,\"sd.portal.help.center.customer.signup\":true,\"sd.sla.agent.jql.security.restricted\":true,\"sd.test.feature.flag.x\":true,\"sd.test.feature.flag.y\":false,\"sd.cluster.safe.mail.channel.shutdown\":true,\"sd.email.channel.folders\":false,\"sd.email.analytics.open\":false,\"sd.kb.project.creation.create.link.space\":true,\"sd.workinghours.new.page\":false,\"sd.confluence.anonymous.permission.fix\":true,\"com.atlassian.jira.issuetable.draggable\":true,\"sd.customer.portal.project.agent.announcement\":true,\"sd.automation.audit.log\":true,\"jira.jql.suggestrecentfields\":false,\"sd.canned.responses.check.index.startup\":false,\"sd.new.project.templates\":true,\"sd.custom.email.notifications.custom.rules.simple.ui\":false,\"sd.custom.email.notifications.cut.over\":true,\"sd.dismiss.all.misconfiguration.warnings.setting\":true,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"sd.sla.configurations.export\":true,\"sd.canned.responses.variable.substitution\":true,\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"sd.customer.portal.prioties.per.project.fix\":true,\"jira.instrumentation.laas\":false,\"sd.kb.self.service.report\":false,\"sla.improved.request.handling\":true,\"sd.no.schedule.async.upgrade.tasks\":true,\"sd.kb.primary.nav\":true,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"sd.kb.issueview.panel.phase2\":true,\"sd.email.outsider.comments\":true,\"jira.create.linked.issue\":true,\"sd.kb.issueview.panel\":true,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"sd.approvals.light.weight\":false,\"sd.automation.then.webhook\":true,\"sd.respect.inline.edit.issue.off\":true,\"jira.jql.smartautoselectfirst\":false,\"sd.global.portal.search.atlassian.only.tracking\":false,\"sd.automation.if.condition.comment.primary.action\":true,\"jira.priorities.per.project\":true,\"sd.inline.noformat.renderer\":true,\"sd.customer.request.type.create.edit.screens\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/png,image/vnd.wap.wbmp,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data"]="{\"substitutionVariables\":{\"issue.summary\":\"Issue summary\",\"issue.description\":\"Issue description\",\"issue.key\":\"Issue key\",\"issue.reporter.name\":\"Issue reporter\",\"issue.resolution\":\"Issue resolution\",\"request.url\":\"Request URL\",\"request.status\":\"Request status\"}}";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-help-links.help-links"]="{\"help\":{\"email.settings\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"managing.queues\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+queues+for+your+team\",\"email.setup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"request.settings.help.bubble\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\",\"email.settings.suitablerequest\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email#Receivingrequestsbyemail-suitablerequest\",\"sla.import.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Importing+SLAs\",\"documentation.home\":\"https://docs.atlassian.com/jira/jsd-docs-039/JIRA+Service+Desk+Documentation\",\"default\":\"https://docs.atlassian.com/jira/jsd-docs-039/\",\"create.space.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base#serving-customers-with-a-knowledge-base-createpermission\",\"email.settings.troubleshooting\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+the+email+channel\",\"admin.notifications.config\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+service+desk+notifications\",\"troubleshoot.requesttype\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+request+types\",\"approvals.configuration\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+JIRA+Service+Desk+approvals\",\"setting.up.reports\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+service+desk+reports\",\"public.signup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+public+signup\",\"knowledge.base\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base\",\"resolve.permission.scheme.errors\":\"https://docs.atlassian.com/jira/jsd-docs-039/Resolving+permission+scheme+errors\",\"getting.started\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+with+JIRA+Service+Desk\",\"getting.started.agent\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+for+service+desk+agents\",\"invite.customers\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\"},\"kb\":{\"default\":\"https://confluence.atlassian.com/display/SDKB/\",\"troubleshooting.user.management.issues\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\",\"legacytransition\":\"https://confluence.atlassian.com/display/SDKB/Replacing+legacy+automatic+transitions+with+automation+rules\",\"umtroubleshoot\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\"}}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-base-url.base-url"]="\"https://issues.apache.org/jira\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"7ad9810c7f9a34\"";
WRM._unparsedData["project-id"]="12310110";
WRM._unparsedData["project-key"]="\"LUCENE\"";
WRM._unparsedData["project-name"]="\"Lucene - Core\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310110";
WRM._unparsedData["projectKey"]="\"LUCENE\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/1a6b21131945f6f49ff48336b49ca3fe-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/d8484c9183f546511a8e336a8779bcd9-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d3b35d835f8f46fc3b53bb4db7f85158-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/71d42e74136d842a3ef4d5d136484843-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/95a4826c265852f4904f1e0e7300df68-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/944bb39eced1b35cfc7194aa02eb5a5a/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/5a8f0f8b8aa8f96a4f0f7e9e248d62f3-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="LUCENE-6276"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[LUCENE-6276] Add matchCost() api to TwoPhaseDocIdSetIterator - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[LUCENE-6276] Add matchCost() api to TwoPhaseDocIdSetIterator - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/LUCENE" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-6276">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310110" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Lucene - Core'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310110&amp;avatarId=10061"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/LUCENE">Lucene - Core</a></li>
                 <li><a class="issue-link" data-issue-key="LUCENE-6276" href="/jira/browse/LUCENE-6276" id="key-val" rel="12776651">LUCENE-6276</a></li>
                </ol>
                <h1 id="summary-val">Add matchCost() api to TwoPhaseDocIdSetIterator</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-6276"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/LUCENE-6276/LUCENE-6276.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/LUCENE-6276/LUCENE-6276.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/LUCENE-6276/LUCENE-6276.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/LUCENE-6276/LUCENE-6276.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" title="Improvement - An improvement or enhancement to an existing feature or task." width="16"> Improvement </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+5.4" title="5.4 Bugfix release after 5.3">5.4</a>, <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+6.0" title="6.0 Major release after 5.5">6.0</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12776651-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310120" class="item"> 
                     <div class="wrap"> 
                      <strong title="Lucene Fields" class="name">Lucene Fields:</strong> 
                      <div id="customfield_12310120-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310120-field"> 
                        <span>New</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>We could add a method like TwoPhaseDISI.matchCost() defined as something like estimate of nanoseconds or similar. </p> 
                  <p>ConjunctionScorer could use this method to sort its 'twoPhaseIterators' array so that cheaper ones are called first. Today it has no idea if one scorer is a simple phrase scorer on a short field vs another that might do some geo calculation or more expensive stuff.</p> 
                  <p>PhraseScorers could implement this based on index statistics (e.g. totalTermFreq/maxDoc)</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/LUCENE-6276?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/LUCENE-6276?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/LUCENE-6276?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/LUCENE-6276?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12772053" data-issue-id="12776651" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12772053/LUCENE-6276.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12772053/LUCENE-6276.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12772053/LUCENE-6276.patch" title="Latest  12/Nov/15 21:55 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12772053/LUCENE-6276.patch">LUCENE-6276.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-11-12T21:55:16.039Z">12/Nov/15 21:55</time>
                   </dd>
                   <dd class="attachment-size">
                    40 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12771207" data-issue-id="12776651" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12771207/LUCENE-6276.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12771207/LUCENE-6276.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12771207/LUCENE-6276.patch" title=" 07/Nov/15 22:21 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12771207/LUCENE-6276.patch">LUCENE-6276.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-11-07T22:21:24.869Z">07/Nov/15 22:21</time>
                   </dd>
                   <dd class="attachment-size">
                    39 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12770160" data-issue-id="12776651" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12770160/LUCENE-6276.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12770160/LUCENE-6276.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12770160/LUCENE-6276.patch" title=" 02/Nov/15 20:06 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12770160/LUCENE-6276.patch">LUCENE-6276.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-11-02T20:06:56.255Z">02/Nov/15 20:06</time>
                   </dd>
                   <dd class="attachment-size">
                    38 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12769114" data-issue-id="12776651" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12769114/LUCENE-6276.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12769114/LUCENE-6276.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12769114/LUCENE-6276.patch" title=" 27/Oct/15 21:27 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12769114/LUCENE-6276.patch">LUCENE-6276.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-10-27T21:27:57.500Z">27/Oct/15 21:27</time>
                   </dd>
                   <dd class="attachment-size">
                    36 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12767249" data-issue-id="12776651" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12767249/LUCENE-6276.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12767249/LUCENE-6276.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12767249/LUCENE-6276.patch" title=" 18/Oct/15 13:15 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12767249/LUCENE-6276.patch">LUCENE-6276.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-10-18T13:15:11.024Z">18/Oct/15 13:15</time>
                   </dd>
                   <dd class="attachment-size">
                    35 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12767230" data-issue-id="12776651" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12767230/LUCENE-6276.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12767230/LUCENE-6276.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12767230/LUCENE-6276.patch" title=" 17/Oct/15 22:47 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12767230/LUCENE-6276.patch">LUCENE-6276.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-10-17T22:47:12.421Z">17/Oct/15 22:47</time>
                   </dd>
                   <dd class="attachment-size">
                    35 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12766873" data-issue-id="12776651" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12766873/LUCENE-6276.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12766873/LUCENE-6276.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12766873/LUCENE-6276.patch" title=" 15/Oct/15 20:42 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12766873/LUCENE-6276.patch">LUCENE-6276.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-10-15T20:42:51.279Z">15/Oct/15 20:42</time>
                   </dd>
                   <dd class="attachment-size">
                    29 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12766640" data-issue-id="12776651" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12766640/LUCENE-6276.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12766640/LUCENE-6276.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12766640/LUCENE-6276.patch" title=" 14/Oct/15 21:28 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276.patch:https://issues.apache.org/jira/secure/attachment/12766640/LUCENE-6276.patch">LUCENE-6276.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-10-14T21:28:03.312Z">14/Oct/15 21:28</time>
                   </dd>
                   <dd class="attachment-size">
                    21 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12766041" data-issue-id="12776651" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12766041/LUCENE-6276-ExactPhraseOnly.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276-ExactPhraseOnly.patch:https://issues.apache.org/jira/secure/attachment/12766041/LUCENE-6276-ExactPhraseOnly.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12766041/LUCENE-6276-ExactPhraseOnly.patch" title="Latest  11/Oct/15 22:15 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276-ExactPhraseOnly.patch:https://issues.apache.org/jira/secure/attachment/12766041/LUCENE-6276-ExactPhraseOnly.patch">LUCENE-6276-ExactPhraseOnly.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-10-11T22:15:24.395Z">11/Oct/15 22:15</time>
                   </dd>
                   <dd class="attachment-size">
                    10 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12766185" data-issue-id="12776651" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12766185/LUCENE-6276-NoSpans.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276-NoSpans.patch:https://issues.apache.org/jira/secure/attachment/12766185/LUCENE-6276-NoSpans.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12766185/LUCENE-6276-NoSpans.patch" title="Latest  12/Oct/15 22:14 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276-NoSpans.patch:https://issues.apache.org/jira/secure/attachment/12766185/LUCENE-6276-NoSpans.patch">LUCENE-6276-NoSpans.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-10-12T22:14:43.321Z">12/Oct/15 22:14</time>
                   </dd>
                   <dd class="attachment-size">
                    19 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12766405" data-issue-id="12776651" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12766405/LUCENE-6276-NoSpans2.patch" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276-NoSpans2.patch:https://issues.apache.org/jira/secure/attachment/12766405/LUCENE-6276-NoSpans2.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12766405/LUCENE-6276-NoSpans2.patch" title="Latest  13/Oct/15 21:14 - Paul Elschot" draggable="true" data-downloadurl="text/x-patch:LUCENE-6276-NoSpans2.patch:https://issues.apache.org/jira/secure/attachment/12766405/LUCENE-6276-NoSpans2.patch">LUCENE-6276-NoSpans2.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-10-13T21:14:40.601Z">13/Oct/15 21:14</time>
                   </dd>
                   <dd class="attachment-size">
                    18 kB
                   </dd>
                   <dd class="attachment-author">
                    Paul Elschot
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10453"></span></span> Unassigned </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_rcmuir" rel="rcmuir" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Robert Muir&quot;,&quot;emailAddress&quot;:&quot;rcmuir@gmail.com&quot;,&quot;username&quot;:&quot;rcmuir&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="rcmuir"></span></span> Robert Muir </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">5</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="21/Feb/15 16:06"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2015-02-21T16:06:06+0000">21/Feb/15 16:06</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="09/May/16 18:32"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2016-05-09T18:32:12+0000">09/May/16 18:32</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="13/Nov/15 20:56"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2015-11-13T20:56:01+0000">13/Nov/15 20:56</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for n/a, Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6276?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6276?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6276?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6276?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6276?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6276?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6276?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6276?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6276?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-6276?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6276?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/LUCENE-6276?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-14330343\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14330343&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14330343\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14330343_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14330343_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Feb\\/15 16:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-02-21T16:47:51+0000\'\u003e21\\/Feb\\/15 16:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI like the idea. I\'m curious if you already have concrete ideas for the match costs of our existing queries? Maybe it should not only measure the cost of the operation but also how likely it is to match? This would make sloppy phrases more \\\"costly\\\" since they are more lenient about positions and thus more likely to match.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14330343_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14330343_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Feb\\/15 16:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-02-21T16:47:51+0000\'\u003e21\\/Feb\\/15 16:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I like the idea. I\'m curious if you already have concrete ideas for the match costs of our existing queries? Maybe it should not only measure the cost of the operation but also how likely it is to match? This would make sloppy phrases more \\\"costly\\\" since they are more lenient about positions and thus more likely to match.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14330411\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14330411&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14330411\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_14330411_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14330411_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Feb\\/15 19:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-02-21T19:54:45+0000\'\u003e21\\/Feb\\/15 19:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eI\'m curious if you already have concrete ideas for the match costs of our existing queries?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eSee above in the description. we know the average number of positions per doc (totalTermFreq\\/docFreq) and so on. So we can compute the amortized cost of reading one position, and its easy from there.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\\n\u003cp\u003eMaybe it should not only measure the cost of the operation but also how likely it is to match?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI don\'t agree. You can already get this with Scorer.getApproximation().cost()\\/Scorer.cost(). \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_14330411_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14330411_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Feb\\/15 19:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-02-21T19:54:45+0000\'\u003e21\\/Feb\\/15 19:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n I\'m curious if you already have concrete ideas for the match costs of our existing queries?  \\n\\n See above in the description. we know the average number of positions per doc (totalTermFreq\\/docFreq) and so on. So we can compute the amortized cost of reading one position, and its easy from there. \\n\\n \\n Maybe it should not only measure the cost of the operation but also how likely it is to match?  \\n\\n I don\'t agree. You can already get this with Scorer.getApproximation().cost()\\/Scorer.cost().               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14909660\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14909660&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14909660\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14909660_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14909660_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/15 08:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-09-27T08:59:35+0000\'\u003e27\\/Sep\\/15 08:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eFrom the javadocs of DocIdSetIterator.cost():\u003cbr\\/\u003e\\nThis is generally an upper bound of the number of documents this iterator might match, but may be a rough heuristic, hardcoded value, or otherwise completely inaccurate.\u003c\\/p\u003e\\n\\n\u003cp\u003ePerhaps this cost method can be renamed to for example expectedMaxMatchingDocs() with these javadocs:\u003cbr\\/\u003e\\nThis an expected upper bound of the number of documents this iterator might match.\u003c\\/p\u003e\\n\\n\u003cp\u003eWould it make sense to put matchCost() at DocIdSetIterator?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14909660_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14909660_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/15 08:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-09-27T08:59:35+0000\'\u003e27\\/Sep\\/15 08:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    From the javadocs of DocIdSetIterator.cost(): \\nThis is generally an upper bound of the number of documents this iterator might match, but may be a rough heuristic, hardcoded value, or otherwise completely inaccurate. \\n\\n Perhaps this cost method can be renamed to for example expectedMaxMatchingDocs() with these javadocs: \\nThis an expected upper bound of the number of documents this iterator might match. \\n\\n Would it make sense to put matchCost() at DocIdSetIterator?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14909666\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14909666&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14909666\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14909666_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14909666_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/15 09:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-09-27T09:27:50+0000\'\u003e27\\/Sep\\/15 09:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003ePerhaps this cost method can be renamed to for example expectedMaxMatchingDocs() with these javadocs: This an expected upper bound of the number of documents this iterator might match.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003ePersonally I don\'t dislike \\\"cost\\\". Even if it does not carry very well the meaning of what it measures, it does a pretty good job at carrying what to do with the result of this method: if you have several iterators, you want to consume the least-costly ones first.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eWould it make sense to put matchCost() at DocIdSetIterator?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThe DocIdSetIterator abstraction does not have the concept of \\\"matching\\\", only TwoPhaseIterator has it, so I think it would be awkward to have it on DocIdSetIterator? TwoPhaseIterator feels like a more appropriate place to have this method.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14909666_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14909666_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/15 09:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-09-27T09:27:50+0000\'\u003e27\\/Sep\\/15 09:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     Perhaps this cost method can be renamed to for example expectedMaxMatchingDocs() with these javadocs: This an expected upper bound of the number of documents this iterator might match.  \\n\\n Personally I don\'t dislike \\\"cost\\\". Even if it does not carry very well the meaning of what it measures, it does a pretty good job at carrying what to do with the result of this method: if you have several iterators, you want to consume the least-costly ones first. \\n\\n  Would it make sense to put matchCost() at DocIdSetIterator?  \\n\\n The DocIdSetIterator abstraction does not have the concept of \\\"matching\\\", only TwoPhaseIterator has it, so I think it would be awkward to have it on DocIdSetIterator? TwoPhaseIterator feels like a more appropriate place to have this method.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14909685\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14909685&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14909685\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14909685_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14909685_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/15 10:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-09-27T10:58:16+0000\'\u003e27\\/Sep\\/15 10:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAs to TwoPhaseIterator or DocIdSetIterator, I think this boils down to whether the leading iterator in ConjunctionDISI should be chosen using the expected number of matching docs only, or also using the totalTermFreq\'s somehow. This is for more complex queries, for example a conjunction with at least one phrase or SpanNearQuery.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut for the more complex queries two phase approximation is already in place, so having matchCost() only in the two phase code could be enough even for these queries.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14909685_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14909685_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Sep\\/15 10:58\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-09-27T10:58:16+0000\'\u003e27\\/Sep\\/15 10:58\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    As to TwoPhaseIterator or DocIdSetIterator, I think this boils down to whether the leading iterator in ConjunctionDISI should be chosen using the expected number of matching docs only, or also using the totalTermFreq\'s somehow. This is for more complex queries, for example a conjunction with at least one phrase or SpanNearQuery. \\n\\n But for the more complex queries two phase approximation is already in place, so having matchCost() only in the two phase code could be enough even for these queries.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14952463\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14952463&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14952463\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14952463_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14952463_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Oct\\/15 22:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-11T22:15:24+0000\'\u003e11\\/Oct\\/15 22:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch of 12 Oct 2015, starting matchCost for ExactPhraseScorer only, the rest does not compile because it still needs matchDoc.\u003cbr\\/\u003e\\n(A little bit too much whitespace was removed by the editor, please ignore the noise.)\u003c\\/p\u003e\\n\\n\u003cp\u003eIs this the direction to take?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14952463_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14952463_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Oct\\/15 22:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-11T22:15:24+0000\'\u003e11\\/Oct\\/15 22:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch of 12 Oct 2015, starting matchCost for ExactPhraseScorer only, the rest does not compile because it still needs matchDoc. \\n(A little bit too much whitespace was removed by the editor, please ignore the noise.) \\n\\n Is this the direction to take?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14952926\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14952926&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14952926\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14952926_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14952926_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 11:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T11:03:25+0000\'\u003e12\\/Oct\\/15 11:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think it would make more sense to sum up \u003ctt\u003etotalTermFreq\\/docFreq\u003c\\/tt\u003e for each term instead of \u003ctt\u003etotalTermFreq\\/conjunctionDISI.cost()\u003c\\/tt\u003e, so that we get the average number of positions per document? But otherwise I think you got the intention right. Something else to be careful with is that \u003ctt\u003eTermStatistics.totalTermFreq()\u003c\\/tt\u003e may return -1, so we need a fallback for that case. Maybe we could just assume 1 position per document?\u003c\\/p\u003e\\n\\n\u003cp\u003eA related question is what definition we should give to \u003ctt\u003ematchCost()\u003c\\/tt\u003e. The patch does not have the issue yet since it only deals with phrase queries, but eventually we should be able to compare the cost of eg. a phrase query against a doc values range query even though they perform very different computations. Maybe the javadocs of matchCost could suggest a scale of costs of operations that implementors of matchCost() could use in order to compute the cost of matching the two-phase iterator. It could be something like 1 for nextDoc(), nextPosition(), comparisons and basic arithmetic operations and eg. 10 for advance()?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14952926_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14952926_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 11:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T11:03:25+0000\'\u003e12\\/Oct\\/15 11:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I think it would make more sense to sum up  totalTermFreq\\/docFreq  for each term instead of  totalTermFreq\\/conjunctionDISI.cost() , so that we get the average number of positions per document? But otherwise I think you got the intention right. Something else to be careful with is that  TermStatistics.totalTermFreq()  may return -1, so we need a fallback for that case. Maybe we could just assume 1 position per document? \\n\\n A related question is what definition we should give to  matchCost() . The patch does not have the issue yet since it only deals with phrase queries, but eventually we should be able to compare the cost of eg. a phrase query against a doc values range query even though they perform very different computations. Maybe the javadocs of matchCost could suggest a scale of costs of operations that implementors of matchCost() could use in order to compute the cost of matching the two-phase iterator. It could be something like 1 for nextDoc(), nextPosition(), comparisons and basic arithmetic operations and eg. 10 for advance()?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14953114\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14953114&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14953114\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_14953114_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14953114_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 13:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T13:31:14+0000\'\u003e12\\/Oct\\/15 13:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\\n\u003cp\u003eAs to TwoPhaseIterator or DocIdSetIterator, I think this boils down to whether the leading iterator in ConjunctionDISI should be chosen using the expected number of matching docs only, or also using the totalTermFreq\'s somehow. This is for more complex queries, for example a conjunction with at least one phrase or SpanNearQuery.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut for the more complex queries two phase approximation is already in place, so having matchCost() only in the two phase code could be enough even for these queries.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eYes, to keep things simple, I imagined this api would just be the cost of calling \u003ctt\u003ematches()\u003c\\/tt\u003e itself so I think the two phase API is the correct place to put it (like in your patch).\u003c\\/p\u003e\\n\\n\u003cp\u003eWe already have a \u003ctt\u003ecost()\u003c\\/tt\u003e api for DISI for doing things like conjunctions (yes its purely based on density and maybe that is imperfect) but I think we should try to narrow the scope of this issue to just the cost of the \u003ctt\u003ematches()\u003c\\/tt\u003e operation, which can vary wildly depending on query type or document size.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhat adrien says about \\\"likelyhood of match\\\" is also interesting but I think we want to defer that too. To me that is just a matter of having more accurate \u003ctt\u003ecost()\u003c\\/tt\u003e and it may not be easy or feasible to improve...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_14953114_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14953114_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 13:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T13:31:14+0000\'\u003e12\\/Oct\\/15 13:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n As to TwoPhaseIterator or DocIdSetIterator, I think this boils down to whether the leading iterator in ConjunctionDISI should be chosen using the expected number of matching docs only, or also using the totalTermFreq\'s somehow. This is for more complex queries, for example a conjunction with at least one phrase or SpanNearQuery. \\n\\n But for the more complex queries two phase approximation is already in place, so having matchCost() only in the two phase code could be enough even for these queries.  \\n\\n Yes, to keep things simple, I imagined this api would just be the cost of calling  matches()  itself so I think the two phase API is the correct place to put it (like in your patch). \\n\\n We already have a  cost()  api for DISI for doing things like conjunctions (yes its purely based on density and maybe that is imperfect) but I think we should try to narrow the scope of this issue to just the cost of the  matches()  operation, which can vary wildly depending on query type or document size. \\n\\n What adrien says about \\\"likelyhood of match\\\" is also interesting but I think we want to defer that too. To me that is just a matter of having more accurate  cost()  and it may not be easy or feasible to improve...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14953518\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14953518&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14953518\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14953518_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14953518_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 18:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T18:26:31+0000\'\u003e12\\/Oct\\/15 18:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eit would make more sense to sum up totalTermFreq\\/docFreq for each term \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI\'ll change that and change the matchCost() method to return a float instead of a long.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eTermStatistics.totalTermFreq() may return -1\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI\'ll add a check for that.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003ewhat definition we should give to matchCost()\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI\'d like to have it reflect an avarage cost to process a single document, once the two phase iterator is at the document.\u003cbr\\/\u003e\\nThat would exclude the cost for next() and advance(), which would be better in the DISI.cost() method for now.\u003c\\/p\u003e\\n\\n\u003cp\u003eHow much of the cost of matches() should be in there I don\'t know, we\'ll see. NearSpans also does work after matches() returns true.\u003c\\/p\u003e\\n\\n\u003cp\u003eAnd the likelyhood of match is the probability that matches() returns true...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14953518_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14953518_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 18:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T18:26:31+0000\'\u003e12\\/Oct\\/15 18:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     it would make more sense to sum up totalTermFreq\\/docFreq for each term   \\n\\n I\'ll change that and change the matchCost() method to return a float instead of a long. \\n\\n  TermStatistics.totalTermFreq() may return -1  \\n\\n I\'ll add a check for that. \\n\\n  what definition we should give to matchCost()  \\n\\n I\'d like to have it reflect an avarage cost to process a single document, once the two phase iterator is at the document. \\nThat would exclude the cost for next() and advance(), which would be better in the DISI.cost() method for now. \\n\\n How much of the cost of matches() should be in there I don\'t know, we\'ll see. NearSpans also does work after matches() returns true. \\n\\n And the likelyhood of match is the probability that matches() returns true...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14953571\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14953571&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14953571\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14953571_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14953571_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 19:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T19:00:17+0000\'\u003e12\\/Oct\\/15 19:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003echange the matchCost() method to return a float instead of a long\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI liked having it as a long, like DISI.cost(). Maybe we could just round?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eI\'d like to have it reflect an avarage cost to process a single document, once the two phase iterator is at the document. That would exclude the cost for next() and advance(), which would be better in the DISI.cost() method for now.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eIndeed this is what it should do! Sorry I introduced some confusion, the reason why I brought these methods is ReqExclScorer, whose TwoPhaseIterator calls DocIdSetIterator.advance() on the excluded iterator in oder to validate a match. So we need to decide how costly calling advance() is.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14953571_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14953571_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 19:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T19:00:17+0000\'\u003e12\\/Oct\\/15 19:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     change the matchCost() method to return a float instead of a long  \\n\\n I liked having it as a long, like DISI.cost(). Maybe we could just round? \\n\\n  I\'d like to have it reflect an avarage cost to process a single document, once the two phase iterator is at the document. That would exclude the cost for next() and advance(), which would be better in the DISI.cost() method for now.  \\n\\n Indeed this is what it should do! Sorry I introduced some confusion, the reason why I brought these methods is ReqExclScorer, whose TwoPhaseIterator calls DocIdSetIterator.advance() on the excluded iterator in oder to validate a match. So we need to decide how costly calling advance() is.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14953855\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14953855&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14953855\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14953855_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14953855_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 22:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T22:14:43+0000\'\u003e12\\/Oct\\/15 22:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch of 13 Oct 2015. No spans yet. \u003cbr\\/\u003e\\nLeft matchDoc() returning float because in many cases the avarage number of positions in a matching document will be close to 1.\u003cbr\\/\u003e\\nQuite a few nocommits at matchDoc implementations throwing an Error(\\\"not yet implemented\\\")\u003c\\/p\u003e\\n\\n\u003cp\u003eThis includes a first attempt at sorting the DISI\'s in ConjunctionDISI.\u003c\\/p\u003e\\n\\n\u003cp\u003eTo my surprise, quite a few tests pass, I have not yet tried all of them.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14953855_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14953855_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 22:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T22:14:43+0000\'\u003e12\\/Oct\\/15 22:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch of 13 Oct 2015. No spans yet.  \\nLeft matchDoc() returning float because in many cases the avarage number of positions in a matching document will be close to 1. \\nQuite a few nocommits at matchDoc implementations throwing an Error(\\\"not yet implemented\\\") \\n\\n This includes a first attempt at sorting the DISI\'s in ConjunctionDISI. \\n\\n To my surprise, quite a few tests pass, I have not yet tried all of them.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14953889\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14953889&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14953889\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14953889_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14953889_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 22:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T22:29:07+0000\'\u003e12\\/Oct\\/15 22:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe change in ConjunctionDISI does not look right to me: we should keep sorting the iterators based on DISI.cost, and only use \u003ctt\u003eTwoPhaseIterator.matchCost\u003c\\/tt\u003e to sort \u003ctt\u003eTwoPhaseConjunctionDISI.twoPhaseIterators\u003c\\/tt\u003e.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m also unhappy about adding a method to TermStatistics, this class should remain as simple as possible. Can we make it private to PhraseWeight?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14953889_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14953889_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Oct\\/15 22:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-12T22:29:07+0000\'\u003e12\\/Oct\\/15 22:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The change in ConjunctionDISI does not look right to me: we should keep sorting the iterators based on DISI.cost, and only use  TwoPhaseIterator.matchCost  to sort  TwoPhaseConjunctionDISI.twoPhaseIterators . \\n\\n I\'m also unhappy about adding a method to TermStatistics, this class should remain as simple as possible. Can we make it private to PhraseWeight?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14955579\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14955579&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14955579\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14955579_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14955579_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Oct\\/15 20:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-13T20:28:21+0000\'\u003e13\\/Oct\\/15 20:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003e... unhappy about  adding a method to TermStatistics, this class should remain as simple as possible. Can we make it private to PhraseWeight?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWhy should TermStatistics remain as simple as possible? Having a method that returns an expected value in a ...Statistics class looks just right to me.\u003c\\/p\u003e\\n\\n\u003cp\u003eI initially had the code in PhraseWeight, but there many getter methods from TermStatistics were used, so I moved the method to TermStatistics and used the return value as the match cost for a single term in PhraseWeight.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think we will need the same thing for spans (multiplied with a factor 4 or so), and in that case the method will have to be public, because the spans are in a different package. Can we reconsider moving the method until the spans are done here?\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003e... only use TwoPhaseIterator.matchCost to sort TwoPhaseConjunctionDISI.twoPhaseIterators.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI missed that, I\'ll introduce it.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14955579_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14955579_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Oct\\/15 20:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-13T20:28:21+0000\'\u003e13\\/Oct\\/15 20:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     ... unhappy about  adding a method to TermStatistics, this class should remain as simple as possible. Can we make it private to PhraseWeight?  \\n\\n Why should TermStatistics remain as simple as possible? Having a method that returns an expected value in a ...Statistics class looks just right to me. \\n\\n I initially had the code in PhraseWeight, but there many getter methods from TermStatistics were used, so I moved the method to TermStatistics and used the return value as the match cost for a single term in PhraseWeight. \\n\\n I think we will need the same thing for spans (multiplied with a factor 4 or so), and in that case the method will have to be public, because the spans are in a different package. Can we reconsider moving the method until the spans are done here? \\n\\n  ... only use TwoPhaseIterator.matchCost to sort TwoPhaseConjunctionDISI.twoPhaseIterators.  \\n\\n I missed that, I\'ll introduce it.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14955692\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14955692&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14955692\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14955692_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14955692_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Oct\\/15 21:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-13T21:14:40+0000\'\u003e13\\/Oct\\/15 21:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSecond patch of 13 Oct 2015:\u003cbr\\/\u003e\\nUse matchCost to sort twoPhaseIterators.\u003cbr\\/\u003e\\nAdd matchCost implementations in test code.\u003cbr\\/\u003e\\nRename method expPositionsPerDoc() to expTermFreqInMatchingDoc().\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14955692_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14955692_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Oct\\/15 21:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-13T21:14:40+0000\'\u003e13\\/Oct\\/15 21:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Second patch of 13 Oct 2015: \\nUse matchCost to sort twoPhaseIterators. \\nAdd matchCost implementations in test code. \\nRename method expPositionsPerDoc() to expTermFreqInMatchingDoc(). \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14955697\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14955697&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14955697\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14955697_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14955697_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Oct\\/15 21:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-13T21:16:39+0000\'\u003e13\\/Oct\\/15 21:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ematchCost is still not implemented for Spans (4 nocommits left), and now some test cases using Spans actually fail.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14955697_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14955697_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Oct\\/15 21:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-13T21:16:39+0000\'\u003e13\\/Oct\\/15 21:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    matchCost is still not implemented for Spans (4 nocommits left), and now some test cases using Spans actually fail.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14955721\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14955721&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14955721\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14955721_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14955721_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Oct\\/15 21:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-13T21:29:34+0000\'\u003e13\\/Oct\\/15 21:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWe could take into account the different costs of advance() and nextDoc(), but at another issue.\u003cbr\\/\u003e\\nWith cost() as an estimation of the number of matching documents, as it is now:\u003cbr\\/\u003e\\nfor conjunctions that could become: 2 * (minimum cost()) * (cost of advance),\u003cbr\\/\u003e\\nand for disjunctions: (total cost()) * (cost of nextDoc).\u003c\\/p\u003e\\n\\n\u003cp\u003eReqExclScorer could use the cost of advance in its matchCost already here, but I have no idea which value to use.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14955721_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14955721_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Oct\\/15 21:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-13T21:29:34+0000\'\u003e13\\/Oct\\/15 21:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    We could take into account the different costs of advance() and nextDoc(), but at another issue. \\nWith cost() as an estimation of the number of matching documents, as it is now: \\nfor conjunctions that could become: 2 * (minimum cost()) * (cost of advance), \\nand for disjunctions: (total cost()) * (cost of nextDoc). \\n\\n ReqExclScorer could use the cost of advance in its matchCost already here, but I have no idea which value to use. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14956557\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14956557&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14956557\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14956557_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14956557_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Oct\\/15 09:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-14T09:29:08+0000\'\u003e14\\/Oct\\/15 09:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eTermStatistics is a class that we need to maintain backward compatibility for since it\'s not experimental\\/internal. So we shouldn\'t put more methods in there that we only need for implementation details of PhraseQuery\\/SpanNearQuery. I would rather duplicate the logic. In addition, the current implementation of this method is trappy as it assumes that the average term freq is 1 when totalTermFreq is not available. While this might be ok for the matchCost computation of phrase queries, it might not be for other use-cases.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe changes in ConjunctionDISI look good to me now, thanks.\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e+            \u003cspan class=\\\"code-keyword\\\"\u003eif\u003c\\/span\u003e (w.twoPhaseView != \u003cspan class=\\\"code-keyword\\\"\u003enull\u003c\\/span\u003e) {\\n+              matchCost += w.twoPhaseView.matchCost();\\n+            } \u003cspan class=\\\"code-keyword\\\"\u003eelse\u003c\\/span\u003e {\\n+              \u003cspan class=\\\"code-keyword\\\"\u003eassert\u003c\\/span\u003e w.iterator \u003cspan class=\\\"code-keyword\\\"\u003einstanceof\u003c\\/span\u003e TermScorer; \u003cspan class=\\\"code-comment\\\"\u003e\\/\\/ zero match cost.\\n\u003c\\/span\u003e+            }\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003e\u003ctt\u003ew.twoPhaseView\u003c\\/tt\u003e can be null on any scorer that does not expose an approximation. So it can be not only a TermScorer, but also a conjunction\\/disjunction of term scorers or even a custom query.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14956557_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14956557_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Oct\\/15 09:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-14T09:29:08+0000\'\u003e14\\/Oct\\/15 09:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    TermStatistics is a class that we need to maintain backward compatibility for since it\'s not experimental\\/internal. So we shouldn\'t put more methods in there that we only need for implementation details of PhraseQuery\\/SpanNearQuery. I would rather duplicate the logic. In addition, the current implementation of this method is trappy as it assumes that the average term freq is 1 when totalTermFreq is not available. While this might be ok for the matchCost computation of phrase queries, it might not be for other use-cases. \\n\\n The changes in ConjunctionDISI look good to me now, thanks. \\n\\n  \\n +             if  (w.twoPhaseView !=  null ) {\\n+              matchCost += w.twoPhaseView.matchCost();\\n+            }  else  {\\n+               assert  w.iterator  instanceof  TermScorer;  \\/\\/ zero match cost.\\n +            }\\n \\n  \\n\\n  w.twoPhaseView  can be null on any scorer that does not expose an approximation. So it can be not only a TermScorer, but also a conjunction\\/disjunction of term scorers or even a custom query.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14957621\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14957621&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14957621\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14957621_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14957621_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Oct\\/15 19:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-14T19:54:45+0000\'\u003e14\\/Oct\\/15 19:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eTermStatistics.java has a \u003ctt\u003e@lucene.experimental\u003c\\/tt\u003e javadoc in trunk.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll remove the \u003ctt\u003eassert w.iterator instanceof TermScorer\u003c\\/tt\u003e, I put it there to remind me to check what to do in other cases.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14957621_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14957621_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Oct\\/15 19:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-14T19:54:45+0000\'\u003e14\\/Oct\\/15 19:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    TermStatistics.java has a  @lucene.experimental  javadoc in trunk. \\n\\n I\'ll remove the  assert w.iterator instanceof TermScorer , I put it there to remind me to check what to do in other cases.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14957817\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14957817&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14957817\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14957817_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14957817_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Oct\\/15 21:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-14T21:28:03+0000\'\u003e14\\/Oct\\/15 21:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch of 14 October 2015.\u003cbr\\/\u003e\\nNo more NOCOMMITS, existing tests pass.\u003cbr\\/\u003e\\nStill no tests to verify that matchCost() is used correctly.\u003c\\/p\u003e\\n\\n\u003cp\u003eSome FIXME\'s for the cost values used.\u003cbr\\/\u003e\\nImprove javadoc for TermStatistics.expTermFreqInMatchingDoc.\u003cbr\\/\u003e\\nIn AssertingTwoPhaseView.matchCost() the cost should be non negative.\u003cbr\\/\u003e\\nSmall javadoc correction in TwoPhaseIterator.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14957817_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14957817_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Oct\\/15 21:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-14T21:28:03+0000\'\u003e14\\/Oct\\/15 21:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch of 14 October 2015. \\nNo more NOCOMMITS, existing tests pass. \\nStill no tests to verify that matchCost() is used correctly. \\n\\n Some FIXME\'s for the cost values used. \\nImprove javadoc for TermStatistics.expTermFreqInMatchingDoc. \\nIn AssertingTwoPhaseView.matchCost() the cost should be non negative. \\nSmall javadoc correction in TwoPhaseIterator. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14958355\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14958355&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14958355\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_14958355_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14958355_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Oct\\/15 05:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-15T05:31:24+0000\'\u003e15\\/Oct\\/15 05:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI agree with Adrien here. TermStatistics and CollectionStatistics are what feed the scoring systems (and already hairy enough as is), so we should keep any of this optimization-related stuff out of them. They were added to allow IndexSearcher to support distributed search.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rcmuir\\\" id=\\\"commentauthor_14958355_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rcmuir\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rcmuir\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Robert Muir\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14958355_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Oct\\/15 05:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-15T05:31:24+0000\'\u003e15\\/Oct\\/15 05:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I agree with Adrien here. TermStatistics and CollectionStatistics are what feed the scoring systems (and already hairy enough as is), so we should keep any of this optimization-related stuff out of them. They were added to allow IndexSearcher to support distributed search.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14959580\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14959580&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14959580\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14959580_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14959580_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Oct\\/15 20:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-15T20:42:51+0000\'\u003e15\\/Oct\\/15 20:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Paul Elschot - 15\\/Oct\\/15 20:45\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e2nd patch of 15 October 2015.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis adds Span.positionsCost() as the basic matchCost to be used for Spans.\u003cbr\\/\u003e\\nThis method has a NOCOMMIT in Spans.java: throw UOE or abstract in Spans?\u003cbr\\/\u003e\\nI\'d prefer to throw an UOE but an abstract method is easier to find the places where positionsCost() really needs to be implemented.\u003cbr\\/\u003e\\nFor now I left it abstract and have some implementations throw UOE.\u003c\\/p\u003e\\n\\n\u003cp\u003eOther changes to the previous patch:\u003cbr\\/\u003e\\nUse TermStatistics from trunk.\u003cbr\\/\u003e\\nMove expTermFreqInMatchingDoc() from TermStatistics into PhraseWeight and a copy into TermSpans.\u003cbr\\/\u003e\\nSimplified matchCost() implementations.\u003c\\/p\u003e\\n\\n\u003cp\u003eExisting tests pass.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis will need improvements, and I hope it works decently for simple cases like a conjunction over a phrase and a SpanNear.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14959580_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14959580_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Oct\\/15 20:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-15T20:42:51+0000\'\u003e15\\/Oct\\/15 20:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Paul Elschot - 15\\/Oct\\/15 20:45\\\"\u003eedited\u003c\\/span\u003e                   2nd patch of 15 October 2015. \\n\\n This adds Span.positionsCost() as the basic matchCost to be used for Spans. \\nThis method has a NOCOMMIT in Spans.java: throw UOE or abstract in Spans? \\nI\'d prefer to throw an UOE but an abstract method is easier to find the places where positionsCost() really needs to be implemented. \\nFor now I left it abstract and have some implementations throw UOE. \\n\\n Other changes to the previous patch: \\nUse TermStatistics from trunk. \\nMove expTermFreqInMatchingDoc() from TermStatistics into PhraseWeight and a copy into TermSpans. \\nSimplified matchCost() implementations. \\n\\n Existing tests pass. \\n\\n This will need improvements, and I hope it works decently for simple cases like a conjunction over a phrase and a SpanNear.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14959624\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14959624&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14959624\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14959624_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14959624_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Oct\\/15 21:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-15T21:11:49+0000\'\u003e15\\/Oct\\/15 21:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSome TwoPhaseIterators in Solr will need to have matchCost() added with the latest patch.\u003cbr\\/\u003e\\nI am not familiar enough with Solr code for that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14959624_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14959624_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Oct\\/15 21:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-15T21:11:49+0000\'\u003e15\\/Oct\\/15 21:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Some TwoPhaseIterators in Solr will need to have matchCost() added with the latest patch. \\nI am not familiar enough with Solr code for that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14962105\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14962105&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14962105\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14962105_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962105_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Oct\\/15 22:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-17T22:47:12+0000\'\u003e17\\/Oct\\/15 22:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch of 18 Oct 2015.\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eCalculate the matchCost per LeafReaderContext, because the sorting by matchCost is done at leaf level.\u003c\\/li\u003e\\n\\t\u003cli\u003eIn the facet, join and spatial modules, add matchCost implementations returning 0, and with a CHECKME comment.\u003c\\/li\u003e\\n\\t\u003cli\u003eFixed a bug in the earlier added added sort comparator in the TwoPhaseConjunctionDISI constructor, it was comparing the same object.\u003c\\/li\u003e\\n\\t\u003cli\u003eDropped the NOCOMMIT for Spans.positionsCost(), pefer this to be an abstract method.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eIn AssertingSpans the positionCost should be positive.\u003c\\/li\u003e\\n\\t\u003cli\u003eAdd some toString() implementations for inline subclasses of TwoPhaseIterator to ease debugging.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14962105_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962105_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Oct\\/15 22:47\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-17T22:47:12+0000\'\u003e17\\/Oct\\/15 22:47\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch of 18 Oct 2015. \\n\\n \\n\\t Calculate the matchCost per LeafReaderContext, because the sorting by matchCost is done at leaf level. \\n\\t In the facet, join and spatial modules, add matchCost implementations returning 0, and with a CHECKME comment. \\n\\t Fixed a bug in the earlier added added sort comparator in the TwoPhaseConjunctionDISI constructor, it was comparing the same object. \\n\\t Dropped the NOCOMMIT for Spans.positionsCost(), pefer this to be an abstract method. \\n \\n\\n\\n \\n\\t In AssertingSpans the positionCost should be positive. \\n\\t Add some toString() implementations for inline subclasses of TwoPhaseIterator to ease debugging. \\n \\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14962369\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14962369&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14962369\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14962369_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962369_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Oct\\/15 13:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-18T13:15:11+0000\'\u003e18\\/Oct\\/15 13:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Paul Elschot - 18\\/Oct\\/15 13:16\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e2nd patch of 18 Oct 2015. More improvements:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eAdd TwoPhaseIterator.termPositionsCost() for use in matchCost() implementations. This replaces the earlier PhraseQuery.expTermFreqInMatchingDoc().\u003c\\/li\u003e\\n\\t\u003cli\u003eIn SpanOrQuery use better avarage cost for matchCost().\u003c\\/li\u003e\\n\\t\u003cli\u003eMove positionsCost() throwing UOE from Near\\/ContainSpans to ConjunctionSpans only.\u003c\\/li\u003e\\n\\t\u003cli\u003ematchCost must be non negative in AssertingScorer.\u003c\\/li\u003e\\n\\t\u003cli\u003eUse a random matchCost in RandomApproximationQuery.\u003c\\/li\u003e\\n\\t\u003cli\u003eBetter javadocs and code comments.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14962369_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962369_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Oct\\/15 13:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-18T13:15:11+0000\'\u003e18\\/Oct\\/15 13:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Paul Elschot - 18\\/Oct\\/15 13:16\\\"\u003eedited\u003c\\/span\u003e                   2nd patch of 18 Oct 2015. More improvements: \\n \\n\\t Add TwoPhaseIterator.termPositionsCost() for use in matchCost() implementations. This replaces the earlier PhraseQuery.expTermFreqInMatchingDoc(). \\n\\t In SpanOrQuery use better avarage cost for matchCost(). \\n\\t Move positionsCost() throwing UOE from Near\\/ContainSpans to ConjunctionSpans only. \\n\\t matchCost must be non negative in AssertingScorer. \\n\\t Use a random matchCost in RandomApproximationQuery. \\n\\t Better javadocs and code comments. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14962471\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14962471&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14962471\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14962471_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962471_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Oct\\/15 15:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-18T15:54:12+0000\'\u003e18\\/Oct\\/15 15:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis is neat.  Couple things...\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eRandomAccessWeight\'s 2-phase should probably call to a protected method on RAW so that a subclass could define the cost based on how expensive using the Bits is.  Maybe it should be abstract and not zero?\u003c\\/li\u003e\\n\\t\u003cli\u003eIt will be difficult for many of the 2-phase implementations to calculate a matchCost &#8211; particularly the ones \u003cem\u003enot\u003c\\/em\u003e based on the number of term positions.  What to do?  A constant of \'0\' (which you often labelled FIXME) is way too cheap I think?  Maybe the best we can hope for is simply a stable sort of same-cost 2-phases and assuming that the order of queries added to a BooleanQuery.Builder remains stable.  This at least allows the user to tune performance by changing the clause order for such constant matchCost queries.  But I see that the latest BooleanQuery.Builder is \u003cem\u003enot\u003c\\/em\u003e stable due to use of HashSet \\/ MultiSet versus LinkedHashSet which would be stable.  What do you think \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\" class=\\\"user-hover\\\" rel=\\\"jpountz\\\"\u003eAdrien Grand\u003c\\/a\u003e?  Alternatively (or in addition) a query wrapper could allow explicitly setting a cost  (vaguely similar to Solr\'s ExtendedQuery.getCost).  This could look similar to BoostQuery but for 2-phase matchCost instead of score.\u003c\\/li\u003e\\n\\t\u003cli\u003eMaybe the \u003ctt\u003eexplain\u003c\\/tt\u003e could possibly display the matchCost?  It\'d be nice to troubleshoot\\/inspect for diagnostics somehow.  Not critical, of course.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14962471_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962471_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Oct\\/15 15:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-18T15:54:12+0000\'\u003e18\\/Oct\\/15 15:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This is neat.  Couple things... \\n\\n \\n\\t RandomAccessWeight\'s 2-phase should probably call to a protected method on RAW so that a subclass could define the cost based on how expensive using the Bits is.  Maybe it should be abstract and not zero? \\n\\t It will be difficult for many of the 2-phase implementations to calculate a matchCost &#8211; particularly the ones  not  based on the number of term positions.  What to do?  A constant of \'0\' (which you often labelled FIXME) is way too cheap I think?  Maybe the best we can hope for is simply a stable sort of same-cost 2-phases and assuming that the order of queries added to a BooleanQuery.Builder remains stable.  This at least allows the user to tune performance by changing the clause order for such constant matchCost queries.  But I see that the latest BooleanQuery.Builder is  not  stable due to use of HashSet \\/ MultiSet versus LinkedHashSet which would be stable.  What do you think  Adrien Grand ?  Alternatively (or in addition) a query wrapper could allow explicitly setting a cost  (vaguely similar to Solr\'s ExtendedQuery.getCost).  This could look similar to BoostQuery but for 2-phase matchCost instead of score. \\n\\t Maybe the  explain  could possibly display the matchCost?  It\'d be nice to troubleshoot\\/inspect for diagnostics somehow.  Not critical, of course. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14962541\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14962541&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14962541\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14962541_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962541_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Oct\\/15 18:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-18T18:09:16+0000\'\u003e18\\/Oct\\/15 18:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI left the matchCosts that I could not easily determine at zero and added a CHECKME. This is more an indication that refinement is possible.\u003c\\/p\u003e\\n\\n\u003cp\u003eSorting subscorers\\/subspans by cost and matchCost is probably better than relying on any given order.\u003cbr\\/\u003e\\nAnyway I don\'t expect the impact of matchCost on performance be more than 4-8% except maybe for really complex queries.\u003c\\/p\u003e\\n\\n\u003cp\u003eShowing the matchCost in explain will be tricky because it is computed by LeafReaderContext, i.e. by segment.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe matchCost is not yet used for the second phase in disjunctions. Yet another priority queue might be needed for that, so I\'d prefer to delay that to another issue.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14962541_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962541_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Oct\\/15 18:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-18T18:09:16+0000\'\u003e18\\/Oct\\/15 18:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I left the matchCosts that I could not easily determine at zero and added a CHECKME. This is more an indication that refinement is possible. \\n\\n Sorting subscorers\\/subspans by cost and matchCost is probably better than relying on any given order. \\nAnyway I don\'t expect the impact of matchCost on performance be more than 4-8% except maybe for really complex queries. \\n\\n Showing the matchCost in explain will be tricky because it is computed by LeafReaderContext, i.e. by segment. \\n\\n The matchCost is not yet used for the second phase in disjunctions. Yet another priority queue might be needed for that, so I\'d prefer to delay that to another issue. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14962547\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14962547&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14962547\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14962547_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962547_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Oct\\/15 18:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-18T18:20:52+0000\'\u003e18\\/Oct\\/15 18:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Paul Elschot - 18\\/Oct\\/15 18:25\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAnother thing to be determined is this the relative cost of span queries vs phrase queries.\u003cbr\\/\u003e\\nThe code for that is in SpanTermQuery here:\u003c\\/p\u003e\\n\u003cdiv class=\\\"code panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"codeContent panelContent\\\"\u003e\\n\u003cpre class=\\\"code-java\\\"\u003e  \\/** A guess of\\n   * the relative cost of dealing with the term positions\\n   * when using a SpanNearQuery instead of a PhraseQuery.\\n   *\\/\\n  \u003cspan class=\\\"code-keyword\\\"\u003eprivate\u003c\\/span\u003e \u003cspan class=\\\"code-keyword\\\"\u003efinal\u003c\\/span\u003e \u003cspan class=\\\"code-object\\\"\u003efloat\u003c\\/span\u003e PHRASE_TO_SPAN_TERM_POSITIONS_COST = 4.0f;\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\u003cp\u003eThis is a guess because it is only based on my recollection of a few years ago that the performance of PhraseQuery was about 4 times better than an ordered SpanNear.\u003cbr\\/\u003e\\nIn the long term it is probably better to make this a configurable parameter.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14962547_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962547_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Oct\\/15 18:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-18T18:20:52+0000\'\u003e18\\/Oct\\/15 18:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Paul Elschot - 18\\/Oct\\/15 18:25\\\"\u003eedited\u003c\\/span\u003e                   Another thing to be determined is this the relative cost of span queries vs phrase queries. \\nThe code for that is in SpanTermQuery here: \\n  \\n   \\/** A guess of\\n   * the relative cost of dealing with the term positions\\n   * when using a SpanNearQuery instead of a PhraseQuery.\\n   *\\/\\n   private   final   float  PHRASE_TO_SPAN_TERM_POSITIONS_COST = 4.0f;\\n \\n  \\n This is a guess because it is only based on my recollection of a few years ago that the performance of PhraseQuery was about 4 times better than an ordered SpanNear. \\nIn the long term it is probably better to make this a configurable parameter.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14962553\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14962553&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14962553\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14962553_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962553_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Oct\\/15 18:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-18T18:30:51+0000\'\u003e18\\/Oct\\/15 18:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eTalking about priority queues, there is also this one: \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-6453\\\" title=\\\"Specialize SpanPositionQueue similar to DisiPriorityQueue\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-6453\\\"\u003e\u003cdel\u003eLUCENE-6453\u003c\\/del\u003e\u003c\\/a\u003e.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14962553_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14962553_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Oct\\/15 18:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-18T18:30:51+0000\'\u003e18\\/Oct\\/15 18:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Talking about priority queues, there is also this one:   LUCENE-6453  .              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14963379\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14963379&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14963379\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14963379_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14963379_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Oct\\/15 14:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-19T14:25:35+0000\'\u003e19\\/Oct\\/15 14:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eIt will be difficult for many of the 2-phase implementations to calculate a matchCost \\u2013 particularly the ones not based on the number of term positions. What to do?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eAgreed: we need to come with a very simple definition of matchCost that could be applied regardless of how matches() is implemented. I think we have two options:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eeither an estimate running time of matches() in nanoseconds,\u003c\\/li\u003e\\n\\t\u003cli\u003eor an average number of operations that need to be performed in matches(), so that you would add +1 every time you do a comparison, arithmetic operation, consume a PostingsEnum, etc.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eRuntimes in nanoseconds could easily vary depending on hardware, JVM version, etc. so I think the 2nd option is more practical. For instance:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003efor a phrase query, we would return the sums of the average number of positions per documents (which is an estimate of how many times you will call PostingsEnum.nextPosition()). Maybe we could try to fold in the cost of balancing the priority queue too.\u003c\\/li\u003e\\n\\t\u003cli\u003efor a doc values range query on numbers, the match cost would be 3: one dv lookup and 2 comparisons\u003c\\/li\u003e\\n\\t\u003cli\u003efor a geo distance query that uses SloppyMath.haversin to confirm matches, we could easily count how many operations are performed by SloppyMath.haversin\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eThis is simplistic but I think it would do the job and keep the implementation simple. For instance, a doc values range query would always be confirmed before a geo-distance query.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eBut I see that the latest BooleanQuery.Builder is not stable due to use of HashSet \\/ MultiSet versus LinkedHashSet which would be stable. What do you think Adrien Grand? \u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eActually it is: those sets and multisets are only used for equals\\/hashcode. The creation of scorers is still based on the list of clauses, which maintains the order from the builder.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eShowing the matchCost in explain will be tricky because it is computed by LeafReaderContext, i.e. by segment.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003e+1 to not do it\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eThe matchCost is not yet used for the second phase in disjunctions. Yet another priority queue might be needed for that, so I\'d prefer to delay that to another issue.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eFeel free to delay, I plan to explore this in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-6815\\\" title=\\\"Should DisjunctionScorer advance more lazily?\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-6815\\\"\u003e\u003cdel\u003eLUCENE-6815\u003c\\/del\u003e\u003c\\/a\u003e.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14963379_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14963379_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Oct\\/15 14:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-19T14:25:35+0000\'\u003e19\\/Oct\\/15 14:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     It will be difficult for many of the 2-phase implementations to calculate a matchCost \\u2013 particularly the ones not based on the number of term positions. What to do?  \\n\\n Agreed: we need to come with a very simple definition of matchCost that could be applied regardless of how matches() is implemented. I think we have two options: \\n \\n\\t either an estimate running time of matches() in nanoseconds, \\n\\t or an average number of operations that need to be performed in matches(), so that you would add +1 every time you do a comparison, arithmetic operation, consume a PostingsEnum, etc. \\n \\n\\n\\n Runtimes in nanoseconds could easily vary depending on hardware, JVM version, etc. so I think the 2nd option is more practical. For instance: \\n \\n\\t for a phrase query, we would return the sums of the average number of positions per documents (which is an estimate of how many times you will call PostingsEnum.nextPosition()). Maybe we could try to fold in the cost of balancing the priority queue too. \\n\\t for a doc values range query on numbers, the match cost would be 3: one dv lookup and 2 comparisons \\n\\t for a geo distance query that uses SloppyMath.haversin to confirm matches, we could easily count how many operations are performed by SloppyMath.haversin \\n \\n\\n\\n This is simplistic but I think it would do the job and keep the implementation simple. For instance, a doc values range query would always be confirmed before a geo-distance query. \\n\\n  But I see that the latest BooleanQuery.Builder is not stable due to use of HashSet \\/ MultiSet versus LinkedHashSet which would be stable. What do you think Adrien Grand?   \\n\\n Actually it is: those sets and multisets are only used for equals\\/hashcode. The creation of scorers is still based on the list of clauses, which maintains the order from the builder. \\n\\n  Showing the matchCost in explain will be tricky because it is computed by LeafReaderContext, i.e. by segment.  \\n\\n +1 to not do it \\n\\n  The matchCost is not yet used for the second phase in disjunctions. Yet another priority queue might be needed for that, so I\'d prefer to delay that to another issue.  \\n\\n Feel free to delay, I plan to explore this in   LUCENE-6815  .              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14963465\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14963465&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14963465\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14963465_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14963465_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Oct\\/15 15:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-19T15:26:18+0000\'\u003e19\\/Oct\\/15 15:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRE BooleanQuery stable ordering: thanks for correcting me; I\'m very glad it\'s stable.  At least this gives the user some control.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think we may need to percolate the matchCost concept further into other APIs &#8211; namely ValueSource\\/FunctionValues.  This way the 2-phase iterator can enclose one of them to fetch the matchCost of it when composing it\'s aggregate matchCost.\u003c\\/p\u003e\\n\\n\u003cp\u003eAnd I question if a numeric DV lookup or reading a posting is equivalent to one mathematical operation since those things involve some code behind them that aren\'t cheap one-liners that a math operation are.  Nonetheless, I get the concept you are suggesting.  \u003c\\/p\u003e\\n\\n\u003cp\u003eI kind of like the time based approach you suggested better but what\'s needed is some automation to aid in establishing a baseline such that someone on their own machine can get an approximation slower\\/faster factor multiplier compared to some baseline server.  Like what if there was an ant target that ran some test based on Wikipedia data that established that the matchCost for a some PhraseQuery on the machine it\'s run on is ____ nanoseconds.  Then the output also displays some hard-coded value that we got when running this on some baseline server.  Dividing the two yields a relative difference between the local machine and the baseline server.  Then when working on a custom query, I could locally temporarily either modify the timing test to test my new query (perhaps plucking the geo data in Wikipedia out to a lat-lon spatial field) or timing it in my own way.  Then I apply the multiplier to determine which number to hard-code into the query going into Lucene.  Make sense?  \u003c\\/p\u003e\\n\\n\u003cp\u003eThere is another aspect of the cost beyond a per-postings iteration cost.  The cost of reading the N+1 position is generally going to be much cheaper than reading the very first position since the first once possibly involves a seek.  If only postings based queries are being compared via matchCost, this is a wash since all of them have this cost but it\'d be different for a doc-values based query.  Although perhaps it\'s a wash there too &#8211; assume one disk seek?  Worst case of course.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14963465_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14963465_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Oct\\/15 15:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-19T15:26:18+0000\'\u003e19\\/Oct\\/15 15:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    RE BooleanQuery stable ordering: thanks for correcting me; I\'m very glad it\'s stable.  At least this gives the user some control. \\n\\n I think we may need to percolate the matchCost concept further into other APIs &#8211; namely ValueSource\\/FunctionValues.  This way the 2-phase iterator can enclose one of them to fetch the matchCost of it when composing it\'s aggregate matchCost. \\n\\n And I question if a numeric DV lookup or reading a posting is equivalent to one mathematical operation since those things involve some code behind them that aren\'t cheap one-liners that a math operation are.  Nonetheless, I get the concept you are suggesting.   \\n\\n I kind of like the time based approach you suggested better but what\'s needed is some automation to aid in establishing a baseline such that someone on their own machine can get an approximation slower\\/faster factor multiplier compared to some baseline server.  Like what if there was an ant target that ran some test based on Wikipedia data that established that the matchCost for a some PhraseQuery on the machine it\'s run on is ____ nanoseconds.  Then the output also displays some hard-coded value that we got when running this on some baseline server.  Dividing the two yields a relative difference between the local machine and the baseline server.  Then when working on a custom query, I could locally temporarily either modify the timing test to test my new query (perhaps plucking the geo data in Wikipedia out to a lat-lon spatial field) or timing it in my own way.  Then I apply the multiplier to determine which number to hard-code into the query going into Lucene.  Make sense?   \\n\\n There is another aspect of the cost beyond a per-postings iteration cost.  The cost of reading the N+1 position is generally going to be much cheaper than reading the very first position since the first once possibly involves a seek.  If only postings based queries are being compared via matchCost, this is a wash since all of them have this cost but it\'d be different for a doc-values based query.  Although perhaps it\'s a wash there too &#8211; assume one disk seek?  Worst case of course.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14963540\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14963540&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14963540\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14963540_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14963540_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Oct\\/15 16:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-19T16:12:25+0000\'\u003e19\\/Oct\\/15 16:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003ean average number of operations that need to be performed in matches(), so that you would add +1 every time you do a comparison, arithmetic operation, consume a PostingsEnum, etc.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eThat sounds doable. The Lucene50PostingsReader takes about such 7 operations for a nextPosition() call  in case it does not seek and\\/or refill its buffer. I assume that would be the cost of consuming a PostingsEnum.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eThe cost of reading the N+1 position is generally going to be much cheaper than reading the very first position since the first once possibly involves a seek.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eTo take that into account an estimation of the seek\\/refill cost per term could be added in once per document.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003ewe may need to percolate the matchCost concept further into other APIs \\u2013 namely ValueSource\\/FunctionValues\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eCould that be done at another issue?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14963540_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14963540_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Oct\\/15 16:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-19T16:12:25+0000\'\u003e19\\/Oct\\/15 16:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     an average number of operations that need to be performed in matches(), so that you would add +1 every time you do a comparison, arithmetic operation, consume a PostingsEnum, etc.  \\n\\n That sounds doable. The Lucene50PostingsReader takes about such 7 operations for a nextPosition() call  in case it does not seek and\\/or refill its buffer. I assume that would be the cost of consuming a PostingsEnum. \\n\\n  The cost of reading the N+1 position is generally going to be much cheaper than reading the very first position since the first once possibly involves a seek.  \\n\\n To take that into account an estimation of the seek\\/refill cost per term could be added in once per document. \\n\\n  we may need to percolate the matchCost concept further into other APIs \\u2013 namely ValueSource\\/FunctionValues  \\n\\n Could that be done at another issue?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14963877\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14963877&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14963877\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14963877_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14963877_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Oct\\/15 19:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-19T19:13:10+0000\'\u003e19\\/Oct\\/15 19:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eTo take that into account an estimation of the seek\\/refill cost per term could be added in once per document.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eRight; I just wanted to point this out.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003ewe may need to percolate the matchCost concept further into other APIs \\u2013 namely ValueSource\\/FunctionValues\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\u003cblockquote\u003e\u003cp\u003eCould that be done at another issue?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eYes, of course.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dsmiley\\\" id=\\\"commentauthor_14963877_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dsmiley\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dsmiley\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e David Smiley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14963877_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Oct\\/15 19:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-19T19:13:10+0000\'\u003e19\\/Oct\\/15 19:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     To take that into account an estimation of the seek\\/refill cost per term could be added in once per document.  \\n\\n Right; I just wanted to point this out. \\n\\n  we may need to percolate the matchCost concept further into other APIs \\u2013 namely ValueSource\\/FunctionValues  \\n  Could that be done at another issue?  \\n\\n Yes, of course.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14977202\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14977202&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14977202\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14977202_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14977202_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Oct\\/15 21:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-27T21:27:57+0000\'\u003e27\\/Oct\\/15 21:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch of 27 October 2015. This\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eis against trunk of today,\u003c\\/li\u003e\\n\\t\u003cli\u003eresolves the conflicts from Spans becoming a Scorer,\u003c\\/li\u003e\\n\\t\u003cli\u003echanges the matchCost to be an estimate of the number of operations needed for the positions. This uses a cost of 7 per position as in the codec code, and a basic cost 128 (no more than a guess) for the initial seek and refill.\u003c\\/li\u003e\\n\\t\u003cli\u003eadds a few more implementations to make ant compile-test pass at top level.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eSince 7 is rather low and the expected number of positions per document containing the term is just above 1 in many cases, I left matchCost() returning a float.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14977202_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14977202_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Oct\\/15 21:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-27T21:27:57+0000\'\u003e27\\/Oct\\/15 21:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch of 27 October 2015. This \\n \\n\\t is against trunk of today, \\n\\t resolves the conflicts from Spans becoming a Scorer, \\n\\t changes the matchCost to be an estimate of the number of operations needed for the positions. This uses a cost of 7 per position as in the codec code, and a basic cost 128 (no more than a guess) for the initial seek and refill. \\n\\t adds a few more implementations to make ant compile-test pass at top level. \\n \\n\\n\\n Since 7 is rather low and the expected number of positions per document containing the term is just above 1 in many cases, I left matchCost() returning a float.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14980447\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14980447&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14980447\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14980447_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14980447_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/15 13:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-29T13:46:48+0000\'\u003e29\\/Oct\\/15 13:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSome suggestions:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003ecould the match costs be computed eagerly instead of lazily, like we compute the costs of DocIdSetIterators?\u003c\\/li\u003e\\n\\t\u003cli\u003ecan you move the utility methods to compute costs of phrases from TwoPhaseIterator into PhraseWeight\\/SpanNearQuery. I don\'t like leaking implementation details of specific TwoPhaseIterators into TwoPhaseIterator.\u003c\\/li\u003e\\n\\t\u003cli\u003esome implementations of matchCost return 0 (eg. RandomAccessWeight); I\'m fine with not implementing every match cost for now, but could you leave a TODO and use a higher constant (eg. 100)? I think it\'s safer to assume that such implementations are costly until they are implemented correctly.\u003c\\/li\u003e\\n\\t\u003cli\u003ere: ReqExclScorer: indeed I think we should try to take into account the cost of advancing the excluded scorer. If this is complicated, I\'m fine with tackling this problem later.\u003c\\/li\u003e\\n\\t\u003cli\u003ere: DisjunctionScorer: I think your current definition of the match cost is fine. Maybe we could improve it by weighting the match cost of each TwoPhaseIterator by the cost of their approximation. I think it would make sense since we will call TwoPhaseIterator.matches() more often if their approximation matches more documents.\u003c\\/li\u003e\\n\\t\u003cli\u003eAssertingSpans\\/AsseringScorer ensure that the match cost is &gt;= 0. Maybe we should also check for NaN and document acceptable return values in the documentation of #matchCost?\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14980447_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14980447_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/15 13:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-29T13:46:48+0000\'\u003e29\\/Oct\\/15 13:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Some suggestions: \\n \\n\\t could the match costs be computed eagerly instead of lazily, like we compute the costs of DocIdSetIterators? \\n\\t can you move the utility methods to compute costs of phrases from TwoPhaseIterator into PhraseWeight\\/SpanNearQuery. I don\'t like leaking implementation details of specific TwoPhaseIterators into TwoPhaseIterator. \\n\\t some implementations of matchCost return 0 (eg. RandomAccessWeight); I\'m fine with not implementing every match cost for now, but could you leave a TODO and use a higher constant (eg. 100)? I think it\'s safer to assume that such implementations are costly until they are implemented correctly. \\n\\t re: ReqExclScorer: indeed I think we should try to take into account the cost of advancing the excluded scorer. If this is complicated, I\'m fine with tackling this problem later. \\n\\t re: DisjunctionScorer: I think your current definition of the match cost is fine. Maybe we could improve it by weighting the match cost of each TwoPhaseIterator by the cost of their approximation. I think it would make sense since we will call TwoPhaseIterator.matches() more often if their approximation matches more documents. \\n\\t AssertingSpans\\/AsseringScorer ensure that the match cost is &gt;= 0. Maybe we should also check for NaN and document acceptable return values in the documentation of #matchCost? \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14980894\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14980894&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14980894\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14980894_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14980894_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/15 17:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-29T17:43:59+0000\'\u003e29\\/Oct\\/15 17:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI basically agree to all of these.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003e... move the utility methods to compute costs of phrases from TwoPhaseIterator into PhraseWeight\\/SpanNearQuery. I don\'t like leaking implementation details of specific TwoPhaseIterators into TwoPhaseIterator.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eand make them (package) private I assume? The only disadvantage of that is that some duplication of these methods is needed in the spans package.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe easiest way to avoid such duplication would be when Spans move from o.a.l.search.spans to o.a.l.search.\u003cbr\\/\u003e\\nIirc there was some talk of that not so long ago (Alan\'s plans for spans iirc), so how about waiting for that, possibly at a separate issue?\u003c\\/p\u003e\\n\\n\u003cp\u003eIt will take a while (at least a week) before I can continue with this. Please feel free to take it on.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14980894_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14980894_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'29\\/Oct\\/15 17:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-10-29T17:43:59+0000\'\u003e29\\/Oct\\/15 17:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I basically agree to all of these. \\n\\n  ... move the utility methods to compute costs of phrases from TwoPhaseIterator into PhraseWeight\\/SpanNearQuery. I don\'t like leaking implementation details of specific TwoPhaseIterators into TwoPhaseIterator.  \\n\\n and make them (package) private I assume? The only disadvantage of that is that some duplication of these methods is needed in the spans package. \\n\\n The easiest way to avoid such duplication would be when Spans move from o.a.l.search.spans to o.a.l.search. \\nIirc there was some talk of that not so long ago (Alan\'s plans for spans iirc), so how about waiting for that, possibly at a separate issue? \\n\\n It will take a while (at least a week) before I can continue with this. Please feel free to take it on.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14985922\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14985922&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14985922\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14985922_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14985922_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/15 20:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-02T20:06:56+0000\'\u003e02\\/Nov\\/15 20:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch of 2 Nov 2015.\u003cbr\\/\u003e\\nThis addresses all the above concerns.\u003cbr\\/\u003e\\nIt also precomputes positionsCost in SpanOrQuery, weighted by the cost() in the same way as matchCost.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14985922_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14985922_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/15 20:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-02T20:06:56+0000\'\u003e02\\/Nov\\/15 20:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch of 2 Nov 2015. \\nThis addresses all the above concerns. \\nIt also precomputes positionsCost in SpanOrQuery, weighted by the cost() in the same way as matchCost.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14989595\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14989595&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14989595\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14989595_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14989595_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Nov\\/15 14:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-04T14:15:24+0000\'\u003e04\\/Nov\\/15 14:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003ecan you add to the javadocs of TwoPhaseIterator#matchCost that match costs need to be a positive number?\u003c\\/li\u003e\\n\\t\u003cli\u003ecan you add some comments around the cost computation for disjunctions\\/conjunctions to explain the reasoning?\u003c\\/li\u003e\\n\\t\u003cli\u003eI would prefer termPositionsCost to be duplicated in PhraseWeight and SpanNearQuery than in TwoPhaseIterator, like we do for disjunctions (SpanOrQuery and DisjunctionScorer). I can understand the concerns around duplication but I think it\'s still cleaner than trying to share the logic by adding utility methods to TwoPhaseIterator.\u003c\\/li\u003e\\n\\t\u003cli\u003eI think SpanTermQuery.PHRASE_TO_SPAN_TERM_POSITIONS_COST should be static?\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eOtherwise the change looks good to me, I like the cost definition for conjunctions\\/disjunctions\\/phrases and we can tackle other queries in follow-up issues, but I think this is already a great start and will help execute slow queries more efficiently!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14989595_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14989595_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Nov\\/15 14:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-04T14:15:24+0000\'\u003e04\\/Nov\\/15 14:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    \\n\\t can you add to the javadocs of TwoPhaseIterator#matchCost that match costs need to be a positive number? \\n\\t can you add some comments around the cost computation for disjunctions\\/conjunctions to explain the reasoning? \\n\\t I would prefer termPositionsCost to be duplicated in PhraseWeight and SpanNearQuery than in TwoPhaseIterator, like we do for disjunctions (SpanOrQuery and DisjunctionScorer). I can understand the concerns around duplication but I think it\'s still cleaner than trying to share the logic by adding utility methods to TwoPhaseIterator. \\n\\t I think SpanTermQuery.PHRASE_TO_SPAN_TERM_POSITIONS_COST should be static? \\n \\n\\n\\n Otherwise the change looks good to me, I like the cost definition for conjunctions\\/disjunctions\\/phrases and we can tackle other queries in follow-up issues, but I think this is already a great start and will help execute slow queries more efficiently!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14995427\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14995427&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14995427\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14995427_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14995427_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Nov\\/15 22:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-07T22:21:24+0000\'\u003e07\\/Nov\\/15 22:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch of 7 Nov 2015.\u003cbr\\/\u003e\\nThis addresses all concerns of 3 days ago.\u003cbr\\/\u003e\\ntermPositionsCost moved from TwoPhaseIterator to PhraseQuery, I left a copy in SpanTermQuery because that is where it is used.\u003c\\/p\u003e\\n\\n\u003cp\u003ePerhaps the result of ConjunctionSpans.asTwoPhaseIterator() should look more like TwoPhaseConjunctionDISI, at the moment I cannot get my head around this.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14995427_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14995427_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Nov\\/15 22:21\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-07T22:21:24+0000\'\u003e07\\/Nov\\/15 22:21\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch of 7 Nov 2015. \\nThis addresses all concerns of 3 days ago. \\ntermPositionsCost moved from TwoPhaseIterator to PhraseQuery, I left a copy in SpanTermQuery because that is where it is used. \\n\\n Perhaps the result of ConjunctionSpans.asTwoPhaseIterator() should look more like TwoPhaseConjunctionDISI, at the moment I cannot get my head around this. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14997422\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14997422&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14997422\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14997422_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14997422_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Nov\\/15 21:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-09T21:45:39+0000\'\u003e09\\/Nov\\/15 21:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI went over the patch and the earlier posts to get an overview of open points, TODO\'s, etc.\u003cbr\\/\u003e\\nThere are quite a lot of them, so we\'ll need to prioritize and\\/or move\\/defer to other issues.\u003c\\/p\u003e\\n\\n\u003cp\u003elucene core:\u003c\\/p\u003e\\n\\n\u003cp\u003eConjunctionDISI matchCost(): give the lower matchCosts a higher weight\u003c\\/p\u003e\\n\\n\u003cp\u003ePhraseQuery:\u003cbr\\/\u003e\\nTERM_POSNS_SEEK_OPS_PER_DOC = 128, guess\u003cbr\\/\u003e\\nPHRASE_TO_SPAN_TERM_POSITIONS_COST = 4, guess\u003c\\/p\u003e\\n\\n\u003cp\u003eTwoPhaseIterator: Return value of matchCost(): long instead of float?\u003c\\/p\u003e\\n\\n\u003cp\u003eRandomAccessWeight matchCost(): 10, use cost of matchingDocs.get()\u003c\\/p\u003e\\n\\n\u003cp\u003eReqExclScorer matchCost(): also use cost of exclApproximation.advance()\u003c\\/p\u003e\\n\\n\u003cp\u003eSpanTermQuery: termPositionsCost is copy of PhraseQuery termPositionsCost\u003c\\/p\u003e\\n\\n\u003cp\u003eSpanOrQuery: add cost of balancing priority queues for positions?\u003c\\/p\u003e\\n\\n\\n\u003cp\u003efacet module (defer to other issue):\u003c\\/p\u003e\\n\\n\u003cp\u003eDoubleRange matchCost(): 100, use cost of range.accept()\u003cbr\\/\u003e\\nLongRange matchCost(): 100, use cost of range.accept()\u003c\\/p\u003e\\n\\n\\n\u003cp\u003ejoin module (defer to other issue ?):\u003c\\/p\u003e\\n\\n\u003cp\u003eGlobalOrdinals(WithScore)Query matchCost(): 100, use cost of values.getOrd() and foundOrds.get()\u003cbr\\/\u003e\\nGlobalOrdinals(WithScore)Query 2nd matchCost(): 100, use cost of values.getOrd() and foundOrds.get()\u003c\\/p\u003e\\n\\n\\n\u003cp\u003equeries module (defer to other issue):\u003c\\/p\u003e\\n\\n\u003cp\u003eValueSourceScorer matchCost(): 100, use cost of ValueSourceScorer.this.matches()ValueSourceScorer matchCost(): 100, use cost of \u003c\\/p\u003e\\n\\n\\n\u003cp\u003espatial module (defer to other issue)::\u003c\\/p\u003e\\n\\n\u003cp\u003eCompositeVerifyQuery matchCost(): 100, use cost of predFuncValues.boolVal()\u003cbr\\/\u003e\\nIntersectsRPTVerifyQuery matchCost(): 100, use cost of exactIterator.advance() and predFuncValues.boolVal()\u003c\\/p\u003e\\n\\n\u003cp\u003etest-framework module:\u003c\\/p\u003e\\n\\n\u003cp\u003eRandomApproximationQuery randomMatchCost: between 0 and 200: ok?\u003c\\/p\u003e\\n\\n\u003cp\u003esolr core:\u003c\\/p\u003e\\n\\n\u003cp\u003eFilter matchCost(): 10, use cost of bits.get() ?\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eAt this issue:\u003c\\/p\u003e\\n\\n\u003cp\u003ePerformance test based on Wikipedia to estimate guessed values.\u003c\\/p\u003e\\n\\n\u003cp\u003etests for matchCost() ?\u003c\\/p\u003e\\n\\n\u003cp\u003eCheck result of ConjunctionSpans.asTwoPhaseIterator: more similar to TwoPhaseConjunctionDISI ?\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eFor other issues:\u003c\\/p\u003e\\n\\n\u003cp\u003eAt \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-6871\\\" title=\\\"Move SpanQueries out of .spans package\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-6871\\\"\u003eLUCENE-6871\u003c\\/a\u003e remove copy of SpanTermQuery.termPositionsCost(). \u003c\\/p\u003e\\n\\n\u003cp\u003eSpanOrQuery is getting too big, split off DisjunctionSpans.\u003c\\/p\u003e\\n\\n\u003cp\u003ecost() implementation of conjunctions and disjunctions could improve: add use of indepence assumption.\u003cbr\\/\u003e\\nThe result of cost() is used here for weighting, so it should be good as possible.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14997422_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14997422_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Nov\\/15 21:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-09T21:45:39+0000\'\u003e09\\/Nov\\/15 21:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I went over the patch and the earlier posts to get an overview of open points, TODO\'s, etc. \\nThere are quite a lot of them, so we\'ll need to prioritize and\\/or move\\/defer to other issues. \\n\\n lucene core: \\n\\n ConjunctionDISI matchCost(): give the lower matchCosts a higher weight \\n\\n PhraseQuery: \\nTERM_POSNS_SEEK_OPS_PER_DOC = 128, guess \\nPHRASE_TO_SPAN_TERM_POSITIONS_COST = 4, guess \\n\\n TwoPhaseIterator: Return value of matchCost(): long instead of float? \\n\\n RandomAccessWeight matchCost(): 10, use cost of matchingDocs.get() \\n\\n ReqExclScorer matchCost(): also use cost of exclApproximation.advance() \\n\\n SpanTermQuery: termPositionsCost is copy of PhraseQuery termPositionsCost \\n\\n SpanOrQuery: add cost of balancing priority queues for positions? \\n\\n\\n facet module (defer to other issue): \\n\\n DoubleRange matchCost(): 100, use cost of range.accept() \\nLongRange matchCost(): 100, use cost of range.accept() \\n\\n\\n join module (defer to other issue ?): \\n\\n GlobalOrdinals(WithScore)Query matchCost(): 100, use cost of values.getOrd() and foundOrds.get() \\nGlobalOrdinals(WithScore)Query 2nd matchCost(): 100, use cost of values.getOrd() and foundOrds.get() \\n\\n\\n queries module (defer to other issue): \\n\\n ValueSourceScorer matchCost(): 100, use cost of ValueSourceScorer.this.matches()ValueSourceScorer matchCost(): 100, use cost of  \\n\\n\\n spatial module (defer to other issue):: \\n\\n CompositeVerifyQuery matchCost(): 100, use cost of predFuncValues.boolVal() \\nIntersectsRPTVerifyQuery matchCost(): 100, use cost of exactIterator.advance() and predFuncValues.boolVal() \\n\\n test-framework module: \\n\\n RandomApproximationQuery randomMatchCost: between 0 and 200: ok? \\n\\n solr core: \\n\\n Filter matchCost(): 10, use cost of bits.get() ? \\n\\n\\n At this issue: \\n\\n Performance test based on Wikipedia to estimate guessed values. \\n\\n tests for matchCost() ? \\n\\n Check result of ConjunctionSpans.asTwoPhaseIterator: more similar to TwoPhaseConjunctionDISI ? \\n\\n\\n For other issues: \\n\\n At  LUCENE-6871  remove copy of SpanTermQuery.termPositionsCost().  \\n\\n SpanOrQuery is getting too big, split off DisjunctionSpans. \\n\\n cost() implementation of conjunctions and disjunctions could improve: add use of indepence assumption. \\nThe result of cost() is used here for weighting, so it should be good as possible.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14997705\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14997705&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14997705\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14997705_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14997705_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Nov\\/15 00:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-10T00:05:41+0000\'\u003e10\\/Nov\\/15 00:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cblockquote\u003e\u003cp\u003eConjunctionDISI matchCost(): give the lower matchCosts a higher weight\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eWe could use the likelyness of a match, which should be given by Scorer.asTwoPhaseApproximation().approximation().cost()\\/Scorer.cost() even though I suspect that most implementations have no way to figure it out (eg. numeric doc values ranges). But I think we should defer, it\'s fine to assume worst case like the patch does today.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003eTwoPhaseIterator: Return value of matchCost(): long instead of float?\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI would be ok with both, but given that matchCost is documented as \\\"an expected cost in number of simple operations\\\", maybe a long makes more sense? It also has the benefit of avoiding issues with \\u00B10, Nans, infinities, etc.\u003c\\/p\u003e\\n\\n\u003cblockquote\u003e\u003cp\u003ePerformance test based on Wikipedia to estimate guessed values.\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eI think this change is very hard to benchmark... I\'m personally fine with moving on here without performance benchmarks.\u003c\\/p\u003e\\n\\n\u003cp\u003eFor other ones that I did not reply to, I suggest that we defer them: I don\'t think they should hold this change.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_14997705_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14997705_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Nov\\/15 00:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-10T00:05:41+0000\'\u003e10\\/Nov\\/15 00:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                     ConjunctionDISI matchCost(): give the lower matchCosts a higher weight  \\n\\n We could use the likelyness of a match, which should be given by Scorer.asTwoPhaseApproximation().approximation().cost()\\/Scorer.cost() even though I suspect that most implementations have no way to figure it out (eg. numeric doc values ranges). But I think we should defer, it\'s fine to assume worst case like the patch does today. \\n\\n  TwoPhaseIterator: Return value of matchCost(): long instead of float?  \\n\\n I would be ok with both, but given that matchCost is documented as \\\"an expected cost in number of simple operations\\\", maybe a long makes more sense? It also has the benefit of avoiding issues with \\u00B10, Nans, infinities, etc. \\n\\n  Performance test based on Wikipedia to estimate guessed values.  \\n\\n I think this change is very hard to benchmark... I\'m personally fine with moving on here without performance benchmarks. \\n\\n For other ones that I did not reply to, I suggest that we defer them: I don\'t think they should hold this change.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14998236\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=14998236&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14998236\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14998236_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14998236_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Nov\\/15 08:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-10T08:20:23+0000\'\u003e10\\/Nov\\/15 08:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAs to long\\/float: the expected outcome of rolling a dice is not a whole number, and as it happens, that has some similarities with the situation here.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_14998236_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14998236_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Nov\\/15 08:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-10T08:20:23+0000\'\u003e10\\/Nov\\/15 08:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    As to long\\/float: the expected outcome of rolling a dice is not a whole number, and as it happens, that has some similarities with the situation here.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15001142\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=15001142&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15001142\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_15001142_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15001142_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Nov\\/15 21:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-11T21:31:41+0000\'\u003e11\\/Nov\\/15 21:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have opened \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-6894\\\" title=\\\"Improve DISI.cost() by assuming independence for match probabilities\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-6894\\\"\u003e\u003cdel\u003eLUCENE-6894\u003c\\/del\u003e\u003c\\/a\u003e for the independence assumption for DISI.cost().\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_15001142_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15001142_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Nov\\/15 21:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-11T21:31:41+0000\'\u003e11\\/Nov\\/15 21:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have opened   LUCENE-6894   for the independence assumption for DISI.cost().              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15001228\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=15001228&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15001228\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_15001228_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15001228_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Nov\\/15 22:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-11T22:15:05+0000\'\u003e11\\/Nov\\/15 22:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m +1 on the patch. I\'ll do some more testing locally in the next days and commit it.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_15001228_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15001228_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Nov\\/15 22:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-11T22:15:05+0000\'\u003e11\\/Nov\\/15 22:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m +1 on the patch. I\'ll do some more testing locally in the next days and commit it.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15002373\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=15002373&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15002373\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_15002373_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15002373_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 16:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T16:39:10+0000\'\u003e12\\/Nov\\/15 16:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHmm, I\'m getting failures with ComplexPhraseQuery:\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e   [junit4] Suite: org.apache.lucene.queryparser.complexPhrase.TestComplexPhraseQuery\\n   [junit4]   2&gt; NOTE: reproduce with: ant test  -Dtestcase=TestComplexPhraseQuery -Dtests.method=testComplexPhrases -Dtests.seed=E7F242A6F40525AB -Dtests.slow=true -Dtests.locale=in_ID -Dtests.timezone=Africa\\/Banjul -Dtests.asserts=true -Dtests.file.encoding=ISO-8859-1\\n   [junit4] FAILURE 0.18s J2 | TestComplexPhraseQuery.testComplexPhrases &lt;&lt;&lt;\\n   [junit4]    &gt; Throwable #1: java.lang.AssertionError\\n   [junit4]    &gt; \\tat __randomizedtesting.SeedInfo.seed([E7F242A6F40525AB:8259F91767B2FFA3]:0)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.SpanOrQuery$SpanOrWeight$1.positionsCost(SpanOrQuery.java:261)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.ScoringWrapperSpans.positionsCost(ScoringWrapperSpans.java:88)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.FilterSpans$2.matchCost(FilterSpans.java:167)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.ConjunctionDISI$TwoPhaseConjunctionDISI.&lt;init&gt;(ConjunctionDISI.java:186)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.ConjunctionDISI$TwoPhaseConjunctionDISI.&lt;init&gt;(ConjunctionDISI.java:164)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.ConjunctionDISI$TwoPhase.&lt;init&gt;(ConjunctionDISI.java:227)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.ConjunctionDISI$TwoPhase.&lt;init&gt;(ConjunctionDISI.java:221)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.ConjunctionDISI.intersect(ConjunctionDISI.java:50)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.ConjunctionSpans.&lt;init&gt;(ConjunctionSpans.java:43)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.NearSpansOrdered.&lt;init&gt;(NearSpansOrdered.java:56)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.SpanNearQuery$SpanNearWeight.getSpans(SpanNearQuery.java:223)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.SpanWeight.scorer(SpanWeight.java:134)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.Weight.bulkScorer(Weight.java:135)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.AssertingWeight.bulkScorer(AssertingWeight.java:69)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.AssertingWeight.bulkScorer(AssertingWeight.java:69)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:667)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.AssertingIndexSearcher.search(AssertingIndexSearcher.java:92)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:474)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:593)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.IndexSearcher.searchAfter(IndexSearcher.java:451)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:462)\\n   [junit4]    &gt; \\tat org.apache.lucene.queryparser.complexPhrase.TestComplexPhraseQuery.checkMatches(TestComplexPhraseQuery.java:116)\\n   [junit4]    &gt; \\tat org.apache.lucene.queryparser.complexPhrase.TestComplexPhraseQuery.testComplexPhrases(TestComplexPhraseQuery.java:58)\\n   [junit4]    &gt; \\tat java.lang.Thread.run(Thread.java:745)\\n   [junit4]   2&gt; NOTE: test params are: codec=Asserting(Lucene60): {role=PostingsFormat(name=Memory doPackFST= false), name=PostingsFormat(name=LuceneFixedGap), id=PostingsFormat(name=LuceneFixedGap)}, docValues:{}, sim=RandomSimilarityProvider(queryNorm=true,coord=no): {role=DFR I(n)LZ(0.3), name=DFR I(n)3(800.0), id=DFR I(n)3(800.0)}, locale=in_ID, timezone=Africa\\/Banjul\\n   [junit4]   2&gt; NOTE: Linux 3.13.0-68-generic amd64\\/Oracle Corporation 1.8.0_66-ea (64-bit)\\/cpus=8,threads=1,free=187449736,total=253231104\\n   [junit4]   2&gt; NOTE: All tests run in this JVM: [TestNumericRangeQueryBuilder, TestExtendableQueryParser, TestSpanQueryParser, TestExtensions, TestComplexPhraseQuery]\\n   [junit4] Completed [11\\/27] on J2 in 0.50s, 5 tests, 1 failure &lt;&lt;&lt; FAILURES!\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eI haven\'t looked into it yet.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_15002373_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15002373_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 16:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T16:39:10+0000\'\u003e12\\/Nov\\/15 16:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Hmm, I\'m getting failures with ComplexPhraseQuery: \\n\\n  \\n    [junit4] Suite: org.apache.lucene.queryparser.complexPhrase.TestComplexPhraseQuery\\n   [junit4]   2&gt; NOTE: reproduce with: ant test  -Dtestcase=TestComplexPhraseQuery -Dtests.method=testComplexPhrases -Dtests.seed=E7F242A6F40525AB -Dtests.slow=true -Dtests.locale=in_ID -Dtests.timezone=Africa\\/Banjul -Dtests.asserts=true -Dtests.file.encoding=ISO-8859-1\\n   [junit4] FAILURE 0.18s J2 | TestComplexPhraseQuery.testComplexPhrases &lt;&lt;&lt;\\n   [junit4]    &gt; Throwable #1: java.lang.AssertionError\\n   [junit4]    &gt; \\tat __randomizedtesting.SeedInfo.seed([E7F242A6F40525AB:8259F91767B2FFA3]:0)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.SpanOrQuery$SpanOrWeight$1.positionsCost(SpanOrQuery.java:261)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.ScoringWrapperSpans.positionsCost(ScoringWrapperSpans.java:88)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.FilterSpans$2.matchCost(FilterSpans.java:167)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.ConjunctionDISI$TwoPhaseConjunctionDISI.&lt;init&gt;(ConjunctionDISI.java:186)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.ConjunctionDISI$TwoPhaseConjunctionDISI.&lt;init&gt;(ConjunctionDISI.java:164)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.ConjunctionDISI$TwoPhase.&lt;init&gt;(ConjunctionDISI.java:227)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.ConjunctionDISI$TwoPhase.&lt;init&gt;(ConjunctionDISI.java:221)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.ConjunctionDISI.intersect(ConjunctionDISI.java:50)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.ConjunctionSpans.&lt;init&gt;(ConjunctionSpans.java:43)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.NearSpansOrdered.&lt;init&gt;(NearSpansOrdered.java:56)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.SpanNearQuery$SpanNearWeight.getSpans(SpanNearQuery.java:223)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.spans.SpanWeight.scorer(SpanWeight.java:134)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.Weight.bulkScorer(Weight.java:135)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.AssertingWeight.bulkScorer(AssertingWeight.java:69)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.AssertingWeight.bulkScorer(AssertingWeight.java:69)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:667)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.AssertingIndexSearcher.search(AssertingIndexSearcher.java:92)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:474)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:593)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.IndexSearcher.searchAfter(IndexSearcher.java:451)\\n   [junit4]    &gt; \\tat org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:462)\\n   [junit4]    &gt; \\tat org.apache.lucene.queryparser.complexPhrase.TestComplexPhraseQuery.checkMatches(TestComplexPhraseQuery.java:116)\\n   [junit4]    &gt; \\tat org.apache.lucene.queryparser.complexPhrase.TestComplexPhraseQuery.testComplexPhrases(TestComplexPhraseQuery.java:58)\\n   [junit4]    &gt; \\tat java.lang.Thread.run(Thread.java:745)\\n   [junit4]   2&gt; NOTE: test params are: codec=Asserting(Lucene60): {role=PostingsFormat(name=Memory doPackFST= false), name=PostingsFormat(name=LuceneFixedGap), id=PostingsFormat(name=LuceneFixedGap)}, docValues:{}, sim=RandomSimilarityProvider(queryNorm=true,coord=no): {role=DFR I(n)LZ(0.3), name=DFR I(n)3(800.0), id=DFR I(n)3(800.0)}, locale=in_ID, timezone=Africa\\/Banjul\\n   [junit4]   2&gt; NOTE: Linux 3.13.0-68-generic amd64\\/Oracle Corporation 1.8.0_66-ea (64-bit)\\/cpus=8,threads=1,free=187449736,total=253231104\\n   [junit4]   2&gt; NOTE: All tests run in this JVM: [TestNumericRangeQueryBuilder, TestExtendableQueryParser, TestSpanQueryParser, TestExtensions, TestComplexPhraseQuery]\\n   [junit4] Completed [11\\/27] on J2 in 0.50s, 5 tests, 1 failure &lt;&lt;&lt; FAILURES!\\n \\n  \\n\\n I haven\'t looked into it yet.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15002694\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=15002694&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15002694\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_15002694_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15002694_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 19:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T19:19:43+0000\'\u003e12\\/Nov\\/15 19:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe test failure reproduces here. I\'ll take a look, thanks.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_15002694_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15002694_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 19:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T19:19:43+0000\'\u003e12\\/Nov\\/15 19:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The test failure reproduces here. I\'ll take a look, thanks.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15002831\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=15002831&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15002831\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_15002831_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15002831_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 20:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T20:10:29+0000\'\u003e12\\/Nov\\/15 20:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis failure disappeared after adding asTwoPhaseIterator() to ScoringWrapperSpans. I\'ll post a new patch later.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_15002831_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15002831_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 20:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T20:10:29+0000\'\u003e12\\/Nov\\/15 20:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This failure disappeared after adding asTwoPhaseIterator() to ScoringWrapperSpans. I\'ll post a new patch later.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15003010\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=15003010&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15003010\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_15003010_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15003010_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 21:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T21:55:16+0000\'\u003e12\\/Nov\\/15 21:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch of 12 Nov 2015.\u003cbr\\/\u003e\\nAdds ScoringWrapperSpans.asTwoPhaseIterator().\u003c\\/p\u003e\\n\\n\u003cp\u003eThis missing method could be a bug in itself.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"paul.elschot@xs4all.nl\\\" id=\\\"commentauthor_15003010_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=paul.elschot%40xs4all.nl\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"paul.elschot@xs4all.nl\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Paul Elschot\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15003010_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 21:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T21:55:16+0000\'\u003e12\\/Nov\\/15 21:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch of 12 Nov 2015. \\nAdds ScoringWrapperSpans.asTwoPhaseIterator(). \\n\\n This missing method could be a bug in itself.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15004632\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=15004632&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15004632\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15004632_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15004632_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Nov\\/15 20:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-13T20:08:02+0000\'\u003e13\\/Nov\\/15 20:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1714261 from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\" class=\\\"user-hover\\\" rel=\\\"jpountz\\\"\u003eAdrien Grand\u003c\\/a\u003e in branch \'dev\\/trunk\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1714261\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1714261\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-6276\\\" title=\\\"Add matchCost() api to TwoPhaseDocIdSetIterator\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-6276\\\"\u003e\u003cdel\u003eLUCENE-6276\u003c\\/del\u003e\u003c\\/a\u003e: Added TwoPhaseIterator.matchCost().\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15004632_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15004632_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Nov\\/15 20:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-13T20:08:02+0000\'\u003e13\\/Nov\\/15 20:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1714261 from  Adrien Grand  in branch \'dev\\/trunk\' \\n[  https:\\/\\/svn.apache.org\\/r1714261  ] \\n\\n   LUCENE-6276  : Added TwoPhaseIterator.matchCost().              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15004701\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=15004701&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15004701\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15004701_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15004701_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Nov\\/15 20:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-13T20:55:21+0000\'\u003e13\\/Nov\\/15 20:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1714266 from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\" class=\\\"user-hover\\\" rel=\\\"jpountz\\\"\u003eAdrien Grand\u003c\\/a\u003e in branch \'dev\\/branches\\/branch_5x\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1714266\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1714266\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-6276\\\" title=\\\"Add matchCost() api to TwoPhaseDocIdSetIterator\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-6276\\\"\u003e\u003cdel\u003eLUCENE-6276\u003c\\/del\u003e\u003c\\/a\u003e: Added TwoPhaseIterator.matchCost().\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15004701_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15004701_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Nov\\/15 20:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-13T20:55:21+0000\'\u003e13\\/Nov\\/15 20:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1714266 from  Adrien Grand  in branch \'dev\\/branches\\/branch_5x\' \\n[  https:\\/\\/svn.apache.org\\/r1714266  ] \\n\\n   LUCENE-6276  : Added TwoPhaseIterator.matchCost().              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15004703\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-6276?focusedCommentId=15004703&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15004703\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_15004703_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15004703_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Nov\\/15 20:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-13T20:56:01+0000\'\u003e13\\/Nov\\/15 20:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI just committed the changes. Thanks Paul!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jpountz\\\" id=\\\"commentauthor_15004703_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jpountz\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jpountz\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Adrien Grand\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15004703_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Nov\\/15 20:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-13T20:56:01+0000\'\u003e13\\/Nov\\/15 20:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I just committed the changes. Thanks Paul!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310110";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310110&amp;avatarId=10061\\\" alt=\\\"Lucene - Core\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\"\u003eLucene - Core\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1516206060399"> 
    <input type="hidden" title="jira.request.server.time" value="488"> 
    <input type="hidden" title="jira.request.id" value="981x7827500x10"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="7"> 
    <input type="hidden" title="db.reads.time.in.ms" value="57"> 
    <input type="hidden" title="db.conns.time.in.ms" value="64"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 981x7827500x10
	          REQUEST TIMESTAMP : [17/Jan/2018:16:21:00 +0000]
	               REQUEST TIME : 0.4890
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 7

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=24, elapsedTotal=57050108, elapsedMin=625389, elapsedMax=16322090, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=28, elapsedTotal=64548059, elapsedMin=689991, elapsedMax=16819042, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|88db89e8d7323768907b1ae1ced5a10233b63b1b|lout"> 
  <link rel="shortcut icon" href="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"jira.instrumentation.laas\":false,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"com.atlassian.jira.issuetable.draggable\":true,\"jira.create.linked.issue\":true,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"jira.jql.suggestrecentfields\":false,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"jira.jql.smartautoselectfirst\":false,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.priorities.per.project\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"jira.renderer.consider.variable.format\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/vnd.wap.wbmp,image/png,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"587f7ffb81e51b\"";
WRM._unparsedData["project-id"]="10594";
WRM._unparsedData["project-key"]="\"DERBY\"";
WRM._unparsedData["project-name"]="\"Derby\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="10594";
WRM._unparsedData["projectKey"]="\"DERBY\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/74ac580603ca910fff0cfdf319e54add-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/98ceb006e504d7924d5ffc411626c6bc-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/c1e4d26ea276469807c3dc0918df482c-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/6bf9253c8d533109c3b02e26794be24e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/ccd2e67b523185973473e8bd5735c8f9-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/33e5e0166867c8c9228d44506f60b2e8/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/6579b6b8ba67abaa496e39b9242a18a4-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="DERBY-5037"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[DERBY-5037] Assertion failure from index-stat-thread when running AutomaticIndexStatisticsTest - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[DERBY-5037] Assertion failure from index-stat-thread when running AutomaticIndexStatisticsTest - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/DERBY" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-5037">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="10594" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Derby'" src="https://issues.apache.org/jira/secure/projectavatar?pid=10594&amp;avatarId=10122"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/DERBY">Derby</a></li>
                 <li><a class="issue-link" data-issue-key="DERBY-5037" href="/jira/browse/DERBY-5037" id="key-val" rel="12498544">DERBY-5037</a></li>
                </ol>
                <h1 id="summary-val">Assertion failure from index-stat-thread when running AutomaticIndexStatisticsTest</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-5037"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/DERBY-5037/DERBY-5037.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/DERBY-5037/DERBY-5037.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/DERBY-5037/DERBY-5037.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/DERBY-5037/DERBY-5037.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" title="Bug - A problem which impairs or prevents the functions of the product." width="16"> Bug </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="10.8.1.2 First release on the 10.8 branch">10.8.1.2</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+fixVersion+%3D+10.8.1.2" title="10.8.1.2 First release on the 10.8 branch">10.8.1.2</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+component+%3D+Test" title="Test ">Test</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <ul class="labels" id="labels-12498544-value"> 
                     <li><a class="lozenge" href="/jira/issues/?jql=labels+%3D+derby_backport_reject_10_5" title="derby_backport_reject_10_5"><span>derby_backport_reject_10_5</span></a></li> 
                    </ul> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310050" class="item"> 
                     <div class="wrap"> 
                      <strong title="Urgency" class="name">Urgency:</strong> 
                      <div id="customfield_12310050-val" class="value type-select" data-fieldtype="select" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        Normal 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>I see the following assertion failure on the console when running AutomaticIndexStatisticsTest standalone against debug jars. This may be related to <a href="https://issues.apache.org/jira/browse/DERBY-5026" title="testStatsCreatedOnGrowthThenDeleteDb failing with ibm15 on trunk. The revision on trunk is 1069665 " class="issue-link" data-issue-key="DERBY-5026"><del>DERBY-5026</del></a>, <a href="https://issues.apache.org/jira/browse/DERBY-5030" title=" &quot;index-stat-thread&quot; java.lang.NullPointerException at store.access.btree.ControlRow.getControlRowForPage in suites.All " class="issue-link" data-issue-key="DERBY-5030"><del>DERBY-5030</del></a>, and <a href="https://issues.apache.org/jira/browse/DERBY-5031" title="Exception in thread &quot;index-stat-thread&quot; java.lang.NullPointerException while calling ControlRow.getControlRowForPage(Unknown Source)" class="issue-link" data-issue-key="DERBY-5031"><del>DERBY-5031</del></a>. The test itself completes successfully:</p> 
                  <p>...Exception in thread "index-stat-thread" org.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED No page at pagenumber: 1; ContainerHandle = BaseContainerHandle:(Container(0, 1153))<br> at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:162)<br> at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:147)<br> at org.apache.derby.impl.store.access.btree.ControlRow.get(ControlRow.java:838)<br> at org.apache.derby.impl.store.access.btree.ControlRow.get(ControlRow.java:820)<br> at org.apache.derby.impl.store.access.btree.BTreeScan.reposition(BTreeScan.java:850)<br> at org.apache.derby.impl.store.access.btree.BTreeForwardScan.fetchRows(BTreeForwardScan.java:109)<br> at org.apache.derby.impl.store.access.btree.BTreeScan.fetchNextGroup(BTreeScan.java:1596)<br> at org.apache.derby.impl.services.daemon.IndexStatisticsDaemonImpl$KeyComparator.fetchRows(IndexStatisticsDaemonImpl.java:1103)<br> at org.apache.derby.impl.services.daemon.IndexStatisticsDaemonImpl.updateIndexStatsMinion(IndexStatisticsDaemonImpl.java:453)<br> at org.apache.derby.impl.services.daemon.IndexStatisticsDaemonImpl.generateStatistics(IndexStatisticsDaemonImpl.java:324)<br> at org.apache.derby.impl.services.daemon.IndexStatisticsDaemonImpl.run(IndexStatisticsDaemonImpl.java:710)<br> at java.lang.Thread.run(Thread.java:637)<br> ---------------<br> Stack traces for all live threads:<br> Thread name=derby.rawStoreDaemon id=13 priority=5 state=TIMED_WAITING isdaemon=true<br> java.lang.Object.wait(Native Method)<br> org.apache.derby.impl.services.daemon.BasicDaemon.rest(BasicDaemon.java:576)<br> org.apache.derby.impl.services.daemon.BasicDaemon.run(BasicDaemon.java:390)<br> java.lang.Thread.run(Thread.java:637)</p> 
                  <p>Thread name=Finalizer id=3 priority=8 state=WAITING isdaemon=true<br> java.lang.Object.wait(Native Method)<br> java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:118)<br> java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:134)<br> java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)</p> 
                  <p>Thread name=Reference Handler id=2 priority=10 state=WAITING isdaemon=true<br> java.lang.Object.wait(Native Method)<br> java.lang.Object.wait(Object.java:485)<br> java.lang.ref.Reference$ReferenceHandler.run(Reference.java:116)</p> 
                  <p>Thread name=main id=1 priority=5 state=RUNNABLE isdaemon=false<br> java.security.AccessController.doPrivileged(Native Method)<br> org.apache.derby.impl.store.raw.data.BaseDataFileFactory.releaseJBMSLockOnDB(BaseDataFileFactory.java:2040)<br> org.apache.derby.impl.store.raw.data.BaseDataFileFactory.stop(BaseDataFileFactory.java:519)<br> org.apache.derby.impl.services.monitor.TopService.stop(TopService.java:442)<br> org.apache.derby.impl.services.monitor.TopService.shutdown(TopService.java:393)<br> org.apache.derby.impl.services.monitor.BaseMonitor.shutdown(BaseMonitor.java:229)<br> org.apache.derby.impl.db.DatabaseContextImpl.cleanupOnError(DatabaseContextImpl.java:62)<br> org.apache.derby.iapi.services.context.ContextManager.cleanupOnError(ContextManager.java:343)<br> org.apache.derby.impl.jdbc.TransactionResourceImpl.cleanupOnError(TransactionResourceImpl.java:433)<br> org.apache.derby.impl.jdbc.EmbedConnection.&lt;init&gt;(EmbedConnection.java:633)<br> org.apache.derby.impl.jdbc.EmbedConnection30.&lt;init&gt;(EmbedConnection30.java:73)<br> org.apache.derby.impl.jdbc.EmbedConnection40.&lt;init&gt;(EmbedConnection40.java:56)<br> org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:70)<br> org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:248)<br> org.apache.derby.jdbc.EmbeddedDataSource.getConnection(EmbeddedDataSource.java:480)<br> org.apache.derby.jdbc.EmbeddedDataSource.getConnection(EmbeddedDataSource.java:424)<br> org.apache.derbyTesting.junit.JDBCDataSource.shutdownDatabase(JDBCDataSource.java:266)<br> org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStatisticsTest.testShutdownWhileScanningThenDelete(AutomaticIndexStatisticsTest.java:180)<br> sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)<br> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)<br> java.lang.reflect.Method.invoke(Method.java:597)<br> junit.framework.TestCase.runTest(TestCase.java:164)<br> junit.framework.TestCase.runBare(TestCase.java:130)<br> org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:112)<br> junit.framework.TestResult$1.protect(TestResult.java:106)<br> junit.framework.TestResult.runProtected(TestResult.java:124)<br> junit.framework.TestResult.run(TestResult.java:109)<br> junit.framework.TestCase.run(TestCase.java:120)<br> junit.framework.TestSuite.runTest(TestSuite.java:230)<br> junit.framework.TestSuite.run(TestSuite.java:225)<br> junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)<br> junit.extensions.TestSetup$1.protect(TestSetup.java:21)<br> junit.framework.TestResult.runProtected(TestResult.java:124)<br> junit.extensions.TestSetup.run(TestSetup.java:25)<br> org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)<br> junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)<br> junit.extensions.TestSetup$1.protect(TestSetup.java:21)<br> junit.framework.TestResult.runProtected(TestResult.java:124)<br> junit.extensions.TestSetup.run(TestSetup.java:25)<br> junit.textui.TestRunner.doRun(TestRunner.java:121)<br> junit.textui.TestRunner.start(TestRunner.java:185)<br> junit.textui.TestRunner.main(TestRunner.java:143)</p> 
                  <p>Thread name=index-stat-thread id=18 priority=5 state=RUNNABLE isdaemon=true<br> java.lang.Thread.dumpThreads(Native Method)<br> java.lang.Thread.getAllStackTraces(Thread.java:1511)<br> org.apache.derby.shared.common.sanity.ThreadDump.getStackDumpString(ThreadDump.java:34)<br> sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)<br> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)<br> java.lang.reflect.Method.invoke(Method.java:597)<br> org.apache.derby.shared.common.sanity.AssertFailure$1.run(AssertFailure.java:165)<br> java.security.AccessController.doPrivileged(Native Method)<br> org.apache.derby.shared.common.sanity.AssertFailure.dumpThreads(AssertFailure.java:159)<br> org.apache.derby.shared.common.sanity.AssertFailure.&lt;init&gt;(AssertFailure.java:72)<br> org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:162)<br> org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:147)<br> org.apache.derby.impl.store.access.btree.ControlRow.get(ControlRow.java:838)<br> org.apache.derby.impl.store.access.btree.ControlRow.get(ControlRow.java:820)<br> org.apache.derby.impl.store.access.btree.BTreeScan.reposition(BTreeScan.java:850)<br> org.apache.derby.impl.store.access.btree.BTreeForwardScan.fetchRows(BTreeForwardScan.java:109)<br> org.apache.derby.impl.store.access.btree.BTreeScan.fetchNextGroup(BTreeScan.java:1596)<br> org.apache.derby.impl.services.daemon.IndexStatisticsDaemonImpl$KeyComparator.fetchRows(IndexStatisticsDaemonImpl.java:1103)<br> org.apache.derby.impl.services.daemon.IndexStatisticsDaemonImpl.updateIndexStatsMinion(IndexStatisticsDaemonImpl.java:453)<br> org.apache.derby.impl.services.daemon.IndexStatisticsDaemonImpl.generateStatistics(IndexStatisticsDaemonImpl.java:324)<br> org.apache.derby.impl.services.daemon.IndexStatisticsDaemonImpl.run(IndexStatisticsDaemonImpl.java:710)<br> java.lang.Thread.run(Thread.java:637)</p> 
                  <p>Thread name=Signal Dispatcher id=5 priority=9 state=RUNNABLE isdaemon=true</p> 
                  <p>Thread name=Timer-0 id=9 priority=5 state=WAITING isdaemon=true<br> java.lang.Object.wait(Native Method)<br> java.lang.Object.wait(Object.java:485)<br> java.util.TimerThread.mainLoop(Timer.java:483)<br> java.util.TimerThread.run(Timer.java:462)</p> 
                  <p>---------------</p> 
                  <p>....<br> Time: 153.799</p> 
                  <p>OK (7 tests)</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/DERBY-5037?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/DERBY-5037?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/DERBY-5037?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/DERBY-5037?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12471194" data-issue-id="12498544" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12471194/derby_5037-01-ac-checkForShutdown.diff" draggable="true" data-downloadurl="application/octet-stream:derby_5037-01-ac-checkForShutdown.diff:https://issues.apache.org/jira/secure/attachment/12471194/derby_5037-01-ac-checkForShutdown.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12471194/derby_5037-01-ac-checkForShutdown.diff" title="Latest  16/Feb/11 16:59 - Rick Hillegas" draggable="true" data-downloadurl="application/octet-stream:derby_5037-01-ac-checkForShutdown.diff:https://issues.apache.org/jira/secure/attachment/12471194/derby_5037-01-ac-checkForShutdown.diff">derby_5037-01-ac-checkForShutdown.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-02-16T16:59:13.600Z">16/Feb/11 16:59</time>
                   </dd>
                   <dd class="attachment-size">
                    3 kB
                   </dd>
                   <dd class="attachment-author">
                    Rick Hillegas
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12471081" data-issue-id="12498544" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12471081/derby-5037-01-aa-checkForShutdown.diff" draggable="true" data-downloadurl="application/octet-stream:derby-5037-01-aa-checkForShutdown.diff:https://issues.apache.org/jira/secure/attachment/12471081/derby-5037-01-aa-checkForShutdown.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12471081/derby-5037-01-aa-checkForShutdown.diff" title="Latest  15/Feb/11 15:44 - Rick Hillegas" draggable="true" data-downloadurl="application/octet-stream:derby-5037-01-aa-checkForShutdown.diff:https://issues.apache.org/jira/secure/attachment/12471081/derby-5037-01-aa-checkForShutdown.diff">derby-5037-01-aa-checkForShutdown.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-02-15T15:44:14.762Z">15/Feb/11 15:44</time>
                   </dd>
                   <dd class="attachment-size">
                    3 kB
                   </dd>
                   <dd class="attachment-author">
                    Rick Hillegas
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12471099" data-issue-id="12498544" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12471099/derby-5037-01-ab-checkForShutdown.diff" draggable="true" data-downloadurl="application/octet-stream:derby-5037-01-ab-checkForShutdown.diff:https://issues.apache.org/jira/secure/attachment/12471099/derby-5037-01-ab-checkForShutdown.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12471099/derby-5037-01-ab-checkForShutdown.diff" title="Latest  15/Feb/11 19:29 - Rick Hillegas" draggable="true" data-downloadurl="application/octet-stream:derby-5037-01-ab-checkForShutdown.diff:https://issues.apache.org/jira/secure/attachment/12471099/derby-5037-01-ab-checkForShutdown.diff">derby-5037-01-ab-checkForShutdown.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-02-15T19:29:44.447Z">15/Feb/11 19:29</time>
                   </dd>
                   <dd class="attachment-size">
                    3 kB
                   </dd>
                   <dd class="attachment-author">
                    Rick Hillegas
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12471116" data-issue-id="12498544" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12471116/derby-5037-2a-alternative_patch.diff" draggable="true" data-downloadurl="text/x-patch:derby-5037-2a-alternative_patch.diff:https://issues.apache.org/jira/secure/attachment/12471116/derby-5037-2a-alternative_patch.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12471116/derby-5037-2a-alternative_patch.diff" title="Latest  15/Feb/11 21:22 - Kristian Waagan" draggable="true" data-downloadurl="text/x-patch:derby-5037-2a-alternative_patch.diff:https://issues.apache.org/jira/secure/attachment/12471116/derby-5037-2a-alternative_patch.diff">derby-5037-2a-alternative_patch.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-02-15T21:22:30.402Z">15/Feb/11 21:22</time>
                   </dd>
                   <dd class="attachment-size">
                    2 kB
                   </dd>
                   <dd class="attachment-author">
                    Kristian Waagan
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="is part of">
                   is part of
                  </dt> 
                  <dd id="internal-12492660_12310010"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype" width="16" height="16" title="Sub-task - The sub-task of the issue" alt="Sub-task - The sub-task of the issue"> <span title="DERBY-4939: Enable istat daemon and tests"> <a href="/jira/browse/DERBY-4939" data-issue-key="DERBY-4939" class="issue-link link-title resolution">DERBY-4939</a> <span class="link-summary">Enable istat daemon and tests</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                 <dl class="links-list "> 
                  <dt title="relates to">
                   relates to
                  </dt> 
                  <dd id="internal-12498403_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" width="16" height="16" title="Bug - A problem which impairs or prevents the functions of the product." alt="Bug - A problem which impairs or prevents the functions of the product."> <span title="DERBY-5026: testStatsCreatedOnGrowthThenDeleteDb failing with ibm15 on trunk. The revision on trunk is 1069665 "> <a href="/jira/browse/DERBY-5026" data-issue-key="DERBY-5026" class="issue-link link-title resolution">DERBY-5026</a> <span class="link-summary">testStatsCreatedOnGrowthThenDeleteDb failing with ibm15 on trunk. The revision on trunk is 1069665 </span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                  <dd id="internal-12498427_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" width="16" height="16" title="Bug - A problem which impairs or prevents the functions of the product." alt="Bug - A problem which impairs or prevents the functions of the product."> <span title="DERBY-5030:  &quot;index-stat-thread&quot; java.lang.NullPointerException at store.access.btree.ControlRow.getControlRowForPage in suites.All "> <a href="/jira/browse/DERBY-5030" data-issue-key="DERBY-5030" class="issue-link link-title resolution">DERBY-5030</a> <span class="link-summary"> "index-stat-thread" java.lang.NullPointerException at store.access.btree.ControlRow.getControlRowForPage in suites.All </span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                  <dd id="internal-12498432_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" width="16" height="16" title="Bug - A problem which impairs or prevents the functions of the product." alt="Bug - A problem which impairs or prevents the functions of the product."> <span title="DERBY-5031: Exception in thread &quot;index-stat-thread&quot; java.lang.NullPointerException while calling ControlRow.getControlRowForPage(Unknown Source)"> <a href="/jira/browse/DERBY-5031" data-issue-key="DERBY-5031" class="issue-link link-title resolution">DERBY-5031</a> <span class="link-summary">Exception in thread "index-stat-thread" java.lang.NullPointerException while calling ControlRow.getControlRowForPage(Unknown Source)</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_rhillegas" rel="rhillegas" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Rick Hillegas&quot;,&quot;emailAddress&quot;:&quot;rhillegas@apache.org&quot;,&quot;username&quot;:&quot;rhillegas&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="rhillegas"></span></span> Rick Hillegas </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_rhillegas" rel="rhillegas" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Rick Hillegas&quot;,&quot;emailAddress&quot;:&quot;rhillegas@apache.org&quot;,&quot;username&quot;:&quot;rhillegas&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="rhillegas"></span></span> Rick Hillegas </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">0</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="14/Feb/11 15:55"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2011-02-14T15:55:58+0000">14/Feb/11 15:55</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="14/Jun/13 17:31"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2013-06-14T17:31:13+0000">14/Jun/13 17:31</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="12/Sep/12 23:20"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2012-09-12T23:20:04+0000">12/Sep/12 23:20</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5037?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-5037?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5037?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5037?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-5037?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5037?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-5037?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5037?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/DERBY-5037?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5037?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-5037?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/DERBY-5037?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-12994363\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12994363&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12994363\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12994363_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994363_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/11 16:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-14T16:56:04+0000\'\u003e14\\/Feb\\/11 16:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have commented out all of the test cases in AutomaticIndexStatisticsTest except for testShutdownWhileScanningThenDelete(). The assertion still occurs with that test case left in.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12994363_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994363_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/11 16:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-14T16:56:04+0000\'\u003e14\\/Feb\\/11 16:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have commented out all of the test cases in AutomaticIndexStatisticsTest except for testShutdownWhileScanningThenDelete(). The assertion still occurs with that test case left in.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12994408\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12994408&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12994408\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12994408_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994408_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/11 18:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-14T18:27:53+0000\'\u003e14\\/Feb\\/11 18:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLooking at the stack traces this looks like a problem with the istat thread running while another thread is shutting down the database.  Looking at the stacks\u003cbr\\/\u003e\\nprinted the test is at line 180:\u003cbr\\/\u003e\\nJDBCDataSource.shutdownDatabase(ds);\u003c\\/p\u003e\\n\\n\u003cp\u003eMeanwhile the background thread is likely just trying to process the queue for the next bit of work.  Derby monitor support for coordinated shutdown is a known issue, but I think at least for a very \\\"ordered\\\" shutdown where there is a request to shutdown we should be able to shutdown the known background thread\u003cbr\\/\u003e\\nin this case.  I think it is a bigger problem if the whole system is shutting down due to some error found at the lowest level.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12994408_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994408_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/11 18:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-14T18:27:53+0000\'\u003e14\\/Feb\\/11 18:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Looking at the stack traces this looks like a problem with the istat thread running while another thread is shutting down the database.  Looking at the stacks \\nprinted the test is at line 180: \\nJDBCDataSource.shutdownDatabase(ds); \\n\\n Meanwhile the background thread is likely just trying to process the queue for the next bit of work.  Derby monitor support for coordinated shutdown is a known issue, but I think at least for a very \\\"ordered\\\" shutdown where there is a request to shutdown we should be able to shutdown the known background thread \\nin this case.  I think it is a bigger problem if the whole system is shutting down due to some error found at the lowest level.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12994409\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12994409&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12994409\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12994409_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994409_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/11 18:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-14T18:29:22+0000\'\u003e14\\/Feb\\/11 18:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eps. kudo\'s to lily\'s work to get all the threads dumped on sanity error, made it very easy to see what was happening in this case.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12994409_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994409_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/11 18:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-14T18:29:22+0000\'\u003e14\\/Feb\\/11 18:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    ps. kudo\'s to lily\'s work to get all the threads dumped on sanity error, made it very easy to see what was happening in this case.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12994479\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12994479&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12994479\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12994479_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994479_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/11 20:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-14T20:42:57+0000\'\u003e14\\/Feb\\/11 20:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks to Mike for spotting that and to Lily for the instrumentation. Note that DataDictionary.stop() is supposed to shut down the the istat thread gracefully.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12994479_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994479_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Feb\\/11 20:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-14T20:42:57+0000\'\u003e14\\/Feb\\/11 20:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks to Mike for spotting that and to Lily for the instrumentation. Note that DataDictionary.stop() is supposed to shut down the the istat thread gracefully.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12994745\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12994745&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12994745\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12994745_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994745_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 10:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T10:35:41+0000\'\u003e15\\/Feb\\/11 10:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks to Erlend, who fixed \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3618\\\" title=\\\"Perform thread dump with ASSERTS with jdk 1.5 or higher\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3618\\\"\u003e\u003cdel\u003eDERBY-3618\u003c\\/del\u003e\u003c\\/a\u003e, you mean... \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/wink.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12994745_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994745_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 10:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T10:35:41+0000\'\u003e15\\/Feb\\/11 10:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks to Erlend, who fixed   DERBY-3618  , you mean...                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12994845\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12994845&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12994845\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12994845_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994845_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 15:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T15:44:14+0000\'\u003e15\\/Feb\\/11 15:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Rick Hillegas - 15\\/Feb\\/11 16:28\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttaching derby-5037-01-aa-checkForShutdown.diff. This is a first attempt to fix this bug. I would like to hear your opinions.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe approach taken here is to assume that exceptions raised during database shutdown are meaningless and can be thrown away. That is, the istat thread now tries to ignore exceptions which are raised during database shutdown.\u003c\\/p\u003e\\n\\n\u003cp\u003eThere is then the tricky bit of figuring out whether the database is being shutdown. I have found that it is not sufficient to check whether the istat thread itself has been marked for shutdown. Sometimes I see daemonStopped set to true (meaning that the DataDictionary has marked the thread for shutdown) and sometimes daemonStopped is still false when Store raises an exception.\u003c\\/p\u003e\\n\\n\u003cp\u003eAs a backup, I am also checking the status of Database.isActive(). I am not sure this is the best global sign that the database is being shutdown. Please let me know if you think there is a better global flag. I have a hunch that TopService.inShutdown is a better global flag but I do not see how to get to it.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eTouches the following file:\u003c\\/p\u003e\\n\\n\u003cp\u003eM      java\\/engine\\/org\\/apache\\/derby\\/impl\\/services\\/daemon\\/IndexStatisticsDaemonImpl.java\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12994845_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994845_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 15:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T15:44:14+0000\'\u003e15\\/Feb\\/11 15:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Rick Hillegas - 15\\/Feb\\/11 16:28\\\"\u003eedited\u003c\\/span\u003e                   Attaching derby-5037-01-aa-checkForShutdown.diff. This is a first attempt to fix this bug. I would like to hear your opinions. \\n\\n The approach taken here is to assume that exceptions raised during database shutdown are meaningless and can be thrown away. That is, the istat thread now tries to ignore exceptions which are raised during database shutdown. \\n\\n There is then the tricky bit of figuring out whether the database is being shutdown. I have found that it is not sufficient to check whether the istat thread itself has been marked for shutdown. Sometimes I see daemonStopped set to true (meaning that the DataDictionary has marked the thread for shutdown) and sometimes daemonStopped is still false when Store raises an exception. \\n\\n As a backup, I am also checking the status of Database.isActive(). I am not sure this is the best global sign that the database is being shutdown. Please let me know if you think there is a better global flag. I have a hunch that TopService.inShutdown is a better global flag but I do not see how to get to it. \\n\\n\\n Touches the following file: \\n\\n M      java\\/engine\\/org\\/apache\\/derby\\/impl\\/services\\/daemon\\/IndexStatisticsDaemonImpl.java              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12994869\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12994869&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12994869\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12994869_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994869_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 16:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T16:36:06+0000\'\u003e15\\/Feb\\/11 16:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRick said: \\\"The approach taken here is to assume that exceptions raised during database shutdown are meaningless and can be thrown away.\\\"\u003c\\/p\u003e\\n\\n\u003cp\u003eI  can recall cases where errors in shutdown were important to diagnosing user problems, so would prefer we not introduce a blanket assumption like that.  If possible,  I think it would be good for the shutdown process to do an orderly shutdown of the istat daemon if  is running before shutdown.\u003c\\/p\u003e\\n\\n\u003cp\u003ePardon if this this an ignorant approach. I am not familiar with the istat implementation, but just know that general error suppression  can be problematic.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12994869_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994869_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 16:36\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T16:36:06+0000\'\u003e15\\/Feb\\/11 16:36\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Rick said: \\\"The approach taken here is to assume that exceptions raised during database shutdown are meaningless and can be thrown away.\\\" \\n\\n I  can recall cases where errors in shutdown were important to diagnosing user problems, so would prefer we not introduce a blanket assumption like that.  If possible,  I think it would be good for the shutdown process to do an orderly shutdown of the istat daemon if  is running before shutdown. \\n\\n Pardon if this this an ignorant approach. I am not familiar with the istat implementation, but just know that general error suppression  can be problematic.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12994880\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12994880&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12994880\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12994880_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994880_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 17:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T17:04:17+0000\'\u003e15\\/Feb\\/11 17:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Knut Anders Hatlen - 15\\/Feb\\/11 17:05\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIt sounds reasonable to me that the istat daemon simply ignores any exceptions if the database is being shut down under its feet. However, I think the patch also ignores exceptions when statistics are updated explicitly (e.g., by using ALTER TABLE or SYSCS_UPDATE_STATISTICS) because of the changes in runExplicitly(). We should probably continue raising exceptions if these explicit calls fail during shutdown.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12994880_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994880_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 17:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T17:04:17+0000\'\u003e15\\/Feb\\/11 17:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Knut Anders Hatlen - 15\\/Feb\\/11 17:05\\\"\u003eedited\u003c\\/span\u003e                   It sounds reasonable to me that the istat daemon simply ignores any exceptions if the database is being shut down under its feet. However, I think the patch also ignores exceptions when statistics are updated explicitly (e.g., by using ALTER TABLE or SYSCS_UPDATE_STATISTICS) because of the changes in runExplicitly(). We should probably continue raising exceptions if these explicit calls fail during shutdown.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12994905\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12994905&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12994905\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12994905_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994905_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 18:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T18:04:10+0000\'\u003e15\\/Feb\\/11 18:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have not looked at patch yet.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn keeping with trying to have as much zero admin as possible I am ok with the istat deamon handling it\'s own errors and not making those errors affect the rest of the server.  It\'s job is to work in background and OPTIONALLY complete units of work.  Because the\u003cbr\\/\u003e\\nwork it does is optional, it is in a unique situation for error handling and should take advantage of it - basically it can catch everything\u003cbr\\/\u003e\\nclean up its resources move on.  If it gets an error\u003cbr\\/\u003e\\ndoing a piece of work it should catch it and try to figure out what to do.  Maybe it throws it away, maybe it retries it.   Deciding to throw away the unit of work when it detects that a shutdown is in progress is reasonable to me.   As I understand the\u003cbr\\/\u003e\\ncurrent design it is well suited to throwing away the unit of work, because it has a way to pick it up again the next time a query is run.   I think a good design would be that it\'s errors do not affect user threads in any way.  Once it throws away a unit of work and see\'s that\u003cbr\\/\u003e\\nshutdown is in progress it should just shutdown.\u003c\\/p\u003e\\n\\n\u003cp\u003eFor some sorts of database shutdown this \\\"bottom-up\\\" shutdown may be the only way it will work.   For example when store gets\u003cbr\\/\u003e\\na serious problem while logging, it raises a database shutdown level error and for safety basically nulls out the ability to do i\\/o to \u003cbr\\/\u003e\\nthe log or the database.  This results in the kind of errors that the istat daemon is seeing.\u003c\\/p\u003e\\n\\n\u003cp\u003eFor an orderly shutdown on the database, should the system wait for istat daemon to complete it\'s current unit of work?  If so it \u003cbr\\/\u003e\\nseems like it should be possible to make the system wait for istat daemon to shutdown, but I am not sure how easy that would be.\u003c\\/p\u003e\\n\\n\u003cp\u003eThere may be some value to logging information about failures in the background istat thread to derby.log, but i don\'t think by default\u003cbr\\/\u003e\\nit should be enabled.  I guess the worst case is if there is some bug causing the istat daemon to always fail it\'s unit of work.  I know there\u003cbr\\/\u003e\\nis already some toggle for istat logging, so maybe it\'s error logging could be tied to this somehow. \u003c\\/p\u003e\\n\\n\u003cp\u003eThis is a similar methodology done for background processing done in store using the monitor provided background daemon thread.  \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_12994905_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994905_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 18:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T18:04:10+0000\'\u003e15\\/Feb\\/11 18:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have not looked at patch yet. \\n\\n In keeping with trying to have as much zero admin as possible I am ok with the istat deamon handling it\'s own errors and not making those errors affect the rest of the server.  It\'s job is to work in background and OPTIONALLY complete units of work.  Because the \\nwork it does is optional, it is in a unique situation for error handling and should take advantage of it - basically it can catch everything \\nclean up its resources move on.  If it gets an error \\ndoing a piece of work it should catch it and try to figure out what to do.  Maybe it throws it away, maybe it retries it.   Deciding to throw away the unit of work when it detects that a shutdown is in progress is reasonable to me.   As I understand the \\ncurrent design it is well suited to throwing away the unit of work, because it has a way to pick it up again the next time a query is run.   I think a good design would be that it\'s errors do not affect user threads in any way.  Once it throws away a unit of work and see\'s that \\nshutdown is in progress it should just shutdown. \\n\\n For some sorts of database shutdown this \\\"bottom-up\\\" shutdown may be the only way it will work.   For example when store gets \\na serious problem while logging, it raises a database shutdown level error and for safety basically nulls out the ability to do i\\/o to  \\nthe log or the database.  This results in the kind of errors that the istat daemon is seeing. \\n\\n For an orderly shutdown on the database, should the system wait for istat daemon to complete it\'s current unit of work?  If so it  \\nseems like it should be possible to make the system wait for istat daemon to shutdown, but I am not sure how easy that would be. \\n\\n There may be some value to logging information about failures in the background istat thread to derby.log, but i don\'t think by default \\nit should be enabled.  I guess the worst case is if there is some bug causing the istat daemon to always fail it\'s unit of work.  I know there \\nis already some toggle for istat logging, so maybe it\'s error logging could be tied to this somehow.  \\n\\n This is a similar methodology done for background processing done in store using the monitor provided background daemon thread.                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12994946\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12994946&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12994946\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12994946_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994946_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 19:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T19:29:44+0000\'\u003e15\\/Feb\\/11 19:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks to Kathey, Knut, and Mike for the quick feedback. Tests passed cleanly on the first rev of the patch. Attaching derby-5037-01-ab-checkForShutdown.diff. This second rev addresses Knut\'s concern that the user is entitled to an error if database shutdown aborts an ALTER TABLE statement or an explicit attempt to recompute statistics.\u003c\\/p\u003e\\n\\n\u003cp\u003eConcerning Kathey\'s comment: As I read the code, the orderly shutdown of the istat thread will happen regardless of whether the shutdown-induced exception is thrown away. I think that the system will wait for the DataDictionary to shutdown and DataDictionary shutdown will, in turn, wait for the istat stop() logic to finish. \u003c\\/p\u003e\\n\\n\u003cp\u003eConcerning Mike\'s comments: I don\'t think that there is much value in trying to coax istat into finishing the current unit of work if the rest of the system is shutting down. The worst that can happen is that the current unit of work will be rolled back. For this particular problem, I think that\'s what the exiting Store has already done and there is no point in trying to ask Store to do anything else. Rolling back the current unit of work is pretty much equivalent to what will happen to the other queued up units of work during orderly shutdown: they will simply be thrown away. I recommend against prolonging or complicating the shutdown.\u003c\\/p\u003e\\n\\n\u003cp\u003eThere might be some value in adding trace logic around the exception-swallowing but I\'m not sure how to filter the signal out of the noise here.\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks,\u003cbr\\/\u003e\\n-Rick\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12994946_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994946_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 19:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T19:29:44+0000\'\u003e15\\/Feb\\/11 19:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks to Kathey, Knut, and Mike for the quick feedback. Tests passed cleanly on the first rev of the patch. Attaching derby-5037-01-ab-checkForShutdown.diff. This second rev addresses Knut\'s concern that the user is entitled to an error if database shutdown aborts an ALTER TABLE statement or an explicit attempt to recompute statistics. \\n\\n Concerning Kathey\'s comment: As I read the code, the orderly shutdown of the istat thread will happen regardless of whether the shutdown-induced exception is thrown away. I think that the system will wait for the DataDictionary to shutdown and DataDictionary shutdown will, in turn, wait for the istat stop() logic to finish.  \\n\\n Concerning Mike\'s comments: I don\'t think that there is much value in trying to coax istat into finishing the current unit of work if the rest of the system is shutting down. The worst that can happen is that the current unit of work will be rolled back. For this particular problem, I think that\'s what the exiting Store has already done and there is no point in trying to ask Store to do anything else. Rolling back the current unit of work is pretty much equivalent to what will happen to the other queued up units of work during orderly shutdown: they will simply be thrown away. I recommend against prolonging or complicating the shutdown. \\n\\n There might be some value in adding trace logic around the exception-swallowing but I\'m not sure how to filter the signal out of the noise here. \\n\\n Thanks, \\n-Rick              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12994995\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12994995&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12994995\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12994995_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994995_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 20:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T20:43:39+0000\'\u003e15\\/Feb\\/11 20:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eTests passed cleanly for me on derby-5037-01-ab-checkForShutdown.diff except for some variation of the istat-related instability in updatelocksJDBC30 tracked by \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5038\\\" title=\\\"updatelocks test failing in tinderbox when background update statistics are enabled.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5038\\\"\u003e\u003cdel\u003eDERBY-5038\u003c\\/del\u003e\u003c\\/a\u003e and \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5039\\\" title=\\\"store\\/updatelocksJDBC30.sql test failing in tinderbox when background update statistics are enabled.\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5039\\\"\u003e\u003cdel\u003eDERBY-5039\u003c\\/del\u003e\u003c\\/a\u003e:\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003e\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003e\\n\\t\\t\u003cul\u003e\\n\\t\\t\\t\u003cli\u003e\\n\\t\\t\\t\u003cul\u003e\\n\\t\\t\\t\\t\u003cli\u003e\\n\\t\\t\\t\\t\u003cul\u003e\\n\\t\\t\\t\\t\\t\u003cli\u003e\\n\\t\\t\\t\\t\\t\u003cul\u003e\\n\\t\\t\\t\\t\\t\\t\u003cli\u003e\\n\\t\\t\\t\\t\\t\\t\u003cul\u003e\\n\\t\\t\\t\\t\\t\\t\\t\u003cli\u003e\\n\\t\\t\\t\\t\\t\\t\\t\u003cul\u003e\\n\\t\\t\\t\\t\\t\\t\\t\\t\u003cli\u003e\\n\\t\\t\\t\\t\\t\\t\\t\\t\u003cul\u003e\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\u003cli\u003eDiff file derbyall\\/encryptionAll\\/storemats\\/storemats\\/updatelocksJDBC30.diff\u003c\\/li\u003e\\n\\t\\t\\t\\t\\t\\t\\t\\t\u003c\\/ul\u003e\\n\\t\\t\\t\\t\\t\\t\\t\\t\u003c\\/li\u003e\\n\\t\\t\\t\\t\\t\\t\\t\u003c\\/ul\u003e\\n\\t\\t\\t\\t\\t\\t\\t\u003c\\/li\u003e\\n\\t\\t\\t\\t\\t\\t\u003c\\/ul\u003e\\n\\t\\t\\t\\t\\t\\t\u003c\\/li\u003e\\n\\t\\t\\t\\t\\t\u003c\\/ul\u003e\\n\\t\\t\\t\\t\\t\u003c\\/li\u003e\\n\\t\\t\\t\\t\u003c\\/ul\u003e\\n\\t\\t\\t\\t\u003c\\/li\u003e\\n\\t\\t\\t\u003c\\/ul\u003e\\n\\t\\t\\t\u003c\\/li\u003e\\n\\t\\t\\t\u003cli\u003eStart: updatelocksJDBC30 jdk1.5.0_22 storemats:storemats 2011-02-15 11:10:10 ***\u003cbr\\/\u003e\\n2504,2513d2503\u003cbr\\/\u003e\\n&lt; APP     |UserTran|TABLE   |1   |IX  |A           |Tablelock |GRANT|ACTIVE  \u003cbr\\/\u003e\\n&lt; ij&gt; next scan_cursor;\u003cbr\\/\u003e\\n&lt; A          |B          |C                                                                                                                               \u003cbr\\/\u003e\\n&lt; --------------------------------------------------------------------------------------------------------------------------------------------------------\u003cbr\\/\u003e\\n&lt; 3          |-30        |-three                                                                                                                          \u003cbr\\/\u003e\\n&lt; ij&gt; update a set b=30,c=\'three\' where current of scan_cursor;\u003cbr\\/\u003e\\n&lt; 1 row inserted\\/updated\\/deleted\u003cbr\\/\u003e\\n&lt; ij&gt; select * from lock_table order by tabname, type desc, mode, cnt, lockname;\u003cbr\\/\u003e\\n&lt; USERNAME|TRANTYPE|TYPE    |CNT |MODE|TABNAME     |LOCKNAME  |STATE|STATUS  \u003cbr\\/\u003e\\n&lt; ---------------------------------------------------------------------------\u003cbr\\/\u003e\\n2514a2505,2514\u003cbr\\/\u003e\\n&gt; ij&gt; next scan_cursor;\u003cbr\\/\u003e\\n&gt; A          |B          |C                                                                                                                               \u003cbr\\/\u003e\\n&gt; --------------------------------------------------------------------------------------------------------------------------------------------------------\u003cbr\\/\u003e\\n&gt; 3          |-30        |-three                                                                                                                          \u003cbr\\/\u003e\\n&gt; ij&gt; update a set b=30,c=\'three\' where current of scan_cursor;\u003cbr\\/\u003e\\n&gt; 1 row inserted\\/updated\\/deleted\u003cbr\\/\u003e\\n&gt; ij&gt; select * from lock_table order by tabname, type desc, mode, cnt, lockname;\u003cbr\\/\u003e\\n&gt; USERNAME|TRANTYPE|TYPE    |CNT |MODE|TABNAME     |LOCKNAME  |STATE|STATUS  \u003cbr\\/\u003e\\n&gt; ---------------------------------------------------------------------------\u003cbr\\/\u003e\\n&gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE  \u003cbr\\/\u003e\\n2524 del\u003cbr\\/\u003e\\n&lt; APP     |UserTran|TABLE   |2   |IX  |A           |Tablelock |GRANT|ACTIVE  \u003cbr\\/\u003e\\n2524a2524\u003cbr\\/\u003e\\n&gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE  \u003cbr\\/\u003e\\n2531 del\u003cbr\\/\u003e\\n&lt; APP     |UserTran|TABLE   |2   |IX  |A           |Tablelock |GRANT|ACTIVE  \u003cbr\\/\u003e\\n2531a2531\u003cbr\\/\u003e\\n&gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE  \u003cbr\\/\u003e\\nTest Failed.\u003c\\/li\u003e\\n\\t\\t\\t\u003cli\u003eEnd:   updatelocksJDBC30 jdk1.5.0_22 storemats:storemats 2011-02-15 11:10:24 ***\u003cbr\\/\u003e\\n------------------------------------------------------\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12994995_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12994995_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 20:43\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T20:43:39+0000\'\u003e15\\/Feb\\/11 20:43\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Tests passed cleanly for me on derby-5037-01-ab-checkForShutdown.diff except for some variation of the istat-related instability in updatelocksJDBC30 tracked by   DERBY-5038   and   DERBY-5039  : \\n\\n \\n\\t \\n\\t \\n\\t\\t \\n\\t\\t \\n\\t\\t\\t \\n\\t\\t\\t \\n\\t\\t\\t\\t \\n\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t\\t\\t\\t Diff file derbyall\\/encryptionAll\\/storemats\\/storemats\\/updatelocksJDBC30.diff \\n\\t\\t\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t \\n\\t\\t\\t\\t \\n\\t\\t\\t \\n\\t\\t\\t \\n\\t\\t\\t Start: updatelocksJDBC30 jdk1.5.0_22 storemats:storemats 2011-02-15 11:10:10 *** \\n2504,2513d2503 \\n&lt; APP     |UserTran|TABLE   |1   |IX  |A           |Tablelock |GRANT|ACTIVE   \\n&lt; ij&gt; next scan_cursor; \\n&lt; A          |B          |C                                                                                                                                \\n&lt; -------------------------------------------------------------------------------------------------------------------------------------------------------- \\n&lt; 3          |-30        |-three                                                                                                                           \\n&lt; ij&gt; update a set b=30,c=\'three\' where current of scan_cursor; \\n&lt; 1 row inserted\\/updated\\/deleted \\n&lt; ij&gt; select * from lock_table order by tabname, type desc, mode, cnt, lockname; \\n&lt; USERNAME|TRANTYPE|TYPE    |CNT |MODE|TABNAME     |LOCKNAME  |STATE|STATUS   \\n&lt; --------------------------------------------------------------------------- \\n2514a2505,2514 \\n&gt; ij&gt; next scan_cursor; \\n&gt; A          |B          |C                                                                                                                                \\n&gt; -------------------------------------------------------------------------------------------------------------------------------------------------------- \\n&gt; 3          |-30        |-three                                                                                                                           \\n&gt; ij&gt; update a set b=30,c=\'three\' where current of scan_cursor; \\n&gt; 1 row inserted\\/updated\\/deleted \\n&gt; ij&gt; select * from lock_table order by tabname, type desc, mode, cnt, lockname; \\n&gt; USERNAME|TRANTYPE|TYPE    |CNT |MODE|TABNAME     |LOCKNAME  |STATE|STATUS   \\n&gt; --------------------------------------------------------------------------- \\n&gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE   \\n2524 del \\n&lt; APP     |UserTran|TABLE   |2   |IX  |A           |Tablelock |GRANT|ACTIVE   \\n2524a2524 \\n&gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE   \\n2531 del \\n&lt; APP     |UserTran|TABLE   |2   |IX  |A           |Tablelock |GRANT|ACTIVE   \\n2531a2531 \\n&gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE   \\nTest Failed. \\n\\t\\t\\t End:   updatelocksJDBC30 jdk1.5.0_22 storemats:storemats 2011-02-15 11:10:24 *** \\n------------------------------------------------------ \\n\\t\\t \\n\\t\\t \\n\\t \\n\\t \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12995001\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12995001&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12995001\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12995001_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995001_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 20:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T20:56:30+0000\'\u003e15\\/Feb\\/11 20:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for making the changes, Rick. I\'m fine with that patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eOne small nit is that the comments in tryToGatherStats() seem to imply that StandardException can only be raised by non-debug jars and RuntimeException only by debug jars. I\'m not sure that\'s necessarily correct. For example, in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5030\\\" title=\\\" &quot;index-stat-thread&quot; java.lang.NullPointerException at store.access.btree.ControlRow.getControlRowForPage in suites.All \\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5030\\\"\u003e\u003cdel\u003eDERBY-5030\u003c\\/del\u003e\u003c\\/a\u003e a NullPointerException is raised in this code when running with non-debug jars. I suppose the opposite could happen as well.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12995001_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995001_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 20:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T20:56:30+0000\'\u003e15\\/Feb\\/11 20:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for making the changes, Rick. I\'m fine with that patch. \\n\\n One small nit is that the comments in tryToGatherStats() seem to imply that StandardException can only be raised by non-debug jars and RuntimeException only by debug jars. I\'m not sure that\'s necessarily correct. For example, in   DERBY-5030   a NullPointerException is raised in this code when running with non-debug jars. I suppose the opposite could happen as well.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12995011\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12995011&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12995011\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_12995011_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995011_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 21:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T21:22:30+0000\'\u003e15\\/Feb\\/11 21:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttaching patch 2a.\u003c\\/p\u003e\\n\\n\u003cp\u003eProviding my input as a patch I wrote when investigating this issue. I have not taken daemonStopped into consideration, as I don\'t know how it relates to db.isActive(). If the order in which they are set varies, the variable has to be considered too.\u003c\\/p\u003e\\n\\n\u003cp\u003eNote also the debug code in the catch-block for RuntimeException, which should cause another RuntimeException to be thrown if \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5030\\\" title=\\\" &quot;index-stat-thread&quot; java.lang.NullPointerException at store.access.btree.ControlRow.getControlRowForPage in suites.All \\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5030\\\"\u003e\u003cdel\u003eDERBY-5030\u003c\\/del\u003e\u003c\\/a\u003e is hit.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think Mike\'s comments\\/observations above agree pretty much with my thinking when writing the code. Seems there are several error-handling issues to iron out though...\u003cbr\\/\u003e\\nA few specific comments:\u003cbr\\/\u003e\\n o I decided to not make Derby wait for the background thread to finish on shutdown, as it might potentially be scanning a very large table.\u003cbr\\/\u003e\\n o Logging is rather verbose now during testing, but I agree it should be less verbose (or maybe turned off completely) when released.\u003cbr\\/\u003e\\n o I\'m logging a lot of exceptions to aid testing\\/debugging. These should also go away, or be enabled by a property if the user wishes to do so.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_12995011_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995011_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Feb\\/11 21:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-15T21:22:30+0000\'\u003e15\\/Feb\\/11 21:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attaching patch 2a. \\n\\n Providing my input as a patch I wrote when investigating this issue. I have not taken daemonStopped into consideration, as I don\'t know how it relates to db.isActive(). If the order in which they are set varies, the variable has to be considered too. \\n\\n Note also the debug code in the catch-block for RuntimeException, which should cause another RuntimeException to be thrown if   DERBY-5030   is hit. \\n\\n I think Mike\'s comments\\/observations above agree pretty much with my thinking when writing the code. Seems there are several error-handling issues to iron out though... \\nA few specific comments: \\n o I decided to not make Derby wait for the background thread to finish on shutdown, as it might potentially be scanning a very large table. \\n o Logging is rather verbose now during testing, but I agree it should be less verbose (or maybe turned off completely) when released. \\n o I\'m logging a lot of exceptions to aid testing\\/debugging. These should also go away, or be enabled by a property if the user wishes to do so.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12995069\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12995069&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12995069\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12995069_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995069_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/11 00:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-16T00:05:12+0000\'\u003e16\\/Feb\\/11 00:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAre the 376 failures on Win Vista 64 since istat was enabled the same thing as this issue?\u003cbr\\/\u003e\\n\u003ca href=\\\"http:\\/\\/dbtg.foundry.sun.com\\/derby\\/test\\/Daily\\/jvm1.7\\/testing\\/testlog\\/vista-64\\/1069888-suitesAll_diff.txt\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/dbtg.foundry.sun.com\\/derby\\/test\\/Daily\\/jvm1.7\\/testing\\/testlog\\/vista-64\\/1069888-suitesAll_diff.txt\u003c\\/a\u003e\u003cbr\\/\u003e\\nMostly it complains that wombat already exists, but has happened consistently since revision 1069888.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12995069_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995069_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/11 00:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-16T00:05:12+0000\'\u003e16\\/Feb\\/11 00:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Are the 376 failures on Win Vista 64 since istat was enabled the same thing as this issue? \\n http:\\/\\/dbtg.foundry.sun.com\\/derby\\/test\\/Daily\\/jvm1.7\\/testing\\/testlog\\/vista-64\\/1069888-suitesAll_diff.txt  \\nMostly it complains that wombat already exists, but has happened consistently since revision 1069888.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12995151\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12995151&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12995151\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"lilywei\\\" id=\\\"commentauthor_12995151_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=lilywei\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"lilywei\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lily Wei\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995151_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/11 04:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-16T04:16:36+0000\'\u003e16\\/Feb\\/11 04:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eApply derby-5037-2a-alternative_patch.diff. On Windows 7, AutomaticIndexStatisticsTest failed on testShutdownWhileScanningThenDelete(line 181) on assertDirectoryDeleted(constructDbPath(db));\u003cbr\\/\u003e\\nThis is the stacktrace:\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;Error\\/failure logged at Tue Feb 15 19:54:25 PST 2011&#93;\u003c\\/span\u003e\u003cbr\\/\u003e\\njunit.framework.AssertionFailedError: Failed to delete 3 files (root=c:\\\\derby2\\\\t\u003cbr\\/\u003e\\nrunk\\\\testtmp\\\\system\\\\singleUse\\\\copyShutdown: c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\singl\u003cbr\\/\u003e\\neUse\\\\copyShutdown\\\\seg0\\\\c481.dat (isDir=false, canRead=true, canWrite=true, size=\u003cbr\\/\u003e\\n22351872), c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\singleUse\\\\copyShutdown\\\\seg0 (isDir=tru\u003cbr\\/\u003e\\ne, canRead=true, canWrite=true, size=12288), c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\sing\u003cbr\\/\u003e\\nleUse\\\\copyShutdown (isDir=true, canRead=true, canWrite=true, size=4096)\u003cbr\\/\u003e\\n        at junit.framework.Assert.fail(Assert.java:47)\u003cbr\\/\u003e\\n        at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertDirectoryDeleted\u003cbr\\/\u003e\\n(BaseJDBCTestCase.java:1496)\u003cbr\\/\u003e\\n        at org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStati\u003cbr\\/\u003e\\nsticsTest.testShutdownWhileScanningThenDelete(AutomaticIndexStatisticsTest.java:\u003cbr\\/\u003e\\n181)\u003cbr\\/\u003e\\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\u003cbr\\/\u003e\\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.\u003cbr\\/\u003e\\njava:39)\u003cbr\\/\u003e\\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces\u003cbr\\/\u003e\\nsorImpl.java:25)\u003cbr\\/\u003e\\n        at java.lang.reflect.Method.invoke(Method.java:597)\u003cbr\\/\u003e\\n        at junit.framework.TestCase.runTest(TestCase.java:154)\u003cbr\\/\u003e\\n        at junit.framework.TestCase.runBare(TestCase.java:127)\u003cbr\\/\u003e\\n        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:\u003cbr\\/\u003e\\n112)\u003cbr\\/\u003e\\n        Without study too much of the code, , should we put more sleep between \\\"JDBCDataSource.shutdownDatabase(ds); and assertDirectoryDeleted(constructDbPath(db));\\\"?\u003c\\/p\u003e\\n\\n\u003cp\u003e        Will try derby-5037-01-ab-checkForShutdown.diff patch next?  Thanks.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"lilywei\\\" id=\\\"commentauthor_12995151_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=lilywei\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"lilywei\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lily Wei\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995151_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/11 04:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-16T04:16:36+0000\'\u003e16\\/Feb\\/11 04:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Apply derby-5037-2a-alternative_patch.diff. On Windows 7, AutomaticIndexStatisticsTest failed on testShutdownWhileScanningThenDelete(line 181) on assertDirectoryDeleted(constructDbPath(db)); \\nThis is the stacktrace: \\n &#91;Error\\/failure logged at Tue Feb 15 19:54:25 PST 2011&#93;  \\njunit.framework.AssertionFailedError: Failed to delete 3 files (root=c:\\\\derby2\\\\t \\nrunk\\\\testtmp\\\\system\\\\singleUse\\\\copyShutdown: c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\singl \\neUse\\\\copyShutdown\\\\seg0\\\\c481.dat (isDir=false, canRead=true, canWrite=true, size= \\n22351872), c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\singleUse\\\\copyShutdown\\\\seg0 (isDir=tru \\ne, canRead=true, canWrite=true, size=12288), c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\sing \\nleUse\\\\copyShutdown (isDir=true, canRead=true, canWrite=true, size=4096) \\n        at junit.framework.Assert.fail(Assert.java:47) \\n        at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertDirectoryDeleted \\n(BaseJDBCTestCase.java:1496) \\n        at org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStati \\nsticsTest.testShutdownWhileScanningThenDelete(AutomaticIndexStatisticsTest.java: \\n181) \\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) \\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl. \\njava:39) \\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces \\nsorImpl.java:25) \\n        at java.lang.reflect.Method.invoke(Method.java:597) \\n        at junit.framework.TestCase.runTest(TestCase.java:154) \\n        at junit.framework.TestCase.runBare(TestCase.java:127) \\n        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java: \\n112) \\n        Without study too much of the code, , should we put more sleep between \\\"JDBCDataSource.shutdownDatabase(ds); and assertDirectoryDeleted(constructDbPath(db));\\\"? \\n\\n         Will try derby-5037-01-ab-checkForShutdown.diff patch next?  Thanks.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12995258\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12995258&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12995258\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_12995258_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995258_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/11 11:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-16T11:32:43+0000\'\u003e16\\/Feb\\/11 11:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'ve seen the delete error before too. If it is always c481.dat it would maybe be helpful to find out which conglomerate\\/table this is.\u003cbr\\/\u003e\\nI\'ve also seen intermittent delete errors in other tests before the istat code was committed, so that may be a separate issue.\u003c\\/p\u003e\\n\\n\u003cp\u003eLily, did you run the tests with a sane or an insane build?\u003cbr\\/\u003e\\nThe 2a patch will only help with sane builds, with insane builds you will still get \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5030\\\" title=\\\" &quot;index-stat-thread&quot; java.lang.NullPointerException at store.access.btree.ControlRow.getControlRowForPage in suites.All \\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5030\\\"\u003e\u003cdel\u003eDERBY-5030\u003c\\/del\u003e\u003c\\/a\u003e.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_12995258_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995258_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/11 11:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-16T11:32:43+0000\'\u003e16\\/Feb\\/11 11:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'ve seen the delete error before too. If it is always c481.dat it would maybe be helpful to find out which conglomerate\\/table this is. \\nI\'ve also seen intermittent delete errors in other tests before the istat code was committed, so that may be a separate issue. \\n\\n Lily, did you run the tests with a sane or an insane build? \\nThe 2a patch will only help with sane builds, with insane builds you will still get   DERBY-5030  .              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12995386\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12995386&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12995386\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12995386_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995386_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/11 16:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-16T16:59:13+0000\'\u003e16\\/Feb\\/11 16:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for the continued analysis, everyone. Attaching derby-5037-01-ac-checkForShutdown.diff. This patch removes a comment line, hopefully addressing Knut\'s concerns about muddy wording. Committed at subversion revision 1071310.\u003c\\/p\u003e\\n\\n\u003cp\u003eI have committed this patch in the interests of cleaning up the noise in the regression tests. Let\'s see if this does address \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5030\\\" title=\\\" &quot;index-stat-thread&quot; java.lang.NullPointerException at store.access.btree.ControlRow.getControlRowForPage in suites.All \\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5030\\\"\u003e\u003cdel\u003eDERBY-5030\u003c\\/del\u003e\u003c\\/a\u003e also.\u003c\\/p\u003e\\n\\n\u003cp\u003eNo doubt, additional work can be done in the area of error logging and exception swallowing. If people want to recommend other approaches, I recommend filing new JIRAs to track those efforts.\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks,\u003cbr\\/\u003e\\n-Rick\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_12995386_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995386_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/11 16:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-16T16:59:13+0000\'\u003e16\\/Feb\\/11 16:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for the continued analysis, everyone. Attaching derby-5037-01-ac-checkForShutdown.diff. This patch removes a comment line, hopefully addressing Knut\'s concerns about muddy wording. Committed at subversion revision 1071310. \\n\\n I have committed this patch in the interests of cleaning up the noise in the regression tests. Let\'s see if this does address   DERBY-5030   also. \\n\\n No doubt, additional work can be done in the area of error logging and exception swallowing. If people want to recommend other approaches, I recommend filing new JIRAs to track those efforts. \\n\\n Thanks, \\n-Rick              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12995452\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12995452&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12995452\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"lilywei\\\" id=\\\"commentauthor_12995452_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=lilywei\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"lilywei\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lily Wei\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995452_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/11 18:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-16T18:53:51+0000\'\u003e16\\/Feb\\/11 18:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks, Kristian and Rick. With with svn 1071319. I did not see \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5030\\\" title=\\\" &quot;index-stat-thread&quot; java.lang.NullPointerException at store.access.btree.ControlRow.getControlRowForPage in suites.All \\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5030\\\"\u003e\u003cdel\u003eDERBY-5030\u003c\\/del\u003e\u003c\\/a\u003e (no delete problem from AutomaticIndexStatisticsTest). I still see it on the insane build for Windows 7.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"lilywei\\\" id=\\\"commentauthor_12995452_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=lilywei\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"lilywei\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lily Wei\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12995452_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Feb\\/11 18:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-16T18:53:51+0000\'\u003e16\\/Feb\\/11 18:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks, Kristian and Rick. With with svn 1071319. I did not see   DERBY-5030   (no delete problem from AutomaticIndexStatisticsTest). I still see it on the insane build for Windows 7.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12996599\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=12996599&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12996599\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"lilywei\\\" id=\\\"commentauthor_12996599_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=lilywei\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"lilywei\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lily Wei\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12996599_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Feb\\/11 21:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-18T21:28:28+0000\'\u003e18\\/Feb\\/11 21:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Rick for point out generateStatistics() no longer calls updateIndexStatsMinion() directly. This is delete problem stack trace I am seeing on Windows 7 (insane build)\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;Error\\/failure logged at Fri Feb 18 11:09:46 PST 2011&#93;\u003c\\/span\u003e\u003cbr\\/\u003e\\njunit.framework.AssertionFailedError: Failed to delete 3 files (root=c:\\\\derby2\\\\t\u003cbr\\/\u003e\\nrunk\\\\testtmp\\\\system\\\\singleUse\\\\copyShutdown: c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\singl\u003cbr\\/\u003e\\neUse\\\\copyShutdown\\\\seg0\\\\c481.dat (isDir=false, canRead=true, canWrite=true, size=\u003cbr\\/\u003e\\n22351872), c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\singleUse\\\\copyShutdown\\\\seg0 (isDir=tru\u003cbr\\/\u003e\\ne, canRead=true, canWrite=true, size=12288), c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\sing\u003cbr\\/\u003e\\nleUse\\\\copyShutdown (isDir=true, canRead=true, canWrite=true, size=4096)\u003cbr\\/\u003e\\n        at junit.framework.Assert.fail(Assert.java:47)\u003cbr\\/\u003e\\n        at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertDirectoryDeleted\u003cbr\\/\u003e\\n(BaseJDBCTestCase.java:1496)\u003cbr\\/\u003e\\n        at org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStati\u003cbr\\/\u003e\\nsticsTest.testShutdownWhileScanningThenDelete(AutomaticIndexStatisticsTest.java:\u003cbr\\/\u003e\\n188)\u003cbr\\/\u003e\\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\u003cbr\\/\u003e\\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.\u003cbr\\/\u003e\\njava:39)\u003cbr\\/\u003e\\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces\u003cbr\\/\u003e\\nsorImpl.java:25)\u003cbr\\/\u003e\\n        at java.lang.reflect.Method.invoke(Method.java:597)\u003cbr\\/\u003e\\n        at junit.framework.TestCase.runTest(TestCase.java:154)\u003cbr\\/\u003e\\n        at junit.framework.TestCase.runBare(TestCase.java:127)\u003cbr\\/\u003e\\n        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:\u003cbr\\/\u003e\\n112)\u003cbr\\/\u003e\\n        at junit.framework.TestResult$1.protect(TestResult.java:106)\u003cbr\\/\u003e\\n        at junit.framework.TestResult.runProtected(TestResult.java:124)\u003cbr\\/\u003e\\n        at junit.framework.TestResult.run(TestResult.java:109)\u003cbr\\/\u003e\\n        at junit.framework.TestCase.run(TestCase.java:118)\u003cbr\\/\u003e\\n        at junit.framework.TestSuite.runTest(TestSuite.java:208)\u003cbr\\/\u003e\\n        at junit.framework.TestSuite.run(TestSuite.java:203)\u003cbr\\/\u003e\\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\u003cbr\\/\u003e\\nI think it is like what Kristian said earlier, it is relate to unable to delete singleUse\\/copyShutdown\\/seg0\\/c481.dat. Thanks!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"lilywei\\\" id=\\\"commentauthor_12996599_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=lilywei\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"lilywei\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Lily Wei\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12996599_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Feb\\/11 21:28\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-02-18T21:28:28+0000\'\u003e18\\/Feb\\/11 21:28\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Rick for point out generateStatistics() no longer calls updateIndexStatsMinion() directly. This is delete problem stack trace I am seeing on Windows 7 (insane build) \\n &#91;Error\\/failure logged at Fri Feb 18 11:09:46 PST 2011&#93;  \\njunit.framework.AssertionFailedError: Failed to delete 3 files (root=c:\\\\derby2\\\\t \\nrunk\\\\testtmp\\\\system\\\\singleUse\\\\copyShutdown: c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\singl \\neUse\\\\copyShutdown\\\\seg0\\\\c481.dat (isDir=false, canRead=true, canWrite=true, size= \\n22351872), c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\singleUse\\\\copyShutdown\\\\seg0 (isDir=tru \\ne, canRead=true, canWrite=true, size=12288), c:\\\\derby2\\\\trunk\\\\testtmp\\\\system\\\\sing \\nleUse\\\\copyShutdown (isDir=true, canRead=true, canWrite=true, size=4096) \\n        at junit.framework.Assert.fail(Assert.java:47) \\n        at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertDirectoryDeleted \\n(BaseJDBCTestCase.java:1496) \\n        at org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStati \\nsticsTest.testShutdownWhileScanningThenDelete(AutomaticIndexStatisticsTest.java: \\n188) \\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) \\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl. \\njava:39) \\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces \\nsorImpl.java:25) \\n        at java.lang.reflect.Method.invoke(Method.java:597) \\n        at junit.framework.TestCase.runTest(TestCase.java:154) \\n        at junit.framework.TestCase.runBare(TestCase.java:127) \\n        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java: \\n112) \\n        at junit.framework.TestResult$1.protect(TestResult.java:106) \\n        at junit.framework.TestResult.runProtected(TestResult.java:124) \\n        at junit.framework.TestResult.run(TestResult.java:109) \\n        at junit.framework.TestCase.run(TestCase.java:118) \\n        at junit.framework.TestSuite.runTest(TestSuite.java:208) \\n        at junit.framework.TestSuite.run(TestSuite.java:203) \\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) \\nI think it is like what Kristian said earlier, it is relate to unable to delete singleUse\\/copyShutdown\\/seg0\\/c481.dat. Thanks!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13001078\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=13001078&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13001078\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_13001078_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13001078_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Mar\\/11 20:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-03-01T20:00:33+0000\'\u003e01\\/Mar\\/11 20:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe patch appears to have fixed this problem.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"rhillegas\\\" id=\\\"commentauthor_13001078_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=rhillegas\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"rhillegas\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Rick Hillegas\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13001078_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Mar\\/11 20:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-03-01T20:00:33+0000\'\u003e01\\/Mar\\/11 20:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The patch appears to have fixed this problem.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13086847\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5037?focusedCommentId=13086847&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13086847\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_13086847_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13086847_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Aug\\/11 07:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-08-18T07:18:30+0000\'\u003e18\\/Aug\\/11 07:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eClosing issue.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kristwaa\\\" id=\\\"commentauthor_13086847_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kristwaa\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kristwaa\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kristian Waagan\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13086847_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Aug\\/11 07:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-08-18T07:18:30+0000\'\u003e18\\/Aug\\/11 07:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Closing issue.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="10594";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=10594&amp;avatarId=10122\\\" alt=\\\"Derby\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\"\u003eDerby\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1520240137601"> 
    <input type="hidden" title="jira.request.server.time" value="267"> 
    <input type="hidden" title="jira.request.id" value="535x94414597x1"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="2"> 
    <input type="hidden" title="db.reads.time.in.ms" value="39"> 
    <input type="hidden" title="db.conns.time.in.ms" value="47"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 535x94414597x1
	          REQUEST TIMESTAMP : [05/Mar/2018:08:55:37 +0000]
	               REQUEST TIME : 0.2670
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 1

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=32, elapsedTotal=39801859, elapsedMin=709425, elapsedMax=12170287, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=36, elapsedTotal=47286803, elapsedMin=739721, elapsedMax=12203827, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|fb245c5f2852f7b34aaae57ee4f3ebc396063d80|lout"> 
  <link rel="shortcut icon" href="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"sd.customer.profile.multi.languages\":true,\"sd.customer.portal.transitions\":true,\"sd.customer.portal.transitions.config\":true,\"sd.custom.email.stripping.rules\":false,\"sd.sla.lucene.issue.id.callback.performance\":true,\"sd.new.settings.sidebar.location\":true,\"sd.workload.report.paginator\":true,\"sd.experimental.portal.search.algorithm.default.1\":false,\"sd.customer.portal.help.center.agent.announcement\":true,\"sd.sla.improved.rendering\":false,\"sd.experimental.portal.search.algorithm.default.2\":false,\"sd.customer.feedback.validate.reporter.on.token\":true,\"sd.custom.email.notifications.utf8.csat.star\":true,\"sd.who.create.customers.by.email.setting\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.renderer.consider.variable.format\":true,\"sd.stats.event.tracking\":true,\"sd.password.helper.dialog\":true,\"sd.canned.responses\":false,\"sd.portal.help.center.customer.signup.secondary.email\":true,\"sd.custom.email.notifications.manage.language\":true,\"sd.use.search.by.permissions\":true,\"sd.slavalue.record.updated.date\":false,\"sd.report.custom.date.range\":false,\"sd.kb.article.helpfulness.report\":false,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"sd.custom.email.notifications.styling\":true,\"sd.workinghours.new.page.bulldog.1\":false,\"sd.customer.portal.two.step.login\":false,\"sd.automation.psmq.async.executor\":true,\"sd.customer.org.list.page.lazy.search\":true,\"sd.approval.requested.when.handler\":true,\"sd.request.type.field.rest.api.filtering.bugfix\":true,\"sd.automation.then.action.auto.answer.approval\":true,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"sla.will.only.be.paused.if.they.are.already.started\":true,\"sd.kb.comment.share.stats.collection\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"sd.customer.orgs.group.participants\":true,\"sd.portal.help.center.customer.signup\":true,\"sd.sla.agent.jql.security.restricted\":true,\"sd.test.feature.flag.x\":true,\"sd.test.feature.flag.y\":false,\"sd.cluster.safe.mail.channel.shutdown\":true,\"sd.email.channel.folders\":false,\"sd.email.analytics.open\":false,\"sd.kb.project.creation.create.link.space\":true,\"sd.workinghours.new.page\":false,\"sd.confluence.anonymous.permission.fix\":true,\"com.atlassian.jira.issuetable.draggable\":true,\"sd.customer.portal.project.agent.announcement\":true,\"sd.automation.audit.log\":true,\"jira.jql.suggestrecentfields\":false,\"sd.canned.responses.check.index.startup\":false,\"sd.new.project.templates\":true,\"sd.custom.email.notifications.custom.rules.simple.ui\":false,\"sd.custom.email.notifications.cut.over\":true,\"sd.dismiss.all.misconfiguration.warnings.setting\":true,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"sd.sla.configurations.export\":true,\"sd.canned.responses.variable.substitution\":true,\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"sd.customer.portal.prioties.per.project.fix\":true,\"jira.instrumentation.laas\":false,\"sd.kb.self.service.report\":false,\"sla.improved.request.handling\":true,\"sd.no.schedule.async.upgrade.tasks\":true,\"sd.kb.primary.nav\":true,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"sd.kb.issueview.panel.phase2\":true,\"sd.email.outsider.comments\":true,\"jira.create.linked.issue\":true,\"sd.kb.issueview.panel\":true,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"sd.approvals.light.weight\":false,\"sd.automation.then.webhook\":true,\"sd.respect.inline.edit.issue.off\":true,\"jira.jql.smartautoselectfirst\":false,\"sd.global.portal.search.atlassian.only.tracking\":false,\"sd.automation.if.condition.comment.primary.action\":true,\"jira.priorities.per.project\":true,\"sd.inline.noformat.renderer\":true,\"sd.customer.request.type.create.edit.screens\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/png,image/vnd.wap.wbmp,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.servicedesk.servicedesk-canned-responses-plugin:canned-responses-data-provider.data"]="{\"substitutionVariables\":{\"issue.summary\":\"Issue summary\",\"issue.description\":\"Issue description\",\"issue.key\":\"Issue key\",\"issue.reporter.name\":\"Issue reporter\",\"issue.resolution\":\"Issue resolution\",\"request.url\":\"Request URL\",\"request.status\":\"Request status\"}}";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-help-links.help-links"]="{\"help\":{\"email.settings\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"managing.queues\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+queues+for+your+team\",\"email.setup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email\",\"request.settings.help.bubble\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\",\"email.settings.suitablerequest\":\"https://docs.atlassian.com/jira/jsd-docs-039/Receiving+requests+by+email#Receivingrequestsbyemail-suitablerequest\",\"sla.import.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Importing+SLAs\",\"documentation.home\":\"https://docs.atlassian.com/jira/jsd-docs-039/JIRA+Service+Desk+Documentation\",\"default\":\"https://docs.atlassian.com/jira/jsd-docs-039/\",\"create.space.help\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base#serving-customers-with-a-knowledge-base-createpermission\",\"email.settings.troubleshooting\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+the+email+channel\",\"admin.notifications.config\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+service+desk+notifications\",\"troubleshoot.requesttype\":\"https://docs.atlassian.com/jira/jsd-docs-039/Troubleshooting+issues+with+request+types\",\"approvals.configuration\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+JIRA+Service+Desk+approvals\",\"setting.up.reports\":\"https://docs.atlassian.com/jira/jsd-docs-039/Setting+up+service+desk+reports\",\"public.signup\":\"https://docs.atlassian.com/jira/jsd-docs-039/Configuring+public+signup\",\"knowledge.base\":\"https://docs.atlassian.com/jira/jsd-docs-039/Serving+customers+with+a+knowledge+base\",\"resolve.permission.scheme.errors\":\"https://docs.atlassian.com/jira/jsd-docs-039/Resolving+permission+scheme+errors\",\"getting.started\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+with+JIRA+Service+Desk\",\"getting.started.agent\":\"https://docs.atlassian.com/jira/jsd-docs-039/Getting+started+for+service+desk+agents\",\"invite.customers\":\"https://docs.atlassian.com/jira/jsd-docs-039/Managing+access+to+your+service+desk\"},\"kb\":{\"default\":\"https://confluence.atlassian.com/display/SDKB/\",\"troubleshooting.user.management.issues\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\",\"legacytransition\":\"https://confluence.atlassian.com/display/SDKB/Replacing+legacy+automatic+transitions+with+automation+rules\",\"umtroubleshoot\":\"https://confluence.atlassian.com/display/SDKB/Troubleshooting+issues+with+service+desk+user+management\"}}";
WRM._unparsedData["com.atlassian.servicedesk.core-ui:util-base-url.base-url"]="\"https://issues.apache.org/jira\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"d1b2f2a0c7312c\"";
WRM._unparsedData["project-id"]="12310110";
WRM._unparsedData["project-key"]="\"LUCENE\"";
WRM._unparsedData["project-name"]="\"Lucene - Core\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310110";
WRM._unparsedData["projectKey"]="\"LUCENE\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/1a6b21131945f6f49ff48336b49ca3fe-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/d8484c9183f546511a8e336a8779bcd9-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d3b35d835f8f46fc3b53bb4db7f85158-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/37a6e594cbbfd462a8a54d5aa11475c1/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/71d42e74136d842a3ef4d5d136484843-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/95a4826c265852f4904f1e0e7300df68-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/944bb39eced1b35cfc7194aa02eb5a5a/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/5a8f0f8b8aa8f96a4f0f7e9e248d62f3-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true&amp;sd_operational=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="LUCENE-701"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[LUCENE-701] Lock-less commits - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[LUCENE-701] Lock-less commits - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/LUCENE" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-701">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310110" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Lucene - Core'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310110&amp;avatarId=10061"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/LUCENE">Lucene - Core</a></li>
                 <li><a class="issue-link" data-issue-key="LUCENE-701" href="/jira/browse/LUCENE-701" id="key-val" rel="12354182">LUCENE-701</a></li>
                </ol>
                <h1 id="summary-val">Lock-less commits</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FLUCENE-701"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/LUCENE-701/LUCENE-701.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/LUCENE-701/LUCENE-701.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/LUCENE-701/LUCENE-701.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/LUCENE-701/LUCENE-701.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" title="Improvement - An improvement or enhancement to an existing feature or task." width="16"> Improvement </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/minor.svg" title="Minor - Minor loss of function, or other problem where easy workaround is present." width="16"> Minor </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="2.1 ">2.1</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+fixVersion+%3D+2.1" title="2.1 ">2.1</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+LUCENE+AND+component+%3D+%22core%2Findex%22" title="core/index issues with indexing code">core/index</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12354182-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310120" class="item"> 
                     <div class="wrap"> 
                      <strong title="Lucene Fields" class="name">Lucene Fields:</strong> 
                      <div id="customfield_12310120-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310120-field"> 
                        <span>Patch Available</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>This is a patch based on discussion a while back on lucene-dev:</p> 
                  <p> <a href="http://mail-archives.apache.org/mod_mbox/lucene-java-dev/200608.mbox/%3c44E5B16D.4010805@mikemccandless.com%3e" class="external-link" rel="nofollow">http://mail-archives.apache.org/mod_mbox/lucene-java-dev/200608.mbox/%3c44E5B16D.4010805@mikemccandless.com%3e</a></p> 
                  <p>The approach is a small modification over the original discussion (see<br> Retry Logic below). It works correctly in all my cross-machine test<br> case, but I want to open it up for feedback, testing by<br> users/developers in more diverse environments, etc.</p> 
                  <p>This is a small change to how lucene stores its index that enables<br> elimination of the commit lock entirely. The write lock still<br> remains.</p> 
                  <p>Of the two, the commit lock has been more troublesome for users since<br> it typically serves an active role in production. Whereas the write<br> lock is usually more of a design check to make sure you only have one<br> writer against the index at a time.</p> 
                  <p>The basic idea is that filenames are never reused ("write once"),<br> meaning, a writer never writes to a file that a reader may be reading<br> (there is one exception: the segments.gen file; see "RETRY LOGIC"<br> below). Instead it writes to generational files, ie, segments_1, then<br> segments_2, etc. Besides the segments file, the .del files and norm<br> files (.sX suffix) are also now generational. A generation is stored<br> as an "_N" suffix before the file extension (eg, _p_4.s0 is the<br> separate norms file for segment "p", generation 4).</p> 
                  <p>One important benefit of this is it avoids files contents caching<br> entirely (the likely cause of errors when readers open an index<br> mounted on NFS) since the file is always a new file.</p> 
                  <p>With this patch I can reliably instantiate readers over NFS when a<br> writer is writing to the index. However, with NFS, you are still forced to<br> refresh your reader once a writer has committed because "point in<br> time" searching doesn't work over NFS (see <a href="https://issues.apache.org/jira/browse/LUCENE-673" title="Exceptions when using Lucene over NFS" class="issue-link" data-issue-key="LUCENE-673"><del>LUCENE-673</del></a> ).</p> 
                  <p>The changes are fully backwards compatible: you can open an old index<br> for searching, or to add/delete docs, etc. I've added a new unit test<br> to test these cases.</p> 
                  <p>All units test pass, and I've added a number of additional unit tests,<br> some of which fail on WIN32 in the current lucene but pass with this<br> patch. The "fileformats.xml" has been updated to describe the changes<br> to the files (but XXX references need to be fixed before committing).</p> 
                  <p>There are some other important benefits:</p> 
                  <ul> 
                   <li>Readers are now entirely read-only.</li> 
                  </ul> 
                  <ul> 
                   <li>Readers no longer block one another (false contention) on<br> initialization.</li> 
                  </ul> 
                  <ul> 
                   <li>On hitting contention, we immediately retry instead of a fixed<br> (default 1.0 second now) pause.</li> 
                  </ul> 
                  <ul> 
                   <li>No file renaming is ever done. File renaming has caused sneaky<br> access denied errors on WIN32 (see <a href="https://issues.apache.org/jira/browse/LUCENE-665" title="temporary file access denied on Windows" class="issue-link" data-issue-key="LUCENE-665"><del>LUCENE-665</del></a> ). (Yonik, I used<br> your approach here to not rename the segments_N file(try<br> segments_(N-1) on hitting IOException on segments_N): the separate<br> ".done" file did not work reliably under very high stress testing<br> when a directory listing was not "point in time").</li> 
                  </ul> 
                  <ul> 
                   <li>On WIN32, you can now call IndexReader.setNorm() even if other<br> readers have the index open (fixes a pre-existing minor bug in<br> Lucene).</li> 
                  </ul> 
                  <ul> 
                   <li>On WIN32, You can now create an IndexWriter with create=true even<br> if readers have the index open (eg see<br> www.gossamer-threads.com/lists/lucene/java-user/39265) .</li> 
                  </ul> 
                  <p>Here's an overview of the changes:</p> 
                  <ul> 
                   <li>Every commit writes to the next segments_(N+1).</li> 
                  </ul> 
                  <ul> 
                   <li>Loading the segments_N file (&amp; opening the segments) now requires<br> retry logic. I've captured this logic into a new static class:<br> SegmentInfos.FindSegmentsFile. All places that need to do<br> something on the current segments file now use this class.</li> 
                  </ul> 
                  <ul> 
                   <li>No more deletable file. Instead, the writer computes what's<br> deletable on instantiation and updates this in memory whenever<br> files can be deleted (ie, when it commits). Created a common<br> class index.IndexFileDeleter shared by reader &amp; writer, to manage<br> deletes.</li> 
                  </ul> 
                  <ul> 
                   <li>Storing more information into segments info file: whether it has<br> separate deletes (and which generation), whether it has separate<br> norms, per field (and which generation), whether it's compound or<br> not. This is instead of relying on IO operations (file exists<br> calls). Note that this fixes the current misleading<br> FileNotFoundException users now see when an _X.cfs file is missing<br> (eg <a href="http://www.nabble.com/FileNotFound-Exception-t6987.html" class="external-link" rel="nofollow">http://www.nabble.com/FileNotFound-Exception-t6987.html</a>).</li> 
                  </ul> 
                  <ul> 
                   <li>Fixed some small things about RAMDirectory that were not<br> filesystem-like (eg opening a non-existent IndexInput failed to<br> raise IOException; renames were not atomic). I added a stress<br> test against a RAMDirectory (1 writer thread &amp; 2 reader threads)<br> that uncovered these.</li> 
                  </ul> 
                  <ul> 
                   <li>Added option to not remove old files when create=true on creating<br> FSDirectory; this is so the writer can do its own [more<br> sophisticated because it retries on errors] removal.</li> 
                  </ul> 
                  <ul> 
                   <li>Removed all references to commit lock, COMMIT_LOCK_TIMEOUT, etc.<br> (This is an API change).</li> 
                  </ul> 
                  <ul> 
                   <li>Extended index/IndexFileNames.java and index/IndexFileNameFilter.java<br> with logic for computing generational file names.</li> 
                  </ul> 
                  <ul> 
                   <li>Changed index/IndexFileNameFilter.java to use a HashSet to check<br> file extentsions for better performance.</li> 
                  </ul> 
                  <ul> 
                   <li>Fixed the test case TestIndexReader.testLastModified: it was<br> incorrectly (I think?) comparing lastModified to version, of the<br> index. I fixed that and then added a new test case for version.</li> 
                  </ul> 
                  <p>Retry Logic (in index/SegmentInfos.java)</p> 
                  <p>If a reader tries to load the segments just as a writer is committing,<br> it may hit an IOException. This is just normal contention. In<br> current Lucene contention causes a <span class="error">[default]</span> 1.0 second pause then<br> retry. With lock-less the contention causes no added delay beyond the<br> time to retry.</p> 
                  <p>When this happens, we first try segments_(N-1) if present, because it<br> could be segments_N is still being written. If that fails, we<br> re-check to see if there is now a newer segments_M where M &gt; N and<br> advance if so. Else we retry segments_N once more (since it could be<br> it was in process previously but must now be complete since<br> segments_(N-1) did not load).</p> 
                  <p>In order to find the current segments_N file, I list the directory and<br> take the biggest segments_N that exists.</p> 
                  <p>However, under extreme stress testing (5 threads just opening &amp;<br> closing readers over and over), on one platform (OS X) I found that<br> the directory listing can be incorrect (stale) by up to 1.0 seconds.<br> This means the listing will show a segments_N file but that file does<br> not exist (fileExists() returns false).</p> 
                  <p>In order to handle this (and other such platforms), I switched to a<br> hybrid approach (originally proposed by Doron Cohen in the original<br> thread): on committing, the writer writes to a file "segments.gen" the<br> generation it just committed. It writes 2 identical longs into this<br> file. The retry logic, on detecting that the directory listing is<br> stale falls back to the contents of this file. If that file is<br> consistent (the two longs are identical), and, the generation is<br> indeed newer than the dir listing, it will use that.</p> 
                  <p>Finally, if this approach is also stale, we fallback to stepping<br> through sequential generations (up to a maximum # tries). If all 3<br> methods fail, we throw the original exception we hit.</p> 
                  <p>I added a static method SegmentInfos.setInfoStream() which will print<br> details of retry attempts. In the patch it's set to System.out right<br> now (we should turn off before a real commit) so if there are problems<br> we can see what retry logic had done.</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/LUCENE-701?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/LUCENE-701?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/LUCENE-701?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/LUCENE-701?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12343820" data-issue-id="12354182" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12343820/index.prelockless.cfs.zip" draggable="true" data-downloadurl="application/zip:index.prelockless.cfs.zip:https://issues.apache.org/jira/secure/attachment/12343820/index.prelockless.cfs.zip"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-zip" title="Zip Archive"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12343820/index.prelockless.cfs.zip" title="Latest  27/Oct/06 23:41 - Michael McCandless" draggable="true" data-downloadurl="application/zip:index.prelockless.cfs.zip:https://issues.apache.org/jira/secure/attachment/12343820/index.prelockless.cfs.zip">index.prelockless.cfs.zip</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2006-10-27T23:41:51.000Z">27/Oct/06 23:41</time>
                   </dd>
                   <dd class="attachment-size">
                    4 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael McCandless
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12343821" data-issue-id="12354182" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12343821/index.prelockless.nocfs.zip" draggable="true" data-downloadurl="application/zip:index.prelockless.nocfs.zip:https://issues.apache.org/jira/secure/attachment/12343821/index.prelockless.nocfs.zip"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-zip" title="Zip Archive"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12343821/index.prelockless.nocfs.zip" title="Latest  27/Oct/06 23:42 - Michael McCandless" draggable="true" data-downloadurl="application/zip:index.prelockless.nocfs.zip:https://issues.apache.org/jira/secure/attachment/12343821/index.prelockless.nocfs.zip">index.prelockless.nocfs.zip</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2006-10-27T23:42:16.000Z">27/Oct/06 23:42</time>
                   </dd>
                   <dd class="attachment-size">
                    11 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael McCandless
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12343819" data-issue-id="12354182" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12343819/lockless-commits-patch.txt" draggable="true" data-downloadurl="text/plain:lockless-commits-patch.txt:https://issues.apache.org/jira/secure/attachment/12343819/lockless-commits-patch.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12343819/lockless-commits-patch.txt" title="Latest  27/Oct/06 23:40 - Michael McCandless" draggable="true" data-downloadurl="text/plain:lockless-commits-patch.txt:https://issues.apache.org/jira/secure/attachment/12343819/lockless-commits-patch.txt">lockless-commits-patch.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2006-10-27T23:40:23.000Z">27/Oct/06 23:40</time>
                   </dd>
                   <dd class="attachment-size">
                    124 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael McCandless
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12344414" data-issue-id="12354182" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12344414/lockless-commits-patch2.txt" draggable="true" data-downloadurl="text/plain:lockless-commits-patch2.txt:https://issues.apache.org/jira/secure/attachment/12344414/lockless-commits-patch2.txt"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-txt" title="Text File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12344414/lockless-commits-patch2.txt" title="Latest  06/Nov/06 19:26 - Michael McCandless" draggable="true" data-downloadurl="text/plain:lockless-commits-patch2.txt:https://issues.apache.org/jira/secure/attachment/12344414/lockless-commits-patch2.txt">lockless-commits-patch2.txt</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2006-11-06T19:26:45.000Z">06/Nov/06 19:26</time>
                   </dd>
                   <dd class="attachment-size">
                    113 kB
                   </dd>
                   <dd class="attachment-author">
                    Michael McCandless
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_mikemccand" rel="mikemccand" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Michael McCandless&quot;,&quot;emailAddress&quot;:&quot;lucene@mikemccandless.com&quot;,&quot;username&quot;:&quot;mikemccand&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="mikemccand"></span></span> Michael McCandless </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_mikemccand" rel="mikemccand" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Michael McCandless&quot;,&quot;emailAddress&quot;:&quot;lucene@mikemccandless.com&quot;,&quot;username&quot;:&quot;mikemccand&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="mikemccand"></span></span> Michael McCandless </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">4</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">1</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="27/Oct/06 23:39"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2006-10-27T23:39:47+0000">27/Oct/06 23:39</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="27/Feb/07 18:10"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2007-02-27T18:10:35+0000">27/Feb/07 18:10</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="17/Nov/06 23:22"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2006-11-17T23:22:40+0000">17/Nov/06 23:22</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for n/a, Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-701?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-701?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-701?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-701?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-701?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-701?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-701?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-701?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/LUCENE-701?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/LUCENE-701?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/LUCENE-701?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/LUCENE-701?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-12445298\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12445298&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12445298\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12445298_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12445298_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Oct\\/06 23:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-27T23:41:51+0000\'\u003e27\\/Oct\\/06 23:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eZIP file that needs to be put in src\\/test\\/org\\/apache\\/lucene\\/index (used by backwards compatibility test).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12445298_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12445298_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Oct\\/06 23:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-27T23:41:51+0000\'\u003e27\\/Oct\\/06 23:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    ZIP file that needs to be put in src\\/test\\/org\\/apache\\/lucene\\/index (used by backwards compatibility test).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12445299\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12445299&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12445299\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12445299_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12445299_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Oct\\/06 23:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-27T23:42:16+0000\'\u003e27\\/Oct\\/06 23:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eZIP file that needs to be put in src\\/test\\/org\\/apache\\/lucene\\/index (used by backwards compatibility test).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12445299_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12445299_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Oct\\/06 23:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-27T23:42:16+0000\'\u003e27\\/Oct\\/06 23:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    ZIP file that needs to be put in src\\/test\\/org\\/apache\\/lucene\\/index (used by backwards compatibility test).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446122\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446122&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446122\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12446122_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446122_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Oct\\/06 23:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-31T23:49:16+0000\'\u003e31\\/Oct\\/06 23:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNice job on this very ambitious patch (all 3500 lines of it!) Good tests are certainly important!\u003c\\/p\u003e\\n\\n\u003cp\u003eCould you elaborate on how the backward compatibility works w.r.t. modifying an old index?\u003cbr\\/\u003e\\nHow do versioned norms &amp; del files mix with older unversion files?\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the absense of contention, have you noticed any performance differences in opening an IndexReader?\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; on one platform (OS X) I found that the directory listing can be incorrect (stale) by up to 1.0 seconds. \u003c\\/p\u003e\\n\\n\u003cp\u003eThat sucks... (but great job on the very thorough testing).\u003cbr\\/\u003e\\nCan it happen with the latest version of OS X?  If not, couldn\'t we just require an upgrade, or do you think that other platforms suffer from this.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12446122_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446122_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'31\\/Oct\\/06 23:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-10-31T23:49:16+0000\'\u003e31\\/Oct\\/06 23:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Nice job on this very ambitious patch (all 3500 lines of it!) Good tests are certainly important! \\n\\n Could you elaborate on how the backward compatibility works w.r.t. modifying an old index? \\nHow do versioned norms &amp; del files mix with older unversion files? \\n\\n In the absense of contention, have you noticed any performance differences in opening an IndexReader? \\n\\n &gt; on one platform (OS X) I found that the directory listing can be incorrect (stale) by up to 1.0 seconds.  \\n\\n That sucks... (but great job on the very thorough testing). \\nCan it happen with the latest version of OS X?  If not, couldn\'t we just require an upgrade, or do you think that other platforms suffer from this.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446342\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446342&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446342\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446342_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446342_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Nov\\/06 18:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-01T18:34:13+0000\'\u003e01\\/Nov\\/06 18:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Yonik for looking at this!\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; Could you elaborate on how the backward compatibility works w.r.t. modifying an old index?\u003cbr\\/\u003e\\n&gt; How do versioned norms &amp; del files mix with older unversion files?\u003c\\/p\u003e\\n\\n\u003cp\u003eOK, first off, the only file whose contents and name are changed is\u003cbr\\/\u003e\\nthe \\\"segments_N\\\" file.  Then, the only files whose name (but not\u003cbr\\/\u003e\\ncontents) is changed are the \\\"_X_N.del\\\" deletes file, and \\\"_X_N.sZ\\\"\u003cbr\\/\u003e\\nseparate norms files).  Finally, the only file that is deleted is\u003cbr\\/\u003e\\ndeletable.  All other segments files are unchanged.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe unit test I added for this (TestBackwardsCompatibility) un-zips a\u003cbr\\/\u003e\\npre-lockless index (I have one zip file for CFS format and one for\u003cbr\\/\u003e\\nnon-CFS) and then runs various tests: adding docs, deleting a doc,\u003cbr\\/\u003e\\nsetting a norm for a doc, searching, etc., verifying that the results\u003cbr\\/\u003e\\nare then as expected.\u003c\\/p\u003e\\n\\n\u003cp\u003eOn opening an pre-lockless index, first we see only a \\\"segments\\\" file\u003cbr\\/\u003e\\nwith no _N extension, and record its generation as 0.  Second, since\u003cbr\\/\u003e\\nthat file\'s contents doesn\'t lead with format lockless code (-2), we\u003cbr\\/\u003e\\nknow to load the old segments info format that does not contain the\u003cbr\\/\u003e\\n\\\"del\\\" gen, \\\"separate norm\\\" gen nor the \\\"isCompundFile\\\" marker.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhen loading each Segmentinfo, since the format of the segments files\u003cbr\\/\u003e\\nwas old, we record this with \\\"preLockless = true\\\" and set delGen and\u003cbr\\/\u003e\\nisCompoundFile to 0 and normGen to null.  0 means \\\"must check\u003cbr\\/\u003e\\nfilesystem for existence\\\".  The various methods (hasSeparateNorms,\u003cbr\\/\u003e\\nhasDeletions, etc.) know to handle these \\\"0\\\" cases as falling back to\u003cbr\\/\u003e\\nfilesystem existence checks of the existing naming (ie, _X.del).  I\u003cbr\\/\u003e\\ntried to capture \\/ contain all of this inside the methods of\u003cbr\\/\u003e\\nSegmentInfo.\u003c\\/p\u003e\\n\\n\u003cp\u003eNow, when a writer commits to this pre-lockless index, we write in the\u003cbr\\/\u003e\\nnew (format lockless) format and to the file \\\"segments_1\\\".  (Actually,\u003cbr\\/\u003e\\nwith compound file turned on, we then make a .cfs file and commit\u003cbr\\/\u003e\\nagain to \\\"segments_2\\\").  This file will reference all of the old\u003cbr\\/\u003e\\nsegments (except eg those deleted by a merge) plus the one new\u003cbr\\/\u003e\\nsegment.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe old segments have written the \\\"0\\\"\'s for delGen, normGen (null is\u003cbr\\/\u003e\\nwritten as -1 length), isCompoundFile so that on re-loading this\u003cbr\\/\u003e\\nsegments_2 file these segments remain pre-lockless.  The SegmentInfo\u003cbr\\/\u003e\\nfor the new segment file will have isCompoundFile=1 (meaning it is a\u003cbr\\/\u003e\\ncompound file), delGen=-1 (there are no separate deletes yet) and\u003cbr\\/\u003e\\nnormGen=null (there are no separate norms yet).  When normGen is null,\u003cbr\\/\u003e\\nwe look at \\\"preLockless\\\" to differentiate whether this means there are\u003cbr\\/\u003e\\nno separate norms at all for any fields, or, this segment is pre\u003cbr\\/\u003e\\nlockless and therefore we must fallback to the filesystem check.\u003c\\/p\u003e\\n\\n\u003cp\u003eIf a delete or setNorm call takes place against an old segment format,\u003cbr\\/\u003e\\nwe will at that time create \\\"generation 1\\\" for that file.  This means\u003cbr\\/\u003e\\nyou can have an old segment whose separate del file is still\u003cbr\\/\u003e\\n\\\"generation 0\\\" (you have to check for existence of _X.del) but whose\u003cbr\\/\u003e\\nseparate norms generations are known (or, only certain fields are\u003cbr\\/\u003e\\nknown and the others are \\\"generation 0\\\" and require filesystem check).\u003cbr\\/\u003e\\nThis means an \\\"old\\\" segment file could become \\\"slightly newer\\\" as\u003cbr\\/\u003e\\nnorm\\/del changes are made against it.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo an index can have mixed old\\/new segments.  The SegmentInfo for each\u003cbr\\/\u003e\\nsegment keeps track of old\\/new (and tries to hide these implementation\u003cbr\\/\u003e\\ndetails under its methods) with delGen, normGen, isCompoundFile and\u003cbr\\/\u003e\\npreLockless (which is derived from isCompoundFile).\u003c\\/p\u003e\\n\\n\u003cp\u003eOnce an optimize is done, or, all old segments have been merged away,\u003cbr\\/\u003e\\nthen all segments are now the lockless format.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446342_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446342_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Nov\\/06 18:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-01T18:34:13+0000\'\u003e01\\/Nov\\/06 18:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Yonik for looking at this! \\n\\n &gt; Could you elaborate on how the backward compatibility works w.r.t. modifying an old index? \\n&gt; How do versioned norms &amp; del files mix with older unversion files? \\n\\n OK, first off, the only file whose contents and name are changed is \\nthe \\\"segments_N\\\" file.  Then, the only files whose name (but not \\ncontents) is changed are the \\\"_X_N.del\\\" deletes file, and \\\"_X_N.sZ\\\" \\nseparate norms files).  Finally, the only file that is deleted is \\ndeletable.  All other segments files are unchanged. \\n\\n The unit test I added for this (TestBackwardsCompatibility) un-zips a \\npre-lockless index (I have one zip file for CFS format and one for \\nnon-CFS) and then runs various tests: adding docs, deleting a doc, \\nsetting a norm for a doc, searching, etc., verifying that the results \\nare then as expected. \\n\\n On opening an pre-lockless index, first we see only a \\\"segments\\\" file \\nwith no _N extension, and record its generation as 0.  Second, since \\nthat file\'s contents doesn\'t lead with format lockless code (-2), we \\nknow to load the old segments info format that does not contain the \\n\\\"del\\\" gen, \\\"separate norm\\\" gen nor the \\\"isCompundFile\\\" marker. \\n\\n When loading each Segmentinfo, since the format of the segments files \\nwas old, we record this with \\\"preLockless = true\\\" and set delGen and \\nisCompoundFile to 0 and normGen to null.  0 means \\\"must check \\nfilesystem for existence\\\".  The various methods (hasSeparateNorms, \\nhasDeletions, etc.) know to handle these \\\"0\\\" cases as falling back to \\nfilesystem existence checks of the existing naming (ie, _X.del).  I \\ntried to capture \\/ contain all of this inside the methods of \\nSegmentInfo. \\n\\n Now, when a writer commits to this pre-lockless index, we write in the \\nnew (format lockless) format and to the file \\\"segments_1\\\".  (Actually, \\nwith compound file turned on, we then make a .cfs file and commit \\nagain to \\\"segments_2\\\").  This file will reference all of the old \\nsegments (except eg those deleted by a merge) plus the one new \\nsegment. \\n\\n The old segments have written the \\\"0\\\"\'s for delGen, normGen (null is \\nwritten as -1 length), isCompoundFile so that on re-loading this \\nsegments_2 file these segments remain pre-lockless.  The SegmentInfo \\nfor the new segment file will have isCompoundFile=1 (meaning it is a \\ncompound file), delGen=-1 (there are no separate deletes yet) and \\nnormGen=null (there are no separate norms yet).  When normGen is null, \\nwe look at \\\"preLockless\\\" to differentiate whether this means there are \\nno separate norms at all for any fields, or, this segment is pre \\nlockless and therefore we must fallback to the filesystem check. \\n\\n If a delete or setNorm call takes place against an old segment format, \\nwe will at that time create \\\"generation 1\\\" for that file.  This means \\nyou can have an old segment whose separate del file is still \\n\\\"generation 0\\\" (you have to check for existence of _X.del) but whose \\nseparate norms generations are known (or, only certain fields are \\nknown and the others are \\\"generation 0\\\" and require filesystem check). \\nThis means an \\\"old\\\" segment file could become \\\"slightly newer\\\" as \\nnorm\\/del changes are made against it. \\n\\n So an index can have mixed old\\/new segments.  The SegmentInfo for each \\nsegment keeps track of old\\/new (and tries to hide these implementation \\ndetails under its methods) with delGen, normGen, isCompoundFile and \\npreLockless (which is derived from isCompoundFile). \\n\\n Once an optimize is done, or, all old segments have been merged away, \\nthen all segments are now the lockless format. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446344\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446344&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446344\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446344_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446344_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Nov\\/06 18:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-01T18:35:38+0000\'\u003e01\\/Nov\\/06 18:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; &gt; on one platform (OS X) I found that the directory listing can be incorrect (stale) by up to 1.0 seconds.\u003cbr\\/\u003e\\n&gt; \u003cbr\\/\u003e\\n&gt; That sucks... (but great job on the very thorough testing).\u003cbr\\/\u003e\\n&gt; Can it happen with the latest version of OS X? If not, couldn\'t we just require an upgrade, or do you think that other platforms suffer from this.\u003c\\/p\u003e\\n\\n\u003cp\u003eYes, this was very surprising and annoying!  Unfortunately, this\u003cbr\\/\u003e\\nhappens on the latest version of OS X (10.4.8).  Other platforms that\u003cbr\\/\u003e\\nI tested do \\\"the right thing\\\" meaning when you list a directory the\u003cbr\\/\u003e\\nNFS client on Linux first checks with the server to see if its cache\u003cbr\\/\u003e\\nis stale and correctly clears the cache.  Windows SMB is also always\u003cbr\\/\u003e\\ncorrect.  But I think it\'s entirely likely that filesystems do this\u003cbr\\/\u003e\\nkind of time-based (only) cache validation. I figured better safe than\u003cbr\\/\u003e\\nsorry here, and Lucene should tolerate stale caching around either\u003cbr\\/\u003e\\nfile contents or directory listing.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446344_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446344_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Nov\\/06 18:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-01T18:35:38+0000\'\u003e01\\/Nov\\/06 18:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; &gt; on one platform (OS X) I found that the directory listing can be incorrect (stale) by up to 1.0 seconds. \\n&gt;  \\n&gt; That sucks... (but great job on the very thorough testing). \\n&gt; Can it happen with the latest version of OS X? If not, couldn\'t we just require an upgrade, or do you think that other platforms suffer from this. \\n\\n Yes, this was very surprising and annoying!  Unfortunately, this \\nhappens on the latest version of OS X (10.4.8).  Other platforms that \\nI tested do \\\"the right thing\\\" meaning when you list a directory the \\nNFS client on Linux first checks with the server to see if its cache \\nis stale and correctly clears the cache.  Windows SMB is also always \\ncorrect.  But I think it\'s entirely likely that filesystems do this \\nkind of time-based (only) cache validation. I figured better safe than \\nsorry here, and Lucene should tolerate stale caching around either \\nfile contents or directory listing.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446346\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446346&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446346\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446346_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446346_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Nov\\/06 18:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-01T18:42:35+0000\'\u003e01\\/Nov\\/06 18:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; In the absense of contention, have you noticed any performance differences in opening an IndexReader? \u003c\\/p\u003e\\n\\n\u003cp\u003e[First one side note: it\'s during contention that lock-less really\u003cbr\\/\u003e\\nshines.  Because, currently Lucene hits at least a \u003cspan class=\\\"error\\\"\u003e&#91;default&#93;\u003c\\/span\u003e 1.0\u003cbr\\/\u003e\\nsecond delay under contention, whereas lockless immediately retries.\u003cbr\\/\u003e\\nAnd, readers now have contention with one another, but not with\u003cbr\\/\u003e\\nlock-less.]\u003c\\/p\u003e\\n\\n\u003cp\u003eI ran the following basic performance test.  In each case I measure\u003cbr\\/\u003e\\navg wall clock time to instantiate readers &amp; writers against the same\u003cbr\\/\u003e\\nindex.  A writer creates the index, adding documents as quickly as it\u003cbr\\/\u003e\\ncan, and commits and closes\\/reopens its writer every 2 seconds.  Then,\u003cbr\\/\u003e\\na reader reads against the same index, just instantiating a searcher\u003cbr\\/\u003e\\nthen closing it and then pausing for 2 seconds.  I skew the writer by\u003cbr\\/\u003e\\n1 sec to try to minimize contention.  Each test is avg of 3 runs,\u003cbr\\/\u003e\\nwhere each run is 2 minutes.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn order to not count contention, I made temporary mods, to both\u003cbr\\/\u003e\\ncurrent lucene &amp; lockless, to throw IOException on hitting contention.\u003cbr\\/\u003e\\nThen, I catch that above and discard the time for that one\u003cbr\\/\u003e\\ninstantiation of reader or writer.\u003c\\/p\u003e\\n\\n\u003cp\u003eAll times are mili-seconds.  Each time is formatted as current Lucene\u003cbr\\/\u003e\\ntime followed by lockless in (...)s:\u003c\\/p\u003e\\n\\n\u003cp\u003e       Local index (Linux):   4.62  (6.04)\u003cbr\\/\u003e\\n       Local index (WIN32):  85.45 (66.37)\u003c\\/p\u003e\\n\\n\u003cp\u003e  NFS remote index (Linux): 171.26 (11.04)\u003cbr\\/\u003e\\n  SMB remote index (WIN32):  48.91 (31.55)\u003c\\/p\u003e\\n\\n\u003cp\u003eThe \\\"remote index\\\" case means a writer on that OS, and a reader on\u003cbr\\/\u003e\\nanother machine with the same OS, reading the index on a mount from\u003cbr\\/\u003e\\nthe writer machine (ie, writer is writing locally and reader is\u003cbr\\/\u003e\\nreading remotely).\u003c\\/p\u003e\\n\\n\u003cp\u003eOne caveat: I saw quite a bit of variance between runs.  I tried to\u003cbr\\/\u003e\\neliminate causes (stopped all services, other applications, etc.)  but\u003cbr\\/\u003e\\nstill there is variance.  Maybe I should be taking the \\\"minumum\\\" time\u003cbr\\/\u003e\\nseen instead of the average (this was mentioned on the benchmarking\u003cbr\\/\u003e\\nJira issue)...\u003c\\/p\u003e\\n\\n\u003cp\u003eAnyway, the surprising thing is that lockless is faster in most cases\u003cbr\\/\u003e\\nIn the remote cases (especially NFS) it\'s quite a bit faster.  I think\u003cbr\\/\u003e\\nthis may be because lockless does far fewer \\\"fileExists\\\" calls\u003cbr\\/\u003e\\ncompared to current Lucene.  For example, the \\\"openNorms\\\" call\u003cbr\\/\u003e\\npresently does a \\\"fileExists\\\" call per field that has norms index\u003cbr\\/\u003e\\ntimes the number of segments.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m not sure these speedups\\/differences are all that important in a\u003cbr\\/\u003e\\ntypical Lucene use case, where the cost of instantiating a reader is\u003cbr\\/\u003e\\namortized over all the searches that occur during the lifetime of that\u003cbr\\/\u003e\\nreader.  Though, maybe one real difference is: if we can make sure the\u003cbr\\/\u003e\\nlatency is low enough, it\'s OK to have a single query pay the price of\u003cbr\\/\u003e\\nreopening the searcher.  Ie, it becomes reasonable to have an incoming\u003cbr\\/\u003e\\nquery first check whether the searcher is current and if not, reopen\u003cbr\\/\u003e\\nit, and then run the query, vs having separate background thread do\u003cbr\\/\u003e\\nthis, which is certainly feasible just more complicated.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446346_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446346_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Nov\\/06 18:42\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-01T18:42:35+0000\'\u003e01\\/Nov\\/06 18:42\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; In the absense of contention, have you noticed any performance differences in opening an IndexReader?  \\n\\n [First one side note: it\'s during contention that lock-less really \\nshines.  Because, currently Lucene hits at least a  &#91;default&#93;  1.0 \\nsecond delay under contention, whereas lockless immediately retries. \\nAnd, readers now have contention with one another, but not with \\nlock-less.] \\n\\n I ran the following basic performance test.  In each case I measure \\navg wall clock time to instantiate readers &amp; writers against the same \\nindex.  A writer creates the index, adding documents as quickly as it \\ncan, and commits and closes\\/reopens its writer every 2 seconds.  Then, \\na reader reads against the same index, just instantiating a searcher \\nthen closing it and then pausing for 2 seconds.  I skew the writer by \\n1 sec to try to minimize contention.  Each test is avg of 3 runs, \\nwhere each run is 2 minutes. \\n\\n In order to not count contention, I made temporary mods, to both \\ncurrent lucene &amp; lockless, to throw IOException on hitting contention. \\nThen, I catch that above and discard the time for that one \\ninstantiation of reader or writer. \\n\\n All times are mili-seconds.  Each time is formatted as current Lucene \\ntime followed by lockless in (...)s: \\n\\n        Local index (Linux):   4.62  (6.04) \\n       Local index (WIN32):  85.45 (66.37) \\n\\n   NFS remote index (Linux): 171.26 (11.04) \\n  SMB remote index (WIN32):  48.91 (31.55) \\n\\n The \\\"remote index\\\" case means a writer on that OS, and a reader on \\nanother machine with the same OS, reading the index on a mount from \\nthe writer machine (ie, writer is writing locally and reader is \\nreading remotely). \\n\\n One caveat: I saw quite a bit of variance between runs.  I tried to \\neliminate causes (stopped all services, other applications, etc.)  but \\nstill there is variance.  Maybe I should be taking the \\\"minumum\\\" time \\nseen instead of the average (this was mentioned on the benchmarking \\nJira issue)... \\n\\n Anyway, the surprising thing is that lockless is faster in most cases \\nIn the remote cases (especially NFS) it\'s quite a bit faster.  I think \\nthis may be because lockless does far fewer \\\"fileExists\\\" calls \\ncompared to current Lucene.  For example, the \\\"openNorms\\\" call \\npresently does a \\\"fileExists\\\" call per field that has norms index \\ntimes the number of segments. \\n\\n I\'m not sure these speedups\\/differences are all that important in a \\ntypical Lucene use case, where the cost of instantiating a reader is \\namortized over all the searches that occur during the lifetime of that \\nreader.  Though, maybe one real difference is: if we can make sure the \\nlatency is low enough, it\'s OK to have a single query pay the price of \\nreopening the searcher.  Ie, it becomes reasonable to have an incoming \\nquery first check whether the searcher is current and if not, reopen \\nit, and then run the query, vs having separate background thread do \\nthis, which is certainly feasible just more complicated.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446397\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446397&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446397\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12446397_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446397_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Nov\\/06 22:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-01T22:55:25+0000\'\u003e01\\/Nov\\/06 22:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for all the details Michael!  A few more random comments and questions:\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the future, it might be nice if there was an option to disable segments.gen to be more friendly to write-once filesystems like HDFS.\u003c\\/p\u003e\\n\\n\u003cp\u003eAs far as performance goes, I was personally interested in the contentionless case since that\'s what processes that coordinate everything (like Solr) will see.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m not sure I understand the \\\"segments.gen\\\" logic of writing two longs that are identical.\u003cbr\\/\u003e\\nLooking at the code, it doesn\'t seem like you are implementing this:\u003cbr\\/\u003e\\n\u003ca href=\\\"http:\\/\\/www.nabble.com\\/Re%3A-Lock-less-commits-p5978090.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.nabble.com\\/Re%3A-Lock-less-commits-p5978090.html\u003c\\/a\u003e\u003cbr\\/\u003e\\nAre there two longs instead of one in order to leave \\\"space\\\" for that implementation if needed, w\\/o having to change the file format?\u003c\\/p\u003e\\n\\n\u003cp\u003eThe file deleting code does much more than in the past, and that\'s a good thing IMO.  For example it looks like leftover non-compound segment files from a failed CFS merge (say the JVM dies) will now be cleaned up!\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m having a hard time figuring out how older delete files are removed (since they contain the current segment name, it looks like findDeletableFiles would skip them).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12446397_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446397_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'01\\/Nov\\/06 22:55\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-01T22:55:25+0000\'\u003e01\\/Nov\\/06 22:55\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for all the details Michael!  A few more random comments and questions: \\n\\n In the future, it might be nice if there was an option to disable segments.gen to be more friendly to write-once filesystems like HDFS. \\n\\n As far as performance goes, I was personally interested in the contentionless case since that\'s what processes that coordinate everything (like Solr) will see. \\n\\n I\'m not sure I understand the \\\"segments.gen\\\" logic of writing two longs that are identical. \\nLooking at the code, it doesn\'t seem like you are implementing this: \\n http:\\/\\/www.nabble.com\\/Re%3A-Lock-less-commits-p5978090.html  \\nAre there two longs instead of one in order to leave \\\"space\\\" for that implementation if needed, w\\/o having to change the file format? \\n\\n The file deleting code does much more than in the past, and that\'s a good thing IMO.  For example it looks like leftover non-compound segment files from a failed CFS merge (say the JVM dies) will now be cleaned up! \\n\\n I\'m having a hard time figuring out how older delete files are removed (since they contain the current segment name, it looks like findDeletableFiles would skip them).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446628\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446628&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446628\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446628_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446628_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 15:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T15:19:16+0000\'\u003e02\\/Nov\\/06 15:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGood questions!\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; In the future, it might be nice if there was an option to disable\u003cbr\\/\u003e\\n&gt; segments.gen to be more friendly to write-once filesystems like\u003cbr\\/\u003e\\n&gt; HDFS.\u003c\\/p\u003e\\n\\n\u003cp\u003eI think this makes sense.  I will add control over this on the next\u003cbr\\/\u003e\\niteration of the patch.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; As far as performance goes, I was personally interested in the\u003cbr\\/\u003e\\n&gt; contentionless case since that\'s what processes that coordinate\u003cbr\\/\u003e\\n&gt; everything (like Solr) will see.\u003c\\/p\u003e\\n\\n\u003cp\u003eAhh got it, OK.  That\'s fair.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; I\'m not sure I understand the \\\"segments.gen\\\" logic of writing two\u003cbr\\/\u003e\\n&gt; longs that are identical.  Looking at the code, it doesn\'t seem like\u003cbr\\/\u003e\\n&gt; you are implementing this:\u003cbr\\/\u003e\\n&gt; \u003ca href=\\\"http:\\/\\/www.nabble.com\\/Re%3A-Lock-less-commits-p5978090.html\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/www.nabble.com\\/Re%3A-Lock-less-commits-p5978090.html\u003c\\/a\u003e\u003cbr\\/\u003e\\n&gt; Are there two longs instead of one in order to leave \\\"space\\\" for\u003cbr\\/\u003e\\n&gt; that implementation if needed, w\\/o having to change the file format?\u003c\\/p\u003e\\n\\n\u003cp\u003eRight, I settled on a simplification of that approach.  I write two\u003cbr\\/\u003e\\nlongs so that reader can read both &amp; compare and only trust them if they\u003cbr\\/\u003e\\nare identical.  With one long I was worried eg that perhaps 3 bytes\u003cbr\\/\u003e\\nfrom the writer were written but not yet the remaining 5 bytes, and\u003cbr\\/\u003e\\nthen reader would get the wrong value.  I don\'t think IO systems\u003cbr\\/\u003e\\nguarantee atomicity of eg 8 byte chunks (though in practice it\'s\u003cbr\\/\u003e\\nprobably often the case).\u003c\\/p\u003e\\n\\n\u003cp\u003eOne thing I will also add is a version header to this file.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; The file deleting code does much more than in the past, and that\'s a\u003cbr\\/\u003e\\n&gt; good thing IMO.  For example it looks like leftover non-compound\u003cbr\\/\u003e\\n&gt; segment files from a failed CFS merge (say the JVM dies) will now be\u003cbr\\/\u003e\\n&gt; cleaned up!\u003c\\/p\u003e\\n\\n\u003cp\u003eOh, right!  In fact any time an index crashes not having committed its\u003cbr\\/\u003e\\nsegments file, there is potential for leftover (unreferenced) files\u003cbr\\/\u003e\\nnow.  This separate IndexFileDeleter class should correctly reclaim in\u003cbr\\/\u003e\\nsuch cases.  And even other potential future situations like the\u003cbr\\/\u003e\\ndiscussion in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-702\\\" title=\\\"Disk full during addIndexes(Directory[]) can corrupt index\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-702\\\"\u003e\u003cdel\u003eLUCENE-702\u003c\\/del\u003e\u003c\\/a\u003e would be reclaimed correctly with this\u003cbr\\/\u003e\\napproach.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; I\'m having a hard time figuring out how older delete files are\u003cbr\\/\u003e\\n&gt; removed (since they contain the current segment name, it looks like\u003cbr\\/\u003e\\n&gt; findDeletableFiles would skip them).\u003c\\/p\u003e\\n\\n\u003cp\u003eOooh &#8211; you are correct.  I do record this file for deleting at the\u003cbr\\/\u003e\\npoint it becomes unreferenced (ie, as a reader is committing its\u003cbr\\/\u003e\\nseparate norms\\/deletes), and then I delete this file after the commit\u003cbr\\/\u003e\\nis done.  But if JVM crashes after the new del file was written and\u003cbr\\/\u003e\\nbefore the commit, then you\'re right on restarting I don\'t correctly\u003cbr\\/\u003e\\ndelete the unreferenced old _X_N.del files, nor I believe the separate\u003cbr\\/\u003e\\nnorms _X_N.sM files.  I will add a unit test to verify this bug and\u003cbr\\/\u003e\\nthen fix it &#8211; good catch!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446628_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446628_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 15:19\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T15:19:16+0000\'\u003e02\\/Nov\\/06 15:19\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Good questions! \\n\\n &gt; In the future, it might be nice if there was an option to disable \\n&gt; segments.gen to be more friendly to write-once filesystems like \\n&gt; HDFS. \\n\\n I think this makes sense.  I will add control over this on the next \\niteration of the patch. \\n\\n &gt; As far as performance goes, I was personally interested in the \\n&gt; contentionless case since that\'s what processes that coordinate \\n&gt; everything (like Solr) will see. \\n\\n Ahh got it, OK.  That\'s fair. \\n\\n &gt; I\'m not sure I understand the \\\"segments.gen\\\" logic of writing two \\n&gt; longs that are identical.  Looking at the code, it doesn\'t seem like \\n&gt; you are implementing this: \\n&gt;  http:\\/\\/www.nabble.com\\/Re%3A-Lock-less-commits-p5978090.html  \\n&gt; Are there two longs instead of one in order to leave \\\"space\\\" for \\n&gt; that implementation if needed, w\\/o having to change the file format? \\n\\n Right, I settled on a simplification of that approach.  I write two \\nlongs so that reader can read both &amp; compare and only trust them if they \\nare identical.  With one long I was worried eg that perhaps 3 bytes \\nfrom the writer were written but not yet the remaining 5 bytes, and \\nthen reader would get the wrong value.  I don\'t think IO systems \\nguarantee atomicity of eg 8 byte chunks (though in practice it\'s \\nprobably often the case). \\n\\n One thing I will also add is a version header to this file. \\n\\n &gt; The file deleting code does much more than in the past, and that\'s a \\n&gt; good thing IMO.  For example it looks like leftover non-compound \\n&gt; segment files from a failed CFS merge (say the JVM dies) will now be \\n&gt; cleaned up! \\n\\n Oh, right!  In fact any time an index crashes not having committed its \\nsegments file, there is potential for leftover (unreferenced) files \\nnow.  This separate IndexFileDeleter class should correctly reclaim in \\nsuch cases.  And even other potential future situations like the \\ndiscussion in   LUCENE-702   would be reclaimed correctly with this \\napproach. \\n\\n &gt; I\'m having a hard time figuring out how older delete files are \\n&gt; removed (since they contain the current segment name, it looks like \\n&gt; findDeletableFiles would skip them). \\n\\n Oooh &#8211; you are correct.  I do record this file for deleting at the \\npoint it becomes unreferenced (ie, as a reader is committing its \\nseparate norms\\/deletes), and then I delete this file after the commit \\nis done.  But if JVM crashes after the new del file was written and \\nbefore the commit, then you\'re right on restarting I don\'t correctly \\ndelete the unreferenced old _X_N.del files, nor I believe the separate \\nnorms _X_N.sM files.  I will add a unit test to verify this bug and \\nthen fix it &#8211; good catch!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446638\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446638&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446638\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ningli\\\" id=\\\"commentauthor_12446638_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ningli\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ningli\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ning Li\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446638_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 16:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T16:11:02+0000\'\u003e02\\/Nov\\/06 16:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCan the following scenario happen with lock-less commits?\u003c\\/p\u003e\\n\\n\u003cp\u003e1 A reader reads segments.1, which says the index contains seg_1.\u003cbr\\/\u003e\\n2 A writer writes segments.2, which says the index now contains seg_2, and deletes seg_1.\u003cbr\\/\u003e\\n3 The reader tries to load seg_1 and fails.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ningli\\\" id=\\\"commentauthor_12446638_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ningli\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ningli\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ning Li\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446638_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 16:11\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T16:11:02+0000\'\u003e02\\/Nov\\/06 16:11\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Can the following scenario happen with lock-less commits? \\n\\n 1 A reader reads segments.1, which says the index contains seg_1. \\n2 A writer writes segments.2, which says the index now contains seg_2, and deletes seg_1. \\n3 The reader tries to load seg_1 and fails.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446649\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446649&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446649\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12446649_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446649_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 16:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T16:51:05+0000\'\u003e02\\/Nov\\/06 16:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; 3 The reader tries to load seg_1 and fails. \u003c\\/p\u003e\\n\\n\u003cp\u003eThat wouldn\'t be considered a failure because it\'s part of the retry logic.  At that point, an attempt would be made to open seg_2.\u003cbr\\/\u003e\\nTo minimize the possibility of this happening, the segments are opened in reverse order (since the last segments change the most often).\u003c\\/p\u003e\\n\\n\u003cp\u003eThen a question might be, could a writer possibly change the index fast enough to prevent a reader from opening at all?  I don\'t think so (and it would be a mis-configured writer IMO), but maybe Michael could speak to that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12446649_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446649_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 16:51\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T16:51:05+0000\'\u003e02\\/Nov\\/06 16:51\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; 3 The reader tries to load seg_1 and fails.  \\n\\n That wouldn\'t be considered a failure because it\'s part of the retry logic.  At that point, an attempt would be made to open seg_2. \\nTo minimize the possibility of this happening, the segments are opened in reverse order (since the last segments change the most often). \\n\\n Then a question might be, could a writer possibly change the index fast enough to prevent a reader from opening at all?  I don\'t think so (and it would be a mis-configured writer IMO), but maybe Michael could speak to that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446656\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446656&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446656\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ningli\\\" id=\\\"commentauthor_12446656_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ningli\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ningli\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ning Li\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446656_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 17:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T17:18:24+0000\'\u003e02\\/Nov\\/06 17:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; That wouldn\'t be considered a failure because it\'s part of the retry logic. At that point, an attempt would be made to open seg_2. \u003c\\/p\u003e\\n\\n\u003cp\u003eFrom the description of the retry logic, I thought the retry logic only applies to the loading of the \\\"segments_N\\\" file, but not to the entire process of loading all the files of an index.\u003c\\/p\u003e\\n\\n\u003cp\u003eYou are right, it wouldn\'t be a failure if the retry logic is applied to the loading of all the files of an index.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"ningli\\\" id=\\\"commentauthor_12446656_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=ningli\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"ningli\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Ning Li\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446656_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 17:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T17:18:24+0000\'\u003e02\\/Nov\\/06 17:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; That wouldn\'t be considered a failure because it\'s part of the retry logic. At that point, an attempt would be made to open seg_2.  \\n\\n From the description of the retry logic, I thought the retry logic only applies to the loading of the \\\"segments_N\\\" file, but not to the entire process of loading all the files of an index. \\n\\n You are right, it wouldn\'t be a failure if the retry logic is applied to the loading of all the files of an index.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446665\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446665&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446665\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12446665_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446665_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 17:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T17:41:49+0000\'\u003e02\\/Nov\\/06 17:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; &gt; In the future, it might be nice if there was an option to disable\u003cbr\\/\u003e\\n&gt; &gt; segments.gen to be more friendly to write-once filesystems like\u003cbr\\/\u003e\\n&gt; &gt; HDFS.\u003cbr\\/\u003e\\n&gt; I think this makes sense. I will add control over this on the next\u003cbr\\/\u003e\\n&gt; iteration of the patch. \u003c\\/p\u003e\\n\\n\u003cp\u003eJust to be clear, I didn\'t mean that I thought it was needed now... \u003cbr\\/\u003e\\nthere is another place in Lucene that prevents write-once from working (segment file lengths at the beginning IIRC).\u003c\\/p\u003e\\n\\n\u003cp\u003eWhen this option is added, perhaps the configuration name should be generic and not tied to the implementation specifics that could change more frequently?  Something like WRITE_ONCE or setWriteOnce()?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12446665_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446665_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 17:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T17:41:49+0000\'\u003e02\\/Nov\\/06 17:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; &gt; In the future, it might be nice if there was an option to disable \\n&gt; &gt; segments.gen to be more friendly to write-once filesystems like \\n&gt; &gt; HDFS. \\n&gt; I think this makes sense. I will add control over this on the next \\n&gt; iteration of the patch.  \\n\\n Just to be clear, I didn\'t mean that I thought it was needed now...  \\nthere is another place in Lucene that prevents write-once from working (segment file lengths at the beginning IIRC). \\n\\n When this option is added, perhaps the configuration name should be generic and not tied to the implementation specifics that could change more frequently?  Something like WRITE_ONCE or setWriteOnce()?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446677\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446677&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446677\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446677_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446677_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 18:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T18:13:49+0000\'\u003e02\\/Nov\\/06 18:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\\n\u003cp\u003eRight, this is just normal contention.  We do indeed retry around not\u003cbr\\/\u003e\\nonly loading of segments_N but also the loading of the individual\u003cbr\\/\u003e\\nsegments files.  There are other places (eg lastModified()) that do\u003cbr\\/\u003e\\nother things with the segments file.  These places also use the retry\u003cbr\\/\u003e\\nlogic.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn Lucene currently, contention causes a pause (default 1.0 second)\u003cbr\\/\u003e\\nand then retry to obtain the commit lock.  With lockless, we simply\u003cbr\\/\u003e\\nretry immediately loading the latest segments_N file.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt\'s important to note that at any given instant, the index is always\u003cbr\\/\u003e\\n\\\"consistent\\\" (well, except for issues like \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-702\\\" title=\\\"Disk full during addIndexes(Directory[]) can corrupt index\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-702\\\"\u003e\u003cdel\u003eLUCENE-702\u003c\\/del\u003e\u003c\\/a\u003e ).\u003c\\/p\u003e\\n\\n\u003cp\u003eBut, because a reader takes non-zero time to load the index, you can\u003cbr\\/\u003e\\nhit contention if a writer\'s commit spans that time.  If a reader\u003cbr\\/\u003e\\ncould load an index in zero time there would never be contention.\u003c\\/p\u003e\\n\\n\u003cp\u003eThere are several ways that contention will manifest itself.  These\u003cbr\\/\u003e\\nare just the different alignments \\/ convolutions of the series of\u003cbr\\/\u003e\\nsteps that reader goes through \\\"sliding against\\\" the series of steps\u003cbr\\/\u003e\\nthat a writer goes through:\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eReader opens the segments_N but in reading it hits EOF because\u003cbr\\/\u003e\\n    writer has not finished writing it yet.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eReader opens segments_N, fully reads its contents, but then hits\u003cbr\\/\u003e\\n    IOException on loading each segment file because during this team\u003cbr\\/\u003e\\n    writer has committed and is now deleting segments files.  This\u003cbr\\/\u003e\\n    case is your example above.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eReader opens segments_N, but hits IOException while reading its\u003cbr\\/\u003e\\n    contents because it was deleted by writer before reader could read\u003cbr\\/\u003e\\n    all of its contents (should only happen on fileystems that don\'t\u003cbr\\/\u003e\\n    do \\\"delete on last close\\\" or \\\"can\'t delete open files\\\").\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eReader takes listing of directory, locates segments_N, but fails\u003cbr\\/\u003e\\n    to open that file because writer has now removed it.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eAnyway, on hitting an IOException, we first retry segments_N-1 (if it\u003cbr\\/\u003e\\nexists).  Failing that we recheck the directory for latest segments_N.\u003cbr\\/\u003e\\nIf N has advanced we try that.  If N has not advanced we give it one\u003cbr\\/\u003e\\nmore chance to load (since it could be on first try we hit case 1\u003cbr\\/\u003e\\nabove).  If it fails that second chance and on re-listing we are still\u003cbr\\/\u003e\\nat N, we throw the original exception we hit.\u003c\\/p\u003e\\n\\n\u003cp\u003eI added a couple of tests cases to TestIndexWriter to verify that a\u003cbr\\/\u003e\\nmessed up index indeed throws an IOException.\u003c\\/p\u003e\\n\\n\u003cp\u003eOn Yonik\'s question:\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; Then a question might be, could a writer possibly change the index\u003cbr\\/\u003e\\n&gt; fast enough to prevent a reader from opening at all?  I don\'t think\u003cbr\\/\u003e\\n&gt; so (and it would be a mis-configured writer IMO), but maybe Michael\u003cbr\\/\u003e\\n&gt; could speak to that.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis is definitely possible.  This really is a form of \\\"starvation\\\".\u003cbr\\/\u003e\\nIf a writer is committing too fast, or, readers are constantly\u003cbr\\/\u003e\\nre-opening too fast, they will starve one another.\u003c\\/p\u003e\\n\\n\u003cp\u003eBoth current Lucene and lockless will hit starvation under high enough\u003cbr\\/\u003e\\nrate of commit\\/opens, but, different things happen.  EG \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/LUCENE-307\\\" title=\\\"Lock obtain time out errors when opening readers and writers\\\" class=\\\"issue-link\\\" data-issue-key=\\\"LUCENE-307\\\"\u003e\u003cdel\u003eLUCENE-307\u003c\\/del\u003e\u003c\\/a\u003e\u003cbr\\/\u003e\\nissue is exactly this case on the current Lucene.  Lockless will retry\u003cbr\\/\u003e\\nindefinitely though may at some point succeed (but take many\u003cbr\\/\u003e\\nretries to do so).\u003c\\/p\u003e\\n\\n\u003cp\u003eStill, I think the point at which starvation starts to happen is far\u003cbr\\/\u003e\\nbeyond a normal usage of Lucene (ie, committing &gt; ten times \\/ sec).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446677_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446677_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 18:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T18:13:49+0000\'\u003e02\\/Nov\\/06 18:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                   \\n Right, this is just normal contention.  We do indeed retry around not \\nonly loading of segments_N but also the loading of the individual \\nsegments files.  There are other places (eg lastModified()) that do \\nother things with the segments file.  These places also use the retry \\nlogic. \\n\\n In Lucene currently, contention causes a pause (default 1.0 second) \\nand then retry to obtain the commit lock.  With lockless, we simply \\nretry immediately loading the latest segments_N file. \\n\\n It\'s important to note that at any given instant, the index is always \\n\\\"consistent\\\" (well, except for issues like   LUCENE-702   ). \\n\\n But, because a reader takes non-zero time to load the index, you can \\nhit contention if a writer\'s commit spans that time.  If a reader \\ncould load an index in zero time there would never be contention. \\n\\n There are several ways that contention will manifest itself.  These \\nare just the different alignments \\/ convolutions of the series of \\nsteps that reader goes through \\\"sliding against\\\" the series of steps \\nthat a writer goes through: \\n\\n \\n\\t Reader opens the segments_N but in reading it hits EOF because \\n    writer has not finished writing it yet. \\n \\n\\n\\n \\n\\t Reader opens segments_N, fully reads its contents, but then hits \\n    IOException on loading each segment file because during this team \\n    writer has committed and is now deleting segments files.  This \\n    case is your example above. \\n \\n\\n\\n \\n\\t Reader opens segments_N, but hits IOException while reading its \\n    contents because it was deleted by writer before reader could read \\n    all of its contents (should only happen on fileystems that don\'t \\n    do \\\"delete on last close\\\" or \\\"can\'t delete open files\\\"). \\n \\n\\n\\n \\n\\t Reader takes listing of directory, locates segments_N, but fails \\n    to open that file because writer has now removed it. \\n \\n\\n\\n Anyway, on hitting an IOException, we first retry segments_N-1 (if it \\nexists).  Failing that we recheck the directory for latest segments_N. \\nIf N has advanced we try that.  If N has not advanced we give it one \\nmore chance to load (since it could be on first try we hit case 1 \\nabove).  If it fails that second chance and on re-listing we are still \\nat N, we throw the original exception we hit. \\n\\n I added a couple of tests cases to TestIndexWriter to verify that a \\nmessed up index indeed throws an IOException. \\n\\n On Yonik\'s question: \\n\\n &gt; Then a question might be, could a writer possibly change the index \\n&gt; fast enough to prevent a reader from opening at all?  I don\'t think \\n&gt; so (and it would be a mis-configured writer IMO), but maybe Michael \\n&gt; could speak to that. \\n\\n This is definitely possible.  This really is a form of \\\"starvation\\\". \\nIf a writer is committing too fast, or, readers are constantly \\nre-opening too fast, they will starve one another. \\n\\n Both current Lucene and lockless will hit starvation under high enough \\nrate of commit\\/opens, but, different things happen.  EG   LUCENE-307   \\nissue is exactly this case on the current Lucene.  Lockless will retry \\nindefinitely though may at some point succeed (but take many \\nretries to do so). \\n\\n Still, I think the point at which starvation starts to happen is far \\nbeyond a normal usage of Lucene (ie, committing &gt; ten times \\/ sec).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12446678\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12446678&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12446678\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446678_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446678_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 18:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T18:18:11+0000\'\u003e02\\/Nov\\/06 18:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; &gt; In the future, it might be nice if there was an option to disable\u003cbr\\/\u003e\\n&gt; &gt; segments.gen to be more friendly to write-once filesystems like\u003cbr\\/\u003e\\n&gt; &gt; HDFS.\u003cbr\\/\u003e\\n&gt; I think this makes sense. I will add control over this on the next\u003cbr\\/\u003e\\n&gt; iteration of the patch.\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; Just to be clear, I didn\'t mean that I thought it was needed now...\u003cbr\\/\u003e\\n&gt; there is another place in Lucene that prevents write-once from\u003cbr\\/\u003e\\n&gt; working (segment file lengths at the beginning IIRC).\u003c\\/p\u003e\\n\\n\u003cp\u003e&gt; When this option is added, perhaps the configuration name should be\u003cbr\\/\u003e\\n&gt; generic and not tied to the implementation specifics that could change\u003cbr\\/\u003e\\n&gt; more frequently? Something like WRITE_ONCE or setWriteOnce()?\u003c\\/p\u003e\\n\\n\u003cp\u003eOK, I see, this is part of a wider context.  Maybe it\'s the creation\u003cbr\\/\u003e\\nof the compound file you\'re thinking of?  That writes 0\'s into the\u003cbr\\/\u003e\\nheader, adds the files, then rewinds and puts the actual offsets into\u003cbr\\/\u003e\\nit.  Then let\'s open a separate issue to track this &#8211; I\'ll do that.\u003cbr\\/\u003e\\nDon\'t want to make this patch any bigger!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12446678_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12446678_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Nov\\/06 18:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-02T18:18:11+0000\'\u003e02\\/Nov\\/06 18:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; &gt; In the future, it might be nice if there was an option to disable \\n&gt; &gt; segments.gen to be more friendly to write-once filesystems like \\n&gt; &gt; HDFS. \\n&gt; I think this makes sense. I will add control over this on the next \\n&gt; iteration of the patch. \\n\\n &gt; Just to be clear, I didn\'t mean that I thought it was needed now... \\n&gt; there is another place in Lucene that prevents write-once from \\n&gt; working (segment file lengths at the beginning IIRC). \\n\\n &gt; When this option is added, perhaps the configuration name should be \\n&gt; generic and not tied to the implementation specifics that could change \\n&gt; more frequently? Something like WRITE_ONCE or setWriteOnce()? \\n\\n OK, I see, this is part of a wider context.  Maybe it\'s the creation \\nof the compound file you\'re thinking of?  That writes 0\'s into the \\nheader, adds the files, then rewinds and puts the actual offsets into \\nit.  Then let\'s open a separate issue to track this &#8211; I\'ll do that. \\nDon\'t want to make this patch any bigger!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12447508\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12447508&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12447508\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12447508_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12447508_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Nov\\/06 19:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-06T19:26:45+0000\'\u003e06\\/Nov\\/06 19:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOK, another version of the lockless commits patch with these fixes:\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eAdded new unit test (TestIndexFileDeleter) for deleter, caught the\u003cbr\\/\u003e\\n    above bug Yonik found (we can fail to delete orphan\'d separate\u003cbr\\/\u003e\\n    del\\/norm files), fixed it, and unit test now passes.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eWe were also failing to deleted orphan\'d .fN files (norm files\u003cbr\\/\u003e\\n    that do get included into CFS file).  Fixed that case too.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eAdded version header to segments.gen file.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eAdded static setter\\/getters for advanced configuration of the\u003cbr\\/\u003e\\n    retry logic.  Note: this required making the SegmentInfos class\u003cbr\\/\u003e\\n    public.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eYou still need to put those two zip files into\u003cbr\\/\u003e\\nsrc\\/test\\/org\\/apache\\/lucene\\/index after applying this patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis addresses all feedback\\/TODOs that I knew about.\u003c\\/p\u003e\\n\\n\u003cp\u003eAll unit tests pass.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12447508_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12447508_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Nov\\/06 19:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-06T19:26:45+0000\'\u003e06\\/Nov\\/06 19:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    OK, another version of the lockless commits patch with these fixes: \\n\\n \\n\\t Added new unit test (TestIndexFileDeleter) for deleter, caught the \\n    above bug Yonik found (we can fail to delete orphan\'d separate \\n    del\\/norm files), fixed it, and unit test now passes. \\n \\n\\n\\n \\n\\t We were also failing to deleted orphan\'d .fN files (norm files \\n    that do get included into CFS file).  Fixed that case too. \\n \\n\\n\\n \\n\\t Added version header to segments.gen file. \\n \\n\\n\\n \\n\\t Added static setter\\/getters for advanced configuration of the \\n    retry logic.  Note: this required making the SegmentInfos class \\n    public. \\n \\n\\n\\n You still need to put those two zip files into \\nsrc\\/test\\/org\\/apache\\/lucene\\/index after applying this patch. \\n\\n This addresses all feedback\\/TODOs that I knew about. \\n\\n All unit tests pass.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12447574\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12447574&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12447574\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12447574_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12447574_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Nov\\/06 22:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-06T22:59:57+0000\'\u003e06\\/Nov\\/06 22:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLooks good Michael, I think this is ready to commit!\u003cbr\\/\u003e\\nDoes anyone have any concerns with this going into the trunk?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"yseeley@gmail.com\\\" id=\\\"commentauthor_12447574_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=yseeley%40gmail.com\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"yseeley@gmail.com\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Yonik Seeley\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12447574_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Nov\\/06 22:59\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-06T22:59:57+0000\'\u003e06\\/Nov\\/06 22:59\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Looks good Michael, I think this is ready to commit! \\nDoes anyone have any concerns with this going into the trunk?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12447601\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12447601&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12447601\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"steven_parkes\\\" id=\\\"commentauthor_12447601_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=steven_parkes\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"steven_parkes\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Steven Parkes\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12447601_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Nov\\/06 01:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-07T01:12:14+0000\'\u003e07\\/Nov\\/06 01:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI\'m all for the patch ... the only thing I\'m wondering is about release timing, if that\'s issue? This changes the on-disk format, which affects more than Lucene Java and, should anyone that\'s using Lucene out there care (via scripts, etc.), the naming of files on disk.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m just wondering if there\'s any interest\\/reason for doing a 2.1 before something with those side effects?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"steven_parkes\\\" id=\\\"commentauthor_12447601_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=steven_parkes\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"steven_parkes\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Steven Parkes\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12447601_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Nov\\/06 01:12\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-07T01:12:14+0000\'\u003e07\\/Nov\\/06 01:12\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I\'m all for the patch ... the only thing I\'m wondering is about release timing, if that\'s issue? This changes the on-disk format, which affects more than Lucene Java and, should anyone that\'s using Lucene out there care (via scripts, etc.), the naming of files on disk. \\n\\n I\'m just wondering if there\'s any interest\\/reason for doing a 2.1 before something with those side effects?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12448892\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12448892&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12448892\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12448892_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12448892_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Nov\\/06 23:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-10T23:25:24+0000\'\u003e10\\/Nov\\/06 23:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSteven - I don\'t see any issues with this going in before 2.1.  As a matter of fact, this may be a sufficiently substantial change that will make us want to make a 2.1 release.\u003c\\/p\u003e\\n\\n\u003cp\u003eMaybe Michael should commit this next week.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"otis\\\" id=\\\"commentauthor_12448892_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=otis\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"otis\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Otis Gospodnetic\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12448892_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'10\\/Nov\\/06 23:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-10T23:25:24+0000\'\u003e10\\/Nov\\/06 23:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Steven - I don\'t see any issues with this going in before 2.1.  As a matter of fact, this may be a sufficiently substantial change that will make us want to make a 2.1 release. \\n\\n Maybe Michael should commit this next week.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12448902\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12448902&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12448902\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12448902_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12448902_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Nov\\/06 00:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-11T00:13:35+0000\'\u003e11\\/Nov\\/06 00:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eOooh &#8211; I would love to!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12448902_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12448902_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Nov\\/06 00:13\'\u003e\u003ctime class=\'livestamp\' datetime=\'2006-11-11T00:13:35+0000\'\u003e11\\/Nov\\/06 00:13\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Oooh &#8211; I would love to!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12476269\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/LUCENE-701?focusedCommentId=12476269&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12476269\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12476269_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12476269_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/07 18:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-02-27T18:10:35+0000\'\u003e27\\/Feb\\/07 18:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eClosing all issues that were resolved for 2.1.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikemccand\\\" id=\\\"commentauthor_12476269_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikemccand\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikemccand\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Michael McCandless\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12476269_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'27\\/Feb\\/07 18:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2007-02-27T18:10:35+0000\'\u003e27\\/Feb\\/07 18:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Closing all issues that were resolved for 2.1.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310110";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310110&amp;avatarId=10061\\\" alt=\\\"Lucene - Core\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/LUCENE\\/summary\\\" title=\\\"Lucene - Core\\\"\u003eLucene - Core\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/LUCENE?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/-juyfor/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1516201987010"> 
    <input type="hidden" title="jira.request.server.time" value="535"> 
    <input type="hidden" title="jira.request.id" value="913x7655432x4"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="4"> 
    <input type="hidden" title="db.reads.time.in.ms" value="57"> 
    <input type="hidden" title="db.conns.time.in.ms" value="67"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 913x7655432x4
	          REQUEST TIMESTAMP : [17/Jan/2018:15:13:07 +0000]
	               REQUEST TIME : 0.5350
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 4

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=25, elapsedTotal=57891161, elapsedMin=686329, elapsedMax=32820906, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=29, elapsedTotal=67378244, elapsedMin=762951, elapsedMax=32917741, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
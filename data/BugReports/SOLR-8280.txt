<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|7d89d618572578679eb95d1547bc5e4ba95d600b|lout"> 
  <link rel="shortcut icon" href="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"jira.instrumentation.laas\":false,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"com.atlassian.jira.issuetable.draggable\":true,\"jira.create.linked.issue\":true,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"jira.jql.suggestrecentfields\":false,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"jira.jql.smartautoselectfirst\":false,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.priorities.per.project\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"jira.renderer.consider.variable.format\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/vnd.wap.wbmp,image/png,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"f7eb37a1804117\"";
WRM._unparsedData["project-id"]="12310230";
WRM._unparsedData["project-key"]="\"SOLR\"";
WRM._unparsedData["project-name"]="\"Solr\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="12310230";
WRM._unparsedData["projectKey"]="\"SOLR\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/74ac580603ca910fff0cfdf319e54add-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/98ceb006e504d7924d5ffc411626c6bc-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/c1e4d26ea276469807c3dc0918df482c-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/6bf9253c8d533109c3b02e26794be24e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/ccd2e67b523185973473e8bd5735c8f9-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/33e5e0166867c8c9228d44506f60b2e8/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/6579b6b8ba67abaa496e39b9242a18a4-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="SOLR-8280"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[SOLR-8280] Schemaless features don't work reliably with SolrCoreAware sim factory -- example: SchemaSimilarityFactory - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[SOLR-8280] Schemaless features don't work reliably with SolrCoreAware sim factory -- example: SchemaSimilarityFactory - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/SOLR" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FSOLR-8280">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="12310230" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Solr'" src="https://issues.apache.org/jira/secure/projectavatar?pid=12310230&amp;avatarId=22151"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/SOLR">Solr</a></li>
                 <li><a class="issue-link" data-issue-key="SOLR-8280" href="/jira/browse/SOLR-8280" id="key-val" rel="12912355">SOLR-8280</a></li>
                </ol>
                <h1 id="summary-val">Schemaless features don't work reliably with SolrCoreAware sim factory -- example: SchemaSimilarityFactory</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FSOLR-8280"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/SOLR-8280/SOLR-8280.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/SOLR-8280/SOLR-8280.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/SOLR-8280/SOLR-8280.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/SOLR-8280/SOLR-8280.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" title="Bug - A problem which impairs or prevents the functions of the product." width="16"> Bug </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="5.0 First 5.x release, Major release after 4.10">5.0</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+SOLR+AND+fixVersion+%3D+5.4" title="5.4 Major release after 5.3">5.4</a>, <a href="/jira/issues/?jql=project+%3D+SOLR+AND+fixVersion+%3D+6.0" title="6.0 First 6.x release, Major release after 5.5">6.0</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> None </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12912355-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p><a href="https://issues.apache.org/jira/browse/SOLR-8271" title="use SchemaSimilarityFactory as default when no explicit (top level) sim is configured" class="issue-link" data-issue-key="SOLR-8271"><del>SOLR-8271</del></a> uncovered problems with using SchemaSimilarityFactory + schemaless features. While the broader problems of SolrCoreAware objects inited after the SolrCore was live have been spun off into <a href="https://issues.apache.org/jira/browse/SOLR-8311" title="SolrCoreAware and ResourceLoaderAware lifecyel is fragile - particularly with objects that can be created after SolrCore is live" class="issue-link" data-issue-key="SOLR-8311">SOLR-8311</a> this issue focuses on fixing &amp; testing the core problem of ensuring SchemaSimilarityFactory + schemaless features function together.</p> 
                  <div class="panel" style="border-width: 1px;">
                   <div class="panelHeader" style="border-bottom-width: 1px;">
                    <b>original bug report</b>
                   </div>
                   <div class="panelContent"> 
                    <p>Something about the code path(s) involved in TestCloudSchemaless &amp; ChangedSchemaMergeTest don't play nicely with a SimilarityFactory that is SolrCoreAware – notably: SchemaSimilarityFactory.</p> 
                    <p>I discovered this while trying to implement <a href="https://issues.apache.org/jira/browse/SOLR-8271" title="use SchemaSimilarityFactory as default when no explicit (top level) sim is configured" class="issue-link" data-issue-key="SOLR-8271"><del>SOLR-8271</del></a>, but it can be reproduced trivially by modifying the schema-add-schema-fields-update-processor.xml file used by TestCloudSchemaless (and hardcoded in java schema used by ChangedSchemaMergeTest) to refer to SchemaSimilarityFactory explicitly. Other cloud tests (such as CollectionReloadTest) or cloud+schemaless (ex: TestCloudManagedSchema) tests don't seem to demonstrate the same problem.</p> 
                   </div>
                  </div> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/SOLR-8280?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/SOLR-8280?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/SOLR-8280?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/SOLR-8280?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12772434" data-issue-id="12912355" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12772434/SOLR-8280__broken__resource_loader_experiment.patch" draggable="true" data-downloadurl="text/x-patch:SOLR-8280__broken__resource_loader_experiment.patch:https://issues.apache.org/jira/secure/attachment/12772434/SOLR-8280__broken__resource_loader_experiment.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12772434/SOLR-8280__broken__resource_loader_experiment.patch" title="Latest  16/Nov/15 02:07 - Hoss Man" draggable="true" data-downloadurl="text/x-patch:SOLR-8280__broken__resource_loader_experiment.patch:https://issues.apache.org/jira/secure/attachment/12772434/SOLR-8280__broken__resource_loader_experiment.patch">SOLR-8280__broken__resource_loader_experiment.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-11-16T02:07:14.096Z">16/Nov/15 02:07</time>
                   </dd>
                   <dd class="attachment-size">
                    10 kB
                   </dd>
                   <dd class="attachment-author">
                    Hoss Man
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12773120" data-issue-id="12912355" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12773120/SOLR-8280.patch" draggable="true" data-downloadurl="text/x-patch:SOLR-8280.patch:https://issues.apache.org/jira/secure/attachment/12773120/SOLR-8280.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12773120/SOLR-8280.patch" title="Latest  18/Nov/15 23:32 - Hoss Man" draggable="true" data-downloadurl="text/x-patch:SOLR-8280.patch:https://issues.apache.org/jira/secure/attachment/12773120/SOLR-8280.patch">SOLR-8280.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-11-18T23:32:49.986Z">18/Nov/15 23:32</time>
                   </dd>
                   <dd class="attachment-size">
                    15 kB
                   </dd>
                   <dd class="attachment-author">
                    Hoss Man
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12772877" data-issue-id="12912355" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12772877/SOLR-8280.patch" draggable="true" data-downloadurl="text/x-patch:SOLR-8280.patch:https://issues.apache.org/jira/secure/attachment/12772877/SOLR-8280.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12772877/SOLR-8280.patch" title=" 18/Nov/15 00:18 - Hoss Man" draggable="true" data-downloadurl="text/x-patch:SOLR-8280.patch:https://issues.apache.org/jira/secure/attachment/12772877/SOLR-8280.patch">SOLR-8280.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-11-18T00:18:24.522Z">18/Nov/15 00:18</time>
                   </dd>
                   <dd class="attachment-size">
                    7 kB
                   </dd>
                   <dd class="attachment-author">
                    Hoss Man
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12771884" data-issue-id="12912355" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12771884/SOLR-8280.patch" draggable="true" data-downloadurl="text/x-patch:SOLR-8280.patch:https://issues.apache.org/jira/secure/attachment/12771884/SOLR-8280.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12771884/SOLR-8280.patch" title=" 12/Nov/15 01:14 - Hoss Man" draggable="true" data-downloadurl="text/x-patch:SOLR-8280.patch:https://issues.apache.org/jira/secure/attachment/12771884/SOLR-8280.patch">SOLR-8280.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-11-12T01:14:18.464Z">12/Nov/15 01:14</time>
                   </dd>
                   <dd class="attachment-size">
                    2 kB
                   </dd>
                   <dd class="attachment-author">
                    Hoss Man
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12771877" data-issue-id="12912355" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12771877/SOLR-8280.patch" draggable="true" data-downloadurl="text/x-patch:SOLR-8280.patch:https://issues.apache.org/jira/secure/attachment/12771877/SOLR-8280.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12771877/SOLR-8280.patch" title=" 12/Nov/15 00:35 - Hoss Man" draggable="true" data-downloadurl="text/x-patch:SOLR-8280.patch:https://issues.apache.org/jira/secure/attachment/12771877/SOLR-8280.patch">SOLR-8280.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2015-11-12T00:35:37.059Z">12/Nov/15 00:35</time>
                   </dd>
                   <dd class="attachment-size">
                    1 kB
                   </dd>
                   <dd class="attachment-author">
                    Hoss Man
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="blocks">
                   blocks
                  </dt> 
                  <dd id="internal-12911905_10032"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" width="16" height="16" title="Improvement - An improvement or enhancement to an existing feature or task." alt="Improvement - An improvement or enhancement to an existing feature or task."> <span title="SOLR-8271: use SchemaSimilarityFactory as default when no explicit (top level) sim is configured"> <a href="/jira/browse/SOLR-8271" data-issue-key="SOLR-8271" class="issue-link link-title resolution">SOLR-8271</a> <span class="link-summary">use SchemaSimilarityFactory as default when no explicit (top level) sim is configured</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Resolved</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.</span>">Resolved</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                 <dl class="links-list "> 
                  <dt title="is related to">
                   is related to
                  </dt> 
                  <dd id="internal-12914188_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" width="16" height="16" title="Bug - A problem which impairs or prevents the functions of the product." alt="Bug - A problem which impairs or prevents the functions of the product."> <span title="SOLR-8311: SolrCoreAware and ResourceLoaderAware lifecyel is fragile - particularly with objects that can be created after SolrCore is live"> <a href="/jira/browse/SOLR-8311" data-issue-key="SOLR-8311" class="issue-link link-title">SOLR-8311</a> <span class="link-summary">SolrCoreAware and ResourceLoaderAware lifecyel is fragile - particularly with objects that can be created after SolrCore is live</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-blue-gray jira-issue-status-lozenge-new aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Open</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is open and ready for the assignee to start work on it.</span>">Open</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_hossman" rel="hossman" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Hoss Man&quot;,&quot;emailAddress&quot;:&quot;hossman_apachejira@fucit.org&quot;,&quot;username&quot;:&quot;hossman&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="hossman"></span></span> Hoss Man </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_hossman" rel="hossman" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Hoss Man&quot;,&quot;emailAddress&quot;:&quot;hossman_apachejira@fucit.org&quot;,&quot;username&quot;:&quot;hossman&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="hossman"></span></span> Hoss Man </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">4</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="12/Nov/15 00:33"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2015-11-12T00:33:32+0000">12/Nov/15 00:33</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="09/May/16 18:49"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2016-05-09T18:49:30+0000">09/May/16 18:49</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="19/Nov/15 18:03"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2015-11-19T18:03:10+0000">19/Nov/15 18:03</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-8280?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-8280?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-8280?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-8280?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-8280?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-8280?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-8280?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-8280?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/SOLR-8280?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/SOLR-8280?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/SOLR-8280?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/SOLR-8280?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-15001410\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-8280?focusedCommentId=15001410&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15001410\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_15001410_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15001410_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 00:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T00:35:37+0000\'\u003e12\\/Nov\\/15 00:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\\n\u003cp\u003eWith the attached patch, it\'s trivial to trigger a suite failure in TestCloudSchemaless, although lots of other cloud related tests (using schema.xml via AbstractFullDistribZkTestBase) function just fine.\u003c\\/p\u003e\\n\\n\u003cp\u003e(NOTE: there are in fact a handful of other test failures with this patch, but they exist due to specific Sim related assumptions in those tests vs the general change of schema.xml to using SchemaSimilarityFactory ... i included the change to schema.xml in this patch purely as an easy way to demonstrate that most cloud related tests &#8211; even ones using schemaless and\\/or involving core reloads &#8211; don\'t ffreak out the same way as TestCloudSchemaless)\u003c\\/p\u003e\\n\\n\u003chr \\/\u003e\\n\\n\u003cp\u003eQuick walk through of the TestCloudSchemaless failure...\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003eant test  -Dtestcase=TestCloudSchemaless -Dtests.seed=8F1B744FBE000231 -Dtests.slow=true\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003eThe test itself runs fine, and reaches the \u003ctt\u003eSolrTestCaseJ4 ###Ending test\\\" stage\u003c\\/tt\u003e at which point shutdown begins &#8211; and eventually stalls in the dir factory waiting for directories to close...\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e   [junit4]   2&gt; 52621 INFO  (TEST-TestCloudSchemaless.test-seed#[E3CE46BC04E096EF]) [n:127.0.0.1:35554_ c:collection1 s:shard2 r:core_node1 x:collection1] o.a.s.c.SolrCore [collection1] Closing main searcher on request.\\n   [junit4]   2&gt; 52621 INFO  (TEST-TestCloudSchemaless.test-seed#[E3CE46BC04E096EF]) [n:127.0.0.1:35554_ c:collection1 s:shard2 r:core_node1 x:collection1] o.a.s.c.CachingDirectoryFactory Closing NRTCachingDirectoryFactory - 2 directories currently being tracked\\n   [junit4]   2&gt; 64733 ERROR (TEST-TestCloudSchemaless.test-seed#[E3CE46BC04E096EF]) [n:127.0.0.1:35554_ c:collection1 s:shard2 r:core_node1 x:collection1] o.a.s.c.CachingDirectoryFactory Timeout waiting for all directory ref counts to be released - gave up waiting on CachedDir&lt;&lt;refCount=1;path=\\/home\\/hossman\\/lucene\\/dev\\/solr\\/build\\/solr-core\\/test\\/J0\\/temp\\/solr.schema.TestCloudSchemaless_E3CE46BC04E096EF-001\\/shard-1-001\\/cores\\/collection1\\/data\\/index;done=false&gt;&gt;\\n   [junit4]   2&gt; 64733 ERROR (TEST-TestCloudSchemaless.test-seed#[E3CE46BC04E096EF]) [n:127.0.0.1:35554_ c:collection1 s:shard2 r:core_node1 x:collection1] o.a.s.c.CachingDirectoryFactory Error closing directory:org.apache.solr.common.SolrException: Timeout waiting for all directory ref counts to be released - gave up waiting on CachedDir&lt;&lt;refCount=1;path=\\/home\\/hossman\\/lucene\\/dev\\/solr\\/build\\/solr-core\\/test\\/J0\\/temp\\/solr.schema.TestCloudSchemaless_E3CE46BC04E096EF-001\\/shard-1-001\\/cores\\/collection1\\/data\\/index;done=false&gt;&gt;\\n   [junit4]   2&gt; \\tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:187)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCore.close(SolrCore.java:1268)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCores.close(SolrCores.java:124)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.CoreContainer.shutdown(CoreContainer.java:570)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.destroy(SolrDispatchFilter.java:172)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.ChaosMonkey.stopJettySolrRunner(ChaosMonkey.java:186)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.ChaosMonkey.stop(ChaosMonkey.java:518)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.AbstractFullDistribZkTestBase.destroyServers(AbstractFullDistribZkTestBase.java:1514)\\n   [junit4]   2&gt; \\tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsFixedStatement.callStatement(BaseDistributedSearchTestCase.java:964)\\n   [junit4]   2&gt; \\tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsStatement.evaluate(BaseDistributedSearchTestCase.java:938)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesRestoreRule$1.evaluate(SystemPropertiesRestoreRule.java:57)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleSetupTeardownChained$1.evaluate(TestRuleSetupTeardownChained.java:50)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:46)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleThreadAndTestName$1.evaluate(TestRuleThreadAndTestName.java:49)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:65)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl.forkTimeoutingTask(ThreadLeakControl.java:809)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$3.evaluate(ThreadLeakControl.java:460)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner.runSingleTest(RandomizedRunner.java:875)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$5.evaluate(RandomizedRunner.java:777)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$6.evaluate(RandomizedRunner.java:811)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$7.evaluate(RandomizedRunner.java:822)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesRestoreRule$1.evaluate(SystemPropertiesRestoreRule.java:57)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:46)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:42)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:54)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:65)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:55)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\\n   [junit4]   2&gt; \\tat java.lang.Thread.run(Thread.java:745)\\n   [junit4]   2&gt; \\n   [junit4]   2&gt; 64733 ERROR (TEST-TestCloudSchemaless.test-seed#[E3CE46BC04E096EF]) [n:127.0.0.1:35554_ c:collection1 s:shard2 r:core_node1 x:collection1] o.a.s.c.SolrCore java.lang.AssertionError: 1\\n   [junit4]   2&gt; \\tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:201)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCore.close(SolrCore.java:1268)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCores.close(SolrCores.java:124)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.CoreContainer.shutdown(CoreContainer.java:570)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.destroy(SolrDispatchFilter.java:172)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.ChaosMonkey.stopJettySolrRunner(ChaosMonkey.java:186)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.ChaosMonkey.stop(ChaosMonkey.java:518)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.AbstractFullDistribZkTestBase.destroyServers(AbstractFullDistribZkTestBase.java:1514)\\n   [junit4]   2&gt; \\tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsFixedStatement.callStatement(BaseDistributedSearchTestCase.java:964)\\n   [junit4]   2&gt; \\tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsStatement.evaluate(BaseDistributedSearchTestCase.java:938)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesRestoreRule$1.evaluate(SystemPropertiesRestoreRule.java:57)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleSetupTeardownChained$1.evaluate(TestRuleSetupTeardownChained.java:50)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:46)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleThreadAndTestName$1.evaluate(TestRuleThreadAndTestName.java:49)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:65)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl.forkTimeoutingTask(ThreadLeakControl.java:809)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$3.evaluate(ThreadLeakControl.java:460)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner.runSingleTest(RandomizedRunner.java:875)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$5.evaluate(RandomizedRunner.java:777)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$6.evaluate(RandomizedRunner.java:811)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$7.evaluate(RandomizedRunner.java:822)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesRestoreRule$1.evaluate(SystemPropertiesRestoreRule.java:57)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:46)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:42)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:54)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:65)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:55)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\\n   [junit4]   2&gt; \\tat java.lang.Thread.run(Thread.java:745)\\n   [junit4]   2&gt; \\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\\n\u003cp\u003e...at that point, things go from bad to worse, as RecoveryThreads kick in (why is the collection attempting to recover it it was deliberaly being shutdown???) but of course that doesn\'t turn out well because the CoreContainer\'s are all in shutdown mode...\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e   [junit4]   2&gt; 69727 INFO  (qtp1007998027-153) [n:127.0.0.1:44195_    ] o.a.s.h.a.CoreAdminHandler Going to wait for coreNodeName: core_node8, state: recovering, checkLive: true, onlyIfLeader: true, onlyIfLeaderActive: true\\n   [junit4]   2&gt; 69727 INFO  (zkCallback-44-thread-2-processing-n:127.0.0.1:42678_) [n:127.0.0.1:42678_    ] o.a.s.c.c.ZkStateReader Updating data for collection1 from 29 to 30 \\n   [junit4]   2&gt; 69728 INFO  (zkCallback-39-thread-2-processing-n:127.0.0.1:52349_) [n:127.0.0.1:52349_    ] o.a.s.c.c.ZkStateReader Updating data for collection1 from 29 to 30 \\n   [junit4]   2&gt; 69728 INFO  (qtp1007998027-153) [n:127.0.0.1:44195_    ] o.a.s.h.a.CoreAdminHandler Will wait a max of 183 seconds to see collection1 (shard1 of collection1) have state: recovering\\n   [junit4]   2&gt; 69728 INFO  (qtp1007998027-153) [n:127.0.0.1:44195_    ] o.a.s.h.a.CoreAdminHandler In WaitForState(recovering): collection=collection1, shard=shard1, thisCore=collection1, leaderDoesNotNeedRecovery=false, isLeader? true, live=true, checkLive=true, currentState=recovering, localState=active, nodeName=127.0.0.1:42678_, coreNodeName=core_node8, onlyIfActiveCheckResult=false, nodeProps: core_node8:{\\\"core\\\":\\\"collection1\\\",\\\"base_url\\\":\\\"http:\\/\\/127.0.0.1:42678\\\",\\\"node_name\\\":\\\"127.0.0.1:42678_\\\",\\\"state\\\":\\\"recovering\\\"}\\n   [junit4]   2&gt; 69729 INFO  (qtp1007998027-153) [n:127.0.0.1:44195_    ] o.a.s.h.a.CoreAdminHandler Waited coreNodeName: core_node8, state: recovering, checkLive: true, onlyIfLeader: true for: 0 seconds.\\n   [junit4]   2&gt; 69729 INFO  (qtp1007998027-153) [n:127.0.0.1:44195_    ] o.a.s.s.SolrDispatchFilter [admin] webapp=null path=\\/admin\\/cores params={nodeName=127.0.0.1:42678_&amp;onlyIfLeaderActive=true&amp;core=collection1&amp;coreNodeName=core_node8&amp;action=PREPRECOVERY&amp;checkLive=true&amp;state=recovering&amp;onlyIfLeader=true&amp;wt=javabin&amp;version=2} status=0 QTime=1 \\n   [junit4] HEARTBEAT J0 PID(17711@tray): 2015-11-11T16:22:31, stalled for 70.2s at: TestCloudSchemaless.test\\n   [junit4]   2&gt; 72390 INFO  (RecoveryThread-collection1) [n:127.0.0.1:44717_ c:collection1 s:shard3 r:core_node6 x:collection1] o.a.s.c.RecoveryStrategy Starting Replication Recovery.\\n   [junit4]   2&gt; 72390 INFO  (RecoveryThread-collection1) [n:127.0.0.1:44717_ c:collection1 s:shard3 r:core_node6 x:collection1] o.a.s.c.RecoveryStrategy Attempting to replicate from http:\\/\\/127.0.0.1:54475\\/collection1\\/.\\n   [junit4]   2&gt; 72391 ERROR (qtp1661135858-94) [n:127.0.0.1:54475_    ] o.a.s.s.SolrDispatchFilter Error processing the request. CoreContainer is either not initialized or shutting down.\\n   [junit4]   2&gt; 72392 WARN  (qtp1661135858-94) [n:127.0.0.1:54475_    ] o.e.j.s.ServletHandler \\/collection1\\/update\\n   [junit4]   2&gt; org.apache.solr.common.SolrException: Error processing the request. CoreContainer is either not initialized or shutting down.\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:187)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:179)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.apache.solr.client.solrj.embedded.JettySolrRunner$DebugFilter.doFilter(JettySolrRunner.java:109)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlets.UserAgentFilter.doFilter(UserAgentFilter.java:83)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlets.GzipFilter.doFilter(GzipFilter.java:300)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:221)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.Server.handle(Server.java:499)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\\n   [junit4]   2&gt; \\tat java.lang.Thread.run(Thread.java:745)\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003e...and then things \u003cb\u003ereally\u003c\\/b\u003e get weird, as the RecoveryThread starts trying to do replication recovery, and then nodes start complaining that they can\'t open a new searcher because SolrCoreAware.inform() was never called on the SimilarityFactory (an assert that exists inside SchemaSimilarityFactory.getSimilarity()) ...\u003c\\/p\u003e\\n\\n\u003cdiv class=\\\"preformatted panel\\\" style=\\\"border-width: 1px;\\\"\u003e\u003cdiv class=\\\"preformattedContent panelContent\\\"\u003e\\n\u003cpre\u003e   [junit4]   2&gt; 74329 INFO  (RecoveryThread-collection1) [n:127.0.0.1:52349_ c:collection1 s:shard4 r:core_node7 x:collection1] o.a.s.c.RecoveryStrategy Attempting to replicate from http:\\/\\/127.0.0.1:54695\\/collection1\\/.\\n   [junit4]   2&gt; 74331 INFO  (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.u.UpdateHandler start commit{,optimize=false,openSearcher=false,waitSearcher=true,expungeDeletes=false,softCommit=false,prepareCommit=false}\\n   [junit4]   2&gt; 74359 INFO  (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.c.SolrCore SolrDeletionPolicy.onCommit: commits: num=2\\n   [junit4]   2&gt; \\tcommit{dir=NRTCachingDirectory(MMapDirectory@\\/home\\/hossman\\/lucene\\/dev\\/solr\\/build\\/solr-core\\/test\\/J0\\/temp\\/solr.schema.TestCloudSchemaless_E3CE46BC04E096EF-001\\/shard-3-001\\/cores\\/collection1\\/data\\/index lockFactory=org.apache.lucene.store.SingleInstanceLockFactory@5720ab9c; maxCacheMB=48.0 maxMergeSizeMB=4.0),segFN=segments_4,generation=4}\\n   [junit4]   2&gt; \\tcommit{dir=NRTCachingDirectory(MMapDirectory@\\/home\\/hossman\\/lucene\\/dev\\/solr\\/build\\/solr-core\\/test\\/J0\\/temp\\/solr.schema.TestCloudSchemaless_E3CE46BC04E096EF-001\\/shard-3-001\\/cores\\/collection1\\/data\\/index lockFactory=org.apache.lucene.store.SingleInstanceLockFactory@5720ab9c; maxCacheMB=48.0 maxMergeSizeMB=4.0),segFN=segments_5,generation=5}\\n   [junit4]   2&gt; 74359 INFO  (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.c.SolrCore newest commit generation = 5\\n   [junit4]   2&gt; 74361 INFO  (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.s.SolrIndexSearcher Opening Searcher@5428727f[collection1] realtime\\n   [junit4]   2&gt; 74361 INFO  (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.u.p.LogUpdateProcessor [collection1] webapp= path=\\/update params={waitSearcher=true&amp;openSearcher=false&amp;commit=true&amp;softCommit=false&amp;commit_end_point=true&amp;wt=javabin&amp;version=2} {} 0 30\\n   [junit4]   2&gt; 74362 ERROR (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.s.SolrDispatchFilter null:java.lang.RuntimeException: java.lang.AssertionError: inform must be called first\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.HttpSolrCall.sendError(HttpSolrCall.java:616)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:475)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:220)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:179)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.apache.solr.client.solrj.embedded.JettySolrRunner$DebugFilter.doFilter(JettySolrRunner.java:109)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlets.UserAgentFilter.doFilter(UserAgentFilter.java:83)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlets.GzipFilter.doFilter(GzipFilter.java:300)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:221)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.Server.handle(Server.java:499)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\\n   [junit4]   2&gt; \\tat java.lang.Thread.run(Thread.java:745)\\n   [junit4]   2&gt; Caused by: java.lang.AssertionError: inform must be called first\\n   [junit4]   2&gt; \\tat org.apache.solr.search.similarities.SchemaSimilarityFactory.getSimilarity(SchemaSimilarityFactory.java:86)\\n   [junit4]   2&gt; \\tat org.apache.solr.schema.IndexSchema.getSimilarity(IndexSchema.java:269)\\n   [junit4]   2&gt; \\tat org.apache.solr.search.SolrIndexSearcher.&lt;init&gt;(SolrIndexSearcher.java:255)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:1628)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.DirectUpdateHandler2.commit(DirectUpdateHandler2.java:635)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.RunUpdateProcessor.processCommit(RunUpdateProcessorFactory.java:95)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.DistributedUpdateProcessor.doLocalCommit(DistributedUpdateProcessor.java:1616)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.DistributedUpdateProcessor.processCommit(DistributedUpdateProcessor.java:1593)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.LogUpdateProcessor.processCommit(LogUpdateProcessorFactory.java:161)\\n   [junit4]   2&gt; \\tat org.apache.solr.handler.RequestHandlerUtils.handleCommit(RequestHandlerUtils.java:69)\\n   [junit4]   2&gt; \\tat org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:68)\\n   [junit4]   2&gt; \\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:151)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:2079)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:667)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:460)\\n   [junit4]   2&gt; \\t... 23 more\\n\u003c\\/pre\u003e\\n\u003c\\/div\u003e\u003c\\/div\u003e\\n\\n\u003cp\u003e...and then eventually the suite times out.\u003c\\/p\u003e\\n\\n\u003chr \\/\u003e\\n\\n\u003cp\u003eThere are lots of questions here, notably:\u003c\\/p\u003e\\n\\n\u003col\u003e\\n\\t\u003cli\u003ewhat makes this tests special that it fails so spectaculaly like this?\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003ein particular why does this SimilarityFactory change cause the directory ref counting to fail?\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\\t\u003cli\u003ewhy is recovery happening after shutdown?\u003c\\/li\u003e\\n\\t\u003cli\u003eregardless of how\\/why the other things in the test go so bizare in the first place, what code path is leading to the SchemaSimilarityFactory that hasn\'t had \u003ctt\u003e.inform(SolrCore)\u003c\\/tt\u003e called on it?\u003c\\/li\u003e\\n\u003c\\/ol\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_15001410_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15001410_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 00:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T00:35:37+0000\'\u003e12\\/Nov\\/15 00:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                   \\n With the attached patch, it\'s trivial to trigger a suite failure in TestCloudSchemaless, although lots of other cloud related tests (using schema.xml via AbstractFullDistribZkTestBase) function just fine. \\n\\n (NOTE: there are in fact a handful of other test failures with this patch, but they exist due to specific Sim related assumptions in those tests vs the general change of schema.xml to using SchemaSimilarityFactory ... i included the change to schema.xml in this patch purely as an easy way to demonstrate that most cloud related tests &#8211; even ones using schemaless and\\/or involving core reloads &#8211; don\'t ffreak out the same way as TestCloudSchemaless) \\n\\n \\n\\n Quick walk through of the TestCloudSchemaless failure... \\n\\n  \\n ant test  -Dtestcase=TestCloudSchemaless -Dtests.seed=8F1B744FBE000231 -Dtests.slow=true\\n \\n  \\n\\n The test itself runs fine, and reaches the  SolrTestCaseJ4 ###Ending test\\\" stage  at which point shutdown begins &#8211; and eventually stalls in the dir factory waiting for directories to close... \\n\\n  \\n    [junit4]   2&gt; 52621 INFO  (TEST-TestCloudSchemaless.test-seed#[E3CE46BC04E096EF]) [n:127.0.0.1:35554_ c:collection1 s:shard2 r:core_node1 x:collection1] o.a.s.c.SolrCore [collection1] Closing main searcher on request.\\n   [junit4]   2&gt; 52621 INFO  (TEST-TestCloudSchemaless.test-seed#[E3CE46BC04E096EF]) [n:127.0.0.1:35554_ c:collection1 s:shard2 r:core_node1 x:collection1] o.a.s.c.CachingDirectoryFactory Closing NRTCachingDirectoryFactory - 2 directories currently being tracked\\n   [junit4]   2&gt; 64733 ERROR (TEST-TestCloudSchemaless.test-seed#[E3CE46BC04E096EF]) [n:127.0.0.1:35554_ c:collection1 s:shard2 r:core_node1 x:collection1] o.a.s.c.CachingDirectoryFactory Timeout waiting for all directory ref counts to be released - gave up waiting on CachedDir&lt;&lt;refCount=1;path=\\/home\\/hossman\\/lucene\\/dev\\/solr\\/build\\/solr-core\\/test\\/J0\\/temp\\/solr.schema.TestCloudSchemaless_E3CE46BC04E096EF-001\\/shard-1-001\\/cores\\/collection1\\/data\\/index;done=false&gt;&gt;\\n   [junit4]   2&gt; 64733 ERROR (TEST-TestCloudSchemaless.test-seed#[E3CE46BC04E096EF]) [n:127.0.0.1:35554_ c:collection1 s:shard2 r:core_node1 x:collection1] o.a.s.c.CachingDirectoryFactory Error closing directory:org.apache.solr.common.SolrException: Timeout waiting for all directory ref counts to be released - gave up waiting on CachedDir&lt;&lt;refCount=1;path=\\/home\\/hossman\\/lucene\\/dev\\/solr\\/build\\/solr-core\\/test\\/J0\\/temp\\/solr.schema.TestCloudSchemaless_E3CE46BC04E096EF-001\\/shard-1-001\\/cores\\/collection1\\/data\\/index;done=false&gt;&gt;\\n   [junit4]   2&gt; \\tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:187)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCore.close(SolrCore.java:1268)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCores.close(SolrCores.java:124)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.CoreContainer.shutdown(CoreContainer.java:570)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.destroy(SolrDispatchFilter.java:172)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.ChaosMonkey.stopJettySolrRunner(ChaosMonkey.java:186)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.ChaosMonkey.stop(ChaosMonkey.java:518)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.AbstractFullDistribZkTestBase.destroyServers(AbstractFullDistribZkTestBase.java:1514)\\n   [junit4]   2&gt; \\tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsFixedStatement.callStatement(BaseDistributedSearchTestCase.java:964)\\n   [junit4]   2&gt; \\tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsStatement.evaluate(BaseDistributedSearchTestCase.java:938)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesRestoreRule$1.evaluate(SystemPropertiesRestoreRule.java:57)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleSetupTeardownChained$1.evaluate(TestRuleSetupTeardownChained.java:50)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:46)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleThreadAndTestName$1.evaluate(TestRuleThreadAndTestName.java:49)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:65)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl.forkTimeoutingTask(ThreadLeakControl.java:809)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$3.evaluate(ThreadLeakControl.java:460)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner.runSingleTest(RandomizedRunner.java:875)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$5.evaluate(RandomizedRunner.java:777)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$6.evaluate(RandomizedRunner.java:811)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$7.evaluate(RandomizedRunner.java:822)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesRestoreRule$1.evaluate(SystemPropertiesRestoreRule.java:57)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:46)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:42)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:54)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:65)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:55)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\\n   [junit4]   2&gt; \\tat java.lang.Thread.run(Thread.java:745)\\n   [junit4]   2&gt; \\n   [junit4]   2&gt; 64733 ERROR (TEST-TestCloudSchemaless.test-seed#[E3CE46BC04E096EF]) [n:127.0.0.1:35554_ c:collection1 s:shard2 r:core_node1 x:collection1] o.a.s.c.SolrCore java.lang.AssertionError: 1\\n   [junit4]   2&gt; \\tat org.apache.solr.core.CachingDirectoryFactory.close(CachingDirectoryFactory.java:201)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCore.close(SolrCore.java:1268)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCores.close(SolrCores.java:124)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.CoreContainer.shutdown(CoreContainer.java:570)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.destroy(SolrDispatchFilter.java:172)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.ChaosMonkey.stopJettySolrRunner(ChaosMonkey.java:186)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.ChaosMonkey.stop(ChaosMonkey.java:518)\\n   [junit4]   2&gt; \\tat org.apache.solr.cloud.AbstractFullDistribZkTestBase.destroyServers(AbstractFullDistribZkTestBase.java:1514)\\n   [junit4]   2&gt; \\tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsFixedStatement.callStatement(BaseDistributedSearchTestCase.java:964)\\n   [junit4]   2&gt; \\tat org.apache.solr.BaseDistributedSearchTestCase$ShardsRepeatRule$ShardsStatement.evaluate(BaseDistributedSearchTestCase.java:938)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesRestoreRule$1.evaluate(SystemPropertiesRestoreRule.java:57)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleSetupTeardownChained$1.evaluate(TestRuleSetupTeardownChained.java:50)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:46)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleThreadAndTestName$1.evaluate(TestRuleThreadAndTestName.java:49)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:65)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl.forkTimeoutingTask(ThreadLeakControl.java:809)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$3.evaluate(ThreadLeakControl.java:460)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner.runSingleTest(RandomizedRunner.java:875)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$5.evaluate(RandomizedRunner.java:777)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$6.evaluate(RandomizedRunner.java:811)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.RandomizedRunner$7.evaluate(RandomizedRunner.java:822)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.SystemPropertiesRestoreRule$1.evaluate(SystemPropertiesRestoreRule.java:57)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:46)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:42)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:54)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:65)\\n   [junit4]   2&gt; \\tat org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:55)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\\n   [junit4]   2&gt; \\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\\n   [junit4]   2&gt; \\tat java.lang.Thread.run(Thread.java:745)\\n   [junit4]   2&gt; \\n \\n  \\n\\n\\n ...at that point, things go from bad to worse, as RecoveryThreads kick in (why is the collection attempting to recover it it was deliberaly being shutdown???) but of course that doesn\'t turn out well because the CoreContainer\'s are all in shutdown mode... \\n\\n  \\n    [junit4]   2&gt; 69727 INFO  (qtp1007998027-153) [n:127.0.0.1:44195_    ] o.a.s.h.a.CoreAdminHandler Going to wait for coreNodeName: core_node8, state: recovering, checkLive: true, onlyIfLeader: true, onlyIfLeaderActive: true\\n   [junit4]   2&gt; 69727 INFO  (zkCallback-44-thread-2-processing-n:127.0.0.1:42678_) [n:127.0.0.1:42678_    ] o.a.s.c.c.ZkStateReader Updating data for collection1 from 29 to 30 \\n   [junit4]   2&gt; 69728 INFO  (zkCallback-39-thread-2-processing-n:127.0.0.1:52349_) [n:127.0.0.1:52349_    ] o.a.s.c.c.ZkStateReader Updating data for collection1 from 29 to 30 \\n   [junit4]   2&gt; 69728 INFO  (qtp1007998027-153) [n:127.0.0.1:44195_    ] o.a.s.h.a.CoreAdminHandler Will wait a max of 183 seconds to see collection1 (shard1 of collection1) have state: recovering\\n   [junit4]   2&gt; 69728 INFO  (qtp1007998027-153) [n:127.0.0.1:44195_    ] o.a.s.h.a.CoreAdminHandler In WaitForState(recovering): collection=collection1, shard=shard1, thisCore=collection1, leaderDoesNotNeedRecovery=false, isLeader? true, live=true, checkLive=true, currentState=recovering, localState=active, nodeName=127.0.0.1:42678_, coreNodeName=core_node8, onlyIfActiveCheckResult=false, nodeProps: core_node8:{\\\"core\\\":\\\"collection1\\\",\\\"base_url\\\":\\\"http:\\/\\/127.0.0.1:42678\\\",\\\"node_name\\\":\\\"127.0.0.1:42678_\\\",\\\"state\\\":\\\"recovering\\\"}\\n   [junit4]   2&gt; 69729 INFO  (qtp1007998027-153) [n:127.0.0.1:44195_    ] o.a.s.h.a.CoreAdminHandler Waited coreNodeName: core_node8, state: recovering, checkLive: true, onlyIfLeader: true for: 0 seconds.\\n   [junit4]   2&gt; 69729 INFO  (qtp1007998027-153) [n:127.0.0.1:44195_    ] o.a.s.s.SolrDispatchFilter [admin] webapp=null path=\\/admin\\/cores params={nodeName=127.0.0.1:42678_&amp;onlyIfLeaderActive=true&amp;core=collection1&amp;coreNodeName=core_node8&amp;action=PREPRECOVERY&amp;checkLive=true&amp;state=recovering&amp;onlyIfLeader=true&amp;wt=javabin&amp;version=2} status=0 QTime=1 \\n   [junit4] HEARTBEAT J0 PID(17711@tray): 2015-11-11T16:22:31, stalled for 70.2s at: TestCloudSchemaless.test\\n   [junit4]   2&gt; 72390 INFO  (RecoveryThread-collection1) [n:127.0.0.1:44717_ c:collection1 s:shard3 r:core_node6 x:collection1] o.a.s.c.RecoveryStrategy Starting Replication Recovery.\\n   [junit4]   2&gt; 72390 INFO  (RecoveryThread-collection1) [n:127.0.0.1:44717_ c:collection1 s:shard3 r:core_node6 x:collection1] o.a.s.c.RecoveryStrategy Attempting to replicate from http:\\/\\/127.0.0.1:54475\\/collection1\\/.\\n   [junit4]   2&gt; 72391 ERROR (qtp1661135858-94) [n:127.0.0.1:54475_    ] o.a.s.s.SolrDispatchFilter Error processing the request. CoreContainer is either not initialized or shutting down.\\n   [junit4]   2&gt; 72392 WARN  (qtp1661135858-94) [n:127.0.0.1:54475_    ] o.e.j.s.ServletHandler \\/collection1\\/update\\n   [junit4]   2&gt; org.apache.solr.common.SolrException: Error processing the request. CoreContainer is either not initialized or shutting down.\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:187)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:179)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.apache.solr.client.solrj.embedded.JettySolrRunner$DebugFilter.doFilter(JettySolrRunner.java:109)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlets.UserAgentFilter.doFilter(UserAgentFilter.java:83)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlets.GzipFilter.doFilter(GzipFilter.java:300)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:221)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.Server.handle(Server.java:499)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\\n   [junit4]   2&gt; \\tat java.lang.Thread.run(Thread.java:745)\\n \\n  \\n\\n ...and then things  really  get weird, as the RecoveryThread starts trying to do replication recovery, and then nodes start complaining that they can\'t open a new searcher because SolrCoreAware.inform() was never called on the SimilarityFactory (an assert that exists inside SchemaSimilarityFactory.getSimilarity()) ... \\n\\n  \\n    [junit4]   2&gt; 74329 INFO  (RecoveryThread-collection1) [n:127.0.0.1:52349_ c:collection1 s:shard4 r:core_node7 x:collection1] o.a.s.c.RecoveryStrategy Attempting to replicate from http:\\/\\/127.0.0.1:54695\\/collection1\\/.\\n   [junit4]   2&gt; 74331 INFO  (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.u.UpdateHandler start commit{,optimize=false,openSearcher=false,waitSearcher=true,expungeDeletes=false,softCommit=false,prepareCommit=false}\\n   [junit4]   2&gt; 74359 INFO  (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.c.SolrCore SolrDeletionPolicy.onCommit: commits: num=2\\n   [junit4]   2&gt; \\tcommit{dir=NRTCachingDirectory(MMapDirectory@\\/home\\/hossman\\/lucene\\/dev\\/solr\\/build\\/solr-core\\/test\\/J0\\/temp\\/solr.schema.TestCloudSchemaless_E3CE46BC04E096EF-001\\/shard-3-001\\/cores\\/collection1\\/data\\/index lockFactory=org.apache.lucene.store.SingleInstanceLockFactory@5720ab9c; maxCacheMB=48.0 maxMergeSizeMB=4.0),segFN=segments_4,generation=4}\\n   [junit4]   2&gt; \\tcommit{dir=NRTCachingDirectory(MMapDirectory@\\/home\\/hossman\\/lucene\\/dev\\/solr\\/build\\/solr-core\\/test\\/J0\\/temp\\/solr.schema.TestCloudSchemaless_E3CE46BC04E096EF-001\\/shard-3-001\\/cores\\/collection1\\/data\\/index lockFactory=org.apache.lucene.store.SingleInstanceLockFactory@5720ab9c; maxCacheMB=48.0 maxMergeSizeMB=4.0),segFN=segments_5,generation=5}\\n   [junit4]   2&gt; 74359 INFO  (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.c.SolrCore newest commit generation = 5\\n   [junit4]   2&gt; 74361 INFO  (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.s.SolrIndexSearcher Opening Searcher@5428727f[collection1] realtime\\n   [junit4]   2&gt; 74361 INFO  (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.u.p.LogUpdateProcessor [collection1] webapp= path=\\/update params={waitSearcher=true&amp;openSearcher=false&amp;commit=true&amp;softCommit=false&amp;commit_end_point=true&amp;wt=javabin&amp;version=2} {} 0 30\\n   [junit4]   2&gt; 74362 ERROR (qtp1972553455-125) [n:127.0.0.1:54695_ c:collection1 s:shard4 r:core_node3 x:collection1] o.a.s.s.SolrDispatchFilter null:java.lang.RuntimeException: java.lang.AssertionError: inform must be called first\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.HttpSolrCall.sendError(HttpSolrCall.java:616)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:475)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:220)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:179)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.apache.solr.client.solrj.embedded.JettySolrRunner$DebugFilter.doFilter(JettySolrRunner.java:109)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlets.UserAgentFilter.doFilter(UserAgentFilter.java:83)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlets.GzipFilter.doFilter(GzipFilter.java:300)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:221)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.Server.handle(Server.java:499)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\\n   [junit4]   2&gt; \\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\\n   [junit4]   2&gt; \\tat java.lang.Thread.run(Thread.java:745)\\n   [junit4]   2&gt; Caused by: java.lang.AssertionError: inform must be called first\\n   [junit4]   2&gt; \\tat org.apache.solr.search.similarities.SchemaSimilarityFactory.getSimilarity(SchemaSimilarityFactory.java:86)\\n   [junit4]   2&gt; \\tat org.apache.solr.schema.IndexSchema.getSimilarity(IndexSchema.java:269)\\n   [junit4]   2&gt; \\tat org.apache.solr.search.SolrIndexSearcher.&lt;init&gt;(SolrIndexSearcher.java:255)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:1628)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.DirectUpdateHandler2.commit(DirectUpdateHandler2.java:635)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.RunUpdateProcessor.processCommit(RunUpdateProcessorFactory.java:95)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.DistributedUpdateProcessor.doLocalCommit(DistributedUpdateProcessor.java:1616)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.DistributedUpdateProcessor.processCommit(DistributedUpdateProcessor.java:1593)\\n   [junit4]   2&gt; \\tat org.apache.solr.update.processor.LogUpdateProcessor.processCommit(LogUpdateProcessorFactory.java:161)\\n   [junit4]   2&gt; \\tat org.apache.solr.handler.RequestHandlerUtils.handleCommit(RequestHandlerUtils.java:69)\\n   [junit4]   2&gt; \\tat org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:68)\\n   [junit4]   2&gt; \\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:151)\\n   [junit4]   2&gt; \\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:2079)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:667)\\n   [junit4]   2&gt; \\tat org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:460)\\n   [junit4]   2&gt; \\t... 23 more\\n \\n  \\n\\n ...and then eventually the suite times out. \\n\\n \\n\\n There are lots of questions here, notably: \\n\\n \\n\\t what makes this tests special that it fails so spectaculaly like this?\\n\\t \\n\\t\\t in particular why does this SimilarityFactory change cause the directory ref counting to fail? \\n\\t \\n\\t \\n\\t why is recovery happening after shutdown? \\n\\t regardless of how\\/why the other things in the test go so bizare in the first place, what code path is leading to the SchemaSimilarityFactory that hasn\'t had  .inform(SolrCore)  called on it? \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15001442\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-8280?focusedCommentId=15001442&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15001442\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_15001442_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15001442_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 01:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T01:14:18+0000\'\u003e12\\/Nov\\/15 01:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAfter filing this, it occurred to me the original issue that lead me down this investigation (\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-8271\\\" title=\\\"use SchemaSimilarityFactory as default when no explicit (top level) sim is configured\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-8271\\\"\u003e\u003cdel\u003eSOLR-8271\u003c\\/del\u003e\u003c\\/a\u003e) I was also seeing failures in ChangedSchemaMergeTest.testOptimizeDiffSchemas that i wasn\'t seeing with this patch.  Looking into why I realized it\'s because that test uses it\'s own hardcoded schema(s) that are build on the fly from java code.\u003c\\/p\u003e\\n\\n\u003cp\u003eIn this new updated patch, i tweaked them to directly refer to SchemaSimilarityFactory, and now you can see the \u003ctt\u003eAssertionError: inform must be called first\u003c\\/tt\u003e getting logged, and the subsequent cc.shutdown() giving up after a ref count mismatch on the directory factory.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis is probably a simpler test to trouble shoot why the SolrCoreAware.inform isn\'t getting called properly then the cloud test, and hopefully can lead to a fix that helps with both tests.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_15001442_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15001442_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Nov\\/15 01:14\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-12T01:14:18+0000\'\u003e12\\/Nov\\/15 01:14\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    After filing this, it occurred to me the original issue that lead me down this investigation (  SOLR-8271  ) I was also seeing failures in ChangedSchemaMergeTest.testOptimizeDiffSchemas that i wasn\'t seeing with this patch.  Looking into why I realized it\'s because that test uses it\'s own hardcoded schema(s) that are build on the fly from java code. \\n\\n In this new updated patch, i tweaked them to directly refer to SchemaSimilarityFactory, and now you can see the  AssertionError: inform must be called first  getting logged, and the subsequent cc.shutdown() giving up after a ref count mismatch on the directory factory. \\n\\n This is probably a simpler test to trouble shoot why the SolrCoreAware.inform isn\'t getting called properly then the cloud test, and hopefully can lead to a fix that helps with both tests.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15006146\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-8280?focusedCommentId=15006146&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15006146\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_15006146_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15006146_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Nov\\/15 02:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-16T02:07:14+0000\'\u003e16\\/Nov\\/15 02:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\\n\u003cp\u003eThe root problem seems to be that when using the SolrResourceLoader to create newInstances of objects, the loader is tracking what things are SolrCoreAware, ResourceLoaderAware, and\\/or SolrInfoMBean.  Then, just before the SolrCore finishes initialiing itself, it calls a method on SolrResourceLoader to take appropriate action on to inform those instances (and\\/or add them to the MBean registry)\u003c\\/p\u003e\\n\\n\u003cp\u003eThe problem happens when any new instances are created by the SolrResourceLoader \u003cem\u003eafter\u003c\\/em\u003e the SolrCore is up and running &#8211; it currently has a \u003ctt\u003elive\u003c\\/tt\u003e boolean it uses to just flat out ignore wether or not these instances are SolrCoreAware, ResourceLoaderAware, and\\/or SolrInfoMBean, meaning that nothing in the call stack ever informs them about the SolrCore.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt looks like \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-4658\\\" title=\\\"In preparation for dynamic schema modification via REST API, add a &quot;managed&quot; schema facility\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-4658\\\"\u003e\u003cdel\u003eSOLR-4658\u003c\\/del\u003e\u003c\\/a\u003e included a bit of a hack work arround for the ResourceLoaderAware schema elements (see IndexSchema\'s constructor which call\'s \u003ctt\u003eloader.inform(loader);\u003c\\/tt\u003e...\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"http:\\/\\/svn.apache.org\\/viewvc\\/lucene\\/dev\\/trunk\\/solr\\/core\\/src\\/java\\/org\\/apache\\/solr\\/schema\\/IndexSchema.java?r1=1463182&amp;r2=1463181&amp;pathrev=1463182\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/svn.apache.org\\/viewvc\\/lucene\\/dev\\/trunk\\/solr\\/core\\/src\\/java\\/org\\/apache\\/solr\\/schema\\/IndexSchema.java?r1=1463182&amp;r2=1463181&amp;pathrev=1463182\u003c\\/a\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003e...this seems realy sketchy because it causes \u003cb\u003eany\u003c\\/b\u003e ResourceLoaderAware plugins inited so far by the core to be {{inform(ResourceLoader)}}ed once the first IndexSchema is created &#8211; even though that\'s not suppose to happen until mutch later in the SolrCore constructor just before the CountDownLatch is released.\u003c\\/p\u003e\\n\\n\u003cp\u003eWhat it does do however is ensure that when a new schema gets loaded later (by the REST API, or a schemaless update processor) and ResourceLoaderAware fieldtypes\\/analyzers are good to go &#8211; but that doesn\'t do anything to help SolrCoreAware plugins like SimilarityFactory.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m attaching a work in progress patch where I attempted to fix the underlying problem with SolrResourceLoader by having it keep a refrence to the SolrCore it\'s tied to such that any new instances after that the would be immediately informed of the SorlCore\\/ResourceLoader.  This fixes some of the tests I mentioned before in this issue that have problems with SchemaSimilarityFactory but causes other failures in other existing test that reload the schema &#8211; because any FieldType that is ResourceLoader aware is now being \\\"informed\\\" of the loader as soon as it\'s instantiated &#8211; before even basic init() methods are called.  Which makes sense in hind sight &#8211; my whole approach here is flawed because the contract is suppoes to be that the init methods will always be called first, and any (valid) inform methods will be called at some point after that once the core\\/loader is available, but before the instance is used ... calling \\\"new\\\" then \\\"inform\\\" then \\\"init\\\" is maddness.\u003c\\/p\u003e\\n\\n\u003cp\u003eI honestly don\'t know if there is a sane way to solve this problem in the general case &#8211; the best thing I can think of at the moment is a similar special case hack for calling \u003ctt\u003eloader.inform(SolrCore)\u003c\\/tt\u003e after any code that creates a schema (other then SolrCore)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_15006146_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15006146_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Nov\\/15 02:07\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-16T02:07:14+0000\'\u003e16\\/Nov\\/15 02:07\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                   \\n The root problem seems to be that when using the SolrResourceLoader to create newInstances of objects, the loader is tracking what things are SolrCoreAware, ResourceLoaderAware, and\\/or SolrInfoMBean.  Then, just before the SolrCore finishes initialiing itself, it calls a method on SolrResourceLoader to take appropriate action on to inform those instances (and\\/or add them to the MBean registry) \\n\\n The problem happens when any new instances are created by the SolrResourceLoader  after  the SolrCore is up and running &#8211; it currently has a  live  boolean it uses to just flat out ignore wether or not these instances are SolrCoreAware, ResourceLoaderAware, and\\/or SolrInfoMBean, meaning that nothing in the call stack ever informs them about the SolrCore. \\n\\n It looks like   SOLR-4658   included a bit of a hack work arround for the ResourceLoaderAware schema elements (see IndexSchema\'s constructor which call\'s  loader.inform(loader); ... \\n\\n  http:\\/\\/svn.apache.org\\/viewvc\\/lucene\\/dev\\/trunk\\/solr\\/core\\/src\\/java\\/org\\/apache\\/solr\\/schema\\/IndexSchema.java?r1=1463182&amp;r2=1463181&amp;pathrev=1463182  \\n\\n ...this seems realy sketchy because it causes  any  ResourceLoaderAware plugins inited so far by the core to be {{inform(ResourceLoader)}}ed once the first IndexSchema is created &#8211; even though that\'s not suppose to happen until mutch later in the SolrCore constructor just before the CountDownLatch is released. \\n\\n What it does do however is ensure that when a new schema gets loaded later (by the REST API, or a schemaless update processor) and ResourceLoaderAware fieldtypes\\/analyzers are good to go &#8211; but that doesn\'t do anything to help SolrCoreAware plugins like SimilarityFactory. \\n\\n I\'m attaching a work in progress patch where I attempted to fix the underlying problem with SolrResourceLoader by having it keep a refrence to the SolrCore it\'s tied to such that any new instances after that the would be immediately informed of the SorlCore\\/ResourceLoader.  This fixes some of the tests I mentioned before in this issue that have problems with SchemaSimilarityFactory but causes other failures in other existing test that reload the schema &#8211; because any FieldType that is ResourceLoader aware is now being \\\"informed\\\" of the loader as soon as it\'s instantiated &#8211; before even basic init() methods are called.  Which makes sense in hind sight &#8211; my whole approach here is flawed because the contract is suppoes to be that the init methods will always be called first, and any (valid) inform methods will be called at some point after that once the core\\/loader is available, but before the instance is used ... calling \\\"new\\\" then \\\"inform\\\" then \\\"init\\\" is maddness. \\n\\n I honestly don\'t know if there is a sane way to solve this problem in the general case &#8211; the best thing I can think of at the moment is a similar special case hack for calling  loader.inform(SolrCore)  after any code that creates a schema (other then SolrCore)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15006470\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-8280?focusedCommentId=15006470&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15006470\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"romseygeek\\\" id=\\\"commentauthor_15006470_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=romseygeek\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"romseygeek\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Alan Woodward\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15006470_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Nov\\/15 10:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-16T10:29:10+0000\'\u003e16\\/Nov\\/15 10:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have a half-implemented patch hanging around somewhere that tried to clean this up a bit.  I think the root problem is that there are two circumstances in which we\'re using SolrResourceLoader, a) during core initialization when we need to call init() immediately, but wait to call inform() until after the loading latch has been released, and then b) to create new objects once the core is up and serving queries.  I tried to split this out into two separate SRL implementations, one of which is private to SolrCore and used only in the constructor, and does the call-init-and-then-delay-inform dance, and the other of which is returned by SolrCore.getResourceLoader() and inits() and informs() before it returns.  To be honest though, I get so confused by the code paths here that I\'m not sure whether or not that would help in this case...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"romseygeek\\\" id=\\\"commentauthor_15006470_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=romseygeek\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"romseygeek\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Alan Woodward\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15006470_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Nov\\/15 10:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-16T10:29:10+0000\'\u003e16\\/Nov\\/15 10:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have a half-implemented patch hanging around somewhere that tried to clean this up a bit.  I think the root problem is that there are two circumstances in which we\'re using SolrResourceLoader, a) during core initialization when we need to call init() immediately, but wait to call inform() until after the loading latch has been released, and then b) to create new objects once the core is up and serving queries.  I tried to split this out into two separate SRL implementations, one of which is private to SolrCore and used only in the constructor, and does the call-init-and-then-delay-inform dance, and the other of which is returned by SolrCore.getResourceLoader() and inits() and informs() before it returns.  To be honest though, I get so confused by the code paths here that I\'m not sure whether or not that would help in this case...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15009906\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-8280?focusedCommentId=15009906&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15009906\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_15009906_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15009906_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Nov\\/15 00:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-18T00:18:24+0000\'\u003e18\\/Nov\\/15 00:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\\n\u003cblockquote\u003e\u003cp\u003eI have a half-implemented patch hanging around somewhere that tried to clean this up a bit. I think the root problem is that there are two circumstances in which we\'re using SolrResourceLoader, ...\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eAgreed.  It\'s a mess, and it would be nice to clean up &#8211; but that\'s a huge pile of work, so i\'d prefer to punt it to another issue. (which i will file soon)\u003c\\/p\u003e\\n\\n\u003chr \\/\u003e\\n\\n\u003cp\u003eAfter digging into things a bit more, here are a few things i learned\\/realized\\/uncovered in no particular order...\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003ein most cases, the schemaless\\/managed-schema code paths don\'t actaully replace the entire IndexSchema used by a SolrCore...\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003eREST APIs use things like \u003ctt\u003eManagedIndexSchema.addFieldTypes(...)\u003c\\/tt\u003e which do shallow copies\\n\\t\\t\u003cul\u003e\\n\\t\\t\\t\u003cli\u003ethese ManagedIndexSchema methods for mutating things and doing shallow copies already have smarts to ensure that any new \u003ctt\u003eResourceAware\u003c\\/tt\u003e objects get properly informed.\u003c\\/li\u003e\\n\\t\\t\\t\u003cli\u003esince there is no way to dynamically change the SimFactory at run time, the existing instance is re-used in all of these shallow copies and no new SimFactory instances ever need informed of the core\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\\t\u003cli\u003esome (cloud specific) code paths use things like \u003ctt\u003eZkIndexSchemaReader.updateSchema\u003c\\/tt\u003e to notice if\\/when the schema file changes in ZK and act on that locally\\n\\t\\t\u003cul\u003e\\n\\t\\t\\t\u003cli\u003ethis does (evidently) construct an entirely new ManagedIndexSchema instance\u003c\\/li\u003e\\n\\t\\t\\t\u003cli\u003ethis is the code path that was execing after \u003ctt\u003eTestCloudSchemaless\u003c\\/tt\u003e was finished &#8211; but I still understand when\\/why this was happening.\u003c\\/li\u003e\\n\\t\\t\u003c\\/ul\u003e\\n\\t\\t\u003c\\/li\u003e\\n\\t\\t\u003cli\u003eChangedSchemaMergeTest is kind of a special case, because it goes out of it\'s way to construct a new IndexSchema and set it on an existing SolrCore even though it isn\'t using MangedIndexSchema\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\\t\u003cli\u003eThere was already a special kludge for SolrCoreAware SimFactories in \u003ctt\u003eSolrCore.initSchema\u003c\\/tt\u003e\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003elooks like this was originally for ensuring that the SimFactories was usable when other SolrCoreAware things (like listeners) got informed of the SolrCore and tried to use the SolrIndexSearcher (which depended on the sim)\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eSo i think the most straight forward solution to the problem (SimilarityFactory-ies that implement SolrCoreAware playing nice with managed schema) is to refactor that existing kludge from \u003ctt\u003eSolrCore.initSchema\u003c\\/tt\u003e to \u003ctt\u003eSolrCore.setLatestSchema\u003c\\/tt\u003e\u003c\\/p\u003e\\n\\n\u003chr \\/\u003e\\n\\n\u003cp\u003eCurrent Patch...\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003eschema-add-schema-fields-update-processor.xml - explicitly use SchemaSimilarityFactory here to help stress  TestCloudSchemaless\u003c\\/li\u003e\\n\\t\u003cli\u003eChangedSchemaMergeTest - explicitly use SchemaSimilarityFactory here to test that scenerio\u003c\\/li\u003e\\n\\t\u003cli\u003eSolrCore - refactored existing SolrCoreAware simfactory hack so that it applies anytime setLatestSchema is called\u003c\\/li\u003e\\n\\t\u003cli\u003eSchemaSimilarityFactory - switched from assertions to IllegalStateException so it\'s more obvious there\'s a problem even if assertions are disabled (no NPE)\u003c\\/li\u003e\\n\\t\u003cli\u003eSolrResourceLoader - has some nocommits i want to update with strong warnings and a link to a new jira where my &amp; alan\'s comments about the lifecycle problems of objects inited \u003cem\u003eafter\u003c\\/em\u003e the SolrCore is loaded are tracked\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003chr \\/\u003e\\n\\n\u003cp\u003eTODO:\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003ecleanup &amp; beef up nocommit comments\u003c\\/li\u003e\\n\\t\u003cli\u003ebeef up ChangedSchemaMergeTest to actually change the sim used in each schema &amp; verify it\'s updated (and fully functional)\u003c\\/li\u003e\\n\\t\u003cli\u003eadd\\/update a managed schema test that does an add-field type w\\/ a per-fieldtype sim and sanity check that code path + input works properly and plays nicely with SchemaSimilarityFactory\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_15009906_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15009906_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Nov\\/15 00:18\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-18T00:18:24+0000\'\u003e18\\/Nov\\/15 00:18\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                   \\n  I have a half-implemented patch hanging around somewhere that tried to clean this up a bit. I think the root problem is that there are two circumstances in which we\'re using SolrResourceLoader, ...  \\n\\n Agreed.  It\'s a mess, and it would be nice to clean up &#8211; but that\'s a huge pile of work, so i\'d prefer to punt it to another issue. (which i will file soon) \\n\\n \\n\\n After digging into things a bit more, here are a few things i learned\\/realized\\/uncovered in no particular order... \\n\\n \\n\\t in most cases, the schemaless\\/managed-schema code paths don\'t actaully replace the entire IndexSchema used by a SolrCore...\\n\\t \\n\\t\\t REST APIs use things like  ManagedIndexSchema.addFieldTypes(...)  which do shallow copies\\n\\t\\t \\n\\t\\t\\t these ManagedIndexSchema methods for mutating things and doing shallow copies already have smarts to ensure that any new  ResourceAware  objects get properly informed. \\n\\t\\t\\t since there is no way to dynamically change the SimFactory at run time, the existing instance is re-used in all of these shallow copies and no new SimFactory instances ever need informed of the core \\n\\t\\t \\n\\t\\t \\n\\t\\t some (cloud specific) code paths use things like  ZkIndexSchemaReader.updateSchema  to notice if\\/when the schema file changes in ZK and act on that locally\\n\\t\\t \\n\\t\\t\\t this does (evidently) construct an entirely new ManagedIndexSchema instance \\n\\t\\t\\t this is the code path that was execing after  TestCloudSchemaless  was finished &#8211; but I still understand when\\/why this was happening. \\n\\t\\t \\n\\t\\t \\n\\t\\t ChangedSchemaMergeTest is kind of a special case, because it goes out of it\'s way to construct a new IndexSchema and set it on an existing SolrCore even though it isn\'t using MangedIndexSchema \\n\\t \\n\\t \\n\\t There was already a special kludge for SolrCoreAware SimFactories in  SolrCore.initSchema \\n\\t \\n\\t\\t looks like this was originally for ensuring that the SimFactories was usable when other SolrCoreAware things (like listeners) got informed of the SolrCore and tried to use the SolrIndexSearcher (which depended on the sim) \\n\\t \\n\\t \\n \\n\\n\\n So i think the most straight forward solution to the problem (SimilarityFactory-ies that implement SolrCoreAware playing nice with managed schema) is to refactor that existing kludge from  SolrCore.initSchema  to  SolrCore.setLatestSchema  \\n\\n \\n\\n Current Patch... \\n\\n \\n\\t schema-add-schema-fields-update-processor.xml - explicitly use SchemaSimilarityFactory here to help stress  TestCloudSchemaless \\n\\t ChangedSchemaMergeTest - explicitly use SchemaSimilarityFactory here to test that scenerio \\n\\t SolrCore - refactored existing SolrCoreAware simfactory hack so that it applies anytime setLatestSchema is called \\n\\t SchemaSimilarityFactory - switched from assertions to IllegalStateException so it\'s more obvious there\'s a problem even if assertions are disabled (no NPE) \\n\\t SolrResourceLoader - has some nocommits i want to update with strong warnings and a link to a new jira where my &amp; alan\'s comments about the lifecycle problems of objects inited  after  the SolrCore is loaded are tracked \\n \\n\\n\\n \\n\\n TODO: \\n \\n\\t cleanup &amp; beef up nocommit comments \\n\\t beef up ChangedSchemaMergeTest to actually change the sim used in each schema &amp; verify it\'s updated (and fully functional) \\n\\t add\\/update a managed schema test that does an add-field type w\\/ a per-fieldtype sim and sanity check that code path + input works properly and plays nicely with SchemaSimilarityFactory \\n \\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15012363\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-8280?focusedCommentId=15012363&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15012363\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_15012363_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15012363_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Nov\\/15 23:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-18T23:32:49+0000\'\u003e18\\/Nov\\/15 23:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\\n\u003cp\u003eNew in this patch...\u003c\\/p\u003e\\n\\n\u003cul\u003e\\n\\t\u003cli\u003ecleanup &amp; beef up nocommit comments to point to new \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-8311\\\" title=\\\"SolrCoreAware and ResourceLoaderAware lifecyel is fragile - particularly with objects that can be created after SolrCore is live\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-8311\\\"\u003eSOLR-8311\u003c\\/a\u003e trakcing jira\u003c\\/li\u003e\\n\\t\u003cli\u003ebeefed up ChangedSchemaMergeTest to actually change the sim used in each schema &amp; verify it\'s updated (and fully functional)\u003c\\/li\u003e\\n\\t\u003cli\u003eput some sanity checks in TestBulkSchemaAPI.testMultipleCommands\\n\\t\u003cul\u003e\\n\\t\\t\u003cli\u003ealready had some basic verification that adding a fieldtype w\\/sim + field using that type workd\u003c\\/li\u003e\\n\\t\\t\u003cli\u003enow it whitebox verifies that the the underlying SimilarityFactory for the latest schema is  and returns the expected Sim for each field.\u003c\\/li\u003e\\n\\t\u003c\\/ul\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\\n\u003cp\u003e...still testing, but i think this is good to go.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"hossman\\\" id=\\\"commentauthor_15012363_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=hossman\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"hossman\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Hoss Man\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15012363_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Nov\\/15 23:32\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-18T23:32:49+0000\'\u003e18\\/Nov\\/15 23:32\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                   \\n New in this patch... \\n\\n \\n\\t cleanup &amp; beef up nocommit comments to point to new  SOLR-8311  trakcing jira \\n\\t beefed up ChangedSchemaMergeTest to actually change the sim used in each schema &amp; verify it\'s updated (and fully functional) \\n\\t put some sanity checks in TestBulkSchemaAPI.testMultipleCommands\\n\\t \\n\\t\\t already had some basic verification that adding a fieldtype w\\/sim + field using that type workd \\n\\t\\t now it whitebox verifies that the the underlying SimilarityFactory for the latest schema is  and returns the expected Sim for each field. \\n\\t \\n\\t \\n \\n\\n\\n\\n ...still testing, but i think this is good to go.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15013901\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-8280?focusedCommentId=15013901&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15013901\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15013901_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15013901_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Nov\\/15 17:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-19T17:03:37+0000\'\u003e19\\/Nov\\/15 17:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1715215 from hossman@apache.org in branch \'dev\\/trunk\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1715215\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1715215\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-8280\\\" title=\\\"Schemaless features don&#39;t work reliably with SolrCoreAware sim factory -- example: SchemaSimilarityFactory\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-8280\\\"\u003e\u003cdel\u003eSOLR-8280\u003c\\/del\u003e\u003c\\/a\u003e: Fixed bug in SimilarityFactory initialization that prevented SolrCoreAware factories from functioning properly with managed schema features\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15013901_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15013901_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Nov\\/15 17:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-19T17:03:37+0000\'\u003e19\\/Nov\\/15 17:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1715215 from hossman@apache.org in branch \'dev\\/trunk\' \\n[  https:\\/\\/svn.apache.org\\/r1715215  ] \\n\\n   SOLR-8280  : Fixed bug in SimilarityFactory initialization that prevented SolrCoreAware factories from functioning properly with managed schema features              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-15014029\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/SOLR-8280?focusedCommentId=15014029&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15014029\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15014029_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15014029_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Nov\\/15 17:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-19T17:57:27+0000\'\u003e19\\/Nov\\/15 17:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1715225 from hossman@apache.org in branch \'dev\\/branches\\/branch_5x\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1715225\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1715225\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/SOLR-8280\\\" title=\\\"Schemaless features don&#39;t work reliably with SolrCoreAware sim factory -- example: SchemaSimilarityFactory\\\" class=\\\"issue-link\\\" data-issue-key=\\\"SOLR-8280\\\"\u003e\u003cdel\u003eSOLR-8280\u003c\\/del\u003e\u003c\\/a\u003e: Fixed bug in SimilarityFactory initialization that prevented SolrCoreAware factories from functioning properly with managed schema features (merge r1715215)\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_15014029_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_15014029_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Nov\\/15 17:57\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-11-19T17:57:27+0000\'\u003e19\\/Nov\\/15 17:57\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1715225 from hossman@apache.org in branch \'dev\\/branches\\/branch_5x\' \\n[  https:\\/\\/svn.apache.org\\/r1715225  ] \\n\\n   SOLR-8280  : Fixed bug in SimilarityFactory initialization that prevented SolrCoreAware factories from functioning properly with managed schema features (merge r1715215)              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="12310230";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/SOLR\\/summary\\\" title=\\\"Solr\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=12310230&amp;avatarId=22151\\\" alt=\\\"Solr\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/SOLR\\/summary\\\" title=\\\"Solr\\\"\u003eSolr\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/SOLR?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1520341804704"> 
    <input type="hidden" title="jira.request.server.time" value="167"> 
    <input type="hidden" title="jira.request.id" value="790x97493956x7"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="6"> 
    <input type="hidden" title="db.reads.time.in.ms" value="25"> 
    <input type="hidden" title="db.conns.time.in.ms" value="29"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 790x97493956x7
	          REQUEST TIMESTAMP : [06/Mar/2018:13:10:04 +0000]
	               REQUEST TIME : 0.1670
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 6

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=24, elapsedTotal=25488078, elapsedMin=350607, elapsedMax=9683902, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=28, elapsedTotal=29686641, elapsedMin=387154, elapsedMax=9711600, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|11b65b8ab4b2ee53f167456f4634af4d19b8b70f|lout"> 
  <link rel="shortcut icon" href="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"jira.instrumentation.laas\":false,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"com.atlassian.jira.issuetable.draggable\":true,\"jira.create.linked.issue\":true,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"jira.jql.suggestrecentfields\":false,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"jira.jql.smartautoselectfirst\":false,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.priorities.per.project\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"jira.renderer.consider.variable.format\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/vnd.wap.wbmp,image/png,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"7353132ee4f794\"";
WRM._unparsedData["project-id"]="10594";
WRM._unparsedData["project-key"]="\"DERBY\"";
WRM._unparsedData["project-name"]="\"Derby\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="10594";
WRM._unparsedData["projectKey"]="\"DERBY\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/74ac580603ca910fff0cfdf319e54add-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/98ceb006e504d7924d5ffc411626c6bc-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/c1e4d26ea276469807c3dc0918df482c-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/6bf9253c8d533109c3b02e26794be24e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/ccd2e67b523185973473e8bd5735c8f9-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/33e5e0166867c8c9228d44506f60b2e8/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/6579b6b8ba67abaa496e39b9242a18a4-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="DERBY-3603"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[DERBY-3603] 'IN' clause ignores valid results, incorrect qualifier handling suspected - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[DERBY-3603] 'IN' clause ignores valid results, incorrect qualifier handling suspected - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/DERBY" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-3603">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="10594" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Derby'" src="https://issues.apache.org/jira/secure/projectavatar?pid=10594&amp;avatarId=10122"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/DERBY">Derby</a></li>
                 <li><a class="issue-link" data-issue-key="DERBY-3603" href="/jira/browse/DERBY-3603" id="key-val" rel="12393362">DERBY-3603</a></li>
                </ol>
                <h1 id="summary-val">'IN' clause ignores valid results, incorrect qualifier handling suspected</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-3603"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/DERBY-3603/DERBY-3603.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/DERBY-3603/DERBY-3603.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/DERBY-3603/DERBY-3603.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/DERBY-3603/DERBY-3603.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" title="Bug - A problem which impairs or prevents the functions of the product." width="16"> Bug </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="10.3.2.1 ">10.3.2.1</span>, <span title="10.4.1.3 ">10.4.1.3</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+fixVersion+%3D+10.3.3.0" title="10.3.3.0 ">10.3.3.0</a>, <a href="/jira/issues/?jql=project+%3D+DERBY+AND+fixVersion+%3D+10.4.1.3" title="10.4.1.3 ">10.4.1.3</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+component+%3D+SQL" title="SQL ">SQL</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <span class="labels" id="labels-12393362-value">None</span> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310050" class="item"> 
                     <div class="wrap"> 
                      <strong title="Urgency" class="name">Urgency:</strong> 
                      <div id="customfield_12310050-val" class="value type-select" data-fieldtype="select" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        Urgent 
                      </div> 
                     </div> </li> 
                    <li id="rowForcustomfield_12310200" class="item"> 
                     <div class="wrap"> 
                      <strong title="Bug behavior facts" class="name">Bug behavior facts:</strong> 
                      <div id="customfield_12310200-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310200-field"> 
                        <span>Regression</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>Derbys' 'IN' clause is returning different results depending on which side of a joined table<br> I am doing my 'IN' comparison against. This only occurs when the number of items within the 'IN' clause is greater then 1.</p> 
                  <p>This behaviour was also confirmed by Bryan Pendleton in this thread:<br> <a href="http://mail-archives.apache.org/mod_mbox/db-derby-user/200804.mbox/%3c47FA5974.2060705@amberpoint.com%3e" class="external-link" rel="nofollow">http://mail-archives.apache.org/mod_mbox/db-derby-user/200804.mbox/%3c47FA5974.2060705@amberpoint.com%3e</a></p> 
                  <p>Using the test database attatched the following 2 queries produce the issue:</p> 
                  <p>ij&gt; select count<img class="emoticon" src="/jira/images/icons/emoticons/star_yellow.png" height="16" width="16" align="absmiddle" alt="" border="0"> FROM spike.accounts account, spike.admin_units admin_unit,<br> spike.bookings booking<br> WHERE booking.child_id = 2 AND<br> admin_unit.admin_unit_id IN (1,21) AND<br> booking.booking_date_time_out &gt;= 20080331000000 AND<br> booking.booking_date_time_in &lt;= 20080406235900 AND<br> account.account_id = booking.account_id AND<br> admin_unit.admin_unit_id = account.admin_unit_id;<br> 1 <br> -----------<br> 2 </p> 
                  <p>1 row selected<br> ij&gt; select count<img class="emoticon" src="/jira/images/icons/emoticons/star_yellow.png" height="16" width="16" align="absmiddle" alt="" border="0"> FROM spike.accounts account, spike.admin_units admin_unit,<br> spike.bookings booking<br> WHERE booking.child_id = 2 AND<br> account.admin_unit_id IN (1,21) AND<br> booking.booking_date_time_out &gt;= 20080331000000 AND<br> booking.booking_date_time_in &lt;= 20080406235900 AND<br> account.account_id = booking.account_id AND<br> admin_unit.admin_unit_id = account.admin_unit_id;<br> 1 <br> -----------<br> 3 </p> 
                  <p>1 row selected<br> ij&gt; </p> 
                  <p>The only difference between the 2 statements is which side of a join the 'IN' clause is matched against.</p> 
                  <p>Bryan performed some initial testing and stated the following:</p> 
                  <p>--------------------- SNIP ------------------------</p> 
                  <p>Interestingly, although the actual results do NOT contain any values<br> for admin_unit_id = 21, if I change the query to:</p> 
                  <p> admin_unit.admin_unit_id IN (1)<br> or<br> account.admin_unit_id IN (1)</p> 
                  <p>then the problem disappears – I get 3 rows for both queries.</p> 
                  <p>I also ran query plans for both the queries (in the IN (1,21) case)<br> and have pasted the (simplified) query plans at the end of this message.</p> 
                  <p>I notice that in the case where the query gives 2 rows, which is<br> when we specify admin_unit.admin_unit_id in (1,21), the admin_unit_id<br> index scan output in the query plan contains:</p> 
                  <p> qualifiers:<br> Column<span class="error">[0]</span><span class="error">[0]</span> Id: 0<br> Operator: =<br> Ordered nulls: false<br> Unknown return value: false<br> Negate comparison result: false</p> 
                  <p>However, in the case where the query gives 3 rows, which is<br> when we specify account.admin_unit_id in (1,21), the admin_unit_id<br> index scan output in the query plan contains:</p> 
                  <p> qualifiers:<br> None</p> 
                  <p>I think it is the presence/absence of this qualifier on the query<br> scan which is causing the different results in the query, as in<br> the first case we see:</p> 
                  <p> Number of rows qualified=2<br> Number of rows visited=3</p> 
                  <p>but in the second case we see:</p> 
                  <p> Number of rows qualified=3<br> Number of rows visited=3</p> 
                  <p>I definitely don't have any explanation for why you are getting<br> this odd behavior; it certainly seems like a bug to me.</p> 
                  <p>-------------END SNIP -----------------------</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/DERBY-3603?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/DERBY-3603?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/DERBY-3603?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/DERBY-3603?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12379935" data-issue-id="12393362" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12379935/d3603_v1.patch" draggable="true" data-downloadurl="text/x-diff:d3603_v1.patch:https://issues.apache.org/jira/secure/attachment/12379935/d3603_v1.patch"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12379935/d3603_v1.patch" title="Latest  11/Apr/08 17:16 - A B" draggable="true" data-downloadurl="text/x-diff:d3603_v1.patch:https://issues.apache.org/jira/secure/attachment/12379935/d3603_v1.patch">d3603_v1.patch</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-04-11T17:16:24.688Z">11/Apr/08 17:16</time>
                   </dd>
                   <dd class="attachment-size">
                    5 kB
                   </dd>
                   <dd class="attachment-author">
                    A B
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12380036" data-issue-id="12393362" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12380036/d3603_with_test.diff" draggable="true" data-downloadurl="text/x-patch:d3603_with_test.diff:https://issues.apache.org/jira/secure/attachment/12380036/d3603_with_test.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12380036/d3603_with_test.diff" title="Latest  14/Apr/08 03:08 - Bryan Pendleton" draggable="true" data-downloadurl="text/x-patch:d3603_with_test.diff:https://issues.apache.org/jira/secure/attachment/12380036/d3603_with_test.diff">d3603_with_test.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-04-14T03:08:01.139Z">14/Apr/08 03:08</time>
                   </dd>
                   <dd class="attachment-size">
                    8 kB
                   </dd>
                   <dd class="attachment-author">
                    Bryan Pendleton
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12379740" data-issue-id="12393362" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12379740/derbydb.jar" draggable="true" data-downloadurl="application/octet-stream:derbydb.jar:https://issues.apache.org/jira/secure/attachment/12379740/derbydb.jar"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12379740/derbydb.jar" title="Latest  09/Apr/08 15:45 - Kathey Marsden" draggable="true" data-downloadurl="application/octet-stream:derbydb.jar:https://issues.apache.org/jira/secure/attachment/12379740/derbydb.jar">derbydb.jar</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-04-09T15:45:04.394Z">09/Apr/08 15:45</time>
                   </dd>
                   <dd class="attachment-size">
                    425 kB
                   </dd>
                   <dd class="attachment-author">
                    Kathey Marsden
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12379620" data-issue-id="12393362" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12379620/derbydb.tar.bz2" draggable="true" data-downloadurl="application/bzip2:derbydb.tar.bz2:https://issues.apache.org/jira/secure/attachment/12379620/derbydb.tar.bz2"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12379620/derbydb.tar.bz2" title="Latest  08/Apr/08 02:17 - David Butterworth" draggable="true" data-downloadurl="application/bzip2:derbydb.tar.bz2:https://issues.apache.org/jira/secure/attachment/12379620/derbydb.tar.bz2">derbydb.tar.bz2</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-04-08T02:17:45.156Z">08/Apr/08 02:17</time>
                   </dd>
                   <dd class="attachment-size">
                    232 kB
                   </dd>
                   <dd class="attachment-author">
                    David Butterworth
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12380037" data-issue-id="12393362" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12380037/subqueryFlattening.diff" draggable="true" data-downloadurl="text/x-patch:subqueryFlattening.diff:https://issues.apache.org/jira/secure/attachment/12380037/subqueryFlattening.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12380037/subqueryFlattening.diff" title="Latest  14/Apr/08 03:08 - Bryan Pendleton" draggable="true" data-downloadurl="text/x-patch:subqueryFlattening.diff:https://issues.apache.org/jira/secure/attachment/12380037/subqueryFlattening.diff">subqueryFlattening.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-04-14T03:08:01.180Z">14/Apr/08 03:08</time>
                   </dd>
                   <dd class="attachment-size">
                    2 kB
                   </dd>
                   <dd class="attachment-author">
                    Bryan Pendleton
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12380236" data-issue-id="12393362" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12380236/updateSubqueryMaster.diff" draggable="true" data-downloadurl="text/x-patch:updateSubqueryMaster.diff:https://issues.apache.org/jira/secure/attachment/12380236/updateSubqueryMaster.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12380236/updateSubqueryMaster.diff" title="Latest  16/Apr/08 01:23 - Bryan Pendleton" draggable="true" data-downloadurl="text/x-patch:updateSubqueryMaster.diff:https://issues.apache.org/jira/secure/attachment/12380236/updateSubqueryMaster.diff">updateSubqueryMaster.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2008-04-16T01:23:01.079Z">16/Apr/08 01:23</time>
                   </dd>
                   <dd class="attachment-size">
                    12 kB
                   </dd>
                   <dd class="attachment-author">
                    Bryan Pendleton
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_bryanpendleton" rel="bryanpendleton" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Bryan Pendleton&quot;,&quot;emailAddress&quot;:&quot;bpendleton.derby@gmail.com&quot;,&quot;username&quot;:&quot;bryanpendleton&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="bryanpendleton"></span></span> Bryan Pendleton </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_eldavio" rel="eldavio" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;David Butterworth&quot;,&quot;emailAddress&quot;:&quot;david@economicoutlook.net&quot;,&quot;username&quot;:&quot;eldavio&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="eldavio"></span></span> David Butterworth </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">1</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="08/Apr/08 02:14"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2008-04-08T02:14:51+0000">08/Apr/08 02:14</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="21/Jan/11 17:51"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2011-01-21T17:51:51+0000">21/Jan/11 17:51</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="16/Apr/08 16:05"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2008-04-16T16:05:48+0000">16/Apr/08 16:05</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3603?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3603?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3603?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3603?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3603?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3603?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3603?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3603?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/DERBY-3603?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-3603?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-3603?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/DERBY-3603?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-12586816\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12586816&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12586816\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12586816_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12586816_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/08 14:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-08T14:29:12+0000\'\u003e08\\/Apr\\/08 14:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThis is a regression introduced between 10.3.1.4 and 10.3.2.1.\u003c\\/p\u003e\\n\\n\u003cp\u003eI ran the queries on 10.3.1.4 with the provided database snapshot, and they both return 3 rows on 10.3.1.4, but 2 rows for 10.3.2.1.\u003c\\/p\u003e\\n\\n\u003cp\u003e&#8212; \u003cspan class=\\\"error\\\"\u003e&#91;10.3.1.4&#93;\u003c\\/span\u003e snip snip &#8212;\u003cbr\\/\u003e\\nij&gt; select count\u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/star_yellow.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e FROM spike.accounts account, spike.admin_units admin_unit,\u003cbr\\/\u003e\\n    spike.bookings booking\u003cbr\\/\u003e\\n    WHERE booking.child_id = 2 AND\u003cbr\\/\u003e\\n    admin_unit.admin_unit_id IN (1,21) AND\u003cbr\\/\u003e\\n    booking.booking_date_time_out &gt;= 20080331000000 AND\u003cbr\\/\u003e\\n    booking.booking_date_time_in &lt;= 20080406235900 AND\u003cbr\\/\u003e\\n    account.account_id = booking.account_id AND\u003cbr\\/\u003e\\n    admin_unit.admin_unit_id = account.admin_unit_id;\u003cbr\\/\u003e\\n1\u003cbr\\/\u003e\\n-----------\u003cbr\\/\u003e\\n3\u003c\\/p\u003e\\n\\n\u003cp\u003e1 row selected\u003cbr\\/\u003e\\nij&gt; select count\u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/star_yellow.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e FROM spike.accounts account, spike.admin_units admin_unit,\u003cbr\\/\u003e\\n    spike.bookings booking\u003cbr\\/\u003e\\n    WHERE booking.child_id = 2 AND\u003cbr\\/\u003e\\n    account.admin_unit_id IN (1,21) AND\u003cbr\\/\u003e\\n    booking.booking_date_time_out &gt;= 20080331000000 AND\u003cbr\\/\u003e\\n    booking.booking_date_time_in &lt;= 20080406235900 AND\u003cbr\\/\u003e\\n    account.account_id = booking.account_id AND\u003cbr\\/\u003e\\n    admin_unit.admin_unit_id = account.admin_unit_id;\u003cbr\\/\u003e\\n1\u003cbr\\/\u003e\\n-----------\u003cbr\\/\u003e\\n3\u003c\\/p\u003e\\n\\n\u003cp\u003e1 row selected\u003cbr\\/\u003e\\n&#8212; snip snip &#8212;\u003c\\/p\u003e\\n\\n\u003cp\u003eHopefully someone with more historical insight may know what issue could have caused this sideeffect?\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12586816_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12586816_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/08 14:29\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-08T14:29:12+0000\'\u003e08\\/Apr\\/08 14:29\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    This is a regression introduced between 10.3.1.4 and 10.3.2.1. \\n\\n I ran the queries on 10.3.1.4 with the provided database snapshot, and they both return 3 rows on 10.3.1.4, but 2 rows for 10.3.2.1. \\n\\n &#8212;  &#91;10.3.1.4&#93;  snip snip &#8212; \\nij&gt; select count  FROM spike.accounts account, spike.admin_units admin_unit, \\n    spike.bookings booking \\n    WHERE booking.child_id = 2 AND \\n    admin_unit.admin_unit_id IN (1,21) AND \\n    booking.booking_date_time_out &gt;= 20080331000000 AND \\n    booking.booking_date_time_in &lt;= 20080406235900 AND \\n    account.account_id = booking.account_id AND \\n    admin_unit.admin_unit_id = account.admin_unit_id; \\n1 \\n----------- \\n3 \\n\\n 1 row selected \\nij&gt; select count  FROM spike.accounts account, spike.admin_units admin_unit, \\n    spike.bookings booking \\n    WHERE booking.child_id = 2 AND \\n    account.admin_unit_id IN (1,21) AND \\n    booking.booking_date_time_out &gt;= 20080331000000 AND \\n    booking.booking_date_time_in &lt;= 20080406235900 AND \\n    account.account_id = booking.account_id AND \\n    admin_unit.admin_unit_id = account.admin_unit_id; \\n1 \\n----------- \\n3 \\n\\n 1 row selected \\n&#8212; snip snip &#8212; \\n\\n Hopefully someone with more historical insight may know what issue could have caused this sideeffect?              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12586850\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12586850&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12586850\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12586850_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12586850_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/08 15:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-08T15:35:11+0000\'\u003e08\\/Apr\\/08 15:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; This is a regression introduced between 10.3.1.4 and 10.3.2.1.\u003c\\/p\u003e\\n\\n\u003cp\u003eI wonder if this was caused by \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3061\\\" title=\\\"Wrong results from query with two conjuncts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3061\\\"\u003e\u003cdel\u003eDERBY-3061\u003c\\/del\u003e\u003c\\/a\u003e, which was an IN list change that went into 10.3.2.1 (and 10.4) but was not in 10.3.1.4?  I don\'t have a lot of time on my hands right now, but perhaps I can investigate later this evening (PST).  That said, if anyone else has more cycles to investigate, that\'d be great....\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12586850_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12586850_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/08 15:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-08T15:35:11+0000\'\u003e08\\/Apr\\/08 15:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; This is a regression introduced between 10.3.1.4 and 10.3.2.1. \\n\\n I wonder if this was caused by   DERBY-3061  , which was an IN list change that went into 10.3.2.1 (and 10.4) but was not in 10.3.1.4?  I don\'t have a lot of time on my hands right now, but perhaps I can investigate later this evening (PST).  That said, if anyone else has more cycles to investigate, that\'d be great....              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12586863\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12586863&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12586863\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12586863_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12586863_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/08 16:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-08T16:00:09+0000\'\u003e08\\/Apr\\/08 16:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eUnchecking Existing Application Impact, because that means the solution will impact existing applications.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12586863_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12586863_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/08 16:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-08T16:00:09+0000\'\u003e08\\/Apr\\/08 16:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Unchecking Existing Application Impact, because that means the solution will impact existing applications.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12586916\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12586916&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12586916\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12586916_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12586916_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/08 18:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-08T18:09:44+0000\'\u003e08\\/Apr\\/08 18:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI verified on the 10.3 branch that this was indeed related to \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3061\\\" title=\\\"Wrong results from query with two conjuncts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3061\\\"\u003e\u003cdel\u003eDERBY-3061\u003c\\/del\u003e\u003c\\/a\u003e (svn 574730).  Prior to that change, both queries return \\\"3\\\".\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12586916_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12586916_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Apr\\/08 18:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-08T18:09:44+0000\'\u003e08\\/Apr\\/08 18:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I verified on the 10.3 branch that this was indeed related to   DERBY-3061   (svn 574730).  Prior to that change, both queries return \\\"3\\\".              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12587030\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12587030&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12587030\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12587030_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587030_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 01:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T01:48:13+0000\'\u003e09\\/Apr\\/08 01:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eJust for completeness, I repeated Kathey\'s experiment on the trunk;\u003cbr\\/\u003e\\nI backed out the \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3061\\\" title=\\\"Wrong results from query with two conjuncts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3061\\\"\u003e\u003cdel\u003eDERBY-3061\u003c\\/del\u003e\u003c\\/a\u003e change and the query then returns 3 rows.\u003cbr\\/\u003e\\nSo that\'s more evidence that \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3061\\\" title=\\\"Wrong results from query with two conjuncts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3061\\\"\u003e\u003cdel\u003eDERBY-3061\u003c\\/del\u003e\u003c\\/a\u003e\'s change is relevant, but I\'m\u003cbr\\/\u003e\\nafraid I don\'t have any theories to contribute about why that is.\u003c\\/p\u003e\\n\\n\u003cp\u003eI do notice that in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3061\\\" title=\\\"Wrong results from query with two conjuncts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3061\\\"\u003e\u003cdel\u003eDERBY-3061\u003c\\/del\u003e\u003c\\/a\u003e, the query in question has two conditions\u003cbr\\/\u003e\\non the same column, where one is clearly \\\"stronger\\\" than the other:\u003c\\/p\u003e\\n\\n\u003cp\u003e   where mytable.id &lt; 100\u003cbr\\/\u003e\\n   and mytable.id in ( 2, 15, 19, 20, 21, 48, 49 );\u003c\\/p\u003e\\n\\n\u003cp\u003eHowever, in this issue, the query in question has two conditions on the\u003cbr\\/\u003e\\nsame column, where both conditions should (apparently) be of the same\u003cbr\\/\u003e\\n\\\"strength\\\", since both are (according to the \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3061\\\" title=\\\"Wrong results from query with two conjuncts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3061\\\"\u003e\u003cdel\u003eDERBY-3061\u003c\\/del\u003e\u003c\\/a\u003e changes) to be\u003cbr\\/\u003e\\ntreated as equality:\u003c\\/p\u003e\\n\\n\u003cp\u003e   WHERE   admin_unit.admin_unit_id IN (1,21) AND\u003cbr\\/\u003e\\n      admin_unit.admin_unit_id = account.admin_unit_id; \u003c\\/p\u003e\\n\\n\u003cp\u003eThis similarity in query structure appears to explain why the \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3061\\\" title=\\\"Wrong results from query with two conjuncts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3061\\\"\u003e\u003cdel\u003eDERBY-3061\u003c\\/del\u003e\u003c\\/a\u003e\u003cbr\\/\u003e\\nchanges are relevant.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12587030_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587030_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 01:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T01:48:13+0000\'\u003e09\\/Apr\\/08 01:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Just for completeness, I repeated Kathey\'s experiment on the trunk; \\nI backed out the   DERBY-3061   change and the query then returns 3 rows. \\nSo that\'s more evidence that   DERBY-3061  \'s change is relevant, but I\'m \\nafraid I don\'t have any theories to contribute about why that is. \\n\\n I do notice that in   DERBY-3061  , the query in question has two conditions \\non the same column, where one is clearly \\\"stronger\\\" than the other: \\n\\n    where mytable.id &lt; 100 \\n   and mytable.id in ( 2, 15, 19, 20, 21, 48, 49 ); \\n\\n However, in this issue, the query in question has two conditions on the \\nsame column, where both conditions should (apparently) be of the same \\n\\\"strength\\\", since both are (according to the   DERBY-3061   changes) to be \\ntreated as equality: \\n\\n    WHERE   admin_unit.admin_unit_id IN (1,21) AND \\n      admin_unit.admin_unit_id = account.admin_unit_id;  \\n\\n This similarity in query structure appears to explain why the   DERBY-3061   \\nchanges are relevant. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12587138\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12587138&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12587138\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12587138_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587138_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 10:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T10:54:39+0000\'\u003e09\\/Apr\\/08 10:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Thomas Nielsen - 09\\/Apr\\/08 11:05\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3061\\\" title=\\\"Wrong results from query with two conjuncts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3061\\\"\u003e\u003cdel\u003eDERBY-3061\u003c\\/del\u003e\u003c\\/a\u003e adds a check for \\\"otherPred.isInListProbePredicate()\\\". This again checks andNode.leftOperand.isInListProbePredicate().\u003cbr\\/\u003e\\nIt is a possibility that in this case we neglect that there is a equivalent rightOperand (it\'s not simply a true as might be expected) - but I haven\'t verified this yet.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe idea is that certain ordering of the elements effectively place the join on either the left or right side, causing it to be incorrectly evaluated if it ends up on the wrong side - which ever side that may be.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12587138_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587138_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 10:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T10:54:39+0000\'\u003e09\\/Apr\\/08 10:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Thomas Nielsen - 09\\/Apr\\/08 11:05\\\"\u003eedited\u003c\\/span\u003e                     DERBY-3061   adds a check for \\\"otherPred.isInListProbePredicate()\\\". This again checks andNode.leftOperand.isInListProbePredicate(). \\nIt is a possibility that in this case we neglect that there is a equivalent rightOperand (it\'s not simply a true as might be expected) - but I haven\'t verified this yet. \\n\\n The idea is that certain ordering of the elements effectively place the join on either the left or right side, causing it to be incorrectly evaluated if it ends up on the wrong side - which ever side that may be.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12587193\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12587193&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12587193\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12587193_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587193_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 13:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T13:56:48+0000\'\u003e09\\/Apr\\/08 13:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Thomas Nielsen - 09\\/Apr\\/08 14:05\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eRan the queries through the debugger to see if there were any obvious errors.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe only obvious difference I see is that the 2-row result query (S2), enters the procedure changed by \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3061\\\" title=\\\"Wrong results from query with two conjuncts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3061\\\"\u003e\u003cdel\u003eDERBY-3061\u003c\\/del\u003e\u003c\\/a\u003e a total of 4 times during optimization, while the 3-row result query (S3) only enters a single time. The callstacks are identical for the S2 and S3 queries in all 5 invocations. This could mean part of the IN list is optimized away in S2. If one optimizer path in S2 does not take all rows into consideration it will probably be a lot cheaper, and will be used, resulting in an incomplete result.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12587193_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587193_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 13:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T13:56:48+0000\'\u003e09\\/Apr\\/08 13:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Thomas Nielsen - 09\\/Apr\\/08 14:05\\\"\u003eedited\u003c\\/span\u003e                   Ran the queries through the debugger to see if there were any obvious errors. \\n\\n The only obvious difference I see is that the 2-row result query (S2), enters the procedure changed by   DERBY-3061   a total of 4 times during optimization, while the 3-row result query (S3) only enters a single time. The callstacks are identical for the S2 and S3 queries in all 5 invocations. This could mean part of the IN list is optimized away in S2. If one optimizer path in S2 does not take all rows into consideration it will probably be a lot cheaper, and will be used, resulting in an incomplete result.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12587196\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12587196&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12587196\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12587196_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587196_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 14:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T14:00:11+0000\'\u003e09\\/Apr\\/08 14:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003e&gt; the join on either the left or right side, causing it to be incorrectly evaluated if it ends up on the wrong side\u003c\\/p\u003e\\n\\n\u003cp\u003eThat\'s a very intriguing theory, seems quite plausible, and worth following up. Interesting!\u003c\\/p\u003e\\n\\n\u003cp\u003eThe other thing I was thinking about is that if I change the query to just IN (1) rather\u003cbr\\/\u003e\\nthan IN (1,21), then the problem does not occur. So I was wondering if the problem\u003cbr\\/\u003e\\nmight be that Predicate.java is now comparing the two predicates as \u003cb\u003eexactly\u003c\\/b\u003e equal,\u003cbr\\/\u003e\\nrather than just \\\"equal enough for sorting during optimization\\\", and hence was seeing\u003cbr\\/\u003e\\nthe IN (1,21) predicate, at some point, as being redundant with the join criterion and\u003cbr\\/\u003e\\nwas optimizing it entirely away.\u003c\\/p\u003e\\n\\n\u003cp\u003eNormally, erroneously optimizing away an entire predicate would cause us to get\u003cbr\\/\u003e\\nmore results, not fewer, but in this case the IN (1,21) predicate is effectively an \\\"OR\\\"\u003cbr\\/\u003e\\nclause and so if we lost it, or maybe lost one \\\"branch\\\" of it, the result might have\u003cbr\\/\u003e\\nfewer rows than we expected.\u003c\\/p\u003e\\n\\n\u003cp\u003eHowever, I tried breaking the \\\"bad\\\" query (the one that returns 2 rows) into 2 queries, \u003cbr\\/\u003e\\none with IN (1) and one with IN (21), and got the following results:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003equery stating IN (1): count = 3\u003c\\/li\u003e\\n\\t\u003cli\u003equery stating IN (21): count = 0\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eSo rows with admin_unit_id = 21 don\'t appear to be relevant to the actual results of\u003cbr\\/\u003e\\nthis query. I think that probably means this theory is not worth pursuing, but I\u003cbr\\/\u003e\\nfigured I\'d post it anyway in case it was useful to others.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12587196_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587196_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 14:00\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T14:00:11+0000\'\u003e09\\/Apr\\/08 14:00\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    &gt; the join on either the left or right side, causing it to be incorrectly evaluated if it ends up on the wrong side \\n\\n That\'s a very intriguing theory, seems quite plausible, and worth following up. Interesting! \\n\\n The other thing I was thinking about is that if I change the query to just IN (1) rather \\nthan IN (1,21), then the problem does not occur. So I was wondering if the problem \\nmight be that Predicate.java is now comparing the two predicates as  exactly  equal, \\nrather than just \\\"equal enough for sorting during optimization\\\", and hence was seeing \\nthe IN (1,21) predicate, at some point, as being redundant with the join criterion and \\nwas optimizing it entirely away. \\n\\n Normally, erroneously optimizing away an entire predicate would cause us to get \\nmore results, not fewer, but in this case the IN (1,21) predicate is effectively an \\\"OR\\\" \\nclause and so if we lost it, or maybe lost one \\\"branch\\\" of it, the result might have \\nfewer rows than we expected. \\n\\n However, I tried breaking the \\\"bad\\\" query (the one that returns 2 rows) into 2 queries,  \\none with IN (1) and one with IN (21), and got the following results: \\n \\n\\t query stating IN (1): count = 3 \\n\\t query stating IN (21): count = 0 \\n \\n\\n\\n So rows with admin_unit_id = 21 don\'t appear to be relevant to the actual results of \\nthis query. I think that probably means this theory is not worth pursuing, but I \\nfigured I\'d post it anyway in case it was useful to others.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12587239\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12587239&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12587239\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12587239_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587239_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 15:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T15:37:22+0000\'\u003e09\\/Apr\\/08 15:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for the investigation, Bryan and Thomas!  I was hoping to look more into this last night but was hit by a freak migraine that knocked me out early.  It\'s great to see that some work is still happening, though.\u003c\\/p\u003e\\n\\n\u003cp\u003ebryan&gt; The other thing I was thinking about is that if I change the query to just IN (1) rather\u003cbr\\/\u003e\\nbryan&gt; than IN (1,21), then the problem does not occur. \u003c\\/p\u003e\\n\\n\u003cp\u003eJust a quick note that when the IN list only has a single value, it is transformed into a normal equality predicate.  See InListOperatorNode.preprocess(...).  So in that case IN-list \\\"multi-probing\\\" processing, which appears to be where the underlying bug resides, does not come into play.  That could be why things work correctly in that case...\u003c\\/p\u003e\\n\\n\u003cp\u003ethomas&gt; It is a possibility that in this case we neglect that there is a equivalent rightOperand\u003cbr\\/\u003e\\nthomas&gt; (it\'s not simply a true as might be expected)\u003c\\/p\u003e\\n\\n\u003cp\u003eWithout having done any tracing myself, I agree with both of you: this seems worth pursuing...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12587239_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587239_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 15:37\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T15:37:22+0000\'\u003e09\\/Apr\\/08 15:37\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for the investigation, Bryan and Thomas!  I was hoping to look more into this last night but was hit by a freak migraine that knocked me out early.  It\'s great to see that some work is still happening, though. \\n\\n bryan&gt; The other thing I was thinking about is that if I change the query to just IN (1) rather \\nbryan&gt; than IN (1,21), then the problem does not occur.  \\n\\n Just a quick note that when the IN list only has a single value, it is transformed into a normal equality predicate.  See InListOperatorNode.preprocess(...).  So in that case IN-list \\\"multi-probing\\\" processing, which appears to be where the underlying bug resides, does not come into play.  That could be why things work correctly in that case... \\n\\n thomas&gt; It is a possibility that in this case we neglect that there is a equivalent rightOperand \\nthomas&gt; (it\'s not simply a true as might be expected) \\n\\n Without having done any tracing myself, I agree with both of you: this seems worth pursuing...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12587243\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12587243&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12587243\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12587243_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587243_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 15:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T15:45:04+0000\'\u003e09\\/Apr\\/08 15:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttaching jarred up db for easier access.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_12587243_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587243_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Apr\\/08 15:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-09T15:45:04+0000\'\u003e09\\/Apr\\/08 15:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attaching jarred up db for easier access.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12587894\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12587894&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12587894\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12587894_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587894_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Apr\\/08 09:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-11T09:17:05+0000\'\u003e11\\/Apr\\/08 09:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLooking at the queryplans I see something quite interesting.\u003c\\/p\u003e\\n\\n\u003cp\u003eBoth queries S2 and S3 end up with the same query plan. The top looking like this:\u003c\\/p\u003e\\n\\n\u003cp\u003e                              Scalar\u003c\\/p\u003e\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\u003cp\u003e                                 PRN\u003c\\/p\u003e\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\u003cp\u003e                     NestedLoop ExistsJoin\u003cbr\\/\u003e\\n                              \\/                     \\\\\u003cbr\\/\u003e\\nNestedLoopExistsJoin        IndexScanResultSet\u003cbr\\/\u003e\\n   \\/         \\\\                                          |\u003cbr\\/\u003e\\n...           ...                                      ...\u003c\\/p\u003e\\n\\n\u003cp\u003eThe interesting stuff happens in the lower, right-hand IndexScanResultSet (let\'s call it ISR1)\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the correct 3-row query S3, ISR1 sees 3 rows and qualifies 3 rows.\u003cbr\\/\u003e\\nIn the incorrect 2-row query S2, ISR1 seens 3 rows, but only qualifies 2 of them.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo for S2, this becomes\u003cbr\\/\u003e\\n                              Scalar\u003cbr\\/\u003e\\n                                 (\\\"2\\\")\u003c\\/p\u003e\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\u003cp\u003e                                 PRN\u003cbr\\/\u003e\\n                               (2 rows)\u003c\\/p\u003e\\n\u003cdiv class=\'table-wrap\'\u003e\\n\u003ctable class=\'confluenceTable\'\u003e\u003ctbody\u003e\\n\u003ctr\u003e\\n\u003c\\/tr\u003e\\n\u003c\\/tbody\u003e\u003c\\/table\u003e\\n\u003c\\/div\u003e\\n\\n\u003cp\u003e                     NestedLoop ExistsJoin\u003cbr\\/\u003e\\n                    (3 rows L, 2 rows R)\u003cbr\\/\u003e\\n                              \\/                     \\\\\u003cbr\\/\u003e\\nNestedLoopExistsJoin        IndexScanResultSet\u003cbr\\/\u003e\\n(3 rows L, 3 rows R)             (sees 3 rows, qualifies 2 rows)\u003cbr\\/\u003e\\n   \\/         \\\\                                          |\u003cbr\\/\u003e\\n...           ...                                      ...\u003c\\/p\u003e\\n\\n\u003cp\u003eThe query plan for both S2 and S3 state that ISR1 is an\u003cbr\\/\u003e\\n\\\"Index Scan ResultSet for ADMIN_UNITS using constraint ADMIN_UNIT_ID_PK at read committed isolation level using share row locking chosen by the optimizer\\\".\u003c\\/p\u003e\\n\\n\u003cp\u003eNext task would be to find out why ISR1 rejects\\/discards the third row in S2, and not in S3.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12587894_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587894_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Apr\\/08 09:17\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-11T09:17:05+0000\'\u003e11\\/Apr\\/08 09:17\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Looking at the queryplans I see something quite interesting. \\n\\n Both queries S2 and S3 end up with the same query plan. The top looking like this: \\n\\n                               Scalar \\n \\n  \\n \\n \\n  \\n \\n\\n                                  PRN \\n \\n  \\n \\n \\n  \\n \\n\\n                      NestedLoop ExistsJoin \\n                              \\/                     \\\\ \\nNestedLoopExistsJoin        IndexScanResultSet \\n   \\/         \\\\                                          | \\n...           ...                                      ... \\n\\n The interesting stuff happens in the lower, right-hand IndexScanResultSet (let\'s call it ISR1) \\n\\n In the correct 3-row query S3, ISR1 sees 3 rows and qualifies 3 rows. \\nIn the incorrect 2-row query S2, ISR1 seens 3 rows, but only qualifies 2 of them. \\n\\n So for S2, this becomes \\n                              Scalar \\n                                 (\\\"2\\\") \\n \\n  \\n \\n \\n  \\n \\n\\n                                  PRN \\n                               (2 rows) \\n \\n  \\n \\n \\n  \\n \\n\\n                      NestedLoop ExistsJoin \\n                    (3 rows L, 2 rows R) \\n                              \\/                     \\\\ \\nNestedLoopExistsJoin        IndexScanResultSet \\n(3 rows L, 3 rows R)             (sees 3 rows, qualifies 2 rows) \\n   \\/         \\\\                                          | \\n...           ...                                      ... \\n\\n The query plan for both S2 and S3 state that ISR1 is an \\n\\\"Index Scan ResultSet for ADMIN_UNITS using constraint ADMIN_UNIT_ID_PK at read committed isolation level using share row locking chosen by the optimizer\\\". \\n\\n Next task would be to find out why ISR1 rejects\\/discards the third row in S2, and not in S3.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12587919\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12587919&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12587919\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12587919_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587919_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Apr\\/08 10:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-11T10:41:28+0000\'\u003e11\\/Apr\\/08 10:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSeems my comment formatting was messed up - doesn\'t really matter \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the debugger I can see that the problem is actually located in the uppermost NestedLoopExistsJoin of the queryplan (which really is a NestedLoopJoinResultSet), having its oneRowRightSide incorrectly set to true. We are looking for the set (1,21), so the right hand side should not have a single result row in this particular case. Changing this to false in the debugger cause the query to return the correct 3 rows for S2.\u003c\\/p\u003e\\n\\n\u003cp\u003eNext question should then be - why was oneRowRightSide incorrectly set to true?\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12587919_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587919_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Apr\\/08 10:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-11T10:41:28+0000\'\u003e11\\/Apr\\/08 10:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Seems my comment formatting was messed up - doesn\'t really matter   \\n\\n In the debugger I can see that the problem is actually located in the uppermost NestedLoopExistsJoin of the queryplan (which really is a NestedLoopJoinResultSet), having its oneRowRightSide incorrectly set to true. We are looking for the set (1,21), so the right hand side should not have a single result row in this particular case. Changing this to false in the debugger cause the query to return the correct 3 rows for S2. \\n\\n Next question should then be - why was oneRowRightSide incorrectly set to true? \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12587926\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12587926&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12587926\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12587926_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587926_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Apr\\/08 11:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-11T11:06:30+0000\'\u003e11\\/Apr\\/08 11:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eoneRowRightSide is set during code generation for NestedLoopJoinResultSet.\u003c\\/p\u003e\\n\\n\u003cp\u003eThis happens in JoinNode.generateCore(), which ends up with the following callstack:\u003cbr\\/\u003e\\n  org.apache.derby.impl.sql.compile.FromBaseTable.isOneRowResultSet(FromBaseTable.java:4405)\u003cbr\\/\u003e\\n  org.apache.derby.impl.sql.compile.FromBaseTable.isOneRowResultSet(FromBaseTable.java:3825)\u003cbr\\/\u003e\\n  org.apache.derby.impl.sql.compile.IndexToBaseRowNode.isOneRowResultSet(IndexToBaseRowNode.java:316)\u003cbr\\/\u003e\\n  org.apache.derby.impl.sql.compile.SingleChildResultSetNode.isOneRowResultSet(SingleChildResultSetNode.java:531)\u003cbr\\/\u003e\\n  org.apache.derby.impl.sql.compile.JoinNode.oneRowRightSide(JoinNode.java:1691)\u003cbr\\/\u003e\\n  org.apache.derby.impl.sql.compile.JoinNode.getJoinArguments(JoinNode.java:1639)\u003cbr\\/\u003e\\n  org.apache.derby.impl.sql.compile.JoinNode.generateCore(JoinNode.java:1555)\u003cbr\\/\u003e\\n  ...\u003c\\/p\u003e\\n\\n\u003cp\u003eAt this point both the restrictionList and predicateList only have a single entry, forcing us to return true.\u003cbr\\/\u003e\\nSeems we missed a predicate somewhere along the path...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12587926_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12587926_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Apr\\/08 11:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-11T11:06:30+0000\'\u003e11\\/Apr\\/08 11:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    oneRowRightSide is set during code generation for NestedLoopJoinResultSet. \\n\\n This happens in JoinNode.generateCore(), which ends up with the following callstack: \\n  org.apache.derby.impl.sql.compile.FromBaseTable.isOneRowResultSet(FromBaseTable.java:4405) \\n  org.apache.derby.impl.sql.compile.FromBaseTable.isOneRowResultSet(FromBaseTable.java:3825) \\n  org.apache.derby.impl.sql.compile.IndexToBaseRowNode.isOneRowResultSet(IndexToBaseRowNode.java:316) \\n  org.apache.derby.impl.sql.compile.SingleChildResultSetNode.isOneRowResultSet(SingleChildResultSetNode.java:531) \\n  org.apache.derby.impl.sql.compile.JoinNode.oneRowRightSide(JoinNode.java:1691) \\n  org.apache.derby.impl.sql.compile.JoinNode.getJoinArguments(JoinNode.java:1639) \\n  org.apache.derby.impl.sql.compile.JoinNode.generateCore(JoinNode.java:1555) \\n  ... \\n\\n At this point both the restrictionList and predicateList only have a single entry, forcing us to return true. \\nSeems we missed a predicate somewhere along the path...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12588035\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12588035&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12588035\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12588035_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588035_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Apr\\/08 17:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-11T17:16:24+0000\'\u003e11\\/Apr\\/08 17:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe fact that \\\"oneRowRightSide\\\" is true for the NestedLoop join does indeed appear to be important here. Good find, Thomas!  With that in mind I did some tracing of the execution path.  My findings are below.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe query I used for tracing is as follows:\u003c\\/p\u003e\\n\\n\u003cp\u003e  select account.admin_unit_id, account.account_id,\u003cbr\\/\u003e\\n    booking.booking_id, cast (admin_unit.admin_unit_name as varchar(30))\u003cbr\\/\u003e\\n  from spike.accounts account, spike.bookings booking,\u003cbr\\/\u003e\\n  spike.admin_units admin_unit\u003cbr\\/\u003e\\n  where account.account_id = booking.account_id\u003cbr\\/\u003e\\n    and admin_unit.admin_unit_id = account.admin_unit_id\u003cbr\\/\u003e\\n    and admin_unit.admin_unit_id in (1, 21)\u003cbr\\/\u003e\\n    and booking.child_id = 2;\u003c\\/p\u003e\\n\\n\u003cp\u003eWhen I run this query the execution plan shows a join order of:\u003c\\/p\u003e\\n\\n\u003cp\u003e  (ACCOUNTS x BOOKINGS) x ADMIN_UNITS\u003c\\/p\u003e\\n\\n\u003cp\u003eThat is, we join ACCOUNTS and BOOKINGS to get a row R, then for each row R from that join, we join it (R) with a row from ADMIN_UNITS.  Due to the presence of the IN list the optimizer chooses to do multi-probing on ADMIN_UNITS, which means the probe predicate that represents \\\"admin_unit.admin_unit_id IN (1, 21)\\\" becomes the start and stop key.  Since we only allow a single start\\/stop key for any column, the join predicate between ACCOUNTS and ADMIN_UNITS is relegated to being a store qualifier.  This is notable for two reasons: 1) this explains the additional qualifier seen by Bryan in the query plan, and 2) as seen below, this qualifier is what causes the \\\"oneRowRightSide\\\" variable to get set to TRUE for ADMIN_UNITS.\u003c\\/p\u003e\\n\\n\u003cp\u003eAlso note: before the change for \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3061\\\" title=\\\"Wrong results from query with two conjuncts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3061\\\"\u003e\u003cdel\u003eDERBY-3061\u003c\\/del\u003e\u003c\\/a\u003e the optimizer always sorted the join predicate as \\\"stronger\\\" than the probe predicate, and thus always chose the join predicate as the start\\/stop key.  That in turn meant that the probe predicate, which can only be used for probing if it is the start\\/stop key, was \\\"reverted\\\" back to a normal IN list qualifier.  So the problem described below did not show up.  But with \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-3061\\\" title=\\\"Wrong results from query with two conjuncts\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-3061\\\"\u003e\u003cdel\u003eDERBY-3061\u003c\\/del\u003e\u003c\\/a\u003e the probe predicate and the join predicate have the same \\\"strength\\\" and thus the optimizer is free to use either one as the start\\/stop key. In this example it chooses the probe predicate.\u003c\\/p\u003e\\n\\n\u003cp\u003eAll of that said, let\'s take a step back and note that the join between ACCOUNTS and BOOKINGS returns three rows:\u003c\\/p\u003e\\n\\n\u003cp\u003eselect account.admin_unit_id, account.account_id, booking.booking_id\u003cbr\\/\u003e\\n from spike.accounts account, spike.bookings booking\u003cbr\\/\u003e\\n where account.account_id = booking.account_id\u003cbr\\/\u003e\\n and booking.child_id = 2;\u003c\\/p\u003e\\n\\n\u003cp\u003eADMIN_UNIT&amp;|ACCOUNT_ID |BOOKING_ID\u003cbr\\/\u003e\\n-----------------------------------\u003cbr\\/\u003e\\n1          |10         |1\u003cbr\\/\u003e\\n1          |10         |3\u003cbr\\/\u003e\\n1          |10         |4\u003c\\/p\u003e\\n\\n\u003cp\u003eSo now, for \u003cb\u003eeach\u003c\\/b\u003e of the above three rows we want to fetch the matching row from ADMIN_UNITS.  So far so good.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe \\\"oneRowRightSide\\\" variable that Thomas mentioned comes into play because the optimizer thinks that for every outer row, i.e. for each of the three rows shown above, we will have at MOST one matching row from ADMIN_UNITS.  At first I thought this was incorrect--but upon further inspection it turns out be true.  The optimizer deduced this because the predicate refers to a primary key column, which has to be unique. So when we try to fetch a row such that the ADMIN_UNIT_ID column of ADMIN_UNITS equals some value, we will get at most one row back.  And since we have the join predicate as a store qualifier (mentioned above), we know that we \u003cem\u003ewill\u003c\\/em\u003e in fact be trying \\\"to get a row such that the ADMIN_UNIT_ID column of ADMIN_UNITS equals some value\\\", where \\\"some value\\\" will be the ADMIN_UNIT_ID column from the intermediate join table shown above. (Note: the intermediate join table doesn\'t actually exist, it\'s just shown as such for discussion).\u003c\\/p\u003e\\n\\n\u003cp\u003eSo at this point things are still working as expected.  We\'ll take the first row from the intermediate join, i.e. \\\"(1, 10, 1)\\\", and we\'ll do two things.  First we\'ll get the \\\"next\\\" probe value in the list of values.  Since the probe list is \\\"(1, 21)\\\", the next value is \\\"1\\\".  Second, we will see if there is a row in ADMIN_UNITS such that: \u003c\\/p\u003e\\n\\n\u003cp\u003e  a) the ADMIN_UNIT_ID column of the row equals the current probe\u003cbr\\/\u003e\\n     value, which is \\\"1\\\", AND\u003c\\/p\u003e\\n\\n\u003cp\u003e  b) the ADMIN_UNIT_ID column of the row equals the ADMIN_UNIT_ID of\u003cbr\\/\u003e\\n     the outer row, which is \\\"(1, 10, 1)\\\".\u003c\\/p\u003e\\n\\n\u003cp\u003eSince both of these conditions are true, we\'ll return the first row as expected.  So our result at this point is:\u003c\\/p\u003e\\n\\n\u003cp\u003eADMIN_UNIT&amp;|ACCOUNT_ID |BOOKING_ID\u003cbr\\/\u003e\\n-----------------------------------\u003cbr\\/\u003e\\n1          |10         |1\u003c\\/p\u003e\\n\\n\u003cp\u003eNow we attempt to fetch the \\\"next\\\" row from ADMIN_UNITS that matches the outer row \\\"(1, 10, 1)\\\".  But as mentioned earlier, the NestedLoop result set that would do so has \\\"oneRowRightSide\\\" set to TRUE.  This means that the NestedLoop \u003cem\u003eknows\u003c\\/em\u003e it will not find any more rows in ADMIN_UNITS that satsify conditions \\\"a\\\" and \\\"b\\\" shown above.  So instead of going to the table, &gt;&gt;&gt; it just QUITS the scan &lt;&lt;&lt;.  See the following in NestedLoopJoinResultSet:\u003c\\/p\u003e\\n\\n\u003cp\u003e        if (oneRowRightSide &amp;&amp; returnedRowMatchingRightSide)\u003c\\/p\u003e\\n        {\\n            rightRow = null;\\n            returnedRowMatchingRightSide = false;\\n        }\\n\\n\u003cp\u003eSo we quit the inner scan of ADMIN_UNITS, which leads us to get the next \\\"outer\\\" row from the intermediate join rows shown earlier.  I.e.  we\'ll now set our outer row to be \\\"(1, 10, 3)\\\".  Then we\'ll execute:\u003c\\/p\u003e\\n\\n\u003cp\u003e        if (leftRow == null)\u003c\\/p\u003e\\n        {\\n            closeRight();\\n        }\\n\u003cp\u003e        else\u003c\\/p\u003e\\n        {\\n            rowsSeenLeft++;\\n            openRight();\\n        }\\n\\n\u003cp\u003e\\\"leftRow\\\" here is the same as \\\"outer\\\" row, so it is \\\"(1, 10, 3)\\\" at this point.  Since it\'s not null we\'ll re-open the scan on ADMIN_UNITS, per the \\\"else\\\" branch.  Then, similar to what we did with the first outer row, we\'ll get the \\\"next\\\" probe value in the list of values for ADMIN_UNITS.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut this is where the problem occurs.  When we \\\"quit\\\" the scan in the above IF statement we left the MultiProbe result set in the middle of a scan.  So when we make the call to re-open the scan, we need to RESET the probing state.  But the code in MultiProbeTableScanResultSet does not currently do that.  More on that below.\u003c\\/p\u003e\\n\\n\u003cp\u003eFor the current codeline we do \u003cb\u003enot\u003c\\/b\u003e reset the probe scan, and thus the next probe value we see is \\\"21\\\", from the list (1, 21).  With that we will then try to get a row from ADMIN_UNIT_ID such that:\u003c\\/p\u003e\\n\\n\u003cp\u003e  a) the ADMIN_UNIT_ID column of the row equals the current probe\u003cbr\\/\u003e\\n     value, which is &gt;&gt;&gt; \\\"21\\\" &lt;&lt;&lt;, AND\u003c\\/p\u003e\\n\\n\u003cp\u003e  b) the ADMIN_UNIT_ID column of the row equals the ADMIN_UNIT_ID of\u003cbr\\/\u003e\\n     the outer row, which is \\\"(1, 10, 3)\\\".\u003c\\/p\u003e\\n\\n\u003cp\u003eBut ADMIN_UNITS does not contain any rows which satisfy condition \\\"a\\\", so we will not return a row. Having no row from ADMIN_UNITS, we go on to fetch the next \\\"outer\\\" row from the intermediate join table, meaning we end up with \\\"(1, 10, 4)\\\".  So we\'ll use that outer row and do what we did with the others: i.e. First we\'ll get the next probe value in the list of values.  The logic in MultiProbeTableScan result set sees that we have exhaused the probe list at this point, so \u003cb\u003eNOW\u003c\\/b\u003e it RESETS the probing state.  After that it gets the \\\"next\\\" probe value, which is the first value in the list (again), and thus we end up with a probe value of \\\"1\\\".  Second, we will see if there is a row in ADMIN_UNITS such that:\u003c\\/p\u003e\\n\\n\u003cp\u003e  a) the ADMIN_UNIT_ID column of the row equals the current probe\u003cbr\\/\u003e\\n     value, which is \\\"1\\\", AND\u003c\\/p\u003e\\n\\n\u003cp\u003e  b) the ADMIN_UNIT_ID column of the row equals the ADMIN_UNIT_ID of\u003cbr\\/\u003e\\n     the outer row, which is \\\"(1, 10, 4)\\\".\u003c\\/p\u003e\\n\\n\u003cp\u003eSince both of these conditions are true, we\'ll return the row as expected.  So our result at this point is:\u003c\\/p\u003e\\n\\n\u003cp\u003eADMIN_UNIT&amp;|ACCOUNT_ID |BOOKING_ID\u003cbr\\/\u003e\\n-----------------------------------\u003cbr\\/\u003e\\n1          |10         |1\u003cbr\\/\u003e\\n1          |10         |4\u003c\\/p\u003e\\n\\n\u003cp\u003eAnd that\'s how the query ends--missing a row.\u003c\\/p\u003e\\n\\n\u003cp\u003eSo what\'s going on with MultiProbeTableScanResultSet?  There are some comments in the \\\"reopenCore()\\\" method of that class which explain a) why we do NOT reset the probe state in some cases, and b) why we DO reset the probe state in others.  For reference the comment is:\u003c\\/p\u003e\\n\\n\u003cp\u003e     \\/* There are two scenarios for which we reopen this kind of scan:\u003cbr\\/\u003e\\n      *\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eA - The first is for join processing.  In this case we have\u003c\\/li\u003e\\n\\t\u003cli\u003ea(nother) row from some outer table and we want to reopen this\u003c\\/li\u003e\\n\\t\u003cli\u003escan to look for rows matching the new outer row.\u003cbr\\/\u003e\\n      *\u003c\\/li\u003e\\n\\t\u003cli\u003eB - The second is for multi-probing.  Here we want to reopen\u003c\\/li\u003e\\n\\t\u003cli\u003ethe scan on this table to look for rows matching the next value\u003c\\/li\u003e\\n\\t\u003cli\u003ein the probe list.\u003cbr\\/\u003e\\n      *\u003c\\/li\u003e\\n\\t\u003cli\u003eIf we are reopening the scan for scenario A (join processing)\u003c\\/li\u003e\\n\\t\u003cli\u003ethen we need to reset our position within the probe list.\u003c\\/li\u003e\\n\\t\u003cli\u003eIf we are reopening the scan for scenario B then we do \u003cb\u003enot\u003c\\/b\u003e\u003c\\/li\u003e\\n\\t\u003cli\u003ewant to reset our position within the probe list because that\u003c\\/li\u003e\\n\\t\u003cli\u003eposition tells us where to find the next probe value.\u003cbr\\/\u003e\\n      *\u003c\\/li\u003e\\n\\t\u003cli\u003eThe way we tell the difference between the two scenarios is\u003c\\/li\u003e\\n\\t\u003cli\u003eby looking at our current position in the probe list (i.e. the\u003c\\/li\u003e\\n\\t\u003cli\u003evalue of probeValIndex): if our current position is beyond the\u003c\\/li\u003e\\n\\t\u003cli\u003elength of the probe list then we know that we are reopening the\u003c\\/li\u003e\\n\\t\u003cli\u003escan for scenario A.  Or put another away, we should never get\u003c\\/li\u003e\\n\\t\u003cli\u003ehere for scenario B if probeValIndex is greater than or equal\u003c\\/li\u003e\\n\\t\u003cli\u003eto the length of the probe list.  The reason is that the call\u003c\\/li\u003e\\n\\t\u003cli\u003eto reopenCore() for scenario B will only ever happen when\u003c\\/li\u003e\\n\\t\u003cli\u003emoreInListVals() returns true--and in that case we know that\u003c\\/li\u003e\\n\\t\u003cli\u003eprobeValIndex will be less than the length of the probeValues.\u003cbr\\/\u003e\\n      *\\/\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eThis comment states one thing and assumes another. First it states (correctly) that if our current position is beyond the length of the probe list then we must be seeing scenario A.  It then goes on to assume (incorrectly) that if the current position is LESS than the length of the probe list we must be seeing scenario B.  It turns out that this is \u003cb\u003eNOT\u003c\\/b\u003e true.  The reason it is not true is because of the \\\"oneRowRightSide\\\" processing described above: when that flag is set to true we quit the scan early, meaning that the current probe position will in fact be less than the length of the probe list.  Then we later come back with a(nother) row from the outer table (i.e. the intermediate join table shown above) and \\\"we want to reopen this scan to look for rows matching the new outer row\\\".  That means we need to reset the probe state: but due to the incorrect assumption, we don\'t reset it.  The result is incorrect results as described above.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m attaching a first attempt at a fix, d3603_v1.patch.  With this patch applied the repro case correctly returns three rows.  The patch does not include a test case and I don\'t know yet if it passes the regression tests.  I\'m running them now but they won\'t complete for several more hours.  So far the lang\\/subqueryFlattening test has failed with a plan diff, which may require some investigation...\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'m still quite limited on time so if it is agreed that this is the correct fix (or at least, the right direction), it\'d be great if someone could add the test and take it to completion--esp. if it could happen before the next 10.4 release candidate.  If no one picks it up I\'ll try to get to it sometime next week, but probably not in time for the second RC...\u003c\\/p\u003e\\n\\n\u003cp\u003eRegardless of whether or not this writeup proves correct, many thanks again to Bryan and Thomas for their investigation and comments.  As no one officially assigned the issue to him\\/herself I spent some time investigating, as written above.  I hope I didn\'t step on anyone\'s toes in the process.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12588035_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588035_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'11\\/Apr\\/08 17:16\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-11T17:16:24+0000\'\u003e11\\/Apr\\/08 17:16\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The fact that \\\"oneRowRightSide\\\" is true for the NestedLoop join does indeed appear to be important here. Good find, Thomas!  With that in mind I did some tracing of the execution path.  My findings are below. \\n\\n The query I used for tracing is as follows: \\n\\n   select account.admin_unit_id, account.account_id, \\n    booking.booking_id, cast (admin_unit.admin_unit_name as varchar(30)) \\n  from spike.accounts account, spike.bookings booking, \\n  spike.admin_units admin_unit \\n  where account.account_id = booking.account_id \\n    and admin_unit.admin_unit_id = account.admin_unit_id \\n    and admin_unit.admin_unit_id in (1, 21) \\n    and booking.child_id = 2; \\n\\n When I run this query the execution plan shows a join order of: \\n\\n   (ACCOUNTS x BOOKINGS) x ADMIN_UNITS \\n\\n That is, we join ACCOUNTS and BOOKINGS to get a row R, then for each row R from that join, we join it (R) with a row from ADMIN_UNITS.  Due to the presence of the IN list the optimizer chooses to do multi-probing on ADMIN_UNITS, which means the probe predicate that represents \\\"admin_unit.admin_unit_id IN (1, 21)\\\" becomes the start and stop key.  Since we only allow a single start\\/stop key for any column, the join predicate between ACCOUNTS and ADMIN_UNITS is relegated to being a store qualifier.  This is notable for two reasons: 1) this explains the additional qualifier seen by Bryan in the query plan, and 2) as seen below, this qualifier is what causes the \\\"oneRowRightSide\\\" variable to get set to TRUE for ADMIN_UNITS. \\n\\n Also note: before the change for   DERBY-3061   the optimizer always sorted the join predicate as \\\"stronger\\\" than the probe predicate, and thus always chose the join predicate as the start\\/stop key.  That in turn meant that the probe predicate, which can only be used for probing if it is the start\\/stop key, was \\\"reverted\\\" back to a normal IN list qualifier.  So the problem described below did not show up.  But with   DERBY-3061   the probe predicate and the join predicate have the same \\\"strength\\\" and thus the optimizer is free to use either one as the start\\/stop key. In this example it chooses the probe predicate. \\n\\n All of that said, let\'s take a step back and note that the join between ACCOUNTS and BOOKINGS returns three rows: \\n\\n select account.admin_unit_id, account.account_id, booking.booking_id \\n from spike.accounts account, spike.bookings booking \\n where account.account_id = booking.account_id \\n and booking.child_id = 2; \\n\\n ADMIN_UNIT&amp;|ACCOUNT_ID |BOOKING_ID \\n----------------------------------- \\n1          |10         |1 \\n1          |10         |3 \\n1          |10         |4 \\n\\n So now, for  each  of the above three rows we want to fetch the matching row from ADMIN_UNITS.  So far so good. \\n\\n The \\\"oneRowRightSide\\\" variable that Thomas mentioned comes into play because the optimizer thinks that for every outer row, i.e. for each of the three rows shown above, we will have at MOST one matching row from ADMIN_UNITS.  At first I thought this was incorrect--but upon further inspection it turns out be true.  The optimizer deduced this because the predicate refers to a primary key column, which has to be unique. So when we try to fetch a row such that the ADMIN_UNIT_ID column of ADMIN_UNITS equals some value, we will get at most one row back.  And since we have the join predicate as a store qualifier (mentioned above), we know that we  will  in fact be trying \\\"to get a row such that the ADMIN_UNIT_ID column of ADMIN_UNITS equals some value\\\", where \\\"some value\\\" will be the ADMIN_UNIT_ID column from the intermediate join table shown above. (Note: the intermediate join table doesn\'t actually exist, it\'s just shown as such for discussion). \\n\\n So at this point things are still working as expected.  We\'ll take the first row from the intermediate join, i.e. \\\"(1, 10, 1)\\\", and we\'ll do two things.  First we\'ll get the \\\"next\\\" probe value in the list of values.  Since the probe list is \\\"(1, 21)\\\", the next value is \\\"1\\\".  Second, we will see if there is a row in ADMIN_UNITS such that:  \\n\\n   a) the ADMIN_UNIT_ID column of the row equals the current probe \\n     value, which is \\\"1\\\", AND \\n\\n   b) the ADMIN_UNIT_ID column of the row equals the ADMIN_UNIT_ID of \\n     the outer row, which is \\\"(1, 10, 1)\\\". \\n\\n Since both of these conditions are true, we\'ll return the first row as expected.  So our result at this point is: \\n\\n ADMIN_UNIT&amp;|ACCOUNT_ID |BOOKING_ID \\n----------------------------------- \\n1          |10         |1 \\n\\n Now we attempt to fetch the \\\"next\\\" row from ADMIN_UNITS that matches the outer row \\\"(1, 10, 1)\\\".  But as mentioned earlier, the NestedLoop result set that would do so has \\\"oneRowRightSide\\\" set to TRUE.  This means that the NestedLoop  knows  it will not find any more rows in ADMIN_UNITS that satsify conditions \\\"a\\\" and \\\"b\\\" shown above.  So instead of going to the table, &gt;&gt;&gt; it just QUITS the scan &lt;&lt;&lt;.  See the following in NestedLoopJoinResultSet: \\n\\n         if (oneRowRightSide &amp;&amp; returnedRowMatchingRightSide) \\n        {\\n            rightRow = null;\\n            returnedRowMatchingRightSide = false;\\n        }\\n\\n So we quit the inner scan of ADMIN_UNITS, which leads us to get the next \\\"outer\\\" row from the intermediate join rows shown earlier.  I.e.  we\'ll now set our outer row to be \\\"(1, 10, 3)\\\".  Then we\'ll execute: \\n\\n         if (leftRow == null) \\n        {\\n            closeRight();\\n        }\\n         else \\n        {\\n            rowsSeenLeft++;\\n            openRight();\\n        }\\n\\n \\\"leftRow\\\" here is the same as \\\"outer\\\" row, so it is \\\"(1, 10, 3)\\\" at this point.  Since it\'s not null we\'ll re-open the scan on ADMIN_UNITS, per the \\\"else\\\" branch.  Then, similar to what we did with the first outer row, we\'ll get the \\\"next\\\" probe value in the list of values for ADMIN_UNITS. \\n\\n But this is where the problem occurs.  When we \\\"quit\\\" the scan in the above IF statement we left the MultiProbe result set in the middle of a scan.  So when we make the call to re-open the scan, we need to RESET the probing state.  But the code in MultiProbeTableScanResultSet does not currently do that.  More on that below. \\n\\n For the current codeline we do  not  reset the probe scan, and thus the next probe value we see is \\\"21\\\", from the list (1, 21).  With that we will then try to get a row from ADMIN_UNIT_ID such that: \\n\\n   a) the ADMIN_UNIT_ID column of the row equals the current probe \\n     value, which is &gt;&gt;&gt; \\\"21\\\" &lt;&lt;&lt;, AND \\n\\n   b) the ADMIN_UNIT_ID column of the row equals the ADMIN_UNIT_ID of \\n     the outer row, which is \\\"(1, 10, 3)\\\". \\n\\n But ADMIN_UNITS does not contain any rows which satisfy condition \\\"a\\\", so we will not return a row. Having no row from ADMIN_UNITS, we go on to fetch the next \\\"outer\\\" row from the intermediate join table, meaning we end up with \\\"(1, 10, 4)\\\".  So we\'ll use that outer row and do what we did with the others: i.e. First we\'ll get the next probe value in the list of values.  The logic in MultiProbeTableScan result set sees that we have exhaused the probe list at this point, so  NOW  it RESETS the probing state.  After that it gets the \\\"next\\\" probe value, which is the first value in the list (again), and thus we end up with a probe value of \\\"1\\\".  Second, we will see if there is a row in ADMIN_UNITS such that: \\n\\n   a) the ADMIN_UNIT_ID column of the row equals the current probe \\n     value, which is \\\"1\\\", AND \\n\\n   b) the ADMIN_UNIT_ID column of the row equals the ADMIN_UNIT_ID of \\n     the outer row, which is \\\"(1, 10, 4)\\\". \\n\\n Since both of these conditions are true, we\'ll return the row as expected.  So our result at this point is: \\n\\n ADMIN_UNIT&amp;|ACCOUNT_ID |BOOKING_ID \\n----------------------------------- \\n1          |10         |1 \\n1          |10         |4 \\n\\n And that\'s how the query ends--missing a row. \\n\\n So what\'s going on with MultiProbeTableScanResultSet?  There are some comments in the \\\"reopenCore()\\\" method of that class which explain a) why we do NOT reset the probe state in some cases, and b) why we DO reset the probe state in others.  For reference the comment is: \\n\\n      \\/* There are two scenarios for which we reopen this kind of scan: \\n      * \\n \\n\\t A - The first is for join processing.  In this case we have \\n\\t a(nother) row from some outer table and we want to reopen this \\n\\t scan to look for rows matching the new outer row. \\n      * \\n\\t B - The second is for multi-probing.  Here we want to reopen \\n\\t the scan on this table to look for rows matching the next value \\n\\t in the probe list. \\n      * \\n\\t If we are reopening the scan for scenario A (join processing) \\n\\t then we need to reset our position within the probe list. \\n\\t If we are reopening the scan for scenario B then we do  not  \\n\\t want to reset our position within the probe list because that \\n\\t position tells us where to find the next probe value. \\n      * \\n\\t The way we tell the difference between the two scenarios is \\n\\t by looking at our current position in the probe list (i.e. the \\n\\t value of probeValIndex): if our current position is beyond the \\n\\t length of the probe list then we know that we are reopening the \\n\\t scan for scenario A.  Or put another away, we should never get \\n\\t here for scenario B if probeValIndex is greater than or equal \\n\\t to the length of the probe list.  The reason is that the call \\n\\t to reopenCore() for scenario B will only ever happen when \\n\\t moreInListVals() returns true--and in that case we know that \\n\\t probeValIndex will be less than the length of the probeValues. \\n      *\\/ \\n \\n\\n\\n This comment states one thing and assumes another. First it states (correctly) that if our current position is beyond the length of the probe list then we must be seeing scenario A.  It then goes on to assume (incorrectly) that if the current position is LESS than the length of the probe list we must be seeing scenario B.  It turns out that this is  NOT  true.  The reason it is not true is because of the \\\"oneRowRightSide\\\" processing described above: when that flag is set to true we quit the scan early, meaning that the current probe position will in fact be less than the length of the probe list.  Then we later come back with a(nother) row from the outer table (i.e. the intermediate join table shown above) and \\\"we want to reopen this scan to look for rows matching the new outer row\\\".  That means we need to reset the probe state: but due to the incorrect assumption, we don\'t reset it.  The result is incorrect results as described above. \\n\\n I\'m attaching a first attempt at a fix, d3603_v1.patch.  With this patch applied the repro case correctly returns three rows.  The patch does not include a test case and I don\'t know yet if it passes the regression tests.  I\'m running them now but they won\'t complete for several more hours.  So far the lang\\/subqueryFlattening test has failed with a plan diff, which may require some investigation... \\n\\n I\'m still quite limited on time so if it is agreed that this is the correct fix (or at least, the right direction), it\'d be great if someone could add the test and take it to completion--esp. if it could happen before the next 10.4 release candidate.  If no one picks it up I\'ll try to get to it sometime next week, but probably not in time for the second RC... \\n\\n Regardless of whether or not this writeup proves correct, many thanks again to Bryan and Thomas for their investigation and comments.  As no one officially assigned the issue to him\\/herself I spent some time investigating, as written above.  I hope I didn\'t step on anyone\'s toes in the process.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12588404\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12588404&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12588404\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12588404_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588404_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Apr\\/08 16:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-13T16:49:41+0000\'\u003e13\\/Apr\\/08 16:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Thomas and Army for all the analysis and explanation; it is \u003cb\u003every\u003c\\/b\u003e helpful!\u003c\\/p\u003e\\n\\n\u003cp\u003eIf I am understanding it all correctly, then I believe this script reproduces the problem.\u003cbr\\/\u003e\\nWithout Army\'s patch the first 2 queries return (a) count=1, and (b) 1 row, but \u003cb\u003ewith\u003c\\/b\u003e\u003cbr\\/\u003e\\nArmy\'s patch all three queries return a result of 2 rows (count = 2), which I believe\u003cbr\\/\u003e\\nis the correct result.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll see if I can turn Army\'s patch and this repro script into a complete patch and run\u003cbr\\/\u003e\\nthe tests, etc.\u003c\\/p\u003e\\n\\n\u003cp\u003edrop table a;\u003cbr\\/\u003e\\ndrop table c;\u003c\\/p\u003e\\n\\n\u003cp\u003ecreate table a (a_id integer, c_id integer);\u003cbr\\/\u003e\\ncreate table c (c_id integer not null, primary key(c_id),\u003cbr\\/\u003e\\n                d_id integer, t_o bigint, t_i bigint);\u003c\\/p\u003e\\n\\n\u003cp\u003einsert into a (a_id, c_id) values (1, 1);\u003cbr\\/\u003e\\ninsert into a (a_id, c_id) values (2, 2);\u003cbr\\/\u003e\\ninsert into a (a_id, c_id) values (3, 1);\u003cbr\\/\u003e\\ninsert into c (c_id, d_id, t_o, t_i) values (1, 1, 1, 1);\u003cbr\\/\u003e\\ninsert into c (c_id, d_id, t_o, t_i) values (2, 2, 1, 1);\u003cbr\\/\u003e\\ninsert into c (c_id, d_id, t_o, t_i) values (21, 1, 1, 1);\u003c\\/p\u003e\\n\\n\u003cp\u003eselect count\u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/star_yellow.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21)\u003cbr\\/\u003e\\n       and a.c_id = c.c_id;\u003cbr\\/\u003e\\nselect a.a_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21)\u003cbr\\/\u003e\\n       and a.c_id = c.c_id;\u003cbr\\/\u003e\\nselect a.a_id,c.d_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21)\u003cbr\\/\u003e\\n       and a.c_id = c.c_id;\u003c\\/p\u003e\\n\\n\u003cp\u003eResults without the patch:\u003cbr\\/\u003e\\nij&gt; select count\u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/star_yellow.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21)\u003cbr\\/\u003e\\n       and a.c_id = c.c_id;\u003cbr\\/\u003e\\n1\u003cbr\\/\u003e\\n-----------\u003cbr\\/\u003e\\n1\u003c\\/p\u003e\\n\\n\u003cp\u003e1 row selected\u003cbr\\/\u003e\\nij&gt; select a.a_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21)\u003cbr\\/\u003e\\n       and a.c_id = c.c_id;\u003cbr\\/\u003e\\nA_ID\u003cbr\\/\u003e\\n-----------\u003cbr\\/\u003e\\n1\u003c\\/p\u003e\\n\\n\u003cp\u003e1 row selected\u003cbr\\/\u003e\\nij&gt; select a.a_id,c.d_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21)\u003cbr\\/\u003e\\n       and a.c_id = c.c_id;\u003cbr\\/\u003e\\nA_ID       |D_ID\u003cbr\\/\u003e\\n-----------------------\u003cbr\\/\u003e\\n1          |1\u003cbr\\/\u003e\\n3          |1\u003c\\/p\u003e\\n\\n\u003cp\u003eResults with the patch:\u003c\\/p\u003e\\n\\n\u003cp\u003eij&gt; select count\u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/star_yellow.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21)\u003cbr\\/\u003e\\n       and a.c_id = c.c_id;\u003cbr\\/\u003e\\n1\u003cbr\\/\u003e\\n-----------\u003cbr\\/\u003e\\n2\u003c\\/p\u003e\\n\\n\u003cp\u003e1 row selected\u003cbr\\/\u003e\\nij&gt; select a.a_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21)\u003cbr\\/\u003e\\n       and a.c_id = c.c_id;\u003cbr\\/\u003e\\nA_ID\u003cbr\\/\u003e\\n-----------\u003cbr\\/\u003e\\n1\u003cbr\\/\u003e\\n3\u003c\\/p\u003e\\n\\n\u003cp\u003e2 rows selected\u003cbr\\/\u003e\\nij&gt; select a.a_id,c.d_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21)\u003cbr\\/\u003e\\n       and a.c_id = c.c_id;\u003cbr\\/\u003e\\nA_ID       |D_ID\u003cbr\\/\u003e\\n-----------------------\u003cbr\\/\u003e\\n1          |1\u003cbr\\/\u003e\\n3          |1\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12588404_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588404_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'13\\/Apr\\/08 16:49\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-13T16:49:41+0000\'\u003e13\\/Apr\\/08 16:49\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Thomas and Army for all the analysis and explanation; it is  very  helpful! \\n\\n If I am understanding it all correctly, then I believe this script reproduces the problem. \\nWithout Army\'s patch the first 2 queries return (a) count=1, and (b) 1 row, but  with  \\nArmy\'s patch all three queries return a result of 2 rows (count = 2), which I believe \\nis the correct result. \\n\\n I\'ll see if I can turn Army\'s patch and this repro script into a complete patch and run \\nthe tests, etc. \\n\\n drop table a; \\ndrop table c; \\n\\n create table a (a_id integer, c_id integer); \\ncreate table c (c_id integer not null, primary key(c_id), \\n                d_id integer, t_o bigint, t_i bigint); \\n\\n insert into a (a_id, c_id) values (1, 1); \\ninsert into a (a_id, c_id) values (2, 2); \\ninsert into a (a_id, c_id) values (3, 1); \\ninsert into c (c_id, d_id, t_o, t_i) values (1, 1, 1, 1); \\ninsert into c (c_id, d_id, t_o, t_i) values (2, 2, 1, 1); \\ninsert into c (c_id, d_id, t_o, t_i) values (21, 1, 1, 1); \\n\\n select count  from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21) \\n       and a.c_id = c.c_id; \\nselect a.a_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21) \\n       and a.c_id = c.c_id; \\nselect a.a_id,c.d_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21) \\n       and a.c_id = c.c_id; \\n\\n Results without the patch: \\nij&gt; select count  from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21) \\n       and a.c_id = c.c_id; \\n1 \\n----------- \\n1 \\n\\n 1 row selected \\nij&gt; select a.a_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21) \\n       and a.c_id = c.c_id; \\nA_ID \\n----------- \\n1 \\n\\n 1 row selected \\nij&gt; select a.a_id,c.d_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21) \\n       and a.c_id = c.c_id; \\nA_ID       |D_ID \\n----------------------- \\n1          |1 \\n3          |1 \\n\\n Results with the patch: \\n\\n ij&gt; select count  from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21) \\n       and a.c_id = c.c_id; \\n1 \\n----------- \\n2 \\n\\n 1 row selected \\nij&gt; select a.a_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21) \\n       and a.c_id = c.c_id; \\nA_ID \\n----------- \\n1 \\n3 \\n\\n 2 rows selected \\nij&gt; select a.a_id,c.d_id from a, c where a.a_id &lt;&gt; 2 and c.c_id in (1, 21) \\n       and a.c_id = c.c_id; \\nA_ID       |D_ID \\n----------------------- \\n1          |1 \\n3          |1 \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12588468\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12588468&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12588468\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12588468_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588468_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/08 03:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-14T03:08:01+0000\'\u003e14\\/Apr\\/08 03:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttached is \'patch_with_test.diff\', which expands on Army\'s\u003cbr\\/\u003e\\noriginal test by adding a simple reproduction script to\u003cbr\\/\u003e\\nInListMultiProbeTest.java.\u003c\\/p\u003e\\n\\n\u003cp\u003eWith this patch in place, \u003cb\u003ealmost\u003c\\/b\u003e all the tests pass.\u003c\\/p\u003e\\n\\n\u003cp\u003eHowever, I\'m seeing a diff in subqueryFlattening.sql in\u003cbr\\/\u003e\\nthe derbyall\\/derbylang suite. I\'ve attached the diff that I get.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12588468_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588468_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/08 03:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-14T03:08:01+0000\'\u003e14\\/Apr\\/08 03:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attached is \'patch_with_test.diff\', which expands on Army\'s \\noriginal test by adding a simple reproduction script to \\nInListMultiProbeTest.java. \\n\\n With this patch in place,  almost  all the tests pass. \\n\\n However, I\'m seeing a diff in subqueryFlattening.sql in \\nthe derbyall\\/derbylang suite. I\'ve attached the diff that I get.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12588469\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12588469&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12588469\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12588469_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588469_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/08 03:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-14T03:09:18+0000\'\u003e14\\/Apr\\/08 03:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAt a quick glance, it looks like the subqueryFlattening diff might be OK,\u003cbr\\/\u003e\\nand perhaps I just need to update the master output.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut it would be nice to have more eyes on this.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12588469_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588469_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/08 03:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-14T03:09:18+0000\'\u003e14\\/Apr\\/08 03:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    At a quick glance, it looks like the subqueryFlattening diff might be OK, \\nand perhaps I just need to update the master output. \\n\\n But it would be nice to have more eyes on this.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12588492\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12588492&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12588492\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12588492_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588492_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/08 06:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-14T06:41:17+0000\'\u003e14\\/Apr\\/08 06:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNo toes feeling stepped on Army - again an excellent writeup!\u003c\\/p\u003e\\n\\n\u003cp\u003eI agree with Bryan that the subqueryFlattening.diff seems OK - it does produce the correct results but the filtering seems to happen at slightly different levels. I\'ll give the patch a spin too.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"thomanie\\\" id=\\\"commentauthor_12588492_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=thomanie\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"thomanie\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Thomas Nielsen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588492_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/08 06:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-14T06:41:17+0000\'\u003e14\\/Apr\\/08 06:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    No toes feeling stepped on Army - again an excellent writeup! \\n\\n I agree with Bryan that the subqueryFlattening.diff seems OK - it does produce the correct results but the filtering seems to happen at slightly different levels. I\'ll give the patch a spin too.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12588591\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12588591&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12588591\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12588591_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588591_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/08 14:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-14T14:27:06+0000\'\u003e14\\/Apr\\/08 14:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThe 2 queries in subqueryFlattening.sql which get the different runtime statistics are:\u003c\\/p\u003e\\n\\n\u003cp\u003eSELECT count(ID) FROM DOCS WHERE ID &lt;&gt; ANY (SELECT ID FROM COLLS WHERE COLLID IN (-2,1) );\u003cbr\\/\u003e\\nand\u003cbr\\/\u003e\\nSELECT count(ID) FROM DOCS WHERE ID &gt; ANY (SELECT ID FROM COLLS WHERE COLLID IN (-2,1) );\u003c\\/p\u003e\\n\\n\u003cp\u003eThe queries get the correct final results, and the overall shape of the query\u003cbr\\/\u003e\\nplans is the same, but the precise details of which rows are processed\u003cbr\\/\u003e\\nat what stage of the query plan changes slightly.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12588591_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588591_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/08 14:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-14T14:27:06+0000\'\u003e14\\/Apr\\/08 14:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    The 2 queries in subqueryFlattening.sql which get the different runtime statistics are: \\n\\n SELECT count(ID) FROM DOCS WHERE ID &lt;&gt; ANY (SELECT ID FROM COLLS WHERE COLLID IN (-2,1) ); \\nand \\nSELECT count(ID) FROM DOCS WHERE ID &gt; ANY (SELECT ID FROM COLLS WHERE COLLID IN (-2,1) ); \\n\\n The queries get the correct final results, and the overall shape of the query \\nplans is the same, but the precise details of which rows are processed \\nat what stage of the query plan changes slightly.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12588661\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12588661&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12588661\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12588661_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588661_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/08 17:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-14T17:54:45+0000\'\u003e14\\/Apr\\/08 17:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThank you very much for picking this one up, Bryan.  I greatly appreciate it.\u003c\\/p\u003e\\n\\n\u003cp\u003eOn the subqueryFlattening.diff:\u003c\\/p\u003e\\n\\n\u003cp\u003eTo see why the diff occurs, I stepped through the following exercise.  I did not actually trace through the code, but I walked through what I \u003cb\u003ethink\u003c\\/b\u003e should be happening and it seems to have explained the diff...\u003c\\/p\u003e\\n\\n\u003cp\u003eAt the time of the statements in question the data in the DOCS and COLLS tables is as follows:\u003c\\/p\u003e\\n\\n\u003cp\u003eDOCS: ID (VARCHAR) =&gt;\u003cbr\\/\u003e\\n  (\'124\'), (\'24\'), (\'25\'), (\'27\'), (\'36\'), (\'567\')\u003c\\/p\u003e\\n\\n\u003cp\u003eCOLLS: ID (VARCHAR), COLLID (SMALLINT) =&gt;\u003cbr\\/\u003e\\n  (\'123\', 2), (\'124\', -5), (\'24\', 1), (\'26\', -2), (\'36\', 1), (\'37\', 8)\u003c\\/p\u003e\\n\\n\u003cp\u003eNow assume the query in question is:\u003c\\/p\u003e\\n\\n\u003cp\u003e  SELECT count(ID) FROM DOCS\u003cbr\\/\u003e\\n    WHERE ID &lt;&gt; ANY (SELECT ID FROM COLLS WHERE COLLID IN (-2,1))\u003c\\/p\u003e\\n\\n\u003cp\u003eThe ANY will be flattened giving us something to the effect of:\u003c\\/p\u003e\\n\\n\u003cp\u003e  SELECT count(ID) FROM DOCS, COLLS\u003cbr\\/\u003e\\n    WHERE DOCS.ID &lt;&gt; COLLS.ID AND COLLS.COLLID IN (-2, 1)\u003c\\/p\u003e\\n\\n\u003cp\u003eThe IN list for the queries that we\'re talking about is (-2, 1). So per the explanation I posted on Friday, we\'d end up with something like the following withOUT the change.\u003c\\/p\u003e\\n\\n\u003cp\u003eNote: Lines preceded by \\\"+\\\" indicate that we read a row from the inner table, COLLS.  Lines preced by \\\"*\' indicate that what we do for the line changes with the proposed patch for this issue.  Lines preceded by an \\\"x\\\" indicate that we \\\"filter\\\" a row from COLLS, meaning we read it but then we discard it.\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eGet DOCS row (\'124\').\u003c\\/li\u003e\\n\\t\u003cli\u003eGet first IN list value, -2.\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', -2).\u003c\\/li\u003e\\n\\t\u003cli\u003eSee if ID column of (\'26\', -2) is NOT EQUAL to \'124\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'124\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eGet DOCS row (\'24\').\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eGet next IN list value, 1.\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is 1, i.e. (\'24\', 1).\u003cbr\\/\u003e\\n  x See if ID column of (\'24\', 1) is NOT EQUAL to \'24\'.  They\u003cbr\\/\u003e\\n    are EQUAL so we skip the row (\'24\', 1) and continuing our\u003cbr\\/\u003e\\n    scan of COLLS.\u003cbr\\/\u003e\\n  + Get next row from COLLS where COLLID is 1, i.e. (\'36\', 1).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eSee if ID column of (\'36\', 1) is NOT EQUAL to \'24\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'24\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eGet DOCS row (\'25\').\u003c\\/li\u003e\\n\\t\u003cli\u003eImplicitly RESET the probe state, then get the \\\"next\\\" IN\u003cbr\\/\u003e\\n    list value, which will be -2.\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', -2).\u003c\\/li\u003e\\n\\t\u003cli\u003eSee if ID column of (\'26\', -2) is NOT EQUAL to \'25\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'25\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eGet DOCS row (\'27\').\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eGet next IN list value, 1.\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is 1, i.e. (\'24\', 1).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eSee if ID column of (\'24\', 1) is NOT EQUAL to \'27\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'27\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eGet DOCS row (\'36\').\u003c\\/li\u003e\\n\\t\u003cli\u003eImplicitly RESET the probe state, then get the \\\"next\\\" IN\u003cbr\\/\u003e\\n    list value, which will be -2.\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', -2).\u003c\\/li\u003e\\n\\t\u003cli\u003eSee if ID column of (\'26\', -2) is NOT EQUAL to \'36\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'36\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eGet DOCS row (\'567\').\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eGet next IN list value, 1.\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is 1, i.e. (\'24\', 1).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eSee if ID column of (\'24\', 1) is NOT EQUAL to \'567\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'567\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eNo more rows from DOCS, so done.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eWe can see from this that we get a row from COLLS a total of 7 times. In the process we \\\"filtered\\\" one row out, i.e. the row (\'24\', 1), because that row has the same ID has a row in DOCS.  Or put in terms of the scan statistics, we have 7 \\\"rows seen\\\" and one (1) row filtered.  And the query returns a count total of 6 rows from DOCS.\u003c\\/p\u003e\\n\\n\u003cp\u003eBut now if we do the same exercise with the patch applied, we see the following:\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eGet DOCS row (\'124\').\u003c\\/li\u003e\\n\\t\u003cli\u003eGet first IN list value, -2.\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', -2).\u003c\\/li\u003e\\n\\t\u003cli\u003eSee if ID column of (\'26\', -2) is NOT EQUAL to \'124\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'124\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eGet DOCS row (\'24\').\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eRESET probe state, then get \\\"next\\\" IN list value, which\u003cbr\\/\u003e\\n    is -2 (again).\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', 1).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eSee if ID column of (\'26\', -2) is NOT EQUAL to \'24\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'24\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eGet DOCS row (\'25\').\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eRESET probe state, then get \\\"next\\\" IN list value, which\u003cbr\\/\u003e\\n    is -2 (again).\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', 1).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eSee if ID column of (\'26\', -2) is NOT EQUAL to \'25\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'25\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eGet DOCS row (\'27\').\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eRESET probe state, then get \\\"next\\\" IN list value, which\u003cbr\\/\u003e\\n    is -2 (again).\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', 1).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eSee if ID column of (\'26\', -2) is NOT EQUAL to \'27\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'27\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eGet DOCS row (\'36\').\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eRESET probe state, then get \\\"next\\\" IN list value, which\u003cbr\\/\u003e\\n    is -2 (again).\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', 1).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eSee if ID column of (\'26\', -2) is NOT EQUAL to \'36\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'36\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eGet DOCS row (\'567\').\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eRESET probe state, then get \\\"next\\\" IN list value, which\u003cbr\\/\u003e\\n    is -2 (again).\u003cbr\\/\u003e\\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', 1).\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eSee if ID column of (\'26\', -2) is NOT EQUAL to \'567\'.  They\u003cbr\\/\u003e\\n    are not equal so count the \'567\' row from DOCS and quit the\u003cbr\\/\u003e\\n    scan of COLLS.\u003c\\/li\u003e\\n\\t\u003cli\u003eNo more rows from DOCS, so done.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eNow the total number of rows we \\\"see\\\" from COLLS is 6 instead of 7.  This is because we never fetched the row (\'24\', 1) from the table.  Instead, we only had to fetch the one row, (\'26\', -2), over and over.  Then, since we never fetched row (\'24\', 1) from the table we didn\'t have to filter it out.  So we end up with a total of 6 \\\"rows seen\\\" and 0 rows filtered. Meanwhile the query still returns a count total of 6 rows from DOCS.\u003c\\/p\u003e\\n\\n\u003cp\u003eI didn\'t run through this exercise for the other cases, but I imagine (hope!) things would work out in a similar fashion...Does that seem like a reasonable explanation to you?  If so, then I think it\'s okay to update the master file for subqueryFlattening.sql for this issue.\u003c\\/p\u003e\\n\\n\u003cp\u003eOh, and thanks for writing the standalone repro, as well!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12588661_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12588661_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Apr\\/08 17:54\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-14T17:54:45+0000\'\u003e14\\/Apr\\/08 17:54\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thank you very much for picking this one up, Bryan.  I greatly appreciate it. \\n\\n On the subqueryFlattening.diff: \\n\\n To see why the diff occurs, I stepped through the following exercise.  I did not actually trace through the code, but I walked through what I  think  should be happening and it seems to have explained the diff... \\n\\n At the time of the statements in question the data in the DOCS and COLLS tables is as follows: \\n\\n DOCS: ID (VARCHAR) =&gt; \\n  (\'124\'), (\'24\'), (\'25\'), (\'27\'), (\'36\'), (\'567\') \\n\\n COLLS: ID (VARCHAR), COLLID (SMALLINT) =&gt; \\n  (\'123\', 2), (\'124\', -5), (\'24\', 1), (\'26\', -2), (\'36\', 1), (\'37\', 8) \\n\\n Now assume the query in question is: \\n\\n   SELECT count(ID) FROM DOCS \\n    WHERE ID &lt;&gt; ANY (SELECT ID FROM COLLS WHERE COLLID IN (-2,1)) \\n\\n The ANY will be flattened giving us something to the effect of: \\n\\n   SELECT count(ID) FROM DOCS, COLLS \\n    WHERE DOCS.ID &lt;&gt; COLLS.ID AND COLLS.COLLID IN (-2, 1) \\n\\n The IN list for the queries that we\'re talking about is (-2, 1). So per the explanation I posted on Friday, we\'d end up with something like the following withOUT the change. \\n\\n Note: Lines preceded by \\\"+\\\" indicate that we read a row from the inner table, COLLS.  Lines preced by \\\"*\' indicate that what we do for the line changes with the proposed patch for this issue.  Lines preceded by an \\\"x\\\" indicate that we \\\"filter\\\" a row from COLLS, meaning we read it but then we discard it. \\n\\n \\n\\t Get DOCS row (\'124\'). \\n\\t Get first IN list value, -2. \\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', -2). \\n\\t See if ID column of (\'26\', -2) is NOT EQUAL to \'124\'.  They \\n    are not equal so count the \'124\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t Get DOCS row (\'24\'). \\n \\n \\n\\t Get next IN list value, 1. \\n  + Get row from COLLS where COLLID is 1, i.e. (\'24\', 1). \\n  x See if ID column of (\'24\', 1) is NOT EQUAL to \'24\'.  They \\n    are EQUAL so we skip the row (\'24\', 1) and continuing our \\n    scan of COLLS. \\n  + Get next row from COLLS where COLLID is 1, i.e. (\'36\', 1). \\n \\n \\n\\t See if ID column of (\'36\', 1) is NOT EQUAL to \'24\'.  They \\n    are not equal so count the \'24\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t Get DOCS row (\'25\'). \\n\\t Implicitly RESET the probe state, then get the \\\"next\\\" IN \\n    list value, which will be -2. \\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', -2). \\n\\t See if ID column of (\'26\', -2) is NOT EQUAL to \'25\'.  They \\n    are not equal so count the \'25\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t Get DOCS row (\'27\'). \\n \\n \\n\\t Get next IN list value, 1. \\n  + Get row from COLLS where COLLID is 1, i.e. (\'24\', 1). \\n \\n \\n\\t See if ID column of (\'24\', 1) is NOT EQUAL to \'27\'.  They \\n    are not equal so count the \'27\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t Get DOCS row (\'36\'). \\n\\t Implicitly RESET the probe state, then get the \\\"next\\\" IN \\n    list value, which will be -2. \\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', -2). \\n\\t See if ID column of (\'26\', -2) is NOT EQUAL to \'36\'.  They \\n    are not equal so count the \'36\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t Get DOCS row (\'567\'). \\n \\n \\n\\t Get next IN list value, 1. \\n  + Get row from COLLS where COLLID is 1, i.e. (\'24\', 1). \\n \\n \\n\\t See if ID column of (\'24\', 1) is NOT EQUAL to \'567\'.  They \\n    are not equal so count the \'567\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t No more rows from DOCS, so done. \\n \\n\\n\\n We can see from this that we get a row from COLLS a total of 7 times. In the process we \\\"filtered\\\" one row out, i.e. the row (\'24\', 1), because that row has the same ID has a row in DOCS.  Or put in terms of the scan statistics, we have 7 \\\"rows seen\\\" and one (1) row filtered.  And the query returns a count total of 6 rows from DOCS. \\n\\n But now if we do the same exercise with the patch applied, we see the following: \\n\\n \\n\\t Get DOCS row (\'124\'). \\n\\t Get first IN list value, -2. \\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', -2). \\n\\t See if ID column of (\'26\', -2) is NOT EQUAL to \'124\'.  They \\n    are not equal so count the \'124\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t Get DOCS row (\'24\'). \\n \\n \\n\\t RESET probe state, then get \\\"next\\\" IN list value, which \\n    is -2 (again). \\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', 1). \\n \\n \\n\\t See if ID column of (\'26\', -2) is NOT EQUAL to \'24\'.  They \\n    are not equal so count the \'24\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t Get DOCS row (\'25\'). \\n \\n \\n\\t RESET probe state, then get \\\"next\\\" IN list value, which \\n    is -2 (again). \\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', 1). \\n \\n \\n\\t See if ID column of (\'26\', -2) is NOT EQUAL to \'25\'.  They \\n    are not equal so count the \'25\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t Get DOCS row (\'27\'). \\n \\n \\n\\t RESET probe state, then get \\\"next\\\" IN list value, which \\n    is -2 (again). \\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', 1). \\n \\n \\n\\t See if ID column of (\'26\', -2) is NOT EQUAL to \'27\'.  They \\n    are not equal so count the \'27\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t Get DOCS row (\'36\'). \\n \\n \\n\\t RESET probe state, then get \\\"next\\\" IN list value, which \\n    is -2 (again). \\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', 1). \\n \\n \\n\\t See if ID column of (\'26\', -2) is NOT EQUAL to \'36\'.  They \\n    are not equal so count the \'36\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t Get DOCS row (\'567\'). \\n \\n \\n\\t RESET probe state, then get \\\"next\\\" IN list value, which \\n    is -2 (again). \\n  + Get row from COLLS where COLLID is -2, i.e. (\'26\', 1). \\n \\n \\n\\t See if ID column of (\'26\', -2) is NOT EQUAL to \'567\'.  They \\n    are not equal so count the \'567\' row from DOCS and quit the \\n    scan of COLLS. \\n\\t No more rows from DOCS, so done. \\n \\n\\n\\n Now the total number of rows we \\\"see\\\" from COLLS is 6 instead of 7.  This is because we never fetched the row (\'24\', 1) from the table.  Instead, we only had to fetch the one row, (\'26\', -2), over and over.  Then, since we never fetched row (\'24\', 1) from the table we didn\'t have to filter it out.  So we end up with a total of 6 \\\"rows seen\\\" and 0 rows filtered. Meanwhile the query still returns a count total of 6 rows from DOCS. \\n\\n I didn\'t run through this exercise for the other cases, but I imagine (hope!) things would work out in a similar fashion...Does that seem like a reasonable explanation to you?  If so, then I think it\'s okay to update the master file for subqueryFlattening.sql for this issue. \\n\\n Oh, and thanks for writing the standalone repro, as well!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12589380\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12589380&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12589380\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12589380_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12589380_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/08 01:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-16T01:23:01+0000\'\u003e16\\/Apr\\/08 01:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks Army for the clear and detailed description of the subquery processing.\u003c\\/p\u003e\\n\\n\u003cp\u003eTo confirm it, I introduced some crude print statements into the MultiProbe\u003cbr\\/\u003e\\ncode and:\u003c\\/p\u003e\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003ewithout the patch I can see it ping-ponging back and forth between -2 and 1\u003c\\/li\u003e\\n\\t\u003cli\u003ewith the patch I can see that it simply uses the -2 row over and over,\u003cbr\\/\u003e\\n   as you suggest.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cp\u003eBased on that evidence, and on a close read of Army\'s description,\u003cbr\\/\u003e\\nI\'m comfortable updating the subqueryFlattening.out file.\u003c\\/p\u003e\\n\\n\u003cp\u003eAttached is updateSubquerymaster.diff, which I believe is ready for review.\u003c\\/p\u003e\\n\\n\u003cp\u003eI intend to commit this patch to the trunk tonight or tomorrow morning,\u003cbr\\/\u003e\\nand I\'m also intending to merge it to 10.4, assuming no additional\u003cbr\\/\u003e\\nconcerns are raised via review or testing.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12589380_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12589380_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/08 01:23\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-16T01:23:01+0000\'\u003e16\\/Apr\\/08 01:23\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks Army for the clear and detailed description of the subquery processing. \\n\\n To confirm it, I introduced some crude print statements into the MultiProbe \\ncode and: \\n \\n\\t without the patch I can see it ping-ponging back and forth between -2 and 1 \\n\\t with the patch I can see that it simply uses the -2 row over and over, \\n   as you suggest. \\n \\n\\n\\n Based on that evidence, and on a close read of Army\'s description, \\nI\'m comfortable updating the subqueryFlattening.out file. \\n\\n Attached is updateSubquerymaster.diff, which I believe is ready for review. \\n\\n I intend to commit this patch to the trunk tonight or tomorrow morning, \\nand I\'m also intending to merge it to 10.4, assuming no additional \\nconcerns are raised via review or testing.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12589397\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12589397&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12589397\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12589397_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12589397_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/08 03:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-16T03:38:18+0000\'\u003e16\\/Apr\\/08 03:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommitted the change to the trunk as revision 648492.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12589397_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12589397_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/08 03:38\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-16T03:38:18+0000\'\u003e16\\/Apr\\/08 03:38\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Committed the change to the trunk as revision 648492.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12589599\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12589599&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12589599\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12589599_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12589599_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/08 15:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-16T15:24:46+0000\'\u003e16\\/Apr\\/08 15:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommitted the change to the 10.4 branch as revision 648722.\u003c\\/p\u003e\\n\\n\u003cp\u003eI\'ll investigate merging this change back to the 10.3 branch as well.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12589599_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12589599_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/08 15:24\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-16T15:24:46+0000\'\u003e16\\/Apr\\/08 15:24\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Committed the change to the 10.4 branch as revision 648722. \\n\\n I\'ll investigate merging this change back to the 10.3 branch as well.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12589624\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12589624&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12589624\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_12589624_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12589624_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/08 16:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-16T16:05:48+0000\'\u003e16\\/Apr\\/08 16:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eResolving with fixversion 10.4.0.0 (since there is no 10.4.1.3 yet) just to get it on the list of fixed bugs.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_12589624_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12589624_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'16\\/Apr\\/08 16:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-16T16:05:48+0000\'\u003e16\\/Apr\\/08 16:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Resolving with fixversion 10.4.0.0 (since there is no 10.4.1.3 yet) just to get it on the list of fixed bugs.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12590145\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12590145&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12590145\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12590145_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12590145_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/08 18:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-17T18:46:05+0000\'\u003e17\\/Apr\\/08 18:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommitted to the 10.3 branch as revision 649226.\u003c\\/p\u003e\\n\\n\u003cp\u003eUpdated fix version to reflect that.\u003c\\/p\u003e\\n\\n\u003cp\u003eThanks again Army and Thomas for the help and reviews!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"bryanpendleton\\\" id=\\\"commentauthor_12590145_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=bryanpendleton\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"bryanpendleton\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Bryan Pendleton\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12590145_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/08 18:46\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-17T18:46:05+0000\'\u003e17\\/Apr\\/08 18:46\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Committed to the 10.3 branch as revision 649226. \\n\\n Updated fix version to reflect that. \\n\\n Thanks again Army and Thomas for the help and reviews!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12590194\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12590194&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12590194\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12590194_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12590194_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/08 20:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-17T20:15:28+0000\'\u003e17\\/Apr\\/08 20:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAnd thanks to you, Bryan, for taking this one to completion!\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"army\\\" id=\\\"commentauthor_12590194_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=army\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"army\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e A B\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12590194_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Apr\\/08 20:15\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-17T20:15:28+0000\'\u003e17\\/Apr\\/08 20:15\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    And thanks to you, Bryan, for taking this one to completion!              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-12590457\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-3603?focusedCommentId=12590457&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12590457\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12590457_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12590457_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Apr\\/08 13:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-18T13:56:42+0000\'\u003e18\\/Apr\\/08 13:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eChanged fix version from 10.4.0.0 to 10.4.1.3.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_12590457_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_12590457_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Apr\\/08 13:56\'\u003e\u003ctime class=\'livestamp\' datetime=\'2008-04-18T13:56:42+0000\'\u003e18\\/Apr\\/08 13:56\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Changed fix version from 10.4.0.0 to 10.4.1.3.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="10594";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=10594&amp;avatarId=10122\\\" alt=\\\"Derby\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\"\u003eDerby\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1520239414837"> 
    <input type="hidden" title="jira.request.server.time" value="224"> 
    <input type="hidden" title="jira.request.id" value="523x94390797x3"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="4"> 
    <input type="hidden" title="db.reads.time.in.ms" value="34"> 
    <input type="hidden" title="db.conns.time.in.ms" value="43"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 523x94390797x3
	          REQUEST TIMESTAMP : [05/Mar/2018:08:43:34 +0000]
	               REQUEST TIME : 0.2240
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 4

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=19, elapsedTotal=34908668, elapsedMin=531624, elapsedMax=11818892, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=24, elapsedTotal=43098297, elapsedMin=537916, elapsedMax=11844311, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>
<!doctype html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"> 
  <meta name="application-name" content="JIRA" data-name="jira" data-version="7.6.3">
  <meta name="ajs-viewissue-use-history-api" content="false"> 
  <meta name="ajs-jira-base-url" content="https://issues.apache.org/jira"> 
  <meta name="ajs-serverRenderedViewIssue" content="true"> 
  <meta name="ajs-dev-mode" content="false"> 
  <meta name="ajs-context-path" content="/jira"> 
  <meta name="ajs-version-number" content="7.6.3"> 
  <meta name="ajs-build-number" content="76005"> 
  <meta name="ajs-is-beta" content="false"> 
  <meta name="ajs-is-rc" content="false"> 
  <meta name="ajs-is-snapshot" content="false"> 
  <meta name="ajs-is-milestone" content="false"> 
  <meta name="ajs-remote-user" content=""> 
  <meta name="ajs-remote-user-fullname" content=""> 
  <meta name="ajs-user-locale" content="en_UK"> 
  <meta name="ajs-user-locale-group-separator" content=","> 
  <meta name="ajs-app-title" content="ASF JIRA"> 
  <meta name="ajs-keyboard-shortcuts-enabled" content="true"> 
  <meta name="ajs-keyboard-accesskey-modifier" content="Ctrl+Alt"> 
  <meta name="ajs-enabled-dark-features" content="[&quot;com.atlassian.jira.agile.darkfeature.editable.detailsview&quot;,&quot;nps.survey.inline.dialog&quot;,&quot;com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled&quot;,&quot;jira.plugin.devstatus.phasetwo&quot;,&quot;jira.frother.reporter.field&quot;,&quot;atlassian.rest.xsrf.legacy.enabled&quot;,&quot;jira.issue.status.lozenge&quot;,&quot;com.atlassian.jira.config.BIG_PIPE&quot;,&quot;com.atlassian.jira.projects.issuenavigator&quot;,&quot;com.atlassian.jira.config.PDL&quot;,&quot;jira.plugin.devstatus.phasetwo.enabled&quot;,&quot;atlassian.aui.raphael.disabled&quot;,&quot;app-switcher.new&quot;,&quot;frother.assignee.field&quot;,&quot;com.atlassian.jira.projects.ProjectCentricNavigation.Switch&quot;,&quot;sd.internal.base.off.thread.on.completion.events.enabled&quot;,&quot;jira.onboarding.cyoa&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.enabled&quot;,&quot;sd.slavalue.record.updated.date.enabled&quot;,&quot;com.atlassian.jira.config.ProjectConfig.MENU&quot;,&quot;com.atlassian.jira.projects.sidebar.DEFER_RESOURCES&quot;,&quot;com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled&quot;,&quot;com.atlassian.jira.agile.darkfeature.sprint.goal.enabled&quot;,&quot;jira.zdu.admin-updates-ui&quot;,&quot;jira.zdu.jmx-monitoring&quot;,&quot;sd.sla.improved.rendering.enabled&quot;,&quot;sd.canned.responses.enabled&quot;,&quot;sd.new.settings.sidebar.location.disabled&quot;,&quot;jira.zdu.cluster-upgrade-state&quot;,&quot;com.atlassian.jira.agile.darkfeature.splitissue&quot;,&quot;com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED&quot;,&quot;com.atlassian.feedback.feedback-button-move-to-header-enable&quot;,&quot;jira.export.csv.enabled&quot;]"> 
  <meta name="ajs-in-admin-mode" content="false"> 
  <meta name="ajs-is-sysadmin" content="false"> 
  <meta name="ajs-is-admin" content="false"> 
  <meta name="ajs-outgoing-mail-enabled" content="true"> 
  <meta name="ajs-date-relativize" content="true"> 
  <meta name="ajs-date-time" content="HH:mm"> 
  <meta name="ajs-date-day" content="EEEE HH:mm"> 
  <meta name="ajs-date-dmy" content="dd/MMM/yy"> 
  <meta name="ajs-date-complete" content="dd/MMM/yy HH:mm"> 
  <script type="text/javascript">var AJS=AJS||{};AJS.debug=true;</script> 
  <meta id="atlassian-token" name="atlassian-token" content="A5KQ-2QAV-T4JA-FDED|31d68a1229c0a9c9770280e0d4a8304f7dbdaa3e|lout"> 
  <link rel="shortcut icon" href="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/favicon.ico"> 
  <!--[if IE]><![endif]--> 
  <script type="text/javascript">
    (function() {
        var contextPath = '/jira';
        var eventBuffer = [];

        function printDeprecatedMsg() {
            if (console && console.warn) {
                console.warn('DEPRECATED JS - contextPath global variable has been deprecated since 7.4.0. Use `wrm/context-path` module instead.');
            }
        }

        function sendEvent(analytics, postfix) {
            analytics.send({
                name: 'js.globals.contextPath.' + postfix
            });
        }

        function sendDeprecatedEvent(postfix) {
            try {
                var analytics = require('jira/analytics');
                if (eventBuffer.length) {
                    eventBuffer.forEach(function(value) {
                        sendEvent(analytics, value);
                    });
                    eventBuffer = [];
                }

                if (postfix) {
                    sendEvent(analytics, postfix);
                }
            } catch(ex) {
                eventBuffer.push(postfix);
                setTimeout(sendDeprecatedEvent, 1000);
            }
        }

        Object.defineProperty(window, 'contextPath', {
            get: function() {
                printDeprecatedMsg();
                sendDeprecatedEvent('get');
                return contextPath;
            },
            set: function(value) {
                printDeprecatedMsg();
                sendDeprecatedEvent('set');
                contextPath = value;
            }
        });
    })();

</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/jira\"";
WRM._unparsedData["jira.webresources:feature-flags.feature-flag-data"]="{\"enabled-feature-keys\":[\"com.atlassian.jira.agile.darkfeature.editable.detailsview\",\"nps.survey.inline.dialog\",\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint.enabled\",\"jira.plugin.devstatus.phasetwo\",\"jira.frother.reporter.field\",\"atlassian.rest.xsrf.legacy.enabled\",\"jira.issue.status.lozenge\",\"com.atlassian.jira.config.BIG_PIPE\",\"com.atlassian.jira.projects.issuenavigator\",\"com.atlassian.jira.config.PDL\",\"jira.plugin.devstatus.phasetwo.enabled\",\"atlassian.aui.raphael.disabled\",\"app-switcher.new\",\"frother.assignee.field\",\"com.atlassian.jira.projects.ProjectCentricNavigation.Switch\",\"sd.internal.base.off.thread.on.completion.events.enabled\",\"jira.onboarding.cyoa\",\"com.atlassian.jira.agile.darkfeature.kanplan.enabled\",\"sd.slavalue.record.updated.date.enabled\",\"com.atlassian.jira.config.ProjectConfig.MENU\",\"com.atlassian.jira.projects.sidebar.DEFER_RESOURCES\",\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions.enabled\",\"com.atlassian.jira.agile.darkfeature.sprint.goal.enabled\",\"jira.zdu.admin-updates-ui\",\"jira.zdu.jmx-monitoring\",\"sd.sla.improved.rendering.enabled\",\"sd.canned.responses.enabled\",\"sd.new.settings.sidebar.location.disabled\",\"jira.zdu.cluster-upgrade-state\",\"com.atlassian.jira.agile.darkfeature.splitissue\",\"com.atlassian.jira.config.CoreFeatures.LICENSE_ROLES_ENABLED\",\"com.atlassian.feedback.feedback-button-move-to-header-enable\",\"jira.export.csv.enabled\"],\"feature-flag-states\":{\"com.atlassian.jira.agile.darkfeature.kanplan\":false,\"sd.internal.base.off.thread.on.completion.events\":false,\"jira.instrumentation.laas\":false,\"com.atlassian.jira.agile.darkfeature.edit.closed.sprint\":false,\"com.atlassian.jira.issuetable.draggable\":true,\"jira.create.linked.issue\":true,\"com.atlassian.jira.agile.darkfeature.sprint.goal\":false,\"jira.sal.host.connect.accessor.existing.transaction.will.create.transactions\":true,\"jira.jql.suggestrecentfields\":false,\"com.atlassian.jira.agile.darkfeature.kanplan.epics.and.versions\":false,\"jira.jql.smartautoselectfirst\":false,\"com.atlassian.jira.agile.darkfeature.optimistic.transitions\":true,\"com.atlassian.jira.issuetable.move.links.hidden\":true,\"jira.priorities.per.project\":true,\"com.atlassian.jira.upgrade.startup.fix.index\":true,\"jira.renderer.consider.variable.format\":true}}";
WRM._unparsedData["jira.webresources:default-comment-security-level.DefaultCommentSecurityLevelHelpLink"]="{\"extraClasses\":\"default-comment-level-help\",\"title\":\"Commenting on an Issue\",\"url\":\"https://docs.atlassian.com/jira/jcore-docs-076/Editing+and+collaborating+on+issues#Editingandcollaboratingonissues-restrictacomment\",\"isLocal\":false}";
WRM._unparsedData["jira.webresources:dateFormatProvider.allFormats"]="{\"dateFormats\":{\"meridiem\":[\"AM\",\"PM\"],\"eras\":[\"BC\",\"AD\"],\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"monthsShort\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"weekdaysShort\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]},\"lookAndFeelFormats\":{\"relativize\":\"true\",\"time\":\"HH:mm\",\"day\":\"EEEE HH:mm\",\"dmy\":\"dd/MMM/yy\",\"complete\":\"dd/MMM/yy HH:mm\"}}";
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:issueviewer.features"]="{\"rteEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.thumbnail-mime-types"]="\"image/vnd.wap.wbmp,image/png,image/x-png,image/jpeg,image/bmp,image/gif\"";
WRM._unparsedData["com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-issue-drop-zone.upload-limit"]="\"62914560\"";
WRM._unparsedData["com.atlassian.plugins.helptips.jira-help-tips:help-tip-manager.JiraHelpTipData"]="{\"anonymous\":true}";
WRM._unparsedData["com.atlassian.jira.jira-view-issue-plugin:controller-subtasks.controller.subtasks.parameters"]="{\"url\":\"/rest/api/2/issue/{issueId}/subtask/move\"}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["jira.webresources:avatar-picker.data"]="{}";
WRM._unparsedData["com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data"]="{\"jira.feedback.plugin.issue.collector.core\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.default\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"jira.feedback.plugin.issue.collector.service.desk\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?locale=en-UK&collectorId=a698db21\",\"jira.feedback.plugin.issue.collector.software\":\"https://jira.atlassian.com/s/576e9ab86257d4f65f6ea5b6dd50de44-T/en_UK3ljiw5/71006/b6b48b2829824b869586ac216d119363/2.0.11/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=abbf546d\",\"isHeaderFeedbackButtonEnabled\":true}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:dismissedFlags.flags"]="{\"dismissed\":[]}";
WRM._unparsedData["com.atlassian.jira.jira-header-plugin:newsletter-signup-tip-init.newsletterSignup"]="{\"signupDescription\":\"Get updates, inspiration and best practices from the team behind JIRA.\",\"formUrl\":\"https://www.atlassian.com/apis/exact-target/{0}/subscribe?mailingListId=1401671\",\"signupTitle\":\"Sign up!\",\"signupId\":\"newsletter-signup-tip\",\"showNewsletterTip\":false}";
WRM._unparsedData["com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources.ptAnalyticsData"]="{\"instanceCreatedDate\":\"2011-01-31\"}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.help-data"]="{\"showHelp\":true,\"editorDocumentationUrl\":[\"https://docs.atlassian.com/jira/jcore-docs-076/Visual+editing\"],\"editorDocumentationTitle\":[\"Show me documentation for the visual editor\"]}";
WRM._unparsedData["com.atlassian.jira.plugins.jira-wiki-editor:wiki-editor-resources.thumbnails-allowed"]="false";
WRM._unparsedData["jira.webresources:user-message-flags.adminLockout"]="{}";
WRM._unparsedData["jira.request.correlation-id"]="\"e6257859bb9a5b\"";
WRM._unparsedData["project-id"]="10594";
WRM._unparsedData["project-key"]="\"DERBY\"";
WRM._unparsedData["project-name"]="\"Derby\"";
WRM._unparsedData["project-type"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:generic-filters"]="[{\"id\":\"allissues\",\"jql\":\"project = \\\"{0}\\\" ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"All issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[]},{\"id\":\"allopenissues\",\"jql\":\"project = \\\"{0}\\\" AND resolution = Unresolved ORDER BY {1}\",\"defaultOrderby\":\"priority DESC, updated DESC\",\"label\":\"Open issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"resolution\"]},{\"id\":\"doneissues\",\"jql\":\"project = \\\"{0}\\\" AND statusCategory = Done ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Done issues\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"status\"]},{\"id\":\"recentlyviewed\",\"jql\":\"project = \\\"{0}\\\" AND issuekey in issueHistory() ORDER BY {1}\",\"defaultOrderby\":\"lastViewed DESC\",\"label\":\"Viewed recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"issuekey\"]},{\"id\":\"addedrecently\",\"jql\":\"project = \\\"{0}\\\" AND created \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"created DESC\",\"label\":\"Created recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"created\"]},{\"id\":\"resolvedrecently\",\"jql\":\"project = \\\"{0}\\\" AND resolutiondate \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Resolved recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":false,\"fields\":[\"resolutiondate\"]},{\"id\":\"updatedrecently\",\"jql\":\"project = \\\"{0}\\\" AND updated \u003e= -1w ORDER BY {1}\",\"defaultOrderby\":\"updated DESC\",\"label\":\"Updated recently\",\"requiresUser\":false,\"supportsInlineIssueCreate\":true,\"fields\":[\"updated\"]}]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:default-filter-priority"]="[\"allopenissues\",\"allissues\"]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-manage-filters"]="false";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:project-filters"]="[]";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:can-create-issues"]="false";
WRM._unparsedData["projectId"]="10594";
WRM._unparsedData["projectKey"]="\"DERBY\"";
WRM._unparsedData["projectType"]="\"software\"";
WRM._unparsedData["com.atlassian.jira.jira-projects-issue-navigator:server-rendered"]="true";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/a8a4711bc3f2eb261d8c8fd9fbcbba8b-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/css/_super/batch.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/74ac580603ca910fff0cfdf319e54add-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/css/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.css?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" media="all"> 
  <link type="text/css" rel="stylesheet" href="/jira/s/611672383f6cab00ab202241ba6f9d68-T/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources-init/com.atlassian.feedback.jira-feedback-plugin:button-resources-init.css" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources-init" data-wrm-batch-type="resource" media="all"> 
  <script type="text/javascript" src="/jira/s/98ceb006e504d7924d5ffc411626c6bc-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1fca1750044f2777c977e8d8cc023344/_/download/contextbatch/js/_super/batch.js?locale=en-UK" data-wrm-key="_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/c1e4d26ea276469807c3dc0918df482c-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/fbf45109b31165e5b7740a9d72318cea/_/download/contextbatch/js/project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super/batch.js?agile_global_admin_condition=true&amp;hc-enabled=true&amp;is-server-instance=true&amp;jag=true&amp;jira.create.linked.issue=true&amp;locale=en-UK&amp;nps-acknowledged=true&amp;richediton=true" data-wrm-key="project.issue.navigator,jira.view.issue,jira.global,atl.general,jira.general,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/6bf9253c8d533109c3b02e26794be24e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/871d45c9f322a22cb3aa9b7948a69803/_/download/contextbatch/js/atl.global,-_super/batch.js?locale=en-UK" data-wrm-key="atl.global,-_super" data-wrm-batch-type="context" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-en/jira.webresources:calendar-en.js" data-wrm-key="jira.webresources:calendar-en" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:calendar-localisation-moment/jira.webresources:calendar-localisation-moment.js" data-wrm-key="jira.webresources:calendar-localisation-moment" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/7.6.3/_/download/batch/com.atlassian.feedback.jira-feedback-plugin:button-resources/com.atlassian.feedback.jira-feedback-plugin:button-resources.js" data-wrm-key="com.atlassian.feedback.jira-feedback-plugin:button-resources" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/ccd2e67b523185973473e8bd5735c8f9-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/e0de73613a1027de08f3da6a45e1d1a2/_/download/contextbatch/css/jira.global.look-and-feel,-_super/batch.css" data-wrm-key="jira.global.look-and-feel,-_super" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/rest/api/1.0/shortcuts/76005/33e5e0166867c8c9228d44506f60b2e8/shortcuts.js?context=issuenavigation&amp;context=issueaction"></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.jira.jira-issue-nav-components:inline-edit-enabled"]="true";
WRM._unparsedData["should-display-chaperone"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <link type="text/css" rel="stylesheet" href="/jira/s/15712b600e9aecf72ffd9fd3704a0c78-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/css/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.css?jira.create.linked.issue=true&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" media="all"> 
  <script type="text/javascript" src="/jira/s/6579b6b8ba67abaa496e39b9242a18a4-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/6b22a15c7b83f87a47b1757076f43542/_/download/contextbatch/js/com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue/batch.js?jira.create.linked.issue=true&amp;locale=en-UK&amp;richediton=true" data-wrm-key="com.atlassian.jira.projects.sidebar.init,-_super,-project.issue.navigator,-jira.view.issue" data-wrm-batch-type="context" data-initially-rendered></script> 
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta name="ajs-can-search-users" content="false"> 
  <meta name="ajs-can-edit-watchers" content="false"> 
  <meta name="ajs-default-avatar-url" content="https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10453"> 
  <meta name="ajs-issue-project-type" content="software"> 
  <meta name="ajs-issue-key" content="DERBY-5317"> 
  <meta name="ajs-server-view-issue-is-editable" content="false"> 
  <title>[DERBY-5317]  NullPointerException in org.apache.derby.client.net.Request.sendBytes()  with client - ASF JIRA</title> 
  <link rel="search" type="application/opensearchdescription+xml" href="/jira/osd.jsp" title="[DERBY-5317]  NullPointerException in org.apache.derby.client.net.Request.sendBytes()  with client - ASF JIRA"> 
 </head> 
 <body id="jira" class="aui-layout aui-theme-default " data-version="7.6.3"> 
  <div id="page"> 
   <header id="header" role="banner"> 
    <script>
require(["jquery", "jira/license-banner"], function ($, licenseBanner) {
    $(function () {
        licenseBanner.showLicenseBanner("");
        licenseBanner.showLicenseFlag("");
    });
});
</script> 
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation">
     <div class="aui-header-inner">
      <div class="aui-header-before">
       <a class=" aui-dropdown2-trigger app-switcher-trigger" aria-controls="app-switcher" aria-haspopup="true" role="button" tabindex="0" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a>
       <div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" aria-hidden="true" data-is-switcher="true" data-environment="{&quot;isUserAdmin&quot;:false,&quot;isAppSuggestionAvailable&quot;:false,&quot;isSiteAdminUser&quot;:false}">
        <div role="application">
         <div class="app-switcher-loading">
          Loading…
         </div>
        </div>
       </div>
      </div>
      <div class="aui-header-primary">
       <h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://issues.apache.org/jira/secure/MyJiraHome.jspa"><img src="/jira/s/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/_/jira-logo-scaled.png" alt="ASF JIRA"></a></h1>
       <ul class="aui-nav">
        <li><a href="/jira/secure/Dashboard.jspa" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="home_link" aria-haspopup="true" aria-controls="home_link-content" title="View and manage your dashboards" accesskey="d">Dashboards</a>
         <div class="aui-dropdown2 aui-style-default" id="home_link-content" data-aui-dropdown2-ajax-key="home_link"></div></li>
        <li><a href="/jira/browse/DERBY" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="browse_link" aria-haspopup="true" aria-controls="browse_link-content" title="View recent projects and browse a list of projects" accesskey="p">Projects</a>
         <div class="aui-dropdown2 aui-style-default" id="browse_link-content" data-aui-dropdown2-ajax-key="browse_link"></div></li>
        <li><a href="/jira/issues/" class=" aui-nav-link aui-dropdown2-trigger aui-dropdown2-ajax" id="find_link" aria-haspopup="true" aria-controls="find_link-content" title="Search for issues and view recent issues" accesskey="i">Issues</a>
         <div class="aui-dropdown2 aui-style-default" id="find_link-content" data-aui-dropdown2-ajax-key="find_link"></div></li> 
       </ul>
      </div>
      <div class="aui-header-secondary">
       <ul class="aui-nav">
        <li id="quicksearch-menu"> 
         <form action="/jira/secure/QuickSearch.jspa" method="get" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt"> 
          <input id="quickSearchInput" class="search" type="text" title="Search" placeholder="Search" name="searchString" accessKey="q"> 
          <input type="submit" class="hidden" value="Search"> 
         </form> </li> 
        <li><a class="jira-feedback-plugin" role="button" aria-haspopup="true" id="jira-header-feedback-link" href="#"><span class="aui-icon aui-icon-small jira-feedback-plugin-icon">Give feedback to Atlassian</span></a></li> 
        <li id="system-help-menu"> <a class="aui-nav-link aui-dropdown2-trigger" id="help_menu" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="$textUtils.htmlEncode($rootHelpMenuItem.params.target)" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a> 
         <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
           <ul id="jira-help" class="aui-list-truncate"> 
            <li> <a id="view_core_help" class="aui-nav-link " title="Go to the online documentation for JIRA Core" href="https://docs.atlassian.com/jira/jcore-docs-076/" target="_blank">JIRA Core help</a> </li> 
            <li> <a id="keyshortscuthelp" class="aui-nav-link " title="Get more information about JIRA's Keyboard Shortcuts" href="/jira/secure/ViewKeyboardShortcuts!default.jspa" target="_blank">Keyboard Shortcuts</a> </li> 
            <li> <a id="view_about" class="aui-nav-link " title="Get more information about JIRA" href="/jira/secure/AboutPage.jspa">About JIRA</a> </li> 
            <li> <a id="view_credits" class="aui-nav-link " title="See who did what" href="/jira/secure/JiraCreditsPage!default.jspa" target="_blank">JIRA Credits</a> </li> 
           </ul> 
          </div> 
         </div> </li> 
        <li id="user-options"> <a class="aui-nav-link login-link" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-5317">Log In</a> 
         <div id="user-options-content" class="aui-dropdown2 aui-style-default"> 
          <div class="aui-dropdown2-section"> 
          </div> 
         </div> </li> 
       </ul>
      </div>
     </div>
     <!-- .aui-header-inner-->
    </nav>
    <!-- .aui-header --> 
   </header> 
   <section id="content" role="main"> 
    <big-pipe data-id="sidebar-id" unresolved></big-pipe>
    <div class="aui-sidebar  sidebar-placeholder">
     <div class="aui-sidebar-wrapper">
      <div class="aui-sidebar-body"></div>
      <div class="aui-sidebar-footer">
       <a class="aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy" data-tooltip="Expand sidebar ( [ )" href="#"><span class="aui-icon aui-icon-small"></span></a>
      </div>
     </div>
    </div>
    <script id="projects-sidebar-init">
    require(['jira/projects/sidebar/expansion-manager'], function(expansionManager) {
        var scriptTag = document.getElementById('projects-sidebar-init');
        var sidebar = AJS.sidebar('.aui-sidebar');
        expansionManager(sidebar);
        scriptTag.parentElement.removeChild(scriptTag);
    });
    </script>
    <div class="aui-page-panel">
     <div class="aui-page-panel-inner">
      <div class="issue-navigator">
       <div class="content">
        <div class="issue-view">
         <div class="navigation-tools">
          <div class="pager-container"></div>
         </div>
         <div class="issue-container">
          <div id="issue-content" class="issue-edit-form">
           <header id="stalker" class="issue-header js-stalker">
            <div class="issue-header-content">
             <header class="aui-page-header">
              <div class="aui-page-header-inner">
               <div class="aui-page-header-image">
                <span id="10594" class="aui-avatar aui-avatar-large aui-avatar-project"><span class="aui-avatar-inner"><img id="project-avatar" alt="Uploaded image for project: 'Derby'" src="https://issues.apache.org/jira/secure/projectavatar?pid=10594&amp;avatarId=10122"></span></span>
               </div>
               <!-- .aui-page-header-image -->
               <div class="aui-page-header-main">
                <ol class="aui-nav aui-nav-breadcrumbs">
                 <li><a id="project-name-val" href="/jira/browse/DERBY">Derby</a></li>
                 <li><a class="issue-link" data-issue-key="DERBY-5317" href="/jira/browse/DERBY-5317" id="key-val" rel="12513038">DERBY-5317</a></li>
                </ol>
                <h1 id="summary-val"> NullPointerException in org.apache.derby.client.net.Request.sendBytes() with client</h1>
               </div>
               <!-- .aui-page-header-main -->
               <div class="aui-page-header-actions">
                <div id="issue-header-pager"></div>
               </div>
               <!-- .aui-page-header-actions -->
              </div>
              <!-- .aui-page-header-inner -->
             </header>
             <!-- .aui-page-header -->
             <div class="command-bar">
              <div class="ops-cont">
               <div class="ops-menus aui-toolbar">
                <div class="toolbar-split toolbar-split-left">
                 <ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item"><a id="ops-login-lnk" title="Log In" class="toolbar-trigger" href="/jira/login.jsp?os_destination=%2Fbrowse%2FDERBY-5317"><span class="trigger-label">Log In</span></a></li>
                 </ul>
                 <ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul>
                 <ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul>
                </div>
                <div class="toolbar-split toolbar-split-right">
                 <ul id="opsbar-jira.issue.tools" class="toolbar-group pluggable-ops">
                  <li class="toolbar-item">
                   <div>
                    <a href="#" id="viewissue-export" aria-owns="viewissue-export_drop" aria-haspopup="true" title="Export this issue in another format" class="toolbar-trigger aui-button aui-style-default aui-dropdown2-trigger"><span class="icon icon-default aui-icon aui-icon-small aui-iconfont-export"></span> <span class="dropdown-text">Export</span></a>
                    <div id="viewissue-export_drop" class="aui-style-default aui-dropdown2">
                     <ul>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-xml/DERBY-5317/DERBY-5317.xml" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-word/DERBY-5317/DERBY-5317.doc" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/jira.issueviews:issue-html/DERBY-5317/DERBY-5317.html" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li>
                      <li class="aui-list-item"><a href="/jira/si/com.atlassian.jira.plugins.jira-importers-plugin:issue-json/DERBY-5317/DERBY-5317.json" id="com.atlassian.jira.plugins.jira-importers-plugin:issue-json"><span class="trigger-label">JSON</span></a></li>
                     </ul>
                    </div>
                   </div></li>
                 </ul>
                </div>
               </div>
              </div>
             </div>
            </div>
           </header>
           <div class="issue-body-content">
            <div class="aui-group issue-body">
             <div class="aui-item issue-main-column">
              <div id="details-module" class="module toggle-wrap">
               <div id="details-module_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Details</h2>
               </div>
               <div class="mod-content"> 
                <ul id="issuedetails" class="property-list two-cols"> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Type:</strong> 
                   <span id="type-val" class="value"> <img alt="" height="16" src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" title="Bug - A problem which impairs or prevents the functions of the product." width="16"> Bug </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Status:</strong> 
                   <span id="status-val" class="value"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </span> 
                  </div> </li> 
                 <li class="item new"> 
                  <div class="wrap"> 
                   <strong class="name">Priority:</strong> 
                   <span id="priority-val" class="value"> <img alt="" height="16" src="/jira/images/icons/priorities/major.svg" title="Major - Major loss of function." width="16"> Major </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Resolution:</strong> 
                   <span id="resolution-val" class="value resolved"> Fixed </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Affects Version/s:</strong> 
                   <span id="versions-val" class="value"> <span class="shorten" id="versions-field"> <span title="10.9.1.0 First release on the 10.9 branch">10.9.1.0</span> </span> </span> 
                  </div> </li> 
                 <li class="item item-right"> 
                  <div class="wrap"> 
                   <strong class="name">Fix Version/s:</strong> 
                   <span id="fixfor-val" class="value"> <span class="shorten" id="fixVersions-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+fixVersion+%3D+10.11.1.1" title="10.11.1.1 First release on the 10.11 branch">10.11.1.1</a> </span> </span> 
                  </div> </li> 
                 <li class="item"> 
                  <div class="wrap"> 
                   <strong class="name">Component/s:</strong> 
                   <span id="components-val" class="value"> <span class="shorten" id="components-field"> <a href="/jira/issues/?jql=project+%3D+DERBY+AND+component+%3D+%22Network+Client%22" title="Network Client ">Network Client</a> </span> </span> 
                  </div> </li> 
                 <li class="item full-width"> 
                  <div class="wrap" id="wrap-labels"> 
                   <strong class="name">Labels:</strong> 
                   <div class="labels-wrap value"> 
                    <ul class="labels" id="labels-12513038-value"> 
                     <li><a class="lozenge" href="/jira/issues/?jql=labels+%3D+derby_backport_reject_10_10" title="derby_backport_reject_10_10"><span>derby_backport_reject_10_10</span></a></li> 
                     <li><a class="lozenge" href="/jira/issues/?jql=labels+%3D+derby_triage10_11" title="derby_triage10_11"><span>derby_triage10_11</span></a></li> 
                    </ul> 
                   </div> 
                  </div> </li> 
                </ul> 
                <div id="customfieldmodule"> 
                 <div class="aui-tabs horizontal-tabs" id="customfield-tabs"> 
                  <div id="customfield-panel-1" class="tabs-pane active-pane"> 
                   <ul class="property-list"> 
                    <li id="rowForcustomfield_12310050" class="item"> 
                     <div class="wrap"> 
                      <strong title="Urgency" class="name">Urgency:</strong> 
                      <div id="customfield_12310050-val" class="value type-select" data-fieldtype="select" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        Urgent 
                      </div> 
                     </div> </li> 
                    <li id="rowForcustomfield_12310090" class="item"> 
                     <div class="wrap"> 
                      <strong title="Issue &amp; fix info" class="name">Issue &amp; fix info:</strong> 
                      <div id="customfield_12310090-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310090-field"> 
                        <span>High Value Fix</span>, 
                        <span>Repro attached</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                    <li id="rowForcustomfield_12310200" class="item"> 
                     <div class="wrap"> 
                      <strong title="Bug behavior facts" class="name">Bug behavior facts:</strong> 
                      <div id="customfield_12310200-val" class="value type-multicheckboxes" data-fieldtype="multicheckboxes" data-fieldtypecompletekey="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"> 
                       <div class="shorten" id="customfield_12310200-field"> 
                        <span>Crash</span>, 
                        <span>Embedded/Client difference</span>, 
                        <span>Regression</span> 
                       </div> 
                      </div> 
                     </div> </li> 
                   </ul> 
                  </div> 
                 </div>
                </div> 
               </div>
              </div>
              <div id="descriptionmodule" class="module toggle-wrap">
               <div id="descriptionmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Description</h2>
               </div>
               <div class="mod-content">
                <div id="description-val" class="field-ignore-highlight"> 
                 <div class="user-content-block"> 
                  <p>Investigating <a href="https://issues.apache.org/jira/browse/DERBY-5308" title="Investigate if largeData/LobLimits.java  can be run for client" class="issue-link" data-issue-key="DERBY-5308"><del>DERBY-5308</del></a>, I found that the LobLimits.java test run with client fails with a NullPointerException.</p> 
                  <p>END setup<br> ========================================<br> START ClobTest #1 -insertClob of size = 2147483647<br> Rows inserted with clob of size (2147483647) = 2<br> ========================================<br> ========================================<br> START ClobTest #2 - SELECT CLOB of size = 2147483647<br> Matched rows selected with clob of size(2147483647) =1<br> ========================================<br> ========================================<br> START ClobTest #3 - SELECT CLOB of size = 2147483647<br> Matched rows selected with clob of size(2147483647) =1<br> ========================================<br> ========================================<br> START ClobTest #4 - select and then update clob of size= 2147483647 - Uses setClob api<br> FAIL – Unexpected exception:<br> java.lang.NullPointerException<br> at org.apache.derby.client.net.Request.sendBytes(Unknown Source)<br> at org.apache.derby.client.net.Request.flushScalarStreamSegment(Unknown Source)<br> at org.apache.derby.client.net.Request.padScalarStreamForError(Unknown Source)<br> at org.apache.derby.client.net.Request.writePlainScalarStream(Unknown Source)<br> at org.apache.derby.client.net.Request.writeScalarStream(Unknown Source)<br> at org.apache.derby.client.net.Request.writeScalarStream(Unknown Source)<br> at org.apache.derby.client.net.NetStatementRequest.buildEXTDTA(Unknown Source)<br> at org.apache.derby.client.net.NetStatementRequest.writeExecute(Unknown Source)<br> at org.apache.derby.client.net.NetPreparedStatement.writeExecute_(Unknown Source)<br> at org.apache.derby.client.am.PreparedStatement.writeExecute(Unknown Source)<br> at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)<br> at org.apache.derby.client.am.PreparedStatement.executeUpdateX(Unknown Source)<br> at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)<br> at org.apache.derbyTesting.functionTests.tests.largedata.LobLimits.selectUpdateClob(LobLimits.java:115<br> 7)<br> at org.apache.derbyTesting.functionTests.tests.largedata.LobLimits.clobTests(LobLimits.java:313)<br> at org.apache.derbyTesting.functionTests.tests.largedata.LobLimits.runTests(LobLimits.java:177)<br> at org.apache.derbyTesting.functionTests.tests.largedata.LobLimits.main(LobLimits.java:151)<br> ========================================<br> START ClobTest #12.1 -insertClob of size = 104857600<br> NEGATIVE TEST - Expected Exception:<br> EXPECTED SQL Exception: (08003) No current connection.<br> ========================================<br> START ClobTest #12.2 - SELECT CLOB of size = 104857600<br> FAIL – Unexpected exception:<br> java.sql.SQLNonTransientConnectionException: No current connection.<br> at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)<br> at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)<br> at org.apache.derby.client.am.PreparedStatement.setInt(Unknown Source)<br> at org.apache.derbyTesting.functionTests.tests.largedata.LobLimits.selectClob(LobLimits.java:1007)</p> 
                  <p>In the derby.log I see</p> 
                  <p>derby.system.home=/local0/kmarsden/repro/largeData/testtrunkdnc/DerbyNetClient/LobLimits<br> Database Class Loader started - derby.database.classpath=''<br> Tue Jul 05 17:50:01 PDT 2011 Thread<span class="error">[DRDAConnThread_11,5,main]</span> (DATABASE = wombat), (DRDAID = .-580681567053183<br> 269</p> {2}), Execution failed because of a Distributed Protocol Error: DRDA_Proto_SYNTAXRM; CODPNT arg = 200d; E
                  <br> rror Code Value = 1d. Plaintext connection attempt from an SSL enabled client?
                  <br> Tue Jul 05 17:50:01 PDT 2011 : Execution failed because of a Distributed Protocol Error: DRDA_Proto_SYNTAXRM;
                  <br> CODPNT arg = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enabled client?
                  <br> org.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of a Distributed Protocol Error: D
                  <br> RDA_Proto_SYNTAXRM; CODPNT arg = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enable
                  <br> d client?
                  <br> at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(Unknown Source)
                  <br> at org.apache.derby.impl.drda.DRDAConnThread.invalidCodePoint(Unknown Source)
                  <br> at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(Unknown Source)
                  <br> at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(Unknown Source)
                  <br> at org.apache.derby.impl.drda.DRDAConnThread.processCommands(Unknown Source)
                  <br> at org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)
                  <br> Tue Jul 05 17:50:01 PDT 2011 Thread
                  <span class="error">[DRDAConnThread_11,5,main]</span> (DATABASE = wombat), (DRDAID = .-580681567053183
                  <br> 269{2} 
                  <p>), Execution failed because of a Distributed Protocol Error: DRDA_Proto_SYNTAXRM; CODPNT arg = 200d; E<br> rror Code Value = 1d. Plaintext connection attempt from an SSL enabled client?<br> Tue Jul 05 17:50:01 PDT 2011 : Execution failed because of a Distributed Protocol Error: DRDA_Proto_SYNTAXRM;<br> CODPNT arg = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enabled client?<br> org.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of a Distributed Protocol Error: D<br> RDA_Proto_SYNTAXRM; CODPNT arg = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enable<br> d client?<br> at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(Unknown Source)<br> at org.apache.derby.impl.drda.DRDAConnThread.invalidCodePoint(Unknown Source)<br> at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(Unknown Source)<br> at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(Unknown Source)<br> at org.apache.derby.impl.drda.DRDAConnThread.processCommands(Unknown Source)<br> at org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)<br> ----------------------------------------------------------------<br> Tue Jul 05 17:50:07 PDT 2011: Shutting down Derby engine<br> ----------------------------------------------------------------<br> Tue Jul 05 17:50:07 PDT 2011:</p> 
                  <p>To run the test, you have to remove largeData from DerbyNetClient.exclude and run<br> java -Dframework=DerbyNetClient org.apache.derbyTesting.functionTests.harness.RunTest org.apache.derbyTesting.functionTests.tests.lageData.LobLimits.<br> It took about 3.5 hours to occur.</p> 
                  <p>I will work on a smaller reproduction.</p> 
                  <p> 5,9 36%</p> 
                 </div> 
                </div> 
               </div>
              </div>
              <div id="dnd-metadata" class="module toggle-wrap">
               <div id="dnd-metadata_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <div id="dnd-metadata-webpanel" data-can-attach="false" data-project-type="software" data-upload-limit="62914560" data-thumbnails-allowed="false"></div>
               </div>
              </div>
              <div id="attachmentmodule" class="module toggle-wrap">
               <div id="attachmentmodule_heading" class="mod-header">
                <ul class="ops">
                 <li class="drop">
                  <div class="aui-dd-parent">
                   <a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a>
                   <div class="aui-dropdown-content aui-list">
                    <ul id="attachment-sorting-options" class="aui-list-section aui-first">
                     <li class="aui-list-item"><a id="attachment-sort-key-name" href="/jira/browse/DERBY-5317?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-key-date" href="/jira/browse/DERBY-5317?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li>
                    </ul>
                    <ul id="attachment-sorting-order-options" class="aui-list-section aui-last">
                     <li class="aui-list-item"><a id="attachment-sort-direction-asc" href="/jira/browse/DERBY-5317?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li>
                     <li class="aui-list-item"><a id="attachment-sort-direction-desc" href="/jira/browse/DERBY-5317?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li>
                    </ul>
                   </div>
                  </div></li>
                </ul>
                <h2 class="toggle-title">Attachments</h2>
               </div>
               <div class="mod-content">
                <ol id="file_attachments" class="item-attachments" data-sort-key="fileName" data-sort-order="asc">
                 <li class="attachment-content js-file-attachment" data-attachment-id="12603824" data-issue-id="12513038" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12603824/derby-5317a.diff" draggable="true" data-downloadurl="text/x-patch:derby-5317a.diff:https://issues.apache.org/jira/secure/attachment/12603824/derby-5317a.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12603824/derby-5317a.diff" title="Latest  18/Sep/13 13:45 - Dyre Tjeldvoll" draggable="true" data-downloadurl="text/x-patch:derby-5317a.diff:https://issues.apache.org/jira/secure/attachment/12603824/derby-5317a.diff">derby-5317a.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2013-09-18T13:45:24.480Z">18/Sep/13 13:45</time>
                   </dd>
                   <dd class="attachment-size">
                    10 kB
                   </dd>
                   <dd class="attachment-author">
                    Dyre Tjeldvoll
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12605236" data-issue-id="12513038" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12605236/derby-5317b.diff" draggable="true" data-downloadurl="text/x-patch:derby-5317b.diff:https://issues.apache.org/jira/secure/attachment/12605236/derby-5317b.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12605236/derby-5317b.diff" title="Latest  26/Sep/13 11:30 - Dyre Tjeldvoll" draggable="true" data-downloadurl="text/x-patch:derby-5317b.diff:https://issues.apache.org/jira/secure/attachment/12605236/derby-5317b.diff">derby-5317b.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2013-09-26T11:30:21.525Z">26/Sep/13 11:30</time>
                   </dd>
                   <dd class="attachment-size">
                    12 kB
                   </dd>
                   <dd class="attachment-author">
                    Dyre Tjeldvoll
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12607330" data-issue-id="12513038" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12607330/derby-5317c.diff" draggable="true" data-downloadurl="text/x-patch:derby-5317c.diff:https://issues.apache.org/jira/secure/attachment/12607330/derby-5317c.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12607330/derby-5317c.diff" title="Latest  08/Oct/13 07:40 - Dyre Tjeldvoll" draggable="true" data-downloadurl="text/x-patch:derby-5317c.diff:https://issues.apache.org/jira/secure/attachment/12607330/derby-5317c.diff">derby-5317c.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2013-10-08T07:40:08.988Z">08/Oct/13 07:40</time>
                   </dd>
                   <dd class="attachment-size">
                    15 kB
                   </dd>
                   <dd class="attachment-author">
                    Dyre Tjeldvoll
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12607574" data-issue-id="12513038" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12607574/derby-5317d.diff" draggable="true" data-downloadurl="text/x-patch:derby-5317d.diff:https://issues.apache.org/jira/secure/attachment/12607574/derby-5317d.diff"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12607574/derby-5317d.diff" title="Latest  09/Oct/13 15:08 - Dyre Tjeldvoll" draggable="true" data-downloadurl="text/x-patch:derby-5317d.diff:https://issues.apache.org/jira/secure/attachment/12607574/derby-5317d.diff">derby-5317d.diff</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2013-10-09T15:08:33.457Z">09/Oct/13 15:08</time>
                   </dd>
                   <dd class="attachment-size">
                    15 kB
                   </dd>
                   <dd class="attachment-author">
                    Dyre Tjeldvoll
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12485669" data-issue-id="12513038" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12485669/Repro5317.java" draggable="true" data-downloadurl="java/*:Repro5317.java:https://issues.apache.org/jira/secure/attachment/12485669/Repro5317.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12485669/Repro5317.java" title="Latest  08/Jul/11 00:09 - Kathey Marsden" draggable="true" data-downloadurl="java/*:Repro5317.java:https://issues.apache.org/jira/secure/attachment/12485669/Repro5317.java">Repro5317.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-07-08T00:09:23.486Z">08/Jul/11 00:09</time>
                   </dd>
                   <dd class="attachment-size">
                    20 kB
                   </dd>
                   <dd class="attachment-author">
                    Kathey Marsden
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment earlier-version" data-attachment-id="12485639" data-issue-id="12513038" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12485639/Repro5317.java" draggable="true" data-downloadurl="java/*:Repro5317.java:https://issues.apache.org/jira/secure/attachment/12485639/Repro5317.java"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-devtools-file" title="File"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12485639/Repro5317.java" title=" 07/Jul/11 18:48 - Kathey Marsden" draggable="true" data-downloadurl="java/*:Repro5317.java:https://issues.apache.org/jira/secure/attachment/12485639/Repro5317.java">Repro5317.java</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-07-07T18:48:18.524Z">07/Jul/11 18:48</time>
                   </dd>
                   <dd class="attachment-size">
                    20 kB
                   </dd>
                   <dd class="attachment-author">
                    Kathey Marsden
                   </dd>
                  </dl></li>
                 <li class="attachment-content js-file-attachment" data-attachment-id="12485670" data-issue-id="12513038" data-attachment-type="file">
                  <div class="attachment-thumb">
                   <a href="/jira/secure/attachment/12485670/traces_10_2and10_9.zip" draggable="true" data-downloadurl="application/zip:traces_10_2and10_9.zip:https://issues.apache.org/jira/secure/attachment/12485670/traces_10_2and10_9.zip"><span class="aui-icon aui-icon-small attachment-icon aui-iconfont-file-zip" title="Zip Archive"></span></a>
                  </div>
                  <dl>
                   <dt class="attachment-title">
                    <a href="/jira/secure/attachment/12485670/traces_10_2and10_9.zip" title="Latest  08/Jul/11 00:09 - Kathey Marsden" draggable="true" data-downloadurl="application/zip:traces_10_2and10_9.zip:https://issues.apache.org/jira/secure/attachment/12485670/traces_10_2and10_9.zip">traces_10_2and10_9.zip</a>
                   </dt>
                   <dd class="attachment-delete">
                    <span class="icon"></span>
                   </dd>
                   <dd class="attachment-date">
                    <time class="livestamp" datetime="2011-07-08T00:09:23.496Z">08/Jul/11 00:09</time>
                   </dd>
                   <dd class="attachment-size">
                    783 kB
                   </dd>
                   <dd class="attachment-author">
                    Kathey Marsden
                   </dd>
                  </dl></li>
                </ol>
               </div>
              </div>
              <div id="linkingmodule" class="module toggle-wrap">
               <div id="linkingmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Issue Links</h2>
               </div>
               <div class="mod-content"> 
                <div class="links-container" data-default-link-icon="/jira/images/icons/generic_link_16.png"> 
                 <dl class="links-list "> 
                  <dt title="blocks">
                   blocks
                  </dt> 
                  <dd id="internal-12512461_10032"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" width="16" height="16" title="Improvement - An improvement or enhancement to an existing feature or task." alt="Improvement - An improvement or enhancement to an existing feature or task."> <span title="DERBY-5308: Investigate if largeData/LobLimits.java  can be run for client"> <a href="/jira/browse/DERBY-5308" data-issue-key="DERBY-5308" class="issue-link link-title resolution">DERBY-5308</a> <span class="link-summary">Investigate if largeData/LobLimits.java can be run for client</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                 <dl class="links-list "> 
                  <dt title="is related to">
                   is related to
                  </dt> 
                  <dd id="internal-12352050_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype" width="16" height="16" title="Sub-task - The sub-task of the issue" alt="Sub-task - The sub-task of the issue"> <span title="DERBY-1903: Convert  largedata/LobLimits.java to junit"> <a href="/jira/browse/DERBY-1903" data-issue-key="DERBY-1903" class="issue-link link-title resolution">DERBY-1903</a> <span class="link-summary">Convert largedata/LobLimits.java to junit</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/minor.svg" width="16" height="16" title="Minor - Minor loss of function, or other problem where easy workaround is present." alt="Minor - Minor loss of function, or other problem where easy workaround is present."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                  <dd id="internal-12354260_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" width="16" height="16" title="Bug - A problem which impairs or prevents the functions of the product." alt="Bug - A problem which impairs or prevents the functions of the product."> <span title="DERBY-2017: Client driver can insert and commit partial data when a LOB stream throws IOException or does not match the specified length"> <a href="/jira/browse/DERBY-2017" data-issue-key="DERBY-2017" class="issue-link link-title resolution">DERBY-2017</a> <span class="link-summary">Client driver can insert and commit partial data when a LOB stream throws IOException or does not match the specified length</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                  <dd id="internal-12512461_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype" width="16" height="16" title="Improvement - An improvement or enhancement to an existing feature or task." alt="Improvement - An improvement or enhancement to an existing feature or task."> <span title="DERBY-5308: Investigate if largeData/LobLimits.java  can be run for client"> <a href="/jira/browse/DERBY-5308" data-issue-key="DERBY-5308" class="issue-link link-title resolution">DERBY-5308</a> <span class="link-summary">Investigate if largeData/LobLimits.java can be run for client</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                 <dl class="links-list "> 
                  <dt title="relates to">
                   relates to
                  </dt> 
                  <dd id="internal-12674894_10030"> 
                   <div class="link-content"> 
                    <p> <img src="/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype" width="16" height="16" title="Bug - A problem which impairs or prevents the functions of the product." alt="Bug - A problem which impairs or prevents the functions of the product."> <span title="DERBY-6386: Errors in jdbc4.LobStreamTest if derbyclient.jar is first in the classpath"> <a href="/jira/browse/DERBY-6386" data-issue-key="DERBY-6386" class="issue-link link-title resolution">DERBY-6386</a> <span class="link-summary">Errors in jdbc4.LobStreamTest if derbyclient.jar is first in the classpath</span> </span> </p> 
                    <ul class="link-snapshot"> 
                     <li class="priority"> <img src="/jira/images/icons/priorities/major.svg" width="16" height="16" title="Major - Major loss of function." alt="Major - Major loss of function."> </li> 
                     <li class="status"> <span class=" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short" data-tooltip="<span class=&quot;jira-issue-status-tooltip-title&quot;>Closed</span><br><span class=&quot;jira-issue-status-tooltip-desc&quot;>The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.</span>">Closed</span> </li> 
                    </ul> 
                   </div> 
                  </dd> 
                 </dl> 
                </div> 
               </div>
              </div>
              <div id="activitymodule" class="module toggle-wrap">
               <div id="activitymodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Activity</h2>
               </div>
               <div class="mod-content"> 
                <big-pipe data-id="activity-panel-pipe-id" style="height: 70px"> 
                 <div></div> 
                </big-pipe> 
               </div>
              </div>
             </div>
             <div id="viewissuesidebar" class="aui-item issue-side-column">
              <div id="peoplemodule" class="module toggle-wrap">
               <div id="peoplemodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">People</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details" id="peopledetails"> 
                 <li class="people-details"> 
                  <dl> 
                   <dt>
                    Assignee:
                   </dt> 
                   <dd> 
                    <span id="assignee-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_assignee_dyret" rel="dyret" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Dyre Tjeldvoll&quot;,&quot;emailAddress&quot;:&quot;Dyre.Tjeldvoll@oracle.com&quot;,&quot;username&quot;:&quot;dyret&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="dyret"></span></span> Dyre Tjeldvoll </span> </span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Reporter:
                   </dt> 
                   <dd> 
                    <span id="reporter-val" class="view-issue-field"> <span class="user-hover" id="issue_summary_reporter_kmarsden" rel="kmarsden" data-user="{&quot;avatarUrl&quot;:&quot;https://issues.apache.org/jira/secure/useravatar?size=xsmall&amp;avatarId=10452&quot;,&quot;displayName&quot;:&quot;Kathey Marsden&quot;,&quot;emailAddress&quot;:&quot;kmarsdenderby@sbcglobal.net&quot;,&quot;username&quot;:&quot;kmarsden&quot;}"> <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="https://issues.apache.org/jira/secure/useravatar?size=small&amp;avatarId=10452" alt="kmarsden"></span></span> Kathey Marsden </span> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
                <ul class="item-details"> 
                 <li> 
                  <dl> 
                   <dt>
                    Votes:
                   </dt> 
                   <dd> 
                    <span id="vote-data" class="aui-badge vote-state-off">0</span> 
                    <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span> 
                   </dd> 
                  </dl> 
                  <dl> 
                   <dt>
                    Watchers:
                   </dt> 
                   <dd> 
                    <span id="watcher-data" class="aui-badge watch-state-off">4</span> 
                    <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
              <div id="datesmodule" class="module toggle-wrap">
               <div id="datesmodule_heading" class="mod-header">
                <ul class="ops"></ul>
                <h2 class="toggle-title">Dates</h2>
               </div>
               <div class="mod-content"> 
                <ul class="item-details"> 
                 <li> 
                  <dl class="dates"> 
                   <dt>
                    Created:
                   </dt> 
                   <dd class="date user-tz" title="06/Jul/11 21:17"> 
                    <span data-name="Created" id="created-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2011-07-06T21:17:01+0000">06/Jul/11 21:17</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Updated:
                   </dt> 
                   <dd class="date user-tz" title="21/Jan/15 00:22"> 
                    <span data-name="Updated" id="updated-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2015-01-21T00:22:56+0000">21/Jan/15 00:22</time> </span> 
                   </dd> 
                  </dl> 
                  <dl class="dates"> 
                   <dt>
                    Resolved:
                   </dt> 
                   <dd class="date user-tz" title="03/Mar/14 18:34"> 
                    <span data-name="Resolved" id="resolutiondate-val" data-fieldtype="datetime"> <time class="livestamp" datetime="2014-03-03T18:34:47+0000">03/Mar/14 18:34</time> </span> 
                   </dd> 
                  </dl> </li> 
                </ul> 
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- .aui-page-panel-inner -->
    </div>
    <!-- .aui-page-panel -->
    <div class="issue-navigator-init"></div> 
   </section> 
   <footer id="footer" role="contentinfo"> 
    <section class="footer-body"> 
     <ul class="atlassian-footer"> 
      <li> Atlassian JIRA <a class="seo-link" rel="nofollow" href="https://www.atlassian.com/software/jira">Project Management Software</a> <span id="footer-build-information">(v7.6.3#76005-<span title="8a4e38d34af948780dbf52044e7aafb13a7cae58" data-commit-id="8a4e38d34af948780dbf52044e7aafb13a7cae58}">sha1:8a4e38d</span>)</span> </li> 
      <li> <a id="about-link" rel="nofollow" href="/jira/secure/AboutPage.jspa/secure/AboutPage.jspa">About JIRA</a> </li> 
      <li> <a id="footer-report-problem-link" rel="nofollow" href="/jira/secure/CreateIssue!default.jspa">Report a problem</a> </li> 
     </ul> 
     <ul class="atlassian-footer"> 
      <li class="licensemessage"> Powered by a free Atlassian <a rel="nofollow" href="http://www.atlassian.com/software/jira">JIRA</a> open source license for Apache Software Foundation. Try JIRA - <a rel="nofollow" href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team. </li> 
     </ul> 
     <div id="footer-logo">
      <a rel="nofollow" href="http://www.atlassian.com/">Atlassian</a>
     </div> 
    </section> 
    <fieldset class="hidden parameters"> 
     <input type="hidden" title="loggedInUser" value=""> 
     <input type="hidden" title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."> 
     <input type="hidden" title="JiraVersion" value="7.6.3"> 
     <input type="hidden" title="ajaxUnauthorised" value="You are not authorised to perform this operation. Please log in."> 
     <input type="hidden" title="baseURL" value="https://issues.apache.org/jira"> 
     <input type="hidden" title="ajaxCommsError" value="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down. "> 
     <input type="hidden" title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."> 
     <input type="hidden" title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser"> 
     <input type="hidden" title="ajaxErrorDialogHeading" value="Communications Breakdown"> 
     <input type="hidden" title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost."> 
     <input type="hidden" title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog."> 
     <input type="hidden" title="keyType" value="Type"> 
     <input type="hidden" title="keyThen" value="then"> 
     <input type="hidden" title="dblClickToExpand" value="Double click to expand"> 
     <input type="hidden" title="actions" value="Actions"> 
     <input type="hidden" title="removeItem" value="Remove"> 
     <input type="hidden" title="workflow" value="Workflow"> 
     <input type="hidden" title="labelNew" value="New Label"> 
     <input type="hidden" title="issueActionsHint" value="Begin typing for available operations or press down to see all"> 
     <input type="hidden" title="closelink" value="Close"> 
     <input type="hidden" title="dotOperations" value="Operations"> 
     <input type="hidden" title="dotLoading" value="Loading..."> 
     <input type="hidden" title="frotherSuggestions" value="Suggestions"> 
     <input type="hidden" title="frotherNomatches" value="No Matches"> 
     <input type="hidden" title="multiselectVersionsError" value="{0} is not a valid version."> 
     <input type="hidden" title="multiselectComponentsError" value="{0} is not a valid component."> 
     <input type="hidden" title="multiselectGenericError" value="The value {0} is invalid."> 
    </fieldset> 
   </footer> 
  </div> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-js/jira.webresources:bigpipe-js.js" data-wrm-key="jira.webresources:bigpipe-js" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["activity-panel-pipe-id"]="\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n    \u003cdiv class=\\\"tabwrap tabs2\\\"\u003e\\n\\n        \u003cul id=\\\"issue-tabs\\\" class=\\\"tabs horizontal\\\"\u003e\\n                                \\n            \u003cli  data-id=\\\"all-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\" data-label=\\\"All\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5317?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"all-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-5317?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel\\\"\u003e\u003cstrong\u003eAll\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  class=\\\"active\\\" id=\\\"comment-tabpanel\\\"  data-id=\\\"comment-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\" data-label=\\\"Comments\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5317?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel\\\"\u003e\\n                            \u003cstrong tabindex=\\\"0\\\"\u003eComments\u003c\\/strong\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"worklog-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\" data-label=\\\"Work Log\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5317?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"worklog-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-5317?page=com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel\\\"\u003e\u003cstrong\u003eWork Log\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"changehistory-tabpanel\\\" data-key=\\\"com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\" data-label=\\\"History\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5317?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"changehistory-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-5317?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel\\\"\u003e\u003cstrong\u003eHistory\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"activity-stream-issue-tab\\\" data-key=\\\"com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\" data-label=\\\"Activity\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5317?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"activity-stream-issue-tab\\\" href=\\\"\\/jira\\/browse\\/DERBY-5317?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab\\\"\u003e\u003cstrong\u003eActivity\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                                \\n            \u003cli  data-id=\\\"transitions-summary-tabpanel\\\" data-key=\\\"com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\" data-label=\\\"Transitions\\\" data-href=\\\"\\/jira\\/browse\\/DERBY-5317?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\\n                            \u003ca class=\\\"ajax-activity-content\\\" id=\\\"transitions-summary-tabpanel\\\" href=\\\"\\/jira\\/browse\\/DERBY-5317?page=com.googlecode.jira-suite-utilities:transitions-summary-tabpanel\\\"\u003e\u003cstrong\u003eTransitions\u003c\\/strong\u003e\u003c\\/a\u003e\\n                        \u003c\\/li\u003e\\n                \u003c\\/ul\u003e\\n\\n                    \u003cdiv class=\\\"sortwrap\\\"\u003e\\n                                    \u003ca class=\\\"issue-activity-sort-link ajax-activity-content\\\" rel=\\\"nofollow\\\" data-tab-sort data-order=\\\"desc\\\" href=\\\"\\/jira\\/browse\\/DERBY-5317?actionOrder=desc\\\" title=\\\"Ascending order - Click to sort in descending order\\\"\u003e\\n                        \u003cspan class=\\\"aui-icon aui-icon-small aui-iconfont-up\\\"\u003eAscending order - Click to sort in descending order\u003c\\/span\u003e\\n                    \u003c\\/a\u003e\\n                            \u003c\\/div\u003e\\n            \u003c\\/div\u003e\\n    \u003cdiv class=\\\"issuePanelWrapper\\\"\u003e\\n        \u003cdiv class=\\\"issuePanelProgress\\\"\u003e\u003c\\/div\u003e\\n        \u003cdiv class=\\\"issuePanelContainer\\\" id=\\\"issue_actions_container\\\"\u003e\\n                                    \\n\\n\\n\u003cdiv id=\\\"comment-13061482\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13061482&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13061482\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13061482_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13061482_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Jul\\/11 18:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-07T18:48:18+0000\'\u003e07\\/Jul\\/11 18:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere is a short running reproduction for the issue.\u003cbr\\/\u003e\\nIt is just an excerpt from LobLimits.java and uses just 2MB Clobs, so the problem is not associated with large data but rather the case that is being tested, which is described as:\u003c\\/p\u003e\\n\\n\u003cp\u003e  \\/*\u003c\\/p\u003e\\n\u003cul\u003e\\n\\t\u003cli\u003eBasically this test will do an update using setClob api -\u003c\\/li\u003e\\n\\t\u003cli\u003eselect row from clobtbl and then update a row in clobtbl\u003c\\/li\u003e\\n\\t\u003cli\u003eand verify updated data in clobtbl\u003cbr\\/\u003e\\n    *\\/    \u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\\n\\n\u003cp\u003eHere is the output. The server is started by the program and  output goes to the console so is here as well:\u003cbr\\/\u003e\\n$java Repro5317\u003c\\/p\u003e\\n\\n\u003cp\u003eThu Jul 07 11:39:02 PDT 2011 : Apache Derby Network Server - 10.9.0.0 alpha - (1\u003cbr\\/\u003e\\n143485) started and ready to accept connections on port 1527\u003cbr\\/\u003e\\n========================================\u003cbr\\/\u003e\\nSTART insert 2M clob  -insertClob of size = 2097152\u003cbr\\/\u003e\\nInsert Clob (2097152) rows= 2 = 3188\u003cbr\\/\u003e\\nRows inserted with clob of size (2097152) = 2\u003cbr\\/\u003e\\n========================================\u003cbr\\/\u003e\\n========================================\u003cbr\\/\u003e\\nSTART ClobTest #4 - select and then update clob of size= 2097152 - Uses setClob\u003cbr\\/\u003e\\napi\u003cbr\\/\u003e\\nThu Jul 07 11:39:11 PDT 2011 : Execution failed because of a Distributed Protoco\u003cbr\\/\u003e\\nl Error:  DRDA_Proto_SYNTAXRM; CODPNT arg  = 200d; Error Code Value = 1d. Plaint\u003cbr\\/\u003e\\next connection attempt from an SSL enabled client?\u003cbr\\/\u003e\\norg.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of a\u003cbr\\/\u003e\\nDistributed Protocol Error:  DRDA_Proto_SYNTAXRM; CODPNT arg  = 200d; Error Code\u003cbr\\/\u003e\\n Value = 1d. Plaintext connection attempt from an SSL enabled client?\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(DRDAConnThrea\u003cbr\\/\u003e\\nd.java:517)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.invalidCodePoint(DRDAConnTh\u003cbr\\/\u003e\\nread.java:8205)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(DRDAC\u003cbr\\/\u003e\\nonnThread.java:4324)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(DRDAConnThre\u003cbr\\/\u003e\\nad.java:4133)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThr\u003cbr\\/\u003e\\nead.java:1021)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:294\u003cbr\\/\u003e\\n)\u003cbr\\/\u003e\\nThu Jul 07 11:39:11 PDT 2011 : Execution failed because of a Distributed Protoco\u003cbr\\/\u003e\\nl Error:  DRDA_Proto_SYNTAXRM; CODPNT arg  = 200d; Error Code Value = 1d. Plaint\u003cbr\\/\u003e\\next connection attempt from an SSL enabled client?\u003cbr\\/\u003e\\norg.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of a\u003cbr\\/\u003e\\nDistributed Protocol Error:  DRDA_Proto_SYNTAXRM; CODPNT arg  = 200d; Error Code\u003cbr\\/\u003e\\n Value = 1d. Plaintext connection attempt from an SSL enabled client?\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(DRDAConnThrea\u003cbr\\/\u003e\\nd.java:517)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.invalidCodePoint(DRDAConnTh\u003cbr\\/\u003e\\nread.java:8205)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(DRDAC\u003cbr\\/\u003e\\nonnThread.java:4324)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(DRDAConnThre\u003cbr\\/\u003e\\nad.java:4133)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThr\u003cbr\\/\u003e\\nead.java:1021)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:294\u003cbr\\/\u003e\\n)\u003cbr\\/\u003e\\nException in thread \\\"main\\\" java.lang.NullPointerException\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.sendBytes(Request.java:1212)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.flushScalarStreamSegment(Request.\u003cbr\\/\u003e\\njava:604)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.padScalarStreamForError(Request.j\u003cbr\\/\u003e\\nava:660)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.writePlainScalarStream(Request.ja\u003cbr\\/\u003e\\nva:323)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.writeScalarStream(Request.java:24\u003cbr\\/\u003e\\n7)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.writeScalarStream(Request.java:50\u003cbr\\/\u003e\\n0)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.NetStatementRequest.buildEXTDTA(NetStatem\u003cbr\\/\u003e\\nentRequest.java:1043)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.NetStatementRequest.writeExecute(NetState\u003cbr\\/\u003e\\nmentRequest.java:152)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.NetPreparedStatement.writeExecute_(NetPre\u003cbr\\/\u003e\\nparedStatement.java:174)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.writeExecute(PreparedSta\u003cbr\\/\u003e\\ntement.java:1800)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.flowExecute(PreparedStat\u003cbr\\/\u003e\\nement.java:2030)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.executeUpdateX(PreparedS\u003cbr\\/\u003e\\ntatement.java:417)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.executeUpdate(PreparedSt\u003cbr\\/\u003e\\natement.java:403)\u003cbr\\/\u003e\\n        at Repro5317.selectUpdateClob(Repro5317.java:163)\u003cbr\\/\u003e\\n        at Repro5317.main(Repro5317.java:35)\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eI ran with IBM 1.6.\u003c\\/p\u003e\\n\\n\u003cp\u003ejava version \\\"1.6.0\\\"\u003cbr\\/\u003e\\nJava(TM) SE Runtime Environment (build pwi3260sr9fp1-20110208_03(SR9 FP1))\u003cbr\\/\u003e\\nIBM J9 VM (build 2.4, JRE 1.6.0 IBM J9 2.4 Windows XP x86-32 jvmwi3260sr9-201102\u003cbr\\/\u003e\\n03_74623 (JIT enabled, AOT enabled)\u003cbr\\/\u003e\\nJ9VM - 20110203_074623\u003cbr\\/\u003e\\nJIT  - r9_20101028_17488ifx3\u003cbr\\/\u003e\\nGC   - 20101027_AA)\u003cbr\\/\u003e\\nJCL  - 20110203_01\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13061482_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13061482_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Jul\\/11 18:48\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-07T18:48:18+0000\'\u003e07\\/Jul\\/11 18:48\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here is a short running reproduction for the issue. \\nIt is just an excerpt from LobLimits.java and uses just 2MB Clobs, so the problem is not associated with large data but rather the case that is being tested, which is described as: \\n\\n   \\/* \\n \\n\\t Basically this test will do an update using setClob api - \\n\\t select row from clobtbl and then update a row in clobtbl \\n\\t and verify updated data in clobtbl \\n    *\\/     \\n \\n\\n\\n\\n\\n Here is the output. The server is started by the program and  output goes to the console so is here as well: \\n$java Repro5317 \\n\\n Thu Jul 07 11:39:02 PDT 2011 : Apache Derby Network Server - 10.9.0.0 alpha - (1 \\n143485) started and ready to accept connections on port 1527 \\n======================================== \\nSTART insert 2M clob  -insertClob of size = 2097152 \\nInsert Clob (2097152) rows= 2 = 3188 \\nRows inserted with clob of size (2097152) = 2 \\n======================================== \\n======================================== \\nSTART ClobTest #4 - select and then update clob of size= 2097152 - Uses setClob \\napi \\nThu Jul 07 11:39:11 PDT 2011 : Execution failed because of a Distributed Protoco \\nl Error:  DRDA_Proto_SYNTAXRM; CODPNT arg  = 200d; Error Code Value = 1d. Plaint \\next connection attempt from an SSL enabled client? \\norg.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of a \\nDistributed Protocol Error:  DRDA_Proto_SYNTAXRM; CODPNT arg  = 200d; Error Code \\n Value = 1d. Plaintext connection attempt from an SSL enabled client? \\n        at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(DRDAConnThrea \\nd.java:517) \\n        at org.apache.derby.impl.drda.DRDAConnThread.invalidCodePoint(DRDAConnTh \\nread.java:8205) \\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(DRDAC \\nonnThread.java:4324) \\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(DRDAConnThre \\nad.java:4133) \\n        at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThr \\nead.java:1021) \\n        at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:294 \\n) \\nThu Jul 07 11:39:11 PDT 2011 : Execution failed because of a Distributed Protoco \\nl Error:  DRDA_Proto_SYNTAXRM; CODPNT arg  = 200d; Error Code Value = 1d. Plaint \\next connection attempt from an SSL enabled client? \\norg.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of a \\nDistributed Protocol Error:  DRDA_Proto_SYNTAXRM; CODPNT arg  = 200d; Error Code \\n Value = 1d. Plaintext connection attempt from an SSL enabled client? \\n        at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(DRDAConnThrea \\nd.java:517) \\n        at org.apache.derby.impl.drda.DRDAConnThread.invalidCodePoint(DRDAConnTh \\nread.java:8205) \\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(DRDAC \\nonnThread.java:4324) \\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(DRDAConnThre \\nad.java:4133) \\n        at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThr \\nead.java:1021) \\n        at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:294 \\n) \\nException in thread \\\"main\\\" java.lang.NullPointerException \\n        at org.apache.derby.client.net.Request.sendBytes(Request.java:1212) \\n        at org.apache.derby.client.net.Request.flushScalarStreamSegment(Request. \\njava:604) \\n        at org.apache.derby.client.net.Request.padScalarStreamForError(Request.j \\nava:660) \\n        at org.apache.derby.client.net.Request.writePlainScalarStream(Request.ja \\nva:323) \\n        at org.apache.derby.client.net.Request.writeScalarStream(Request.java:24 \\n7) \\n        at org.apache.derby.client.net.Request.writeScalarStream(Request.java:50 \\n0) \\n        at org.apache.derby.client.net.NetStatementRequest.buildEXTDTA(NetStatem \\nentRequest.java:1043) \\n        at org.apache.derby.client.net.NetStatementRequest.writeExecute(NetState \\nmentRequest.java:152) \\n        at org.apache.derby.client.net.NetPreparedStatement.writeExecute_(NetPre \\nparedStatement.java:174) \\n        at org.apache.derby.client.am.PreparedStatement.writeExecute(PreparedSta \\ntement.java:1800) \\n        at org.apache.derby.client.am.PreparedStatement.flowExecute(PreparedStat \\nement.java:2030) \\n        at org.apache.derby.client.am.PreparedStatement.executeUpdateX(PreparedS \\ntatement.java:417) \\n        at org.apache.derby.client.am.PreparedStatement.executeUpdate(PreparedSt \\natement.java:403) \\n        at Repro5317.selectUpdateClob(Repro5317.java:163) \\n        at Repro5317.main(Repro5317.java:35) \\n\\n\\n I ran with IBM 1.6. \\n\\n java version \\\"1.6.0\\\" \\nJava(TM) SE Runtime Environment (build pwi3260sr9fp1-20110208_03(SR9 FP1)) \\nIBM J9 VM (build 2.4, JRE 1.6.0 IBM J9 2.4 Windows XP x86-32 jvmwi3260sr9-201102 \\n03_74623 (JIT enabled, AOT enabled) \\nJ9VM - 20110203_074623 \\nJIT  - r9_20101028_17488ifx3 \\nGC   - 20101027_AA) \\nJCL  - 20110203_01              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13061528\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13061528&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13061528\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13061528_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13061528_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Jul\\/11 19:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-07T19:35:01+0000\'\u003e07\\/Jul\\/11 19:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eIt appears this was a regression with 10.3.1.4.  The small test case passes with 10.2.2.0 and the latest on the 10.2 and 10.1 branches.  10.3.1.4 introduced  lob locators,  \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-208\\\" title=\\\"Add support to retrieve lobs for Network Server by locator rather than matierializing the LOB\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-208\\\"\u003e\u003cdel\u003eDERBY-208\u003c\\/del\u003e\u003c\\/a\u003e and more specifically for clobs \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-2604\\\" title=\\\"Implement Clob support for locators\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-2604\\\"\u003e\u003cdel\u003eDERBY-2604\u003c\\/del\u003e\u003c\\/a\u003e, so that might be a likely suspect.  I could not verify the exact checkin  for the regression.  I tried synching back to 535318 just before the checkin below but had trouble building.\u003c\\/p\u003e\\n\\n\u003cp\u003e\\t#535319 \\tFri May 04 16:32:39 UTC 2007 \\trhillegas \\t\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-2604\\\" title=\\\"Implement Clob support for locators\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-2604\\\"\u003e\u003cdel\u003eDERBY-2604\u003c\\/del\u003e\u003c\\/a\u003e: Commit Naryayan\'s ClobLocatorWork_v1.diff, adding locator support to clobs. \u003c\\/p\u003e\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13061528_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13061528_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Jul\\/11 19:35\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-07T19:35:01+0000\'\u003e07\\/Jul\\/11 19:35\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    It appears this was a regression with 10.3.1.4.  The small test case passes with 10.2.2.0 and the latest on the 10.2 and 10.1 branches.  10.3.1.4 introduced  lob locators,    DERBY-208   and more specifically for clobs   DERBY-2604  , so that might be a likely suspect.  I could not verify the exact checkin  for the regression.  I tried synching back to 535318 just before the checkin below but had trouble building. \\n\\n \\t#535319 \\tFri May 04 16:32:39 UTC 2007 \\trhillegas \\t  DERBY-2604  : Commit Naryayan\'s ClobLocatorWork_v1.diff, adding locator support to clobs.  \\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13061613\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13061613&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13061613\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13061613_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13061613_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Jul\\/11 21:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-07T21:44:06+0000\'\u003e07\\/Jul\\/11 21:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI will take a look at this and see if it is something simple. I Since it is a regression it would be good to get it into 10.8.2.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13061613_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13061613_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Jul\\/11 21:44\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-07T21:44:06+0000\'\u003e07\\/Jul\\/11 21:44\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I will take a look at this and see if it is something simple. I Since it is a regression it would be good to get it into 10.8.2.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13061656\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13061656&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13061656\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13061656_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13061656_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Jul\\/11 23:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-07T23:10:46+0000\'\u003e07\\/Jul\\/11 23:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLooking at the traces on 10.2 and trunk I see the following:\u003c\\/p\u003e\\n\\n\u003cp\u003eIn the 10.2 trace on execution of the prepared update statement with the stream selected from the table we have:\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Time:1310077705922&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Thread:main&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Clob@4d7784be&#93;\u003c\\/span\u003e getCharacterStream () called\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Time:1310077705922&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Thread:main&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Clob@4d7784be&#93;\u003c\\/span\u003e getCharacterStream () returned java.io.StringReader@459484be\u003c\\/p\u003e\\n\\n\u003cp\u003eFollowed by an EXCSQLSTT, SQLDTA and then EXTDTA to send the data.  I believe in this case the entire Clob has been materialized on the client.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eWith trunk we get an UpdateSensitiveClobLocater reader on the select instead of a regular StringReader:\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Time:1310076968203&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Thread:main&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Clob@19981998&#93;\u003c\\/span\u003e getCharacterStream () called\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Time:1310076968203&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Thread:main&#93;\u003c\\/span\u003e\u003cspan class=\\\"error\\\"\u003e&#91;Clob@19981998&#93;\u003c\\/span\u003e getCharacterStream () returned org.apache.derby.client.am.UpdateSensitiveClobLocatorReader@dfe0dfe\u003c\\/p\u003e\\n\\n\u003cp\u003efollowed by EXCSQLSTT, SQLDTA and then instead of the  EXTDTA a stored procedure call is attempted:\u003cbr\\/\u003e\\nderby]        SEND BUFFER: PRPSQLSTT              (ASCII)           (EBCDIC)\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e        0 1 2 3 4 5 6 7   8 9 A B C D E F   0123456789ABCDEF  0123456789ABCDEF\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e 0000   0068D05100010062  200D005E21130026  .h.Q...b ..^!..&amp;  ..}........;....\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e 0010   776F6D6261743B74  7261636546696C65  wombat;traceFile  .?_.\\/....\\/....%.\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e 0020   3D74726163652E6F  75743B6372656174  =trace.out;creat  ...\\/...?......\\/.\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e 0030   653D747275650012  4E554C4C49442020  e=true..NULLID    ........+.&lt;&lt;....\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e 0040   2020202020202020  202000125359534C            ..SYSL  ...............&lt;\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e 0050   4E30303020202020  2020202020205359  N000          SY  +...............\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e 0060   534C564C30310004                    SLVL01..          .&lt;.&lt;....        \u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e \u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e        SEND BUFFER: SQLSTT                 (ASCII)           (EBCDIC)\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e 0000   0039D04300010033  241400000000293F  .9.C...3$.....)?  ..}.............\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e 0010   203D2043414C4C20  53595349424D2E43   = CALL SYSIBM.C  .....&lt;&lt;......(..\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e 0020   4C4F424745545355  42535452494E4728  LOBGETSUBSTRING(  &lt;|...........+..\u003cbr\\/\u003e\\n\u003cspan class=\\\"error\\\"\u003e&#91;derby&#93;\u003c\\/span\u003e 0030   3F2C203F2C203F29  FF                ?, ?, ?).         .........       \u003c\\/p\u003e\\n\\n\\n\u003cp\u003eWhat seems to be happening is that we are all set up to stream the parameter data and that is what the server is expecting, but in order to get that  data from the stream  we need to make this stored procedure call, so we are stuck. Any thoughts on how to resolve this?  I don\'t see how we could interrupt the sending of the data to retrieve more with a stored procedure call. The current traces are too large to attach.  I will scale down the reproduction more to attach them.\u003c\\/p\u003e\\n\\n\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13061656_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13061656_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'07\\/Jul\\/11 23:10\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-07T23:10:46+0000\'\u003e07\\/Jul\\/11 23:10\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Looking at the traces on 10.2 and trunk I see the following: \\n\\n In the 10.2 trace on execution of the prepared update statement with the stream selected from the table we have: \\n\\n  &#91;derby&#93;  &#91;Time:1310077705922&#93;  &#91;Thread:main&#93;  &#91;Clob@4d7784be&#93;  getCharacterStream () called \\n &#91;derby&#93;  &#91;Time:1310077705922&#93;  &#91;Thread:main&#93;  &#91;Clob@4d7784be&#93;  getCharacterStream () returned java.io.StringReader@459484be \\n\\n Followed by an EXCSQLSTT, SQLDTA and then EXTDTA to send the data.  I believe in this case the entire Clob has been materialized on the client. \\n\\n\\n With trunk we get an UpdateSensitiveClobLocater reader on the select instead of a regular StringReader: \\n\\n  &#91;derby&#93;  &#91;Time:1310076968203&#93;  &#91;Thread:main&#93;  &#91;Clob@19981998&#93;  getCharacterStream () called \\n &#91;derby&#93;  &#91;Time:1310076968203&#93;  &#91;Thread:main&#93;  &#91;Clob@19981998&#93;  getCharacterStream () returned org.apache.derby.client.am.UpdateSensitiveClobLocatorReader@dfe0dfe \\n\\n followed by EXCSQLSTT, SQLDTA and then instead of the  EXTDTA a stored procedure call is attempted: \\nderby]        SEND BUFFER: PRPSQLSTT              (ASCII)           (EBCDIC) \\n &#91;derby&#93;         0 1 2 3 4 5 6 7   8 9 A B C D E F   0123456789ABCDEF  0123456789ABCDEF \\n &#91;derby&#93;  0000   0068D05100010062  200D005E21130026  .h.Q...b ..^!..&amp;  ..}........;.... \\n &#91;derby&#93;  0010   776F6D6261743B74  7261636546696C65  wombat;traceFile  .?_.\\/....\\/....%. \\n &#91;derby&#93;  0020   3D74726163652E6F  75743B6372656174  =trace.out;creat  ...\\/...?......\\/. \\n &#91;derby&#93;  0030   653D747275650012  4E554C4C49442020  e=true..NULLID    ........+.&lt;&lt;.... \\n &#91;derby&#93;  0040   2020202020202020  202000125359534C            ..SYSL  ...............&lt; \\n &#91;derby&#93;  0050   4E30303020202020  2020202020205359  N000          SY  +............... \\n &#91;derby&#93;  0060   534C564C30310004                    SLVL01..          .&lt;.&lt;....         \\n &#91;derby&#93;   \\n &#91;derby&#93;         SEND BUFFER: SQLSTT                 (ASCII)           (EBCDIC) \\n &#91;derby&#93;  0000   0039D04300010033  241400000000293F  .9.C...3$.....)?  ..}............. \\n &#91;derby&#93;  0010   203D2043414C4C20  53595349424D2E43   = CALL SYSIBM.C  .....&lt;&lt;......(.. \\n &#91;derby&#93;  0020   4C4F424745545355  42535452494E4728  LOBGETSUBSTRING(  &lt;|...........+.. \\n &#91;derby&#93;  0030   3F2C203F2C203F29  FF                ?, ?, ?).         .........        \\n\\n\\n What seems to be happening is that we are all set up to stream the parameter data and that is what the server is expecting, but in order to get that  data from the stream  we need to make this stored procedure call, so we are stuck. Any thoughts on how to resolve this?  I don\'t see how we could interrupt the sending of the data to retrieve more with a stored procedure call. The current traces are too large to attach.  I will scale down the reproduction more to attach them. \\n\\n\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13061688\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13061688&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13061688\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13061688_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13061688_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jul\\/11 00:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-08T00:09:23+0000\'\u003e08\\/Jul\\/11 00:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eHere is an updated repro and the trace  file output with the clob at 31K.  It fails at even smaller sizes like 2K  but with a different error.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13061688_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13061688_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jul\\/11 00:09\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-08T00:09:23+0000\'\u003e08\\/Jul\\/11 00:09\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Here is an updated repro and the trace  file output with the clob at 31K.  It fails at even smaller sizes like 2K  but with a different error.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13062081\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13062081&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13062081\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13062081_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13062081_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jul\\/11 17:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-08T17:52:00+0000\'\u003e08\\/Jul\\/11 17:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think the description of the test, that it uses the setClob() api is incorrect.  It actually uses getClob() to get the Clob, as value, but then passes value.getCharacterStream() to the parameter.\u003cbr\\/\u003e\\n       psUpd.setCharacterStream(1, value.getCharacterStream(), (int) l);\u003c\\/p\u003e\\n\\n\u003cp\u003eIf I change the test to actually use setClob,  changing the above statement to:\u003cbr\\/\u003e\\n       psUpd.setClob(1, value);\u003c\\/p\u003e\\n\\n\u003cp\u003eThe statement completes, presumably sending the locator as the parameter instead of having to network the stream both directions (I need to double check that this is what is happening).\u003c\\/p\u003e\\n\\n\\n\u003cp\u003eThe only simple solution I can think of  if an unmaterialized stream is passed as a parameter is one that I am loathe to implement.   That would be that if an unmaterialized character stream or binary stream are set as a parameter, that we materialize it as soon as the parameter is set, before starting execution of the statement.  Since we only have one channel of communication between client and server, we just can\'t stream the value from the server and back to it at the same time.\u003c\\/p\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13062081_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13062081_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Jul\\/11 17:52\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-08T17:52:00+0000\'\u003e08\\/Jul\\/11 17:52\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I think the description of the test, that it uses the setClob() api is incorrect.  It actually uses getClob() to get the Clob, as value, but then passes value.getCharacterStream() to the parameter. \\n       psUpd.setCharacterStream(1, value.getCharacterStream(), (int) l); \\n\\n If I change the test to actually use setClob,  changing the above statement to: \\n       psUpd.setClob(1, value); \\n\\n The statement completes, presumably sending the locator as the parameter instead of having to network the stream both directions (I need to double check that this is what is happening). \\n\\n\\n The only simple solution I can think of  if an unmaterialized stream is passed as a parameter is one that I am loathe to implement.   That would be that if an unmaterialized character stream or binary stream are set as a parameter, that we materialize it as soon as the parameter is set, before starting execution of the statement.  Since we only have one channel of communication between client and server, we just can\'t stream the value from the server and back to it at the same time. \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13065232\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13065232&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13065232\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13065232_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13065232_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/11 13:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-14T13:08:06+0000\'\u003e14\\/Jul\\/11 13:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eA good solution to this issue is not clear to me without materializing the  stream parameter  so unassigning myself from this issue.\u003c\\/p\u003e\\n\\n\u003cp\u003eUsers can work around the issue by using setClob instead of setCharacterStream()  on clob.getCharacterStream()\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13065232_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13065232_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'14\\/Jul\\/11 13:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-14T13:08:06+0000\'\u003e14\\/Jul\\/11 13:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    A good solution to this issue is not clear to me without materializing the  stream parameter  so unassigning myself from this issue. \\n\\n Users can work around the issue by using setClob instead of setCharacterStream()  on clob.getCharacterStream()              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13066279\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13066279&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13066279\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13066279_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13066279_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jul\\/11 22:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-15T22:40:19+0000\'\u003e15\\/Jul\\/11 22:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eWith revision 1147335 this can be reproduced by removing the if(usingDerbyNetClient()  LobLimitsTest and running largedata.LobLimitsLiteTest in the following code:\u003c\\/p\u003e\\n\\n\u003cp\u003e       \\/\\/ \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5317\\\" title=\\\" NullPointerException in org.apache.derby.client.net.Request.sendBytes()  with client\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5317\\\"\u003e\u003cdel\u003eDERBY-5317\u003c\\/del\u003e\u003c\\/a\u003e cannot use setCharacterStream with value from\u003cbr\\/\u003e\\n        \\/\\/ Clob.getCharacterStream because server will try to stream\u003cbr\\/\u003e\\n        \\/\\/ lob to and from server at the same time. setClob can be\u003cbr\\/\u003e\\n        \\/\\/ used as a work around.\u003cbr\\/\u003e\\n        if (!usingDerbyNetClient()) \u003c\\/p\u003e\\n{\\n            PreparedStatement psUpd =\\n                    conn.prepareStatement(\\\"update CLOBTBL set content=?, \\\" +\\n                            \\\"dlen =? where id = ?\\\");\\n            psUpd.setCharacterStream(1, value.getCharacterStream(), (int) l);\\n            psUpd.setLong(2, l);\\n            psUpd.setInt(3, updateId);\\n\\n            assertEquals(1, psUpd.executeUpdate());\\n            psUpd.close();\\n        }\\n\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13066279_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13066279_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'15\\/Jul\\/11 22:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2011-07-15T22:40:19+0000\'\u003e15\\/Jul\\/11 22:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    With revision 1147335 this can be reproduced by removing the if(usingDerbyNetClient()  LobLimitsTest and running largedata.LobLimitsLiteTest in the following code: \\n\\n        \\/\\/   DERBY-5317   cannot use setCharacterStream with value from \\n        \\/\\/ Clob.getCharacterStream because server will try to stream \\n        \\/\\/ lob to and from server at the same time. setClob can be \\n        \\/\\/ used as a work around. \\n        if (!usingDerbyNetClient())  \\n{\\n            PreparedStatement psUpd =\\n                    conn.prepareStatement(\\\"update CLOBTBL set content=?, \\\" +\\n                            \\\"dlen =? where id = ?\\\");\\n            psUpd.setCharacterStream(1, value.getCharacterStream(), (int) l);\\n            psUpd.setLong(2, l);\\n            psUpd.setInt(3, updateId);\\n\\n            assertEquals(1, psUpd.executeUpdate());\\n            psUpd.close();\\n        }\\n\\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13210413\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13210413&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13210413\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13210413_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13210413_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Feb\\/12 17:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-02-17T17:53:12+0000\'\u003e17\\/Feb\\/12 17:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eTriaged for 10.9.  Keeping urgency as urgent as it is a client crash and has a simple reproduction.\u003c\\/p\u003e\\n\\n\u003cp\u003eI confirmed the issue reproduces with Repro5317.java  attached and very quickly (in case someone has been shying away from this issue because I mentioned it takes a long time to reproduce with LobLimitsTest.\u003c\\/p\u003e\\n\\n\\n\u003cp\u003e$ java Repro5317\u003cbr\\/\u003e\\nFri Feb 17 09:49:50 PST 2012 : Apache Derby Network Server - 10.9.0.0 alpha - (1242867M) started and ready to accept con\u003cbr\\/\u003e\\nnections on port 1527\u003cbr\\/\u003e\\n========================================\u003cbr\\/\u003e\\nSTART insert  clob  -insertClob of size = 31744\u003cbr\\/\u003e\\nInsert Clob (31744) rows= 2 = 382\u003cbr\\/\u003e\\nRows inserted with clob of size (31744) = 2\u003cbr\\/\u003e\\n========================================\u003cbr\\/\u003e\\n========================================\u003cbr\\/\u003e\\nSTART ClobTest #4 - select and then update clob of size= 31744 - Uses setClob api\u003cbr\\/\u003e\\nFri Feb 17 09:49:52 PST 2012 : Execution failed because of a Distributed Protocol Error:  DRDA_Proto_SYNTAXRM; CODPNT ar\u003cbr\\/\u003e\\ng  = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enabled client?\u003cbr\\/\u003e\\norg.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of a Distributed Protocol Error:  DRDA_Proto_\u003cbr\\/\u003e\\nSYNTAXRM; CODPNT arg  = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enabled client?\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(DRDAConnThread.java:537)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.invalidCodePoint(DRDAConnThread.java:8295)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(DRDAConnThread.java:4366)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(DRDAConnThread.java:4175)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java:1063)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:295)\u003cbr\\/\u003e\\nFri Feb 17 09:49:52 PST 2012 : Execution failed because of a Distributed Protocol Error:  DRDA_Proto_SYNTAXRM; CODPNT ar\u003cbr\\/\u003e\\ng  = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enabled client?\u003cbr\\/\u003e\\norg.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of a Distributed Protocol Error:  DRDA_Proto_\u003cbr\\/\u003e\\nSYNTAXRM; CODPNT arg  = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enabled client?\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(DRDAConnThread.java:537)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.invalidCodePoint(DRDAConnThread.java:8295)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(DRDAConnThread.java:4366)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(DRDAConnThread.java:4175)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java:1063)\u003cbr\\/\u003e\\n        at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:295)\u003cbr\\/\u003e\\nException in thread \\\"main\\\" java.lang.NullPointerException\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.sendBytes(Request.java:1212)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.flushScalarStreamSegment(Request.java:604)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.padScalarStreamForError(Request.java:660)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.writePlainScalarStream(Request.java:323)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.writeScalarStream(Request.java:247)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.Request.writeScalarStream(Request.java:500)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.NetStatementRequest.buildEXTDTA(NetStatementRequest.java:1042)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.NetStatementRequest.writeExecute(NetStatementRequest.java:151)\u003cbr\\/\u003e\\n        at org.apache.derby.client.net.NetPreparedStatement.writeExecute_(NetPreparedStatement.java:174)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.writeExecute(PreparedStatement.java:1806)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.flowExecute(PreparedStatement.java:2036)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.executeUpdateX(PreparedStatement.java:417)\u003cbr\\/\u003e\\n        at org.apache.derby.client.am.PreparedStatement.executeUpdate(PreparedStatement.java:403)\u003cbr\\/\u003e\\n        at Repro5317.selectUpdateClob(Repro5317.java:170)\u003cbr\\/\u003e\\n        at Repro5317.main(Repro5317.java:42)\u003c\\/p\u003e\\n\\n\u003cp\u003ekmarsden@IBM-JDPM42DBIO2 ~\\/repro\\/derby-5317\u003c\\/p\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\u003cp\u003ethink Urgent is correct as \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13210413_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13210413_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'17\\/Feb\\/12 17:53\'\u003e\u003ctime class=\'livestamp\' datetime=\'2012-02-17T17:53:12+0000\'\u003e17\\/Feb\\/12 17:53\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Triaged for 10.9.  Keeping urgency as urgent as it is a client crash and has a simple reproduction. \\n\\n I confirmed the issue reproduces with Repro5317.java  attached and very quickly (in case someone has been shying away from this issue because I mentioned it takes a long time to reproduce with LobLimitsTest. \\n\\n\\n $ java Repro5317 \\nFri Feb 17 09:49:50 PST 2012 : Apache Derby Network Server - 10.9.0.0 alpha - (1242867M) started and ready to accept con \\nnections on port 1527 \\n======================================== \\nSTART insert  clob  -insertClob of size = 31744 \\nInsert Clob (31744) rows= 2 = 382 \\nRows inserted with clob of size (31744) = 2 \\n======================================== \\n======================================== \\nSTART ClobTest #4 - select and then update clob of size= 31744 - Uses setClob api \\nFri Feb 17 09:49:52 PST 2012 : Execution failed because of a Distributed Protocol Error:  DRDA_Proto_SYNTAXRM; CODPNT ar \\ng  = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enabled client? \\norg.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of a Distributed Protocol Error:  DRDA_Proto_ \\nSYNTAXRM; CODPNT arg  = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enabled client? \\n        at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(DRDAConnThread.java:537) \\n        at org.apache.derby.impl.drda.DRDAConnThread.invalidCodePoint(DRDAConnThread.java:8295) \\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(DRDAConnThread.java:4366) \\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(DRDAConnThread.java:4175) \\n        at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java:1063) \\n        at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:295) \\nFri Feb 17 09:49:52 PST 2012 : Execution failed because of a Distributed Protocol Error:  DRDA_Proto_SYNTAXRM; CODPNT ar \\ng  = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enabled client? \\norg.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of a Distributed Protocol Error:  DRDA_Proto_ \\nSYNTAXRM; CODPNT arg  = 200d; Error Code Value = 1d. Plaintext connection attempt from an SSL enabled client? \\n        at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(DRDAConnThread.java:537) \\n        at org.apache.derby.impl.drda.DRDAConnThread.invalidCodePoint(DRDAConnThread.java:8295) \\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(DRDAConnThread.java:4366) \\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(DRDAConnThread.java:4175) \\n        at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java:1063) \\n        at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:295) \\nException in thread \\\"main\\\" java.lang.NullPointerException \\n        at org.apache.derby.client.net.Request.sendBytes(Request.java:1212) \\n        at org.apache.derby.client.net.Request.flushScalarStreamSegment(Request.java:604) \\n        at org.apache.derby.client.net.Request.padScalarStreamForError(Request.java:660) \\n        at org.apache.derby.client.net.Request.writePlainScalarStream(Request.java:323) \\n        at org.apache.derby.client.net.Request.writeScalarStream(Request.java:247) \\n        at org.apache.derby.client.net.Request.writeScalarStream(Request.java:500) \\n        at org.apache.derby.client.net.NetStatementRequest.buildEXTDTA(NetStatementRequest.java:1042) \\n        at org.apache.derby.client.net.NetStatementRequest.writeExecute(NetStatementRequest.java:151) \\n        at org.apache.derby.client.net.NetPreparedStatement.writeExecute_(NetPreparedStatement.java:174) \\n        at org.apache.derby.client.am.PreparedStatement.writeExecute(PreparedStatement.java:1806) \\n        at org.apache.derby.client.am.PreparedStatement.flowExecute(PreparedStatement.java:2036) \\n        at org.apache.derby.client.am.PreparedStatement.executeUpdateX(PreparedStatement.java:417) \\n        at org.apache.derby.client.am.PreparedStatement.executeUpdate(PreparedStatement.java:403) \\n        at Repro5317.selectUpdateClob(Repro5317.java:170) \\n        at Repro5317.main(Repro5317.java:42) \\n\\n kmarsden@IBM-JDPM42DBIO2 ~\\/repro\\/derby-5317 \\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n think Urgent is correct as               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13699030\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13699030&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13699030\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13699030_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13699030_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jul\\/13 14:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-07-03T14:39:24+0000\'\u003e03\\/Jul\\/13 14:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eConfirmed this still reproduces on trunk 10.11\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"kmarsden\\\" id=\\\"commentauthor_13699030_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=kmarsden\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"kmarsden\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Kathey Marsden\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13699030_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Jul\\/13 14:39\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-07-03T14:39:24+0000\'\u003e03\\/Jul\\/13 14:39\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Confirmed this still reproduces on trunk 10.11              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13760642\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13760642&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13760642\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13760642_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13760642_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Sep\\/13 21:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-06T21:20:26+0000\'\u003e06\\/Sep\\/13 21:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eLinking to \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-2017\\\" title=\\\"Client driver can insert and commit partial data when a LOB stream throws IOException or does not match the specified length\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-2017\\\"\u003e\u003cdel\u003eDERBY-2017\u003c\\/del\u003e\u003c\\/a\u003e which added an extra message back to the server in case of certain errors to ensure that LOB-transactions were not \\\"partly\\\" committed. In this case the client attempts to send the extra message after a DisconnectException has been thrown. This does not work since the DisconnectException constructor will close and null the agent\'s stream objects, so that writing the extra message triggers an NPE when attempting to access the output stream.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13760642_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13760642_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Sep\\/13 21:20\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-06T21:20:26+0000\'\u003e06\\/Sep\\/13 21:20\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Linking to   DERBY-2017   which added an extra message back to the server in case of certain errors to ensure that LOB-transactions were not \\\"partly\\\" committed. In this case the client attempts to send the extra message after a DisconnectException has been thrown. This does not work since the DisconnectException constructor will close and null the agent\'s stream objects, so that writing the extra message triggers an NPE when attempting to access the output stream.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13760665\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13760665&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13760665\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13760665_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13760665_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Sep\\/13 21:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-06T21:41:30+0000\'\u003e06\\/Sep\\/13 21:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThere are a couple of issues here: \u003c\\/p\u003e\\n\\n\u003cp\u003e1) That the DisconnectException\'s constructor closes down the connection, so that the connection is closed even if the exception is never thrown. And any caller wanting to catch this exception cannot prevent the connection from being closed.\u003c\\/p\u003e\\n\\n\u003cp\u003e2) It is not clear to me that Reply.doSyntaxrmSemantics() should throw a DisconnectException at all. If it only has detected a protocol error it would make more sense to throw some other exception and leave the connection intact. That would make it possible to send a cleanup message, such as the one added in \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-2017\\\" title=\\\"Client driver can insert and commit partial data when a LOB stream throws IOException or does not match the specified length\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-2017\\\"\u003e\u003cdel\u003eDERBY-2017\u003c\\/del\u003e\u003c\\/a\u003e, to the server as part of handling the exception. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13760665_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13760665_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'06\\/Sep\\/13 21:41\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-06T21:41:30+0000\'\u003e06\\/Sep\\/13 21:41\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    There are a couple of issues here:  \\n\\n 1) That the DisconnectException\'s constructor closes down the connection, so that the connection is closed even if the exception is never thrown. And any caller wanting to catch this exception cannot prevent the connection from being closed. \\n\\n 2) It is not clear to me that Reply.doSyntaxrmSemantics() should throw a DisconnectException at all. If it only has detected a protocol error it would make more sense to throw some other exception and leave the connection intact. That would make it possible to send a cleanup message, such as the one added in   DERBY-2017  , to the server as part of handling the exception.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13761798\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13761798&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13761798\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13761798_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13761798_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Sep\\/13 12:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-09T12:31:55+0000\'\u003e09\\/Sep\\/13 12:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI think it is possible (but ugly) to avoid the NPE by checking if the output stream is null, and then just rethrow the IOException from the Reader. When doing that you\'re left with the \\\"Bad codepoint\\\" error thrown by the server when encountering a PRPSQLSTT cp when reading the EXTDTA objects in the prepare message. That is better than getting an NPE, but it is still difficult to identify the cause of the problem (calling setClob() with a Reader that is a really an UpdateSensitiveClobLocatorReader() tied to the same agent as the ps). \u003c\\/p\u003e\\n\\n\u003cp\u003eI think a reasonable first step would be to throw (some form of) UnsupportedException when attempting to use setX() with a Locator-backed Reader\\/Stream value. If the user is willing to incur the overhead of materializing the object in the client, they can always force that by reading the lob into a buffer and use setX with a Reader\\/Stream referencing that buffer.\u003c\\/p\u003e\\n\\n\u003cp\u003eTo make this efficient I guess we need to identify Locator-backed Readers\\/streams and somehow bind the locator value in place of the Reader\\/Stream, and only convert the locator value into the actual Reader\\/Stream value when required on the server. Don\'t know if that is feasible...\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13761798_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13761798_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Sep\\/13 12:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-09T12:31:55+0000\'\u003e09\\/Sep\\/13 12:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I think it is possible (but ugly) to avoid the NPE by checking if the output stream is null, and then just rethrow the IOException from the Reader. When doing that you\'re left with the \\\"Bad codepoint\\\" error thrown by the server when encountering a PRPSQLSTT cp when reading the EXTDTA objects in the prepare message. That is better than getting an NPE, but it is still difficult to identify the cause of the problem (calling setClob() with a Reader that is a really an UpdateSensitiveClobLocatorReader() tied to the same agent as the ps).  \\n\\n I think a reasonable first step would be to throw (some form of) UnsupportedException when attempting to use setX() with a Locator-backed Reader\\/Stream value. If the user is willing to incur the overhead of materializing the object in the client, they can always force that by reading the lob into a buffer and use setX with a Reader\\/Stream referencing that buffer. \\n\\n To make this efficient I guess we need to identify Locator-backed Readers\\/streams and somehow bind the locator value in place of the Reader\\/Stream, and only convert the locator value into the actual Reader\\/Stream value when required on the server. Don\'t know if that is feasible...              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13765535\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13765535&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13765535\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13765535_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13765535_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Sep\\/13 15:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-12T15:33:35+0000\'\u003e12\\/Sep\\/13 15:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eI have concluded that identifying Locator-based Readers\\/Streams is not really possible since the argument passed to setX() may be wrapped in any number of non-Locator Streams\\/Readers. So I think we must allow such values to be set, and instead intercept their use when generating the DRDA commands for executing the PS. To me it looks like we can trap this situation in Request.initialize() by detecting an un-ended writeChain for which data has been sent to the server. But as we are using the Stream interface we cannot signal this in any way other than throwing an exception. It is not really feasible to use a checked exception for this as it will be wrapped in SqlExceptions and IOExceptions on its way up the callstack, so I plan to throw a (new) subclass of Error and then catching that at the point where we read the Lob-parameter from the top-level stream and then throw a more informative checked exception.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13765535_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13765535_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'12\\/Sep\\/13 15:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-12T15:33:35+0000\'\u003e12\\/Sep\\/13 15:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    I have concluded that identifying Locator-based Readers\\/Streams is not really possible since the argument passed to setX() may be wrapped in any number of non-Locator Streams\\/Readers. So I think we must allow such values to be set, and instead intercept their use when generating the DRDA commands for executing the PS. To me it looks like we can trap this situation in Request.initialize() by detecting an un-ended writeChain for which data has been sent to the server. But as we are using the Stream interface we cannot signal this in any way other than throwing an exception. It is not really feasible to use a checked exception for this as it will be wrapped in SqlExceptions and IOExceptions on its way up the callstack, so I plan to throw a (new) subclass of Error and then catching that at the point where we read the Lob-parameter from the top-level stream and then throw a more informative checked exception.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13770776\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13770776&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13770776\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13770776_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13770776_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Sep\\/13 13:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-18T13:45:24+0000\'\u003e18\\/Sep\\/13 13:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eAttaching patch which tries to identify this situation and provide a better error. Modifies test case accordingly. \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13770776_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13770776_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'18\\/Sep\\/13 13:45\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-18T13:45:24+0000\'\u003e18\\/Sep\\/13 13:45\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Attaching patch which tries to identify this situation and provide a better error. Modifies test case accordingly.               \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13771819\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13771819&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13771819\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_13771819_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13771819_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Sep\\/13 12:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-19T12:04:11+0000\'\u003e19\\/Sep\\/13 12:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks, Dyre. The approach looks reasonable to me. Some comments:\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eThe license header for WriteChainAlreadyInUseError has the wrong class name.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eSince the resulting exception is a DisconnectException, which takes down the connection, I think it should have session severity instead of statement severity. That is, its message id should end with \\\".C\\\" instead of \\\".S\\\".\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eCan we be sure that WriteChainAlreadyInUseError is only thrown when there is a corresponding catch block higher up in the call chain? Is there a way to make sure it won\'t escape to the application without being properly wrapped in the appropriate checked exception type (SQLException or IOException)?\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eWe might want to internationalize WriteChainAlreadyInUseError\'s hard-coded error message, as it is chained to the DisconnectException and will be visible externally.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eIt would be good to have a code comment explaining the purpose of writeChainIsLocked_ and grabWriteChain().\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_13771819_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13771819_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'19\\/Sep\\/13 12:04\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-19T12:04:11+0000\'\u003e19\\/Sep\\/13 12:04\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks, Dyre. The approach looks reasonable to me. Some comments: \\n\\n \\n\\t The license header for WriteChainAlreadyInUseError has the wrong class name. \\n \\n\\n\\n \\n\\t Since the resulting exception is a DisconnectException, which takes down the connection, I think it should have session severity instead of statement severity. That is, its message id should end with \\\".C\\\" instead of \\\".S\\\". \\n \\n\\n\\n \\n\\t Can we be sure that WriteChainAlreadyInUseError is only thrown when there is a corresponding catch block higher up in the call chain? Is there a way to make sure it won\'t escape to the application without being properly wrapped in the appropriate checked exception type (SQLException or IOException)? \\n \\n\\n\\n \\n\\t We might want to internationalize WriteChainAlreadyInUseError\'s hard-coded error message, as it is chained to the DisconnectException and will be visible externally. \\n \\n\\n\\n \\n\\t It would be good to have a code comment explaining the purpose of writeChainIsLocked_ and grabWriteChain(). \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13778573\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13778573&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13778573\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13778573_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13778573_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Sep\\/13 08:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-26T08:31:19+0000\'\u003e26\\/Sep\\/13 08:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for the review Knut. I\'ll create another patch to address your comments.\u003c\\/p\u003e\\n\\n\u003cp\u003eWrt. WriteChainAlreadyInUseError being caught: No I don\'t think we can guarantee that. And even if we analysed the code and concluded that it is safe, there is no guarantee that it will remain so if the code is modified later. My thoughts about this is that starting another writeChain without finishing the previous one, when you already have sent data to server, usually indicates a bug, in much the same way as an NPE or ArrayIndexOutOfBoundsException does. I\'m fairly certain that whenever this situation occurs the result would be some kind of hard-to-understand syntax\\/parsing error from the server, and my reasoning was that even an uncaught WriteChainAlreadyInUseError was a preferable.\u003c\\/p\u003e\\n\\n\u003cp\u003eIt is always possible to make it checked and let it be wrapped in SqlExceptions and IOExceptions on its way up the callstack, but then we need to traverse the cause-chain to trap the situation where you\'re setting a stream backed by your own connection.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13778573_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13778573_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Sep\\/13 08:31\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-26T08:31:19+0000\'\u003e26\\/Sep\\/13 08:31\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for the review Knut. I\'ll create another patch to address your comments. \\n\\n Wrt. WriteChainAlreadyInUseError being caught: No I don\'t think we can guarantee that. And even if we analysed the code and concluded that it is safe, there is no guarantee that it will remain so if the code is modified later. My thoughts about this is that starting another writeChain without finishing the previous one, when you already have sent data to server, usually indicates a bug, in much the same way as an NPE or ArrayIndexOutOfBoundsException does. I\'m fairly certain that whenever this situation occurs the result would be some kind of hard-to-understand syntax\\/parsing error from the server, and my reasoning was that even an uncaught WriteChainAlreadyInUseError was a preferable. \\n\\n It is always possible to make it checked and let it be wrapped in SqlExceptions and IOExceptions on its way up the callstack, but then we need to traverse the cause-chain to trap the situation where you\'re setting a stream backed by your own connection.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13778675\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13778675&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13778675\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13778675_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13778675_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Sep\\/13 11:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-26T11:30:21+0000\'\u003e26\\/Sep\\/13 11:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNew patch which incorporates review comments.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13778675_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13778675_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'26\\/Sep\\/13 11:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-26T11:30:21+0000\'\u003e26\\/Sep\\/13 11:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    New patch which incorporates review comments.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13781717\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13781717&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13781717\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_13781717_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13781717_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Sep\\/13 09:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-30T09:50:03+0000\'\u003e30\\/Sep\\/13 09:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks for the new patch, Dyre. I\'m mostly fine with it. I\'m still a little worried that applications might get confused if the WriteChainAlreadyInUseError escapes out to them. Although it\'s similar to the NPE or ArrayIndexOutOfBoundsException that would have been thrown without the fix, I think an application is more likely to have reasonable handlers for Exception than for Error. So I think I would feel more comfortable if it had been a sub-class of RuntimeException, as that would make me more confident that if it should escape, the consequences for the application would be no worse than today (either the application handles RuntimeException and doesn\'t care whether it\'s a NullPointerException or WriteChainAlreadyInUseException, or it doesn\'t handle it and will get into trouble either way).\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_13781717_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13781717_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'30\\/Sep\\/13 09:50\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-09-30T09:50:03+0000\'\u003e30\\/Sep\\/13 09:50\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks for the new patch, Dyre. I\'m mostly fine with it. I\'m still a little worried that applications might get confused if the WriteChainAlreadyInUseError escapes out to them. Although it\'s similar to the NPE or ArrayIndexOutOfBoundsException that would have been thrown without the fix, I think an application is more likely to have reasonable handlers for Exception than for Error. So I think I would feel more comfortable if it had been a sub-class of RuntimeException, as that would make me more confident that if it should escape, the consequences for the application would be no worse than today (either the application handles RuntimeException and doesn\'t care whether it\'s a NullPointerException or WriteChainAlreadyInUseException, or it doesn\'t handle it and will get into trouble either way).              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13786078\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13786078&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13786078\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13786078_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13786078_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Oct\\/13 11:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-04T11:25:41+0000\'\u003e04\\/Oct\\/13 11:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eKnut also told me (offline) that he would have preferred WriteChainAlreadyInUse to be checked.\u003c\\/p\u003e\\n\\n\u003cp\u003eI decided to try that (I actually replaced WriteChainAlreadyInUse with a DisconnectExecption with SQLState.NET_WRITE_CHAIN_IS_DIRTY) just to see how it would work. When doing so, it occurred to me that there really are three different situations that need to be handled when reading from the InputStream (in Request.writePlainScalarStream()):\u003c\\/p\u003e\\n\\n\u003col\u003e\\n\\t\u003cli\u003ein.read() throws an exception but leaves the connection intact. This case is handled correctly by the existing code (the exception is saved and the stream value is padded with 0 and sent to the server to finish the request).\u003c\\/li\u003e\\n\\t\u003cli\u003ein.read() throws an exception which renders the connection unusable (closed):\\n\\t\u003col\u003e\\n\\t\\t\u003cli\u003ein.read() throws SQLState.NET_WRITE_CHAIN_IS_DIRTY. Inform the user that she cannot use setX with a locator stream from the same connection.\u003c\\/li\u003e\\n\\t\\t\u003cli\u003ein.read() throws some other exception. Since the connection is closed we cannot continue the request as in 1) (that would give an NPE when accessing the output stream), but must throw an SqlException, which should probably be a .C version of XN014.S wrapping the IOException from in.read().\u003c\\/li\u003e\\n\\t\u003c\\/ol\u003e\\n\\t\u003c\\/li\u003e\\n\u003c\\/ol\u003e\\n\\n\\n\u003cp\u003e2.1 is really just a special case of 2.2 which lets us provide a better error message to the user, but in order to provide it we need to traverse the cause chain to see if it contains SQLState.NET_WRITE_CHAIN_IS_DIRTY. \u003c\\/p\u003e\\n\\n\u003cp\u003eAs an experiment, I tried running the repro without special handling of case 2.1:\u003c\\/p\u003e\\n \u003cblockquote\u003e\\n\u003cp\u003eSTART ClobTest #4 - select and then update clob of size= 31744 - Uses setClob api\u003cbr\\/\u003e\\nException in thread \\\"main\\\" java.sql.SQLNonTransientConnectionException: Encountered an exception which terminated the connection, while reading from the stream specified by parameter #1. The Exception had this message: `org.apache.derby.client.am.DisconnectException: A write chain that has transmitted \u003cbr\\/\u003e\\n                    data to the server cannot be reset until the request\u003cbr\\/\u003e\\n                    is finished and the chain terminated.\'.\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:104)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.SqlException.getSQLException(SqlException.java:321)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:404)\u003cbr\\/\u003e\\n\\tat Repro5317.selectUpdateClob(Repro5317.java:172)\u003cbr\\/\u003e\\n\\tat Repro5317.main(Repro5317.java:43)\u003cbr\\/\u003e\\nCaused by: org.apache.derby.client.am.SqlException: Encountered an exception which terminated the connection, while reading from the stream specified by parameter #1. The Exception had this message: `org.apache.derby.client.am.DisconnectException: A write chain that has transmitted \u003cbr\\/\u003e\\n                    data to the server cannot be reset until the request\u003cbr\\/\u003e\\n                    is finished and the chain terminated.\'.\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.net.Request.writePlainScalarStream(Request.java:332)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.net.Request.writeScalarStream(Request.java:244)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.net.Request.writeScalarStream(Request.java:515)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.net.NetStatementRequest.buildEXTDTA(NetStatementRequest.java:1070)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.net.NetStatementRequest.writeExecute(NetStatementRequest.java:166)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.net.NetPreparedStatement.writeExecute_(NetPreparedStatement.java:156)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.ClientPreparedStatement.writeExecute(ClientPreparedStatement.java:1832)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.ClientPreparedStatement.flowExecute(ClientPreparedStatement.java:2047)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.ClientPreparedStatement.executeUpdateX(ClientPreparedStatement.java:409)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:395)\u003cbr\\/\u003e\\n\\t... 2 more\u003cbr\\/\u003e\\nCaused by: java.io.IOException: org.apache.derby.client.am.DisconnectException: A write chain that has transmitted \u003cbr\\/\u003e\\n                    data to the server cannot be reset until the request\u003cbr\\/\u003e\\n                    is finished and the chain terminated.\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.ClobLocatorReader.readCharacters(ClobLocatorReader.java:233)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.ClobLocatorReader.read(ClobLocatorReader.java:152)\u003cbr\\/\u003e\\n\\tat java.io.BufferedReader.fill(BufferedReader.java:154)\u003cbr\\/\u003e\\n\\tat java.io.BufferedReader.read1(BufferedReader.java:205)\u003cbr\\/\u003e\\n\\tat java.io.BufferedReader.read(BufferedReader.java:279)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.UpdateSensitiveClobLocatorReader.read(UpdateSensitiveClobLocatorReader.java:152)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.net.EncodedInputStream.reEncode(EncodedInputStream.java:121)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.net.EncodedInputStream.read(EncodedInputStream.java:180)\u003cbr\\/\u003e\\n\\tat java.io.InputStream.read(InputStream.java:170)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.net.Request.writePlainScalarStream(Request.java:316)\u003cbr\\/\u003e\\n\\t... 11 more\u003cbr\\/\u003e\\nCaused by: org.apache.derby.client.am.DisconnectException: A write chain that has transmitted \u003cbr\\/\u003e\\n                    data to the server cannot be reset until the request\u003cbr\\/\u003e\\n                    is finished and the chain terminated.\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.net.NetAgent.verifyWriteChainIsClean(NetAgent.java:488)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.net.NetAgent.beginWriteChain(NetAgent.java:500)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.ClientPreparedStatement.flowPrepareDescribeInputOutput(ClientPreparedStatement.java:1966)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.ClientPreparedStatement.prepare(ClientPreparedStatement.java:314)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.ClientConnection.prepareCallX(ClientConnection.java:2003)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.CallableLocatorProcedures.clobGetSubString(CallableLocatorProcedures.java:892)\u003cbr\\/\u003e\\n\\tat org.apache.derby.client.am.ClobLocatorReader.readCharacters(ClobLocatorReader.java:223)\u003cbr\\/\u003e\\n\\t... 20 more\u003c\\/p\u003e\u003c\\/blockquote\u003e\\n\\n\u003cp\u003eSo it is not strictly necessary to traverse the cause chain, but the resulting error message is undoubtedly harder to parse. So unless I\'m told otherwise, I\'ll keep the cause-chain traversal and the special error for locator streams from the same connection.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13786078_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13786078_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Oct\\/13 11:25\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-04T11:25:41+0000\'\u003e04\\/Oct\\/13 11:25\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Knut also told me (offline) that he would have preferred WriteChainAlreadyInUse to be checked. \\n\\n I decided to try that (I actually replaced WriteChainAlreadyInUse with a DisconnectExecption with SQLState.NET_WRITE_CHAIN_IS_DIRTY) just to see how it would work. When doing so, it occurred to me that there really are three different situations that need to be handled when reading from the InputStream (in Request.writePlainScalarStream()): \\n\\n \\n\\t in.read() throws an exception but leaves the connection intact. This case is handled correctly by the existing code (the exception is saved and the stream value is padded with 0 and sent to the server to finish the request). \\n\\t in.read() throws an exception which renders the connection unusable (closed):\\n\\t \\n\\t\\t in.read() throws SQLState.NET_WRITE_CHAIN_IS_DIRTY. Inform the user that she cannot use setX with a locator stream from the same connection. \\n\\t\\t in.read() throws some other exception. Since the connection is closed we cannot continue the request as in 1) (that would give an NPE when accessing the output stream), but must throw an SqlException, which should probably be a .C version of XN014.S wrapping the IOException from in.read(). \\n\\t \\n\\t \\n \\n\\n\\n 2.1 is really just a special case of 2.2 which lets us provide a better error message to the user, but in order to provide it we need to traverse the cause chain to see if it contains SQLState.NET_WRITE_CHAIN_IS_DIRTY.  \\n\\n As an experiment, I tried running the repro without special handling of case 2.1: \\n  \\n START ClobTest #4 - select and then update clob of size= 31744 - Uses setClob api \\nException in thread \\\"main\\\" java.sql.SQLNonTransientConnectionException: Encountered an exception which terminated the connection, while reading from the stream specified by parameter #1. The Exception had this message: `org.apache.derby.client.am.DisconnectException: A write chain that has transmitted  \\n                    data to the server cannot be reset until the request \\n                    is finished and the chain terminated.\'. \\n\\tat org.apache.derby.client.am.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:104) \\n\\tat org.apache.derby.client.am.SqlException.getSQLException(SqlException.java:321) \\n\\tat org.apache.derby.client.am.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:404) \\n\\tat Repro5317.selectUpdateClob(Repro5317.java:172) \\n\\tat Repro5317.main(Repro5317.java:43) \\nCaused by: org.apache.derby.client.am.SqlException: Encountered an exception which terminated the connection, while reading from the stream specified by parameter #1. The Exception had this message: `org.apache.derby.client.am.DisconnectException: A write chain that has transmitted  \\n                    data to the server cannot be reset until the request \\n                    is finished and the chain terminated.\'. \\n\\tat org.apache.derby.client.net.Request.writePlainScalarStream(Request.java:332) \\n\\tat org.apache.derby.client.net.Request.writeScalarStream(Request.java:244) \\n\\tat org.apache.derby.client.net.Request.writeScalarStream(Request.java:515) \\n\\tat org.apache.derby.client.net.NetStatementRequest.buildEXTDTA(NetStatementRequest.java:1070) \\n\\tat org.apache.derby.client.net.NetStatementRequest.writeExecute(NetStatementRequest.java:166) \\n\\tat org.apache.derby.client.net.NetPreparedStatement.writeExecute_(NetPreparedStatement.java:156) \\n\\tat org.apache.derby.client.am.ClientPreparedStatement.writeExecute(ClientPreparedStatement.java:1832) \\n\\tat org.apache.derby.client.am.ClientPreparedStatement.flowExecute(ClientPreparedStatement.java:2047) \\n\\tat org.apache.derby.client.am.ClientPreparedStatement.executeUpdateX(ClientPreparedStatement.java:409) \\n\\tat org.apache.derby.client.am.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:395) \\n\\t... 2 more \\nCaused by: java.io.IOException: org.apache.derby.client.am.DisconnectException: A write chain that has transmitted  \\n                    data to the server cannot be reset until the request \\n                    is finished and the chain terminated. \\n\\tat org.apache.derby.client.am.ClobLocatorReader.readCharacters(ClobLocatorReader.java:233) \\n\\tat org.apache.derby.client.am.ClobLocatorReader.read(ClobLocatorReader.java:152) \\n\\tat java.io.BufferedReader.fill(BufferedReader.java:154) \\n\\tat java.io.BufferedReader.read1(BufferedReader.java:205) \\n\\tat java.io.BufferedReader.read(BufferedReader.java:279) \\n\\tat org.apache.derby.client.am.UpdateSensitiveClobLocatorReader.read(UpdateSensitiveClobLocatorReader.java:152) \\n\\tat org.apache.derby.client.net.EncodedInputStream.reEncode(EncodedInputStream.java:121) \\n\\tat org.apache.derby.client.net.EncodedInputStream.read(EncodedInputStream.java:180) \\n\\tat java.io.InputStream.read(InputStream.java:170) \\n\\tat org.apache.derby.client.net.Request.writePlainScalarStream(Request.java:316) \\n\\t... 11 more \\nCaused by: org.apache.derby.client.am.DisconnectException: A write chain that has transmitted  \\n                    data to the server cannot be reset until the request \\n                    is finished and the chain terminated. \\n\\tat org.apache.derby.client.net.NetAgent.verifyWriteChainIsClean(NetAgent.java:488) \\n\\tat org.apache.derby.client.net.NetAgent.beginWriteChain(NetAgent.java:500) \\n\\tat org.apache.derby.client.am.ClientPreparedStatement.flowPrepareDescribeInputOutput(ClientPreparedStatement.java:1966) \\n\\tat org.apache.derby.client.am.ClientPreparedStatement.prepare(ClientPreparedStatement.java:314) \\n\\tat org.apache.derby.client.am.ClientConnection.prepareCallX(ClientConnection.java:2003) \\n\\tat org.apache.derby.client.am.CallableLocatorProcedures.clobGetSubString(CallableLocatorProcedures.java:892) \\n\\tat org.apache.derby.client.am.ClobLocatorReader.readCharacters(ClobLocatorReader.java:223) \\n\\t... 20 more  \\n\\n So it is not strictly necessary to traverse the cause chain, but the resulting error message is undoubtedly harder to parse. So unless I\'m told otherwise, I\'ll keep the cause-chain traversal and the special error for locator streams from the same connection.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13786132\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13786132&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13786132\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_13786132_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13786132_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Oct\\/13 13:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-04T13:30:13+0000\'\u003e04\\/Oct\\/13 13:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eSounds like a good approach. I think it\'s an improvement (no NPE!) even with no special handling of 2.1, but having a more specific error message will make it much clearer what the problem is, so +1 to that.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_13786132_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13786132_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'04\\/Oct\\/13 13:30\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-04T13:30:13+0000\'\u003e04\\/Oct\\/13 13:30\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Sounds like a good approach. I think it\'s an improvement (no NPE!) even with no special handling of 2.1, but having a more specific error message will make it much clearer what the problem is, so +1 to that.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13789015\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13789015&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13789015\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13789015_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13789015_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Oct\\/13 07:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-08T07:40:09+0000\'\u003e08\\/Oct\\/13 07:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ePatch using only checked exceptions, as described.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13789015_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13789015_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'08\\/Oct\\/13 07:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-08T07:40:09+0000\'\u003e08\\/Oct\\/13 07:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Patch using only checked exceptions, as described.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13790249\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13790249&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13790249\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_13790249_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13790249_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Oct\\/13 11:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-09T11:03:13+0000\'\u003e09\\/Oct\\/13 11:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eThanks, Dyre! The patch looks fine to me. I found some tiny nits, but nothing that blocks the patch.\u003c\\/p\u003e\\n\\n\u003cp\u003eThe nits:\u003c\\/p\u003e\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eWhen checking the SQLState of the nested exception, maybe use ExceptionUtil.getSQLStateFromIdentifier(SQLState.NET_WRITE_CHAIN_IS_DIRTY) instead of the magic string \\\"XN022\\\"? (And maybe use equals() instead of contentEquals()? I think they are equivalent, and equals() is shorter and more familiar (to me, at least).)\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eThe XN024.C message uses different characters for opening and closing quotes. I think most existing messages use a single-quote (\') character both for opening and closing. I didn\'t find any existing message that used the backtick (`) character. It would be good to make the style of the new message consistent with the existing messages.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n\\n\\n\u003cul class=\\\"alternate\\\" type=\\\"square\\\"\u003e\\n\\t\u003cli\u003eThe (Object[]) null argument to DisconnectException\'s constructor in verifyWriteChainIsClean() is probably not needed, since it\'s a vararg.\u003c\\/li\u003e\\n\u003c\\/ul\u003e\\n \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"knutanders\\\" id=\\\"commentauthor_13790249_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=knutanders\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"knutanders\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Knut Anders Hatlen\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13790249_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Oct\\/13 11:03\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-09T11:03:13+0000\'\u003e09\\/Oct\\/13 11:03\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Thanks, Dyre! The patch looks fine to me. I found some tiny nits, but nothing that blocks the patch. \\n\\n The nits: \\n\\n \\n\\t When checking the SQLState of the nested exception, maybe use ExceptionUtil.getSQLStateFromIdentifier(SQLState.NET_WRITE_CHAIN_IS_DIRTY) instead of the magic string \\\"XN022\\\"? (And maybe use equals() instead of contentEquals()? I think they are equivalent, and equals() is shorter and more familiar (to me, at least).) \\n \\n\\n\\n \\n\\t The XN024.C message uses different characters for opening and closing quotes. I think most existing messages use a single-quote (\') character both for opening and closing. I didn\'t find any existing message that used the backtick (`) character. It would be good to make the style of the new message consistent with the existing messages. \\n \\n\\n\\n \\n\\t The (Object[]) null argument to DisconnectException\'s constructor in verifyWriteChainIsClean() is probably not needed, since it\'s a vararg. \\n \\n             \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13790284\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13790284&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13790284\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13790284_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13790284_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Oct\\/13 12:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-09T12:06:13+0000\'\u003e09\\/Oct\\/13 12:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eGood suggestions, thanks.\u003c\\/p\u003e\\n\\n\u003cp\u003eWrt. contentEquals - I thought the more specific method should be preferred - contentEquals(CharSquence) over equals(Object). I naively assumed that since someone has gone through the trouble of providing the former, it was because there is some benefit (performance or other) to be had if you already know that you are comparing to a CharSequence...\u003c\\/p\u003e\\n\\n\u003cp\u003eWrt. backtick - Changed - but see \u003cbr\\/\u003e\\n\u003ca href=\\\"http:\\/\\/programmers.stackexchange.com\\/questions\\/75349\\/why-do-nix-y-folks-single-quote-like-this-instead-of-like-this\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttp:\\/\\/programmers.stackexchange.com\\/questions\\/75349\\/why-do-nix-y-folks-single-quote-like-this-instead-of-like-this\u003c\\/a\u003e\u003cbr\\/\u003e\\nif you\'re bored \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e\u003c\\/p\u003e\\n\\n\u003cp\u003eWrt. (Object[]) cast - Changed. However, I shamelessly blame Netbeans for this \u003cimg class=\\\"emoticon\\\" src=\\\"\\/jira\\/images\\/icons\\/emoticons\\/smile.png\\\" height=\\\"16\\\" width=\\\"16\\\" align=\\\"absmiddle\\\" alt=\\\"\\\" border=\\\"0\\\"\\/\u003e I think I used Netbeans to refactor away the local var which was used as the last arg, which then became null, (or maybe I added the null myself just to make it compile). Then NB gives a warning and suggests \\\"cast to Object for a varargs call\\\" or \\\"cast to (Object[]) for a non-varargs call and to suppress this warning\\\".  \u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13790284_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13790284_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Oct\\/13 12:06\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-09T12:06:13+0000\'\u003e09\\/Oct\\/13 12:06\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Good suggestions, thanks. \\n\\n Wrt. contentEquals - I thought the more specific method should be preferred - contentEquals(CharSquence) over equals(Object). I naively assumed that since someone has gone through the trouble of providing the former, it was because there is some benefit (performance or other) to be had if you already know that you are comparing to a CharSequence... \\n\\n Wrt. backtick - Changed - but see  \\n http:\\/\\/programmers.stackexchange.com\\/questions\\/75349\\/why-do-nix-y-folks-single-quote-like-this-instead-of-like-this  \\nif you\'re bored   \\n\\n Wrt. (Object[]) cast - Changed. However, I shamelessly blame Netbeans for this   I think I used Netbeans to refactor away the local var which was used as the last arg, which then became null, (or maybe I added the null myself just to make it compile). Then NB gives a warning and suggests \\\"cast to Object for a varargs call\\\" or \\\"cast to (Object[]) for a non-varargs call and to suppress this warning\\\".                \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13790441\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13790441&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13790441\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13790441_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13790441_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Oct\\/13 15:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-09T15:08:33+0000\'\u003e09\\/Oct\\/13 15:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eNew patch including all suggested changes. I have been persuaded that there is, in fact, no benefit to using contentEquals... quite the opposite.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"dyret\\\" id=\\\"commentauthor_13790441_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"dyret\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Dyre Tjeldvoll\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13790441_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Oct\\/13 15:08\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-09T15:08:33+0000\'\u003e09\\/Oct\\/13 15:08\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    New patch including all suggested changes. I have been persuaded that there is, in fact, no benefit to using contentEquals... quite the opposite.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13790595\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13790595&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13790595\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13790595_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13790595_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Oct\\/13 16:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-09T16:40:32+0000\'\u003e09\\/Oct\\/13 16:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1530704 from \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/ViewProfile.jspa?name=dyret\\\" class=\\\"user-hover\\\" rel=\\\"dyret\\\"\u003eDyre Tjeldvoll\u003c\\/a\u003e in branch \'code\\/trunk\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1530704\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1530704\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5317\\\" title=\\\" NullPointerException in org.apache.derby.client.net.Request.sendBytes()  with client\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5317\\\"\u003e\u003cdel\u003eDERBY-5317\u003c\\/del\u003e\u003c\\/a\u003e: Detect attempts to reuse a connection that in the middle of sending a request to the server. Use this to provide a better error message and avoid the NPE.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13790595_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13790595_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'09\\/Oct\\/13 16:40\'\u003e\u003ctime class=\'livestamp\' datetime=\'2013-10-09T16:40:32+0000\'\u003e09\\/Oct\\/13 16:40\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1530704 from  Dyre Tjeldvoll  in branch \'code\\/trunk\' \\n[  https:\\/\\/svn.apache.org\\/r1530704  ] \\n\\n   DERBY-5317  : Detect attempts to reuse a connection that in the middle of sending a request to the server. Use this to provide a better error message and avoid the NPE.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13916223\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13916223&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13916223\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_13916223_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13916223_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/14 19:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-28T19:26:24+0000\'\u003e28\\/Feb\\/14 19:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eopening for backport to 10.10.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_13916223_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13916223_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'28\\/Feb\\/14 19:26\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-02-28T19:26:24+0000\'\u003e28\\/Feb\\/14 19:26\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    opening for backport to 10.10.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13917507\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13917507&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13917507\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13917507_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13917507_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Mar\\/14 18:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-03-02T18:05:50+0000\'\u003e02\\/Mar\\/14 18:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1573334 from mikem@apache.org in branch \'code\\/branches\\/10.10\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1573334\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1573334\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5317\\\" title=\\\" NullPointerException in org.apache.derby.client.net.Request.sendBytes()  with client\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5317\\\"\u003e\u003cdel\u003eDERBY-5317\u003c\\/del\u003e\u003c\\/a\u003e: Detect attempts to reuse a connection that in the middle of sending a request to the server. Use this to provide a better error message and avoid the NPE.\u003cbr\\/\u003e\\n\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-6386\\\" title=\\\"Errors in jdbc4.LobStreamTest if derbyclient.jar is first in the classpath\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-6386\\\"\u003e\u003cdel\u003eDERBY-6386\u003c\\/del\u003e\u003c\\/a\u003e - Errors in jdbc4.LobStreamTest if derbyclient.jar is first in the classpath\u003c\\/p\u003e\\n\\n\u003cp\u003ebackported change #1530704 to fix \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5317\\\" title=\\\" NullPointerException in org.apache.derby.client.net.Request.sendBytes()  with client\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5317\\\"\u003e\u003cdel\u003eDERBY-5317\u003c\\/del\u003e\u003c\\/a\u003e from trunk to 10.10, needed some\u003cbr\\/\u003e\\n   hand merging to fix difference in argument ordering between 10.10 and trunk.\u003cbr\\/\u003e\\nbackported change #1534425 to fix \u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-6386\\\" title=\\\"Errors in jdbc4.LobStreamTest if derbyclient.jar is first in the classpath\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-6386\\\"\u003e\u003cdel\u003eDERBY-6386\u003c\\/del\u003e\u003c\\/a\u003e which was caused by DERBY5317 fix.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13917507_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13917507_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'02\\/Mar\\/14 18:05\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-03-02T18:05:50+0000\'\u003e02\\/Mar\\/14 18:05\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1573334 from mikem@apache.org in branch \'code\\/branches\\/10.10\' \\n[  https:\\/\\/svn.apache.org\\/r1573334  ] \\n\\n   DERBY-5317  : Detect attempts to reuse a connection that in the middle of sending a request to the server. Use this to provide a better error message and avoid the NPE. \\n  DERBY-6386   - Errors in jdbc4.LobStreamTest if derbyclient.jar is first in the classpath \\n\\n backported change #1530704 to fix   DERBY-5317   from trunk to 10.10, needed some \\n   hand merging to fix difference in argument ordering between 10.10 and trunk. \\nbackported change #1534425 to fix   DERBY-6386   which was caused by DERBY5317 fix.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13918292\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13918292&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13918292\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13918292_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13918292_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Mar\\/14 17:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-03-03T17:27:27+0000\'\u003e03\\/Mar\\/14 17:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eCommit 1573624 from mikem@apache.org in branch \'code\\/branches\\/10.10\'\u003cbr\\/\u003e\\n[ \u003ca href=\\\"https:\\/\\/svn.apache.org\\/r1573624\\\" class=\\\"external-link\\\" rel=\\\"nofollow\\\"\u003ehttps:\\/\\/svn.apache.org\\/r1573624\u003c\\/a\u003e ]\u003c\\/p\u003e\\n\\n\u003cp\u003e\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-5317\\\" title=\\\" NullPointerException in org.apache.derby.client.net.Request.sendBytes()  with client\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-5317\\\"\u003e\u003cdel\u003eDERBY-5317\u003c\\/del\u003e\u003c\\/a\u003e: Detect attempts to reuse a connection that in the middle of sending a request to the server. Use this to provide a better error message and avoid the NPE.\u003cbr\\/\u003e\\n\u003ca href=\\\"https:\\/\\/issues.apache.org\\/jira\\/browse\\/DERBY-6386\\\" title=\\\"Errors in jdbc4.LobStreamTest if derbyclient.jar is first in the classpath\\\" class=\\\"issue-link\\\" data-issue-key=\\\"DERBY-6386\\\"\u003e\u003cdel\u003eDERBY-6386\u003c\\/del\u003e\u003c\\/a\u003e - Errors in jdbc4.LobStreamTest if derbyclient.jar is first in the classpath\u003c\\/p\u003e\\n\\n\u003cp\u003ebacking out change #1573334 which caused problems in nightly 10.10 test runs.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"jira-bot\\\" id=\\\"commentauthor_13918292_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=jira-bot\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"jira-bot\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e ASF subversion and git services\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13918292_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Mar\\/14 17:27\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-03-03T17:27:27+0000\'\u003e03\\/Mar\\/14 17:27\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    Commit 1573624 from mikem@apache.org in branch \'code\\/branches\\/10.10\' \\n[  https:\\/\\/svn.apache.org\\/r1573624  ] \\n\\n   DERBY-5317  : Detect attempts to reuse a connection that in the middle of sending a request to the server. Use this to provide a better error message and avoid the NPE. \\n  DERBY-6386   - Errors in jdbc4.LobStreamTest if derbyclient.jar is first in the classpath \\n\\n backing out change #1573334 which caused problems in nightly 10.10 test runs.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13918380\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13918380&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13918380\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_13918380_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13918380_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Mar\\/14 18:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-03-03T18:33:21+0000\'\u003e03\\/Mar\\/14 18:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Mike Matrigali - 03\\/Mar\\/14 18:37\\\"\u003eedited\u003c\\/span\u003e \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003eissue does not backport cleanly to 10.10.  Also causes build problems in 10.10 in some environments.   Also it adds some exceptions that may not be appropriate for existing \u003cbr\\/\u003e\\napplications on a released product, better to introduce these only in a new release.\u003cbr\\/\u003e\\nMarking not appropriate for backport.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n                                            \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_13918380_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13918380_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Mar\\/14 18:33\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-03-03T18:33:21+0000\'\u003e03\\/Mar\\/14 18:33\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e   - \u003cspan class=\\\"redText subText\\\" title=\\\"Mike Matrigali - 03\\/Mar\\/14 18:37\\\"\u003eedited\u003c\\/span\u003e                   issue does not backport cleanly to 10.10.  Also causes build problems in 10.10 in some environments.   Also it adds some exceptions that may not be appropriate for existing  \\napplications on a released product, better to introduce these only in a new release. \\nMarking not appropriate for backport.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-13918382\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=13918382&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13918382\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_13918382_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13918382_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Mar\\/14 18:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-03-03T18:34:47+0000\'\u003e03\\/Mar\\/14 18:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ereassigning original owner.  Looked at backporting, but ran into both merge and build problems.  Marked not appropriate for backport at this time.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"mikem\\\" id=\\\"commentauthor_13918382_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=mikem\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"mikem\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Mike Matrigali\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_13918382_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'03\\/Mar\\/14 18:34\'\u003e\u003ctime class=\'livestamp\' datetime=\'2014-03-03T18:34:47+0000\'\u003e03\\/Mar\\/14 18:34\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    reassigning original owner.  Looked at backporting, but ran into both merge and build problems.  Marked not appropriate for backport at this time.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \\n\\n\\n\u003cdiv id=\\\"comment-14284717\\\" class=\\\"issue-data-block activity-comment twixi-block  expanded\\\"\u003e\\n    \u003cdiv class=\\\"twixi-wrap verbose actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Collapse comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-expanded\\\"\u003e\u003cspan\u003eHide\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-links\\\"\u003e\\n                \u003ca href=\\\"\\/jira\\/browse\\/DERBY-5317?focusedCommentId=14284717&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14284717\\\"\\n                   title=\\\"Right click and copy link for a permanent link to this comment.\\\" class=\\\"activitymodule-link issue-comment-action\\\"\u003e\\n                    \u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-link\\\"\u003ePermalink\u003c\\/span\u003e\u003c\\/a\u003e\\n                                            \u003c\\/div\u003e\\n            \u003cdiv class=\\\"action-details\\\"\u003e        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"myrna\\\" id=\\\"commentauthor_14284717_verbose\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=myrna\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"myrna\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Myrna van Lunteren\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14284717_verbose subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/15 00:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-01-21T00:22:56+0000\'\u003e21\\/Jan\\/15 00:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e  \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n        \u003cdiv class=\\\"action-body flooded\\\"\u003e\u003cp\u003ebulk change to close all issues resolved but not closed and not changed since June 1, 2014.\u003c\\/p\u003e \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n    \u003cdiv class=\\\"twixi-wrap concise actionContainer\\\"\u003e\\n        \u003cdiv class=\\\"action-head\\\"\u003e\\n            \u003ca href=\\\"#\\\" title=\\\"Expand comment\\\" class=\\\"twixi\\\"\u003e\u003cspan class=\\\"icon-default aui-icon aui-icon-small aui-iconfont-collapsed\\\"\u003e\u003cspan\u003eShow\u003c\\/span\u003e\u003c\\/span\u003e\u003c\\/a\u003e\\n            \u003cdiv class=\\\"action-details flooded\\\"\u003e\\n                        \\n    \\n    \\n    \\n                \\n\\n    \u003ca class=\\\"user-hover user-avatar\\\" rel=\\\"myrna\\\" id=\\\"commentauthor_14284717_concise\\\" href=\\\"\\/jira\\/secure\\/ViewProfile.jspa?name=myrna\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-xsmall\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"https:\\/\\/issues.apache.org\\/jira\\/secure\\/useravatar?size=xsmall&amp;avatarId=10452\\\" alt=\\\"myrna\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e Myrna van Lunteren\u003c\\/a\u003e\\n added a comment  - \u003cspan class=\'commentdate_14284717_concise subText\'\u003e\u003cspan class=\'date user-tz\' title=\'21\\/Jan\\/15 00:22\'\u003e\u003ctime class=\'livestamp\' datetime=\'2015-01-21T00:22:56+0000\'\u003e21\\/Jan\\/15 00:22\u003c\\/time\u003e\u003c\\/span\u003e\u003c\\/span\u003e                    bulk change to close all issues resolved but not closed and not changed since June 1, 2014.              \u003c\\/div\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n                             \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["scope-filter-data"]="{\"createScopeActions\":[],\"scopes\":[]}";
WRM._unparsedData["sidebar-collapsed-by-default"]="true";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:can-manage"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:with-icons"]="false";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:shortcuts"]="[]";
WRM._unparsedData["com.atlassian.jira.projects.shortcuts:project-id"]="10594";
WRM._unparsedData["sidebar-id"]="\"\u003cdiv class=\\\"aui-sidebar  projects-sidebar sidebar-pending\\\" \u003e\u003cdiv class=\\\"aui-sidebar-wrapper\\\"\u003e\u003cdiv class=\\\"aui-sidebar-body\\\"\u003e\u003cheader class=\\\"aui-page-header\\\"\u003e\u003cdiv class=\\\"aui-page-header-inner\\\"\u003e\u003cdiv class=\\\"aui-page-header-image\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\" class=\\\"jira-project-avatar\\\"\u003e\u003cspan class=\\\"aui-avatar aui-avatar-large aui-avatar-project\\\"\u003e\u003cspan class=\\\"aui-avatar-inner\\\"\u003e\u003cimg src=\\\"\\/jira\\/secure\\/projectavatar?pid=10594&amp;avatarId=10122\\\" alt=\\\"Derby\\\" \\/\u003e\u003c\\/span\u003e\u003c\\/span\u003e\u003cimg src=\\\"data:image\\/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI\\/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE4LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDMwMCAzMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwMCAzMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJMYXllcl8yIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRjc5MjMyOyIgZD0iTTE1MCwwQzY2LjY2NywwLDAsNjYuNjY3LDAsMTUwczY2LjY2NywxNTAsMTUwLDE1MHMxNTAtNjYuNjY3LDE1MC0xNTBTMjMzLjMzMywwLDE1MCwweg0KCQkgTTEzNi42NjcsMTc4LjMzM0wxMjUsMTkwbC00MS42NjctNDBMOTUsMTM4LjMzM2wzMC0zMEwxMzYuNjY3LDEyMGwtMzAsMzBMMTM2LjY2NywxNzguMzMzeiBNMjA1LDE2MS42NjdsLTMwLDMwTDE2My4zMzMsMTgwDQoJCWwzMC0zMGwtMzAtMzBMMTc1LDEwOC4zMzNMMjE2LjY2NywxNTBMMjA1LDE2MS42Njd6Ii8+DQo8L2c+DQo8Zz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZGRkZGOyIgcG9pbnRzPSIxNzUsMTkxLjY2NyAyMDUsMTYxLjY2NyAyMTYuNjY3LDE1MCAxNzUsMTA4LjMzMyAxNjMuMzMzLDEyMCAxOTMuMzMzLDE1MCAxNjMuMzMzLDE4MCAJIi8+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIHBvaW50cz0iMTI1LDEwOC4zMzMgOTUsMTM4LjMzMyA4My4zMzMsMTUwIDEyNSwxOTAgMTM2LjY2NywxNzguMzMzIDEwNi42NjcsMTUwIDEzNi42NjcsMTIwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K\\\" alt=\\\"Icon indicating the project type\\\" class=\\\"jira-project-avatar-icon\\\" \\/\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-image --\u003e\u003cdiv class=\\\"aui-page-header-main\\\"\u003e\u003ch1\u003e\u003cdiv class=\\\"aui-group aui-group-split\\\"\u003e\u003cdiv class=\\\"aui-item project-title\\\"\u003e\u003ca href=\\\"\\/jira\\/projects\\/DERBY\\/summary\\\" title=\\\"Derby\\\"\u003eDerby\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/h1\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-main --\u003e\u003c\\/div\u003e\u003c!-- .aui-page-header-inner --\u003e\u003c\\/header\u003e\u003c!-- .aui-page-header --\u003e\u003cnav class=\\\"aui-navgroup aui-navgroup-vertical\\\"\u003e\u003cdiv class=\\\"aui-navgroup-inner sidebar-content-container\\\"\u003e\u003cdiv class=\\\"aui-sidebar-group aui-sidebar-group-tier-one\\\" data-id=\\\"sidebar-navigation-panel\\\"\u003e\u003cul class=\\\"aui-nav\\\"\u003e\u003cli class=\\\"aui-nav-selected\\\" \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY\\/issues\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-issue-navigator:sidebar-issue-navigator\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-issues\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Issues\\\"\u003eIssues\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:report-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large agile-icon-report\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Reports\\\"\u003eReports\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003cli  \u003e\u003ca class=\\\"aui-nav-item \\\" href=\\\"\\/jira\\/projects\\/DERBY?selectedItem=com.atlassian.jira.jira-projects-plugin:components-page\\\" data-link-id=\\\"com.atlassian.jira.jira-projects-plugin:components-page\\\" \u003e\u003cspan class=\\\"aui-icon aui-icon-large icon-sidebar-components\\\"\u003e\u003c\\/span\u003e\u003cspan class=\\\"aui-nav-item-label\\\" title=\\\"Components\\\"\u003eComponents\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/li\u003e\u003c\\/ul\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/nav\u003e\u003c\\/div\u003e\u003cdiv class=\\\"aui-sidebar-footer\\\"\u003e\u003ca class=\\\"aui-button aui-button-subtle aui-sidebar-toggle aui-sidebar-footer-tipsy\\\" data-tooltip=\\\"Expand sidebar ( [ )\\\" href=\\\"#\\\"\u003e\u003cspan class=\\\"aui-icon aui-icon-small\\\"\u003e\u003c\\/span\u003e\u003c\\/a\u003e\u003c\\/div\u003e\u003c\\/div\u003e\u003c\\/div\u003e\"";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script> 
  <script type="text/javascript" src="/jira/s/d41d8cd98f00b204e9800998ecf8427e-CDN/3pgavk/76005/1c78b578e5c0e813799ab2baea47b6f7/1.0/_/download/batch/jira.webresources:bigpipe-init/jira.webresources:bigpipe-init.js" data-wrm-key="jira.webresources:bigpipe-init" data-wrm-batch-type="resource" data-initially-rendered></script> 
  <form id="jira_request_timing_info" class="dont-default-focus"> 
   <fieldset class="parameters hidden"> 
    <input type="hidden" title="jira.request.start.millis" value="1520240278748"> 
    <input type="hidden" title="jira.request.server.time" value="237"> 
    <input type="hidden" title="jira.request.id" value="537x94419301x4"> 
    <input type="hidden" title="jira.session.expiry.time" value="-"> 
    <input type="hidden" title="jira.session.expiry.in.mins" value="-"> 
    <input id="jiraConcurrentRequests" type="hidden" name="jira.request.concurrent.requests" value="5"> 
    <input type="hidden" title="db.reads.time.in.ms" value="44"> 
    <input type="hidden" title="db.conns.time.in.ms" value="50"> 
   </fieldset> 
  </form> 
  <!--
	                 REQUEST ID : 537x94419301x4
	          REQUEST TIMESTAMP : [05/Mar/2018:08:57:58 +0000]
	               REQUEST TIME : 0.2370
	                 ASESSIONID : -
	        CONCURRENT REQUESTS : 5

	                      db.reads : OpSnapshot{name='db.reads', invocationCount=30, elapsedTotal=44169750, elapsedMin=520667, elapsedMax=9566609, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
	                      db.conns : OpSnapshot{name='db.conns', invocationCount=34, elapsedTotal=50860471, elapsedMin=541550, elapsedMax=9606446, resultSetSize=0, cpuTotal=0, cpuMin=0, cpuMax=0}
-->   
 </body>
</html>